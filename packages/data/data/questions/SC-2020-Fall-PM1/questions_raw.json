[
  {
    "qNo": 1,
    "theme": "スマートフォンを用いた決済システムのセキュリティ対策",
    "description": "N社は、従業員数 10,000 名の飲食業者で、全国に 500 店舗を展開している。N社では、会員番号をバーコードとして表示するスマートフォン用ポイントアプリケーションプログラム（以下、ポイントアプリという）を使って、ポイントサービスを提供している。\n\n### 〔Nシステムの概要〕\nNシステムは、店舗で店員が利用するタブレット端末用店舗アプリケーションプログラム（以下、店舗アプリという）、利用者が利用するスマートフォン用決済アプリケーションプログラム（以下、決済アプリという）、及び決済、ログ取得、アラート通知などの機能をもつ Web サーバN を用いて決済を実現する。\n\n```mermaid\ngraph LR\n    subgraph 店舗\n        A[タブレット端末<br/>店舗アプリ] -- \"無線\" --- B[無線LANルータ]\n    end\n    B -- \"HTTPS\" --- C((インターネット))\n    D[スマートフォン<br/>決済アプリ] -- \"HTTPS\" --- C\n    C -- \"HTTPS\" --- E[WebサーバN]\n    subgraph WebサーバN\n        E1[決済]\n        E2[ログ取得]\n        E3[アラート通知]\n    end\n```\n\n**表1 決済アプリの機能の概要（抜粋）**\n| 機能 | 概要 |\n| :--- | :--- |\n| 会員登録 | 利用者を会員登録する。ログインIDとして、メールアドレスを登録する。登録すると会員番号が自動で発番される。 |\n| ログイン | ログインIDとパスワードを入力して、ログインする。 |\n| 決済 | ポイントアプリの仕組みを利用し、16桁の会員番号をバーコードとして表示する。決済が完了すると、決済完了の画面が表示される。 |\n\n**表2 Web サーバN の機能の概要（抜粋）**\n| 機能 | 概要 |\n| :--- | :--- |\n| 決済 | 決済アプリ及び店舗アプリとのメッセージのやり取り、並びに決済を行う。 |\n| ログ取得 | 次の各種ログを取得する。<br>・会員登録、ログイン<br>・決済アプリ及び店舗アプリの起動<br>・決済アプリ及び店舗アプリでの決済 |\n| アラート通知 | 次のイベントが検知された場合は、Nシステムの管理者にアラートを通知する。<br>(i) 同一 IP アドレスから、同一のログイン ID でのログイン失敗が短時間に連続する。<br>(ii) 同一 IP アドレスから、存在しないログイン ID でのログイン試行が短時間に連続する。 |\n\n### 〔Yさんの指摘〕\n情報処理安全確保支援士のYさんがレビューし、指摘を行った。\n\n**表6 Yさんの指摘**\n| 項番 | 指摘の内容 |\n| :--- | :--- |\n| 1 | 他者になりすまして決済できる。今までポイントアプリでは被害が発生していなかったが、決済アプリでは金銭を直接扱うので、リスクがより高い。 |\n| 2 | 店舗の無線 LAN ルータには既知の脆弱性が存在する。インターネット側から管理者機能のログイン画面にアクセスできてしまう。 |\n| 3 | 管理者機能のパスワードが工場出荷時のものから変更されていない可能性がある。変更されていないと、無線 LAN に接続している利用者の端末から管理者機能にアクセスできる。 |\n| 4 | 決済アプリ及び店舗アプリでのサーバ証明書の検証に不備がある。 |\n| 5 | 決済アプリの会員登録機能は、攻撃者が悪用すると、当該機能の挙動からスクリーニングができてしまう。 |\n\n### 〔項番1への対策〕\nメッセージ認証（HMAC）を用いることにした。バーコードに代わり QR コードを表示し、その中に会員番号、乱数、時刻、及びそれらを基に生成される HMAC 値を含める。\n\n```mermaid\nsequenceDiagram\n    participant App as 決済アプリ\n    participant Shop as 店舗アプリ\n    participant Srv as WebサーバN\n    Note over App, Srv: 事前にログイン済み\n    App->>Srv: QRコード生成リクエスト\n    Srv-->>Srv: 乱数生成, QRコード生成\n    Srv->>App: QRコード\n    App->>Shop: QRコード読み込み\n    Shop->>Srv: 決済リクエスト (QRコード, 金額)\n    Srv-->>Srv: QRコード検証, 決済\n    Srv->>Shop: 決済結果通知\n    Srv->>App: 決済結果通知\n```",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "〔項番1への対策〕について、(1)、(2)に答えよ。",
        "explanation": "### 指摘1：なりすまし決済のリスク\n従来のポイントアプリでは16桁の固定の会員番号をバーコード表示していたため、そのバーコードを盗撮・複製されると、他者が本人になりすまして決済できてしまう脆弱性がありました。\n\n### 対策：HMACの導入\nQRコード内に「乱数」と「有効期限（時刻）」、そしてそれらを秘密鍵で署名した「HMAC」を含めることで、以下の効果があります：\n1. **偽造防止**: 秘密鍵を知らない攻撃者は正しいHMAC値を生成できません。\n2. **再利用防止**: 5分間という有効期限を設けることで、一度使われたり時間が経過したQRコードを無効化（リプレイアタック対策）します。\n\n設問1(2)の「a」は、QRコード内のHMAC値（β）と、サーバ側で計算したHMAC値（α）を比較して一致することを確認するプロセスが入ります。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "どのような手段でなりすまして決済ができるのか。想定される手段を30字以内で具体的に述べよ。また、その攻撃が成功してしまう決済アプリにおける問題を25字以内で具体的に述べよ。"
          },
          {
            "label": "(2)",
            "text": "図3中の [ a ] に入れる適切な字句を、30字以内で述べよ。"
          }
        ]
      },
      {
        "subQNo": "設問2",
        "text": "〔項番2〜4への対策〕について、(1)、(2)に答えよ。",
        "explanation": "### 指摘2, 3：無線LANルータの管理不備\n攻撃者が管理者権限を奪取すると、DNSサーバの設定を自身の用意した悪意あるサーバに向けさせる（DNS偽装）ことができます。これにより利用者は正規のサイトに繋いでいるつもりで偽サイトへ誘導される危険があります。\n\n### 指認4：サーバ証明書の検証不備\nアプリ側でサーバ証明書を正しく検証（ホスト名が正しいか、信頼できる認証局か等）しないと、中間者攻撃に対して無防備になります。\n設問2(2)の選択肢について：\n- **b, d**: `subjectAltName` (dDNSName) または `commonName` を確認します。\n- **c**: 接続先のホスト名（WebサーバN）と一致するかを確認します。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線①について、攻撃者はどの設定項目の内容をどのように変更するか。変更する設定項目を表5の中から選び、記号で答えよ。また、変更後の設定内容を25字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "図4中の [ b ] 〜 [ d ] に入れる適切な字句を、解答群の中から選び記号で答えよ。"
          }
        ]
      }
    ]
  },
  {
    "qNo": 2,
    "theme": "電子メールのセキュリティ対策（S/MIMEの導入）",
    "description": "R社は、従業員数 100 名のシステム開発会社である。設計ドキュメントファイルをパスワード付き ZIP ファイルにし、メールに添付して送信しているが、パスワードを平文の別メールで送る「PPAP」の運用に課題を感じている。\n\n### 〔R社の情報システム〕\n```mermaid\ngraph TD\n    Internet((インターネット)) --- FW[ファイアウォール]\n    subgraph R社 内部システムLAN\n        FW --- L2SW1[L2スイッチ]\n        L2SW1 --- InternalMail[内部メールサーバ]\n        L2SW1 --- Directory[ディレクトリサーバ]\n        L2SW1 --- BizSrv[業務サーバ]\n    end\n    subgraph DMZ\n        FW --- L2SW2[L2スイッチ]\n        L2SW2 --- ExtMail[外部メールサーバ]\n        L2SW2 --- Proxy[プロキシサーバ]\n    end\n    FW --- L2SW3[L2スイッチ]\n    L2SW3 --- PCLAN[PC-LAN]\n```\n\n### 〔要望への対応〕\nD部長は、メールの暗号化と送信者の検証を求めた。E主任とHさんは S/MIME の利用を検討した。S/MIME を利用すれば、電子署名による送信者の確認と、メール本文の暗号化が可能になる。\n\n### 〔S/MIME 利用に向けた課題と解決策〕\n1. プライベート認証局（R社CA）のルート証明書をPCに登録する必要があるが、委託先によっては禁止されている。\n2. 委託先に事前に S/MIME 証明書を渡す必要がある。\n3. メーリングリスト（ML）宛てのメールを暗号化できない。MLサーバ側で一旦復号し、各メンバ宛てに個別に暗号化し直す必要があるが、Gサービスでは対応していない。",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "〔R社の情報システム〕について、(1)、(2)に答えよ。",
        "explanation": "### プロトコルの知識\nディレクトリサーバ（LDAP）へのアクセスには標準でTCP 389番ポートが使われます。英字5字以内なので「LDAP」となります。\nPCのWebブラウザがサーバ証明書の失効を確認するための仕組みとして、RFC 6960で規定されているのは「OCSP」です。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "表1中の [ a ] に入れる適切なプロトコル名を、英字5字以内で答えよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の [ b ] に入れる適切なプロトコル名を、英字5字以内で答えよ。"
          }
        ]
      },
      {
        "subQNo": "設問2",
        "text": "〔要望への対応〕について、(1)〜(3)に答えよ。",
        "explanation": "### メールのセキュリティ\nメールの通信経路（SMTP over TLS等）を暗号化しただけでは、サーバに保管されている間のメールや、転送先でのセキュリティが担保されません。つまり「エンドツーエンド」の暗号化にならないため、表3の項番1（送信者から受信者まで暗号化された状態）を満たせません。\n送信者ドメイン認証（SPF, DKIM, DMARC）などは、エンベロープ（From）の真偽を確認できますが、メール本文の署名（S/MIME）により、より確実に送信者の検証が可能です。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線①の理由を、35字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の [ c ] に入れる適切な字句を、10字以内で答えよ。"
          },
          {
            "label": "(3)",
            "text": "本文中の下線②について、復号できなくなるのはどのような場合か。25字以内で述べよ。"
          }
        ]
      }
    ]
  },
  {
    "qNo": 3,
    "theme": "Webシステムのセキュリティ診断",
    "description": "L社は、ECサイトを運営しており、Pシステム（ポイントシステム）を運用している。セキュリティ強化のため、脆弱性診断を実施することになった。\n\n### 〔Pシステムのネットワーク構成〕\n```mermaid\ngraph TD\n    Internet((インターネット)) --- FW1\n    subgraph 本番環境 DMZ\n        FW1 --- NIPS[N-IPS]\n        NIPS --- L2SW_A[L2SW a]\n        L2SW_A --- SSL[SSLアクセラレータ]\n        SSL --- WebSrv[本番Webサーバ]\n    end\n    subgraph 本番環境 DB-LAN\n        FW1 --- L2SW_C[L2SW c]\n        L2SW_C --- DBSrv[本番DBサーバ]\n    end\n    subgraph 管理LAN\n        FW2 --- L2SW_B[L2SW b]\n        L2SW_B --- WebPC[Web管理PC]\n        L2SW_D[L2SW d] --- DBPC[DB管理PC]\n    end\n```\n\n### 〔診断計画〕\n脆弱性診断には「プラットフォーム（PF）診断」と「Webアプリケーション診断」がある。PF診断はOSやミドルウェアの脆弱性を、Web診断はアプリの不備を検査する。\n\n診断PCの接続地点について議論があり、インターネット経由の診断では、N-IPS（侵入防止システム）が診断通信をブロックしてしまう可能性がある。診断効果を最大化するためには、N-IPSの設定を一時的に変更するか、N-IPSの内側から診断を実施する必要がある。",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "〔Pシステムの診断計画〕について、(1)〜(3)に答えよ。",
        "explanation": "### N-IPSの影響\n脆弱性診断はスキャンツールなどを用いて疑似的な攻撃パケットを大量に送るため、N-IPSが「攻撃」と判断して遮断してしまいます。遮断されると、その背後にあるサーバの真の脆弱性が検出できなくなるため、診断時は「検知モード（遮断しないモード）」に変更するのが一般的です。\n接続地点については、インターネットからの攻撃を想定した診断であれば、本来はインターネット（a地点）から行うべきですが、IPSの影響を避けるために内部（DMZ内）から行う選択肢もあります。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線①について、その理由を35字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の下線②について、どのような設定変更をすべきか。30字以内で述べよ。"
          },
          {
            "label": "(3)",
            "text": "本文中及び表2中の [ a ] に入れる接続箇所を記号で答えよ。"
          }
        ]
      },
      {
        "subQNo": "設問2",
        "text": "〔Pシステムの診断計画レビュー〕について、(1)〜(4)に答えよ。",
        "explanation": "### 二次被害の防止\n本番DBサーバへの診断において、誤って管理用のアラート（警告灯）を点灯させてしまうリスクが指摘されました。ホスト型IPSが「DB管理PC」以外からのアクセスを検知して作動するため、FW2のフィルタリングルールを一時的に調整し、診断PCからの通信を許可または除外する必要があります。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の [ b ] に入れる適切な字句を、15字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の下線③について、何をどのように変更すべきか。20字以内で述べよ。"
          },
          {
            "label": "(3)",
            "text": "本文中の下線④について、どの機器に対して、どのように設定変更すべきか。55字以内で具体的に述べよ。"
          }
        ]
      }
    ]
  }
]