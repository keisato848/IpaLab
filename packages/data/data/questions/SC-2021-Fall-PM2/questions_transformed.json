{
  "questions": [
    {
      "qNo": 1,
      "theme": "Webアプリケーションのセキュリティ診断とXSS対策",
      "description": "構造化のために提供されたデータには、問題文の全体（背景情報、図表、設問1, 設問2など）が含まれていません。設問3の内容を解析するために、背景情報を推測して記述しています。",
      "context": {
        "title": "Dシステムの脆弱性診断",
        "background": "\n\n〔項目1の検討〕\nU社は、Gサービスを利用する際のセキュリティ要件を確認した。\n\nクラウドサービスに関連する国際規格として、ISO/IEC 27017 ([ d ]) と ISO/IEC 27018 ([ e ]) の適用可能性を検討した。\n\nまた、GサービスのデータセンターはF国に存在するが、F国の国内法によっては、G社がF国の捜査機関からのデータ提出命令に従わざるを得ない場合がある。この場合、顧客データが漏洩するリスクがあるため、U社はこれに対する措置を検討した。\n\nU社は、Gサービスが管理している暗号鍵を使ってファイルを暗号化しているが、この方法ではF国の法令に基づく強制開示を避けられない可能性があるため、下線④の措置を検討する。\n\n下線④: ファイルの内容が強制的に開示されることを防止するための措置。\n\nこの問題の背景情報や本文は入力データに含まれていません。\n\nL社では、特定の機密情報を扱うDシステムへのアクセスに際し、セキュリティ強化が求められている。特に、ファイル受渡し用PCからのみDシステムへのアクセスを許可する要件がある。このため、全社で導入しているIDaaSと連携し、FIDO認証を利用した多要素認証を導入することとした。\n\n〔IDaaSとの連携による多要素認証の実現方式の検討〕\n\nIDaaS連携による認証器の管理方式を検討するため、以下の表7に認証器の種類と検討事項をまとめた。\n\n{{diagram:table7}}\n\nまた、FIDO認証の導入にあたり、認証器の信頼性とセキュリティ要件を満たす必要があり、認証器としてOS内蔵機能（生体認証）を利用することを推奨するに至った（下線⑥）。FIDO認証では、フィッシング対策として、認証要求の際にオリジン確認を行う。しかし、攻撃者が [ g ] 場合、認証器が意図しない認証情報（署名M）を生成してしまうリスクがある。",
        "diagrams": [
          {
            "id": "fig3",
            "label": "報告書の内容（診断結果）",
            "type": "image",
            "content": "報告書に記載された診断結果の項目。特に(3) descriptionパラメータのエスケープ処理、(4) refURLのXSS発動について言及あり。"
          },
          {
            "id": "fig5",
            "label": "descriptionパラメータにスクリプトを入力した際の表示",
            "type": "image",
            "content": "descriptionパラメータに <script>alert('XSS!')</script> を入力した結果、エスケープ処理により &lt;script&gt;alert('XSS!')&lt;/script&gt; のように表示された画面キャプチャ。"
          },
          {
            "id": "fig6",
            "label": "画面Bの参考URLリンク部分のHTML構造（一部）",
            "type": "image",
            "content": "XSSが発動した画面BのリンクのHTML構造。`<a href=\" [ c ] \">` が含まれる。"
          },
          {
            "id": "fig7",
            "label": "画面Bの参考URLリンク部分のHTML構造（詳細）",
            "type": "image",
            "content": "XSSが発動した画面BのリンクのHTML構造。`<a href=\" [ c ] \"> [ c ] </a>` の形式を持つ。"
          },
          {
            "id": "table7",
            "label": "認証器の種類と検討事項",
            "type": "markdown",
            "content": "| 認証器の種類 | 紛失・盗難時の対策 | 退職時の対策 | セキュリティレベル | 備考 |\n|---|---|---|---|---|\n| スマートフォン (個人所有) | 認証器使用時に [ h ] が必要 | i 側で j が必要 | 高 | |\n| USB接続外部認証器 | ユーザー確認がないため、直ちに k が必要 | i 側で j が必要 | 中 | |\n| OS内蔵機能 (ファイル受渡し用PCに限定) | 認証器使用時に [ h ] が必要 | PC廃棄時に認証情報削除 | 極めて高 | 下線⑥の根拠 |"
          }
        ]
      },
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔Dシステムの脆弱性診断〕について、(1), (2)に答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図5中の [ a ], [ b ] に入れる適切な文字列を、それぞれ4字で答えよ。",
              "references": [
                "fig5"
              ],
              "answer": "&lt;, &gt;",
              "explanation": "図5は、`description`パラメータに`<script>alert('XSS!')</script>`を入力した結果です。報告書(図3, (3))によると、この箇所ではエスケープ処理が正しく行われているため、スクリプトは実行されず、タグがテキストとして表示されています。HTMLでタグを構成する山括弧（<, >）をテキスト表示するには、HTMLエンティティ（`&lt;`, `&gt;`）に変換します。4文字指定のため、\n\na: `&lt;`\nb: `&gt;`"
            },
            {
              "label": "(2)",
              "text": "図6中及び図7中の [ c ] に入れる適切な文字列を、解答群の中から選び、記号で答えよ。\n\n解答群\nア onmouseover=alert('XSS!')\nイ \"><script>alert('XSS!')</script>\nウ http: <script>alert('XSS!')</script>\nエ javascript:alert('XSS!')",
              "references": [
                "fig6",
                "fig7"
              ],
              "answer": "エ",
              "explanation": "診断用URL2を入力した際、画面Bの参考URLリンクをクリックするとXSSが発動した(図3, (4))ことから、`refURL`の値が`href`属性に注入され、クリックイベントでスクリプトが実行されたことがわかります。\n図7の出力構造は `<a href=\" [ c ] \"> [ c ] </a>` であり、クリック時にスクリプトを実行可能にするためには、`href`属性に`javascript:`スキームを使用するのが典型的です。\n\n解答群「エ javascript:alert('XSS!')」を`c`に代入すると、リンクは`<a href=\"javascript:alert('XSS!')\">javascript:alert('XSS!')</a>`となり、クリックによってアラートが実行されます。これは診断結果と一致します。\n\nしたがって、`c`には エ が入ります。"
            }
          ],
          "point": 20
        },
        {
          "subQNo": "設問2",
          "text": "〔Dシステムの脆弱性対策〕について、(1)~(3)に答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線①について、改修方法を45字以内で具体的に述べよ。",
              "answer": "refURLパラメータの値をHTMLタグの属性値として出力する際に必要な、ダブルクォーテーションやスペースなどのエスケープ処理を実装する。",
              "explanation": "下線①は、HTMLタグの属性値（`href`属性）として`refURL`パラメータを出力する際に必要なエスケープ処理が不足していた脆弱性（図3, (6)）を解消するための改修です。\n\n**解答:** `refURLパラメータの値をHTMLタグの属性値として出力する際に必要な、ダブルクォーテーションやスペースなどのエスケープ処理を実装する。`"
            },
            {
              "label": "(2)",
              "text": "本文中の下線②について,実行が許可されるのはどのようなスクリプトファイルか。40字以内で述べよ。",
              "answer": "Dシステムを構成するWebアプリケーションプログラムと同じオリジンから配信されるスクリプトファイル。",
              "explanation": "下線②は、`Content-Security-Policy: script-src 'self';`によって許可されるスクリプトです。`'self'`は、ドキュメントを配信したサーバーと同じオリジンからロードされるリソースを許可します。\n\n**解答:** `Dシステムを構成するWebアプリケーションプログラムと同じオリジンから配信されるスクリプトファイル。`"
            },
            {
              "label": "(3)",
              "text": "本文中の下線③について,実行が制限されてしまうのはどのようなスクリプトか。30字以内で述べよ。また、変更後の呼出し方法を50字以内で具体的に述べよ。",
              "answer": "HTML内に直接記述されたインラインスクリプトやインラインイベントハンドラ。 インラインスクリプトを外部ファイル化し、インラインイベントハンドラを外部スクリプトファイルでイベントリスナとして登録する方式に変更する。",
              "explanation": "`script-src 'self'`は、インラインスクリプトやHTML属性に直接記述されたイベントハンドラの実行を制限します。\n\n**実行が制限されるスクリプト (30字以内):** `HTML内に直接記述されたインラインスクリプトやインラインイベントハンドラ。`\n\n**変更後の呼出し方法 (50字以内):** 制限されるインラインコードを外部ファイル化し、外部ファイル内でイベントリスナーとして登録する方式に切り替えます。\n\n**解答:** `インラインスクリプトを外部ファイル化し、インラインイベントハンドラを外部スクリプトファイルでイベントリスナとして登録する方式に変更する。`"
            }
          ],
          "point": 20
        },
        {
          "subQNo": "設問3",
          "text": "〔項目1の検討〕について、(1),(2)に答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ d ], [ e ] に入れる適切な字句を、解答群の中から選び、記号で答えよ。\n\n解答群\nア 個人情報保護\nイ システム監査\nウ 情報セキュリティ管理策\nエ 審査及び認証",
              "answer": "d: ウ, e: ア",
              "explanation": "クラウドサービスの国際規格に関する問題です。\n*   ISO/IEC 27017は、クラウドサービス提供者が適用すべきセキュリティ管理策のガイダンスです。 d: ウ 情報セキュリティ管理策。\n*   ISO/IEC 27018は、パブリッククラウドにおけるPII（個人を特定できる情報）の保護に関する規範です。 e: ア 個人情報保護。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線④について、取り得る措置を40字以内で述べよ。",
              "answer": "ファイルをGサービスへアップロードする前に、U社が管理する鍵で暗号化する。",
              "explanation": "F国の国内法によりデータ提出を強制されるリスクに対して、ファイル内容を保護するための措置です。Gサービスが鍵を管理しているため、G社に強制力が行使された場合、データが漏洩します。これを防ぐには、U社自身が鍵を管理し、Gサービスには暗号化された状態でファイルを預ける必要があります。\n\n解答: ファイルをGサービスへアップロードする前に、U社が管理する鍵で暗号化する。"
            }
          ],
          "point": 20
        },
        {
          "subQNo": "設問4",
          "text": "〔項目2の検討〕について、(1),(2)に答えよ。",
          "references": [
            "table4"
          ],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "表4中の [ f ] に入れる適切な内容を20字以内で答えよ。",
              "answer": "ログイン失敗",
              "explanation": "項番1は、特定の利用者IDに対してパスワードを総当たりする攻撃（ブルートフォースアタック）の検知方法です。パスワード試行が失敗した回数をカウントします。\n\n**解答:** `ログイン失敗`"
            },
            {
              "label": "(2)",
              "text": "本文中の下線⑤について、ほかの場合とはどのような場合か。40字以内で述べよ。",
              "answer": "一定時間当たりに、同一IPアドレスから少数の利用者IDでログイン失敗が繰り返された場合。",
              "explanation": "項番2は、同一IPアドレスから多数の異なる利用者IDに対してログイン失敗が起きた場合に、IDの総当たり攻撃と判断して検知する仕組みです。\n「ほかの場合」とは、この検知条件（異なる利用者IDの数が多いこと）を満たさないケース、つまり、攻撃者が少数の利用者IDを標的としてパスワード総当たり攻撃を行う場合を指します。\n\n**解答:** `一定時間当たりに、同一IPアドレスから少数の利用者IDでログイン失敗が繰り返された場合。`"
            }
          ],
          "point": 20
        },
        {
          "subQNo": "設問5",
          "text": "〔IDaaSとの連携による多要素認証の実現方式の検討〕について、(1)~(3)に答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ g ] に入れる適切な内容を、20字以内で具体的に答えよ。",
              "answer": "正規のKサービスであるかのように見せかける",
              "explanation": "FIDO認証において、メッセージにオリジンb（Webサイトのドメイン）を含めるのは、フィッシングサイトからの認証要求を防ぐためです。攻撃者が正規のサイトを偽装した特別なサーバを立てた場合、認証器はそのオリジンを確認し、正規のオリジンでなければ認証情報（署名M）を生成しない、または生成してもサーバー側で検証に失敗します。gには、フィッシング攻撃の手口が入ります。\n\n**解答:** `正規のKサービスであるかのように見せかける`"
            },
            {
              "label": "(2)",
              "text": "表7中の [ h ] ~ [ k ] に入れる、適切な内容を、それぞれ 10字以内で答えよ。",
              "references": [
                "table7"
              ],
              "answer": "h: 生体認証, i: Kサービス, j: 登録を削除, k: 登録を解除",
              "explanation": "10文字以内で回答します。\n*   **h:** スマートフォンやOS内蔵機能は、紛失・盗難時に不正利用される可能性が低い理由として、「認証器使用時に [ h ] が必要」とあります。これは **生体認証** です。\n    **h:** `生体認証`\n*   **i, j:** スマートフォンを個人所有していた場合、退職時に不正アクセスを防ぐために、Kサービス側で認証器の登録を抹消する必要があります。\n    **i:** `Kサービス`\n    **j:** `登録を削除`\n*   **k:** USB接続外部認証器はユーザー確認がないため、紛失・盗難時には直ちに登録を解除する必要があります。\n    **k:** `登録を解除`"
            },
            {
              "label": "(3)",
              "text": "本文中の下線⑥のように考えた理由は何か。50字以内で述べよ。",
              "answer": "OS内蔵機能は認証器がファイル受渡し用PCに限定されるため、他のPCからのアクセス制限を技術的に実現できるから。",
              "explanation": "OS内蔵の生体認証機能が望ましいとされたのは、Dシステムが要求するセキュリティ要件（ファイル受渡し用PCからのみアクセス可能）を技術的に実現できるためです。\nOS内蔵機能は認証情報がそのPCのOSに紐づいており、認証器がPC本体から切り離せないため、他のPCから利用されるリスクを防げます。\n\n**解答:** `OS内蔵機能は認証器がファイル受渡し用PCに限定されるため、他のPCからのアクセス制限を技術的に実現できるから。`"
            }
          ],
          "point": 20
        }
      ]
    }
  ]
}