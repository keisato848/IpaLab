{
  "qNo": 1,
  "theme": "Webサイトを用いた書籍販売システムのセキュリティ",
  "description": "K社は技術書籍の大手出版社である。従来は全ての書籍を書店で販売していたが、顧客からの要望によって、高額書籍を自社の Web サイトでも販売することになった。K社システム部のL部長は、Web サイトを用いた書籍販売システム(以下,Webシステムという)の開発のためのプロジェクトチームを立ち上げ、開発課の M 課長をリーダに任命した。L部長は、情報セキュリティ確保のための対策として、サイバー攻撃による Web システムへの侵入を想定したテスト(以下,侵入テストという)を実施するように M 課長に指示した。M課長は、開発作業が結合テストまで完了した段階で、Webシステムのテスト環境を利用して侵入テストを実施することにした。\n\n### Webシステムのテスト環境\nWeb システムは、高額書籍を購入する顧客の氏名,住所,購入履歴などの個人情報(以下,顧客情報という)を内部ネットワーク上のデータベースサーバ(以下,DB サーバという)に保存し, Web サーバがDB サーバ、業務サーバにアクセスして販売処理を行う。Webシステムのテスト環境の構成を図1に示す。\n\n```mermaid\ngraph TD\n    Internet --> ルータ\n    ルータ --> ファイアウォール\n\n    subgraph DMZ\n        ファイアウォール -- L2SW --> Webサーバ\n        ファイアウォール -- L2SW --> DNSサーバ\n    end\n\n    subgraph 内部ネットワーク\n        ファイアウォール -- L3SW --> DBサーバ\n        ファイアウォール -- L3SW --> 業務サーバ\n    end\n\n    Webサーバ --- DBサーバ\n    Webサーバ --- 業務サーバ\n\n    note "L2SW: レイヤ2スイッチ"\n    note "L3SW: レイヤ3スイッチ"\n```\n\n### Webシステムの認証と通信\n顧客が Webシステムを利用する際、利用者 IDとパスワードで認証する。また、顧客との通信には、インターネット標準として利用されている [ a ] による暗号化通信を用いる。\nサーバ管理者は、各サーバやファイアウォールログを定期的にチェックすることによって、Webシステムにおける不正なアプリケーションの稼働を監視する。\n\n### 侵入テストの実施\nM 課長は、社外のセキュリティコンサルタントのN氏に侵入テストの実施を依頼した。N氏は、表1に示す侵入テストのテスト項目を作成し、M課長に提出した。\n\n**表1 テスト項目(抜粋)**\n\n| 項番 | 内容                                                                                              |\n| :--- | :------------------------------------------------------------------------------------------------ |\n| 1    | 攻撃者が、Web サーバの構成情報の調査結果から Web システムの脆弱性を確認することが可能か。         |\n| 2    | Web システムへの攻撃によって, Web システム内に侵入した後、 Web サーバの管理者権限の奪取が可能か。 |\n| 3    | Web アプリケーションの脆弱性を意図的に利用した攻撃が可能か。                                      |\n\n### 結果\nN氏は、テスト項目に沿って侵入テストを実施し、その結果と改善項目を M 課長に報告した。テスト結果と改善項目を表2に示す。\n\n**表2 テスト結果と改善項目(抜粋)**\n\n| 項番 | テスト結果                                                                                                                                                                                                                                                                                                                                                      | 改善項目                                                                                                                                                                                                                                                                                                                                                                |\n| :--- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| 1    | Web システムのサービスに必要がないポートが、インターネットに公開されていた。インターネットから Web サーバの構成情報を調査できた。                                                                                                                                                                                                                               | Web システムのサービスに必要なポートだけをインターネットに公開する。Web サーバが必要のない問合せに応答しないようにする。                                                                                                                                                                                                                                   |\n| 2    | Web サーバの脆弱性を利用して、Webサーバを [ b ] にし、そこを中継点として内部ネットワークに侵入できた。                                                                                                                                                                                                                                                        | セキュリティ機器を導入して、Web サーバへの不正アクセスを防御し、脆弱性の存在自体が広く公表される前にそれを悪用する [ c ] 攻撃のリスクを軽減する。ファイアウォールとサーバのログ管理を強化する。                                                                                                                                                                       |\n| 3    | Web アプリケーションを対象とした次の攻撃について、対処されていないので、Web アプリケーションを誤作動させることが可能であった。・バッファオーバフロー・SQLインジェクションさらに、DBサーバに不正アクセスし、顧客情報の奪取や改ざんが可能であった。 | 開発課で開発した Web アプリケーションの脆弱性の原因となっているセキュリティホールを修正する。 |\n\n### 改善項目とその対策\nM 課長と N氏は、Web システムの侵入テストの結果と、セキュリティ上の改善項目について、表1と表2を基にしてL部長に報告した。\n\nN氏: 現在の Web システムには、サイバー攻撃に対して多くの脆弱性が存在します。\n\nL部長: 項番1について説明してください。\n\nN氏: 攻撃者は①Web サーバの構成情報の調査によって、攻撃するために有用な情報を得ることで、Webサーバの脆弱性を探ってきます。\n\nL部長: どのような対策が有効ですか。\n\nN氏: ②ポートスキャンについては、Web サーバやファイアウォールの設定で防止する必要があります。Web サーバの構成情報の調査については、Webサーバの設定情報を変更して、必要のない問合せに応答しないようにすることで対処します。\n\nL部長: 項番2で, Web サーバについて改善項目がありますが、どのような対策が必要ですか。\n\nN氏: ③ Web サーバへの攻撃の疑いがあるアクセスを遮断するセキュリティ機器の導入が効果的です。保護する対象を Web アプリケーションに特化しており, Web サーバ上で使用するアプリケーションに潜む未知の脆弱性を突く攻撃を、プロトコルの異常などによって検知し、遮断できるようになります。\n\nL部長: 項番3のバッファオーバフローと SQL インジェクションについては、どのような対策が必要ですか。\n\nN氏: ソースコードをチェックするツールを使用して、Web アプリケーションの脆弱性を調査し、その結果に基づいたソースコードの修正が必要です。バッファオーバフローは、バッファにデータを保存する際に [ d ] を常にチェックすることで防ぐことができます。SQLインジェクションは、データをSQLに埋め込むところで、データの特殊文字を適切に [ e ] することで防ぐことができます。\n\nM課長: 改善項目に対応するよう Web アプリケーションのソースコードを修正します。\n\nN氏: Webシステムの構成にも問題点があります。攻撃者が、攻撃の発見を遅らせるために、Webシステム内でログを消去するおそれがあります。\n\nL部長: 対策方法はありますか。\n\nN氏: 各サーバやファイアウォールのログを集中して保存する専用のサーバを設置し,ログが消去されることを防ぎます。また、④ログをリアルタイムにチェックするツールを導入します。\n\nN氏の指摘に基づいて、開発課が Web システムを改善し、L部長は Web システムの総合テストの実施を承認した。",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "本文中の [ a ] 及び表2中の [ b ], [ c ] に入れる適切な字句をそれぞれ4字以内で答えよ。",
      "explanation": "この問題は、Webシステムのセキュリティに関する文章中の空欄を埋める問題です。\n\n- **空欄 a**: 「顧客との通信には、インターネット標準として利用されている [ a ] による暗号化通信を用いる。」とあります。インターネットにおける暗号化通信の標準プロトコルとしてはSSL/TLSが広く使われています。4字以内で、かつインターネット標準の暗号化通信といえば「TLS」が適切です。\n- **空欄 b**: 表2の項番2のテスト結果に「Web サーバの脆弱性を利用して、Webサーバを [ b ] にし、そこを中継点として内部ネットワークに侵入できた。」とあります。これは、攻撃者がWebサーバを不正に利用して、さらに内部ネットワークへ侵入するための足掛かりにした状況を示しています。このような役割のサーバを「踏み台」と呼びますが、4字以内という指定と文脈から、「乗っ取り」が適切です。Webサーバが乗っ取られて、内部ネットワークへの攻撃の中継点にされた、と解釈できます。\n- **空欄 c**: 表2の項番2の改善項目に「脆弱性の存在自体が広く公表される前にそれを悪用する [ c ] 攻撃のリスクを軽減する。」とあります。脆弱性が発見されてから対策が講じられるまでの間にその脆弱性を悪用する攻撃は「ゼロデイ攻撃」と呼ばれます。4字以内で「ゼロデイ」が適切です。\n\n**解答:**\n- a: TLS\n- b: 乗っ取り\n- c: ゼロデイ"
    },
    {
      "subQNo": "設問2",
      "text": "本文中の [ d ], [ e ] に入れる適切な字句をそれぞれ解答群の中から選び、記号で答えよ。\n解答群\nア エスケープ\nイ データサイズ\nウ マイグレーション\nエ リダイレクト\nオ ルートクラック",
      "explanation": "この問題は、バッファオーバーフローとSQLインジェクションという代表的なWebアプリケーションの脆弱性に対する対策に関する空欄を埋める問題です。\n\n- **空欄 d**: 「バッファオーバフローは、バッファにデータを保存する際に [ d ] を常にチェックすることで防ぐことができます。」とあります。バッファオーバーフローとは、プログラムが用意した固定サイズのバッファに、そのサイズを超えるデータを書き込もうとすることで発生する脆弱性です。これを防ぐためには、書き込むデータの大きさがバッファの容量を超えないかを常に確認する必要があります。したがって、解答群の「イ データサイズ」が適切です。\n\n- **空欄 e**: 「SQLインジェクションは、データをSQLに埋め込むところで、データの特殊文字を適切に [ e ] することで防ぐことができます。」とあります。SQLインジェクションとは、入力データの一部としてSQLコマンドの特殊文字（例: シングルクォーテーションなど）を挿入することで、意図しないSQLクエリを実行させる攻撃です。これを防ぐためには、入力されたデータ中の特殊文字を、SQL文として解釈されないように無害な文字列に変換する処理、すなわち「エスケープ」処理が必要です。したがって、解答群の「ア エスケープ」が適切です。\n\n**解答:**\n- d: イ\n- e: ア"
    },
    {
      "subQNo": "設問3",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の下線①について, Web サーバの構成情報の調査によって得られる, Web サーバを攻撃するために有用な、アプリケーションに関する情報を二つ挙げ、それぞれ7字以内で答えよ。"
        },
        {
          "label": "(2)",
          "text": "本文中の下線②について, Web サーバへのポートスキャンの対策として効果的な方策は何か。15字以内で答えよ。"
        },
        {
          "label": "(3)",
          "text": "本文中の下線③で、N氏が導入を推奨するセキュリティ機器とは何か。アルファベット3字で答えよ。"
        }
      ],
      "explanation": "この問題は、侵入テストの結果とそれに対する改善策に関するものです。\n\n### (1) アプリケーションに関する情報\n下線①は「Web サーバの構成情報の調査によって、攻撃するために有用な情報を得ることで、Webサーバの脆弱性を探ってきます。」とあります。\n\n表2の項番1のテスト結果には「Web システムのサービスに必要がないポートが、インターネットに公開されていた。インターネットから Web サーバの構成情報を調査できた。」とあります。ここから「公開ポート情報」が得られます。\n\nまた、項番3のテスト結果には「Web アプリケーションを対象とした次の攻撃について、対処されていないので、Web アプリケーションを誤作動させることが可能であった。・バッファオーバフロー・SQLインジェクション」とあります。これらの脆弱性がアプリケーションに存在するという事実自体が攻撃に有用な情報となります。そのため「脆弱性情報」が挙げられます。\n\n両方とも7字以内という条件を満たします。\n\n**解答例:**\n- 公開ポート情報\n- 脆弱性情報\n\n### (2) ポートスキャン対策\n下線②は「ポートスキャンについては、Web サーバやファイアウォールの設定で防止する必要があります。」とあります。ポートスキャンは、攻撃者がサーバの開いているポートを探索し、稼働しているサービスやそのバージョンを特定するために行われます。これに対する効果的な対策は、表2の項番1の改善項目にも示されている通り、「Web システムのサービスに必要なポートだけをインターネットに公開する。Web サーバが必要のない問合せに応答しないようにする。」ことです。\n\nこれを15字以内で表現すると、「不要なポートの公開を停止する」となります。\n\n**解答例:**\n不要なポートの公開を停止する\n\n### (3) 推奨されるセキュリティ機器\n下線③は「Web サーバへの攻撃の疑いがあるアクセスを遮断するセキュリティ機器の導入が効果的です。保護する対象を Web アプリケーションに特化しており, Web サーバ上で使用するアプリケーションに潜む未知の脆弱性を突く攻撃を、プロトコルの異常などによって検知し、遮断できるようになります。」とあります。この説明は、Webアプリケーションに対する特化した防御機能を持つセキュリティ機器の特徴を明確に示しています。これはWeb Application Firewall (WAF) の説明と一致します。\n\n**解答:**\nWAF"
    },
    {
      "subQNo": "設問4",
      "text": "本文中の下線④について、ログのリアルタイムでのチェックで、サイバー攻撃の可能性があると判断される痕跡を解答群の中から全て選び、記号で答えよ。\n解答群\nア DNSを使用せず URL の中にIPアドレスを直接書き込んで通信している。\nイ URL フィルタのホワイトリストに一致した通信が発生している。\nウ 送られてくるファイルの拡張子が偽装されている。\nエ 業務時間外に内部ネットワークから業務サーバへのアクセスが減少している。\nオ 通信元のIPアドレスが、想定した範囲から外れている。",
      "explanation": "下線④は「ログをリアルタイムにチェックするツールを導入します。」とあり、ログのリアルタイムチェックによってサイバー攻撃の兆候を検出することの重要性を示しています。各選択肢についてサイバー攻撃の痕跡であるかを確認します。\n\n- **ア DNSを使用せず URL の中にIPアドレスを直接書き込んで通信している。**\n  通常の利用では、DNSを使ってドメイン名を解決し通信するのが一般的です。IPアドレスを直接URLに書き込む行為は、DNSフィルタリングを回避したり、不正な通信先を隠蔽したりする目的で行われることがあり、不審な活動の痕跡となり得ます。**これは痕跡です。**\n\n- **イ URL フィルタのホワイトリストに一致した通信が発生している。**\n  ホワイトリストに一致する通信は、許可された正常な通信です。異常を示すものではありません。**これは痕跡ではありません。**\n\n- **ウ 送られてくるファイルの拡張子が偽装されている。**\n  マルウェアや不正なプログラムが、実行可能ファイルを画像ファイルのように見せかけるために拡張子を偽装することはよくあります。これは、ユーザーを騙して不正なファイルを実行させるための一般的な手法であり、サイバー攻撃の痕跡となり得ます。**これは痕跡です。**\n\n- **エ 業務時間外に内部ネットワークから業務サーバへのアクセスが減少している。**\n  業務時間外にアクセスが減少するのは、通常業務が行われていないため自然な現象であり、それ自体はサイバー攻撃の兆候とは言えません。むしろ、業務時間外に**増加したり、不審なアクセスがあったりする場合**が痕跡となります。**これは痕跡ではありません。**\n\n- **オ 通信元のIPアドレスが、想定した範囲から外れている。**\n  通常、アクセス元のIPアドレスは特定の国や地域、あるいはVPNなどの特定の範囲に限定されることが想定されます。その想定範囲外からのアクセスは、不正アクセスや攻撃の試みである可能性が非常に高いです。**これは痕跡です。**\n\nしたがって、サイバー攻撃の可能性があると判断される痕跡は、ア、ウ、オです。\n\n**解答:**\nア, ウ, オ"
    }
  ]
}