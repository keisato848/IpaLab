{
  "questions": [
    {
      "qNo": 1,
      "theme": "ソフトウェア開発におけるメモリ破壊脆弱性と対策",
      "description": "U社は、IoT機器の開発を行う、従業員数400名の企業である。IoT機器のソフトウェアの開発には C/C++ 言語を使っている。これまで製品に大きなトラブルはなかったが、2020年の東京オリンピック・パラリンピックに向けて IoT 機器に関するセキュリティリスクが高まると経営層が判断し、開発におけるセキュリティ対策を強化することになった。\n\n### [メモリ破壊攻撃の概要]\nメモリ破壊脆弱性は、プログラム実行時に、メモリ上にある制御情報を書き換えることによって、実行制御を奪うなどのメモリ破壊攻撃に悪用される。メモリ破壊脆弱性の一種にバッファオーバフロー脆弱性がある。\n\n例えば、図1に示すプログラム Vuln があったとする。Vuln は、スタックバッファオーバフロー脆弱性の学習用に作成した、32ビット版 Linux で実行可能なプログラムである。図2は Vuln 内の関数 foo が呼び出された後のメモリマップである。プログラム実行時に、変数 b が指し示すデータが不正な場合、そのデータによって、 [  a  ] が [  あ  ] に書き換えられると、関数 foo の終了時に shell コードへ処理が遷移する。しかし、①このような遷移があっても、データ実行防止機能（以下、DEPという）が機能していると、攻撃は成功しない。\n\n攻撃者が、DEPを回避するため、図2中の shell コードへ処理を遷移させる代わりに、 [  b  ] 中の実行可能なコードや [  c  ] 領域にマップされている Vuln の断片コードを利用するケースがある。例えば、攻撃の際、 [  a  ] を [  b  ] 関数の先頭アドレスで書き換えて、攻撃者の意図した [  b  ] 関数を呼び出す [  d  ] 攻撃もある。\n\n```c\n/* 図1 スタックバッファオーバフロー脆弱性のあるプログラム Vuln */\n(省略)\n1: int main(int argc, char *argv[]) {\n2:     char *a, *x;\n       (省略, argvに応じてサイズを確保する。)\n       (省略, ここでa, xがポイントする領域にargvからデータをコピーする。)\n3:     foo(a, x);\n       (省略, ここでその他の必要な処理をする。)\n4: }\n5: int foo(char *b, char *c) {\n6:     char d[100];\n       (省略)\n7:     strcpy(d, b);\n8:     if (d[0] == 0) {\n9:         err_out(c);\n       (省略)\n10:    }\n       (省略)\n11:    return 0;\n12: }\n13: int err_out(char *errmsg) {\n14:     char s1[100];\n15:     int i=0;\n       (省略)\n16:     while ((s1[i++] = *errmsg++) != '\\0');\n17:     fprintf(stderr, \"Error : %s\\n\", s1);\n       (省略)\n18:     return 0;\n19: }\n```\n\n```mermaid\ngraph TD\n    subgraph \"スタック領域\"\n        RA[\"リターンアドレスX\"] \n        BP[\"ベースポインタレジスタ保存値\"]\n        Buf[\"char d[100]\"]\n    end\n\n    SC[\"(ここにshellコードが入っている。)\"]\n    Lib[\"ライブラリ\"]\n    Heap[\"ヒープ領域\"]\n    BSS[\"BSS領域 / データ領域\"]\n    Text[\"テキスト領域 (Vuln)\"]\n\n    %% Connections to represent memory layout\n    SC --- RA\n    RA --- BP\n    BP --- Buf\n    Buf --- Lib\n    Lib --- Heap\n    Heap --- BSS\n    BSS --- Text\n\n    %% Annotation arrows\n    A1[\"(ア) ffffffff\"] --> SC\n    A2[\"(イ) bffff2bc\"] --> SC\n    A3[\"(ウ) bffff29d\"] --> RA\n    A4[\"(エ) bffdf000\"] --> Lib\n    A5[\"(オ) 08048350\"] --> Text\n\n    style RA fill:#fff,stroke:#333\n    style BP fill:#fff,stroke:#333\n    style SC fill:#fff,stroke:#333\n```\n\n### [メモリ破壊攻撃に対する対策技術]\n現在、メモリ破壊攻撃に対する対策技術（以下、M対策技術という）が普及している。X主任は、DEPを含めた代表的なM対策技術を調査し、表1にまとめた。\n\n| 技術名 | 概要 | 期待される効果 | 備考 |\n| :--- | :--- | :--- | :--- |\n| DEP | (省略) | (省略) | プログラムによっては適用できない。 |\n| SSP (Stack Smashing Protection) | スタック領域で canary と呼ばれる値を利用してスタックバッファオーバフローの有無を確認する技術 | スタックバッファオーバフローを検知し、抑制する。 | (省略) |\n| ASLR (Address Space Layout Randomization) | プログラムの実行時に、データ領域、ヒープ領域、スタック領域及びライブラリを、ランダムにマップする OS の技術 | (省略) | 32ビットOSの場合、効果が限定的である。 |\n| PIE (Position Independent Executable) | プログラムの実行時に、ASLR が対象とする領域に加えて、テキスト領域もランダムにマップする技術 | (省略) | プログラムによっては適用できない。 |\n| Automatic Fortification | バッファオーバフロー脆弱性の原因となりうる脆弱なライブラリ関数を、コンパイル時に境界チェックを行う安全な関数に置換する技術 | 境界チェックによって、オーバフローを抑制する。 | 境界チェックにおいて、書込み先のサイズが不明な場合は機能しない。 |\n\n### [M対策技術の動作概要]\n例えば、Vuln のコンパイル時に SSP が適用されていると、関数 foo を呼び出す際、図2のベースポインタレジスタ保存値より下位に [  e  ] が挿入される。もしも、 [  e  ] が上書きされた場合は、攻撃と判断し、Vuln の実行を停止する。なお、Vuln の場合は簡単ではないが、攻撃者が [  e  ] の値を正確に推測して上書きできてしまうと、 [  a  ] の書換えが可能となり、 [  d  ] 攻撃を防げない。その対策としては、ライブラリ関数のアドレス推定を困難にさせる [  f  ] が有効である。\nしかし、 [  f  ] は [  c  ] 領域にある実行可能なコードを用いる攻撃に対しては効果がない。そうした攻撃は PIE によって緩和される。さらに、Vuln の場合、Automatic Fortification によって、ライブラリ関数 [  g  ] を安全な関数に置き換えることで、バッファオーバフローの原因を排除することができる。\n\n### [脆弱性対策強化]\nL部長とX主任が表1の技術を確認したところ、表1の備考欄の指摘以外にも②Automatic Fortification ではバッファオーバフローの原因を排除できないケースがあることが分かった。\nL部長は次に、表1の技術を適用することによる影響を確認した。その結果、次のことが分かった。例えば、ソースコードに脆弱性があっても、SSP を適用してコンパイルしていると、メモリ破壊攻撃が成立しないが、そのソースコードを③別の開発環境でコンパイルすると問題となる場合があることが分かった。",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "[メモリ破壊攻撃の概要]について、(1)〜(3)に答えよ。",
          "explanation": "### 攻撃の仕組みと対策の解説\n1.  **スタックバッファオーバフロー**: 関数が呼び出されると、戻り先のアドレス（リターンアドレス）がスタックに積まれます。図2のように、バッファ(`char d[100]`)が溢れると、その上にあるリターンアドレスを書き換えることが可能になります。\n2.  **DEP (Data Execution Prevention)**: データ領域（スタックやヒープ）を実行不能にする機能です。攻撃者がスタックに注入した「shellコード」を実行しようとしても、DEPによってCPUが実行を拒否するため攻撃が失敗します。\n3.  **Return-to-libc / ROP**: DEPを回避するために、スタック上のコードを実行するのではなく、既にメモリ上にある実行可能な「ライブラリ（libc）」や「プログラム自身のコード断片（Text領域）」を組み合わせて実行させる手法です。\n\n```mermaid\ngraph LR\n    B[バッファ入力] -- 溢れる --> RA[リターンアドレスを上書き]\n    RA -- shellコードのアドレス --> S[注入したコードを実行しようとする]\n    S -- DEP有効 --> X[実行拒否/停止]\n    RA -- ライブラリ関数のアドレス --> L[ライブラリ内の既存コードを実行]\n    L -- DEP無効化不可 --> O[攻撃成功 (Return-to-libc)]\n```",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [  a  ] 〜 [  d  ] に入れる適切な字句を、解答群の中から選び、記号で答えよ。\n解答群： ア Return-to-libc, イ ROP, ウ テキスト, エ ヒープ, オ ベースポインタレジスタ保存値, カ ライブラリ, キ リターンアドレスX"
            },
            {
              "label": "(2)",
              "text": "本文中の [  あ  ] に入れる適切なアドレス値を図2の中から選び、(ア)〜(オ)の記号で答えよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線①について、攻撃が成功しない理由を35字以内で述べよ。"
            }
          ]
        },
        {
          "subQNo": "設問2",
          "text": "[M対策技術の動作概要]について、(1)、(2)に答えよ。",
          "explanation": "### 防御技術の補足\n- **SSP (Canary)**: スタック上のリターンアドレスの直前に「カナリア（Canary）」と呼ばれるランダムな値を挿入します。関数終了時にこの値が書き換えられていないかチェックすることで、バッファオーバフローを検知します。\n- **ASLR**: 共有ライブラリやスタックなどの配置をランダム化し、攻撃者が関数のアドレスを予測できないようにします。\n- **Automatic Fortification**: `strcpy` などの危険な関数を、自動的に境界チェック付きの安全な関数（`__strcpy_chk`など）へ置き換えます。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [  e  ] , [  f  ] に入れる適切な字句を、表1中の用語を用いて答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の [  g  ] に入れる適切なライブラリ関数名を答えよ。"
            }
          ]
        },
        {
          "subQNo": "設問3",
          "text": "[脆弱性対策強化]について、(1)、(2)に答えよ。",
          "explanation": "### コンパイラによる対策の限界\n- **Automatic Fortificationの限界**: コンパイル時にコピー元のサイズが確定できない場合（外部入力をループで一文字ずつコピーする場合など）は、境界チェックを挿入することができません。図1の16行目のような `while` ループによるコピーがこれに該当します。\n- **開発環境の差異**: SSPなどの対策はコンパイラの機能であるため、古いコンパイラや対策機能がオフに設定された環境でビルドすると、ソースコードに脆弱性が残ったまま攻撃可能なバイナリが生成されてしまいます。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線②について、図1のプログラムにおいて、排除できないケースに該当する処理を行番号で答えよ。また、排除できない理由を30字以内で述べよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線③について、どのような問題か。また、どのような開発環境の場合に問題となるか。それぞれ25字以内で述べよ。"
            }
          ]
        }
      ],
      "point": 34
    },
    {
      "qNo": 2,
      "theme": "ネットワークセキュリティとインシデント対応",
      "description": "G社は、従業員数1,200名の製造業者であり、本社と四つの工場がある。無線LAN、レイヤ3スイッチ(L3SW)、ネットワークセキュリティモニタリング(NSM)センサなどが導入されている。NSMセンサはIDS機能に加え、ネットワークフロー情報(NF情報)を記録する。\n\n### 図1 G社のネットワーク構成\n```mermaid\ngraph TD\n    Internet((インターネット)) --- FW[FW]\n    \n    subgraph \"本社\"\n        FW --- L3SW_HQ[L3SW]\n        L3SW_HQ --- L2SW_Srv[L2SW]\n        L2SW_Srv --- Srv_F[ファイルサーバ]\n        L2SW_Srv --- Srv_W[Webサーバ]\n        L2SW_Srv --- Srv_M[メールサーバ]\n        L2SW_Srv --- Srv_NSM[NSM管理サーバ]\n        L2SW_Srv --- Srv_Log[ログ管理サーバ]\n        \n        L3SW_HQ --- NSM_S1[NSMセンサ]\n        L3SW_HQ --- L2SW_PC[L2SW]\n        L2SW_PC --- PC1[PC]\n        L2SW_PC --- PC2[PC]\n    end\n\n    FW --- L3SW_F1[L3SW]\n    subgraph \"工場1\"\n        L3SW_F1 --- NSM_S2[NSMセンサ]\n        L3SW_F1 --- L2SW_F1[L2SW]\n        L2SW_F1 --- PC3[PC]\n        L2SW_F1 --- PC4[PC]\n    end\n\n    FW --- L3SW_F2[L3SW]\n    subgraph \"工場2\"\n        L3SW_F2 --- NSM_S3[NSMセンサ]\n        L3SW_F2 --- L2SW_F2[L2SW]\n        L2SW_F2 --- PC5[PC]\n        L2SW_F2 --- PC6[PC]\n        L2SW_F2 --- AP[AP]\n        AP -.-> WPC1[PC]\n        AP -.-> WPC2[PC]\n    end\n```\n\nある日、セキュリティ管理部のJ主任にアラートメールが届いた。通信量が普段の2倍以上に増えていた。調査の結果、10.100.130.1 の機器がワームVに感染している可能性があると判断した。この機器は無線LANのAP（ルータとして動作）であった。APの通信ログ（表1）とDHCPサーバログ（表2）を基に、感染したPCを特定した。\n\n### 図3 ワームVに関する注意喚起\n- Windowsの脆弱性を悪用し、445/TCPポートを経由して感染を広める。\n- IPアドレス範囲に対してスキャンを行う。\n  - (a) 感染したPCと同一セグメントの範囲\n  - (b) 1.1.1.1 から 223.255.255.255 の範囲",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "本文中の [  a  ] 〜 [  e  ] に入れる適切な語句を解答群から選び、記号で答えよ。",
          "explanation": "### インフラ・用語の解説\n- **ミラーリング帯域**: 1Gbpsの全二重通信をミラーリングする場合、送信と受信の両方を集約するため、理論上最大で 2Gbps の帯域が必要になります。\n- **VLANタグ**: IEEE 802.1Q規格に基づき、パケットにVLAN識別用のタグを付与します。\n- **STIX/TAXII**: セキュリティ脅威情報の構造化（STIX）と、その情報を転送するためのプロトコル（TAXII）です。インディケータ情報の提供によく使われます。",
          "subQuestions": []
        },
        {
          "subQNo": "設問2",
          "text": "[セキュリティインシデントの発生]について、(1), (2)に答えよ。",
          "explanation": "### ワームの挙動スキャン\n1.  **TCPフラグの応答**: ポートが閉じている場合や、存在しないIPへの接続試行に対し、通常は `RST+ACK` などの応答が返りますが、無応答（タイムアウト）になることも多いです。J主任は「SYNに対して応答なし」が多いことからスキャンを推測しています。\n2.  **スキャンの特徴**: 図3(b)のように広大なグローバルIP範囲をスキャンする場合、ほとんどの宛先は存在しないか応答しないため、特定の宛先IPへの通信件数上位には現れにくくなります。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図3中の下線①について、どのような TCP フラグの組合せの応答か。8字以内で答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線②について、ワームVが行うスキャンの特徴を踏まえて、図3中の(a)及び(b)のスキャンが宛先 IP アドレス別の件数の上位に登場しない理由を、それぞれ25字以内で述べよ。"
            }
          ]
        },
        {
          "subQNo": "設問3",
          "text": "[無線LANセグメントの調査]について、(1), (2)に答えよ。",
          "explanation": "### ログの紐付け\n1.  **APの通信ログ（表1）**: 外部(1.1.1.1など)の445ポートへスキャンを行っている内部IP(`NAPT変換前`)を確認します。10/28 14:25:02 に `192.168.0.32` が外部へ通信しています。\n2.  **DHCPログ（表2）**: 通信時刻（14:25頃）において `192.168.0.32` を使用していたMACアドレスやホスト名を探します。14:24:50 に PC321 がこのIPをリースされています。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "APの通信ログとDHCPサーバログを調査して、ワームVに感染したと判断すべきPCを全て答えよ。(解答用紙の表2に〇印)"
            },
            {
              "label": "(2)",
              "text": "感染したPCによる通信を調べてみると、DHCPによってIPアドレスが変わったので、感染した複数のPCが同じ送信元IPアドレスを使っている場合がある。感染した複数のPCによって使われた送信元IPアドレスを解答群から全て選び、記号で答えよ。"
            }
          ]
        },
        {
          "subQNo": "設問4",
          "text": "[セキュリティインシデントの再発防止策]について、(1), (2)に答えよ。",
          "explanation": "### ネットワーク分離と検疫\n- **持ち込みPCのチェック**: 私物のPCや社外から戻ったPCがウイルスに感染していないか、パッチが適用されているか等を確認してからネットワーク接続を許可する仕組みが必要です。\n- **L2スイッチのセキュリティ**: 同一セグメント内での拡散を防ぐためには、L2SWの「プライベートVLAN（ポートアイソレーション）」機能などを用いてPC間の直接通信を遮断することが有効です。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線③について、チェックすべき内容を二つ挙げ、それぞれ30字以内で述べよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線④を実現するために行う設定を25字以内で述べよ。"
            }
          ]
        }
      ],
      "point": 33
    },
    {
      "qNo": 3,
      "theme": "アプリケーションフレームワークの脆弱性対策とWAFの導入",
      "description": "B社は、食品販売会社であり、インターネットを介して消費者向けに食品を通信販売している。通販システムは、Eサーバ、待機サーバ、FW2、DBサーバから構成される。\n\n### [脆弱性情報の公開と対応]\nある日、S君は、アプリケーションフレームワーク（以下、AFという）のうち、Eサーバで使用しているもの（以下、E-AFという）の脆弱性Tの情報が公開されているのを発見した。脆弱性Tは、リモートから任意のOSコマンドを実行される恐れがあり、 [  a  ] による深刻度が高いものであった。B社ではパッチ適用の検討中に、Eサーバのバッチ処理が異常終了するインシデントが発生した。調査の結果、未知のスクリプトUが実行されていたことが判明した。\n\n### [リスク軽減策の検討]\nセキュリティ専門会社から、WAF（Web Application Firewall）の導入が有効であるとの助言を受けた。S君はWAFの導入形態について検討した。\n\n- **ソフトウェア型**: Eサーバ自体に導入する。\n- **ハードウェア型**: DMZ内のL2SWとEサーバの間に設置する。\n- **クラウド型**: サービス事業者のネットワーク上のWAFを利用する。この場合、 [  c  ] の設定を変更し、 [  d  ] レコードを定義して通信をWAF経由に誘導する必要がある。",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "本文中の下線①を実現するための手段を15字以内で述べよ。",
          "explanation": "### ログの時刻整合\n複数のサーバやNW機器のログを突き合わせて分析するには、時刻が一致していることが不可欠です。NTP（Network Time Protocol）サーバを使用して時刻を同期させる必要があります。",
          "subQuestions": []
        },
        {
          "subQNo": "設問2",
          "text": "図2中の [  a  ] に入れる適切な字句を英字4字で答えよ。",
          "explanation": "### CVSS\nCommon Vulnerability Scoring System。脆弱性の深刻度を評価するオープンな指標です。「基本評価基準」「現状評価基準」「環境評価基準」の3つの基準で構成されます。",
          "subQuestions": []
        },
        {
          "subQNo": "設問3",
          "text": "本文中の下線②について、KリーダがS君に指示した措置を、30字以内で述べよ。",
          "explanation": "### インシデントの被害拡大防止\nスクリプトUによる外部への通信（仮想通貨マイニングやさらなる攻撃コードの取得など）を確認した場合、まずは被害の拡大を防ぐため「対象サーバのネットワークからの隔離」や「当該通信の遮断」を行う必要があります。",
          "subQuestions": []
        },
        {
          "subQNo": "設問4",
          "text": "図3中の下線③について、... 調査すべき機器の名称を図1中から選び答えよ。また、調査すべき内容を30字以内で具体的に述べよ。",
          "explanation": "### 踏み台の調査\n攻撃者がSSHで他の機器へ接続を試みた形跡がある場合、宛先となった機器のログインログやコマンド履歴を確認し、侵入が成功していないか、不正な操作が行われていないかを確認する必要があります。",
          "subQuestions": []
        },
        {
          "subQNo": "設問5",
          "text": "[リスク軽減策の検討]について、(1)〜(3)に答えよ。",
          "explanation": "### WAFの導入とDNS\n1.  **モニタリングモード**: 導入初期に誤検知（False Positive）を防ぐため、遮断せずにアラートのみを出すモードです。正規の通信が遮断されないことを確認します。\n2.  **HTTPSの復号**: WAFがHTTPS通信の内容（OSコマンド注入など）を検査するためには、WAF上でSSL/TLSを復号（終端）する機能が必要です。\n3.  **DNSによる誘導**: クラウド型WAFを利用する場合、自社ドメインの宛先をWAF事業者が提供するFQDNに向けるため、DNSの `CNAME` レコードを設定します。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [  b  ] に入れる適切な字句を5字以内で答えよ。"
            },
            {
              "label": "(2)",
              "text": "B社で、ハードウェア型WAFを導入する場合、通信プロトコルを考慮すると本文中の下線④の機能が必要である。その機能を30字以内で具体的に述べよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の [  c  ] に入れる適切なサーバ名を図1中から選び答えよ。また、 [  d  ] に入れる適切なレコードの名称を答えよ。"
            }
          ]
        }
      ],
      "point": 33
    }
  ]
}