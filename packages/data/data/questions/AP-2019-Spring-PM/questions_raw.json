{
  "qNo": 1,
  "theme": "情報セキュリティ / ECサイトの利用者認証",
  "description": "M社は、社員数が200名の輸入化粧品の販売会社である。このたび、M 社では販路拡大の一環として、インターネット経由の通信販売(以下,インターネット通販という)を行うことを決めた。インターネット通販の開始に当たり、情報システム課の N 課長を責任者として、インターネット通販用の Web サイト(以下,M社ECサイトという)を構築することになった。\nM社ECサイトへの外部からの不正アクセスが行われると、インターネット通販事業で甚大な損害を被るおそれがある。そこで、N課長は、部下のC 主任に、不正アクセスを防止するための対策について検討を指示した。\n\n### 利用者認証の方式の調査\nN課長の指示を受けたC主任は、最初に、利用者認証の方式について調査した。\n利用者認証の方式には、次の3種類がある。\n(i) 利用者の記憶、知識を基にしたもの\n(ii) 利用者の所有物を基にしたもの\n(iii) 利用者の生体の特徴を基にしたもの\n\n(ii)には、[ ウ ]による認証があり, (iii)には、[ ア ]による認証がある。(ii), (iii) の方式は、セキュリティ面の安全性が高いが、①多数の会員獲得を目指す M社ECサイトの利用者認証には適さないとC主任は考えた。他社のECサイトを調査したところ、ほとんど(i)の方式が採用されていることが分かった。そこで、M社ECサイトでは、(i)の方式の一つである ID, パスワードによる認証を行うことにし、ID、パスワード認証のリスクに関する調査結果を基に、対応策を検討することにした。\n\n### ID, パスワード認証のリスクの調査\nID, パスワード認証のリスクについて調査したところ、幾つかの攻撃手法が報告されていた。パスワードに対する主な攻撃を表1に示す。\n\n**表1 パスワードに対する主な攻撃**\n| 項番 | 攻撃名 | 説明 |\n| :---: | :--- | :--- |\n| 1 | [ 総当たり ] 攻撃 | ID を固定して、パスワードに可能性のある全ての文字を組み合わせてログインを試行する攻撃 |\n| 2 | 逆 [ 総当たり ] 攻撃 | パスワードを固定して、IDに可能性のある全ての文字を組み合わせてログインを試行する攻撃 |\n| 3 | 類推攻撃 | 利用者の個人情報などからパスワードを類推してログインを試行する攻撃 |\n| 4 | 辞書攻撃 | 辞書や人名録などに載っている単語や、それらを組み合わせた文字列などでログインを試行する攻撃 |\n| 5 | [ リスト型 ] 攻撃 | セキュリティ強度の低い Web サイト又は EC サイトから、IDとパスワードが記録されたファイルを窃取して、解読した ID、パスワードのリストを作成し、リストを用いて、ほかのサイトへのログインを試行する攻撃 |\n\n表1中の項番1~4の攻撃に対しては、パスワードとして設定する文字列を工夫することが重要である。項番5の攻撃に対しては、M社ECサイトでの認証情報の管理方法の工夫が必要である。しかし、他組織の Web サイトやECサイト(以下,他サイトという)から流出した認証情報が悪用された場合は、M社ECサイトでは対処できない。そこで、C主任は、M社ECサイトでのパスワード設定規則,パスワード管理策及び会員に求めるパスワードの設定方法の3点について、検討を進めることにした。\n\n### パスワード設定規則とパスワード管理策\n最初に、C主任は、表1中の項番1,2の攻撃への対策について検討した。検討の結果,パスワードの安全性を高めるために、M社ECサイトに、次のパスワード設定規則を導入することにした。\n・パスワード長の範囲を10~20桁とする。\n・パスワードについては、英大文字,英小文字,数字及び記号の 70 種類を使用可能とし、英大文字,英小文字,数字及び記号を必ず含める。\n次に、C主任は、M社ECサイトのID, パスワードが窃取・解析され、表1中の項番5の攻撃で他サイトが攻撃されるのを防ぐために、M社ECサイトで実施するパスワードの管理方法について検討した。\n\n一般に、Webサイトでは、②パスワードをハッシュ関数によってハッシュ値に変換(以下,ハッシュ化という)し、平文のパスワードの代わりにハッシュ値を秘密認証情報のデータベースに登録している。しかし、データベースに登録された認証情報が流出すると、レインボー攻撃と呼ばれる次の方法によって、ハッシュ値からパスワードが割り出されるおそれがある。\n・攻撃者が、膨大な数のパスワード候補とそのハッシュ値の対応テーブル(以下,Rテーブルという)をあらかじめ作成するか、又は作成された R テーブルを入手する。\n・窃取したアカウント情報中のパスワードのハッシュ値をキーとして,R テーブルを検索する。一致したハッシュ値があればパスワードが割り出される。\n\nレインボー攻撃はオフラインで行われ、時間や検索回数の制約がないので、パスワードが割り出される可能性が高い。そこで、C主任は、レインボー攻撃によるパスワードの割出しをしにくくするために、③次の処理を実装することにした。\n・会員が設定したパスワードのバイト列に、ソルトと呼ばれる、会員ごとに異なる十分な長さのバイト列を結合する。\n・ソルトを結合した全体のバイト列をハッシュ化する。\n・ID, ハッシュ値及びソルトを、秘密認証情報のデータベースに登録する。\n\n### 会員に求めるパスワードの設定方法\n次に、C主任は、表1中の項番3,4及び5の攻撃への対策を検討し、次のルールに従うことをM社ECサイトの会員に求めることにした。\n・会員自身の個人情報を基にしたパスワードを設定しないこと\n・辞書や人名録に載っている単語を基にしたパスワードを設定しないこと\n・④会員が利用する他サイトと M社ECサイトでは、同一のパスワードを使い回さないこと\n\nC主任は、これらの検討結果をN 課長に報告した。報告内容と対応策は N 課長に承認され、実施されることになった。",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "[利用者認証の方式の調査]について、(1), (2) に答えよ。\n(1) 本文中の [ a ], [ b ] に入れる適切な字句を解答群の中から選び、記号で答えよ。\n解答群:\nア 虹彩\nイ 体温\nウ ディジタル証明書\nエ 動脈\nオ パスフレーズ\nカ パソコンの製造番号\n(2) 本文中の下線①について, (ii)又は(iii)の方式の適用が難しいと考えられる適切な理由を解答群の中から選び、記号で答えよ。",
      "explanation": "### (1) 認証方式の分類\n利用者認証の方式は、一般的に「知識情報」「所有情報」「生体情報」の3種類に分類されます。\n\n| 分類 | 説明 | 具体例 (解答群より) |\n| :--- | :--- | :--- |\n| (i) 知識情報 | 記憶、知識を基にしたもの | パスワード、パスフレーズ（オ） |\n| (ii) 所有情報 | 利用者の所有物を基にしたもの | **ディジタル証明書（ウ）**、ICカード、トークン |\n| (iii) 生体情報 | 利用者の生体の特徴を基にしたもの | **虹彩（ア）**、指紋、動脈（エ） |\n\n(ii)は「所有物を基にしたもの」であり、解答群から適切なものは「ウ ディジタル証明書」です。\n(iii)は「生体の特徴を基にしたもの」であり、解答群から適切なものは「ア 虹彩」または「エ 動脈」です。どちらもバイオメトリクス認証ですが、(ii)の代表例であるウと対応させる形で、(iii)の代表例の一つであるアを選択します。\n\n**解答:** a: ウ, b: ア (または エ)\n\n### (2) ECサイトでの適用難度\n下線①では、(ii)所有物認証や(iii)生体認証はセキュリティ面で高いが、多数の会員獲得を目指すECサイトには適さないとされています。\nECサイトは不特定多数の利用者が利用し、利便性が重視されます。(ii)や(iii)の方式を採用する場合、利用者は認証に使う専用のデバイス（ICカードリーダー、生体認証デバイス）を用意するか、登録作業（生体情報登録、証明書インストール）を行う必要があります。これは新規会員にとって障壁となります。\n\n**解答:** ウ (利用者に認証デバイス又は認証情報を配付する必要があるから)",
      "subQuestions": [
        { "label": "(1)", "text": "a: ウ, b: ア" },
        { "label": "(2)", "text": "ウ" }
      ]
    },
    {
      "subQNo": "設問2",
      "text": "[ID, パスワード認証のリスクの調査]について、(1), (2)に答えよ。\n(1) 表1中の [ c ], [ d ] に入れる適切な字句を答えよ。\n(2) 表1中の項番1の攻撃には有効であるが、項番2の攻撃には効果が期待できない対策を、“パスワード”という字句を用いて,20字以内で答えよ。",
      "explanation": "### (1) 攻撃名の特定\n**項番1 (c 攻撃)**: IDを固定し、パスワードの全ての組み合わせを試す攻撃です。これは「総当たり攻撃 (Brute Force Attack)」です。\n**項番2 (逆 c 攻撃)**: パスワードを固定し、IDの全ての組み合わせを試す攻撃です。これは「逆総当たり攻撃 (Reverse Brute Force Attack)」です。\n**項番5 (d 攻撃)**: 他サイトから流出したIDとパスワードのリストを使って、他のサイトへのログインを試す攻撃です。これは「リスト型攻撃 (Credential Stuffing Attack)」です。\n\n**解答:** c: 総当たり, d: リスト型\n\n### (2) アカウントロック対策の検討\n項番1（総当たり攻撃）は、特定のIDに対して大量のパスワード試行を行うため、パスワードの入力失敗回数に上限を設ける（アカウントロック）ことで有効に対策できます。\n\n```mermaid\nsequenceDiagram\n    participant A as 攻撃者(ID固定)\n    participant S as システム\n    A->>S: PWD 1 (誤)\n    S->>S: 失敗回数カウント++\n    A->>S: PWD 2 (誤)\n    S->>S: 失敗回数カウント++\n    Note right of S: カウントが上限に達する\n    S->>S: IDをロック\n```\n\nしかし、項番2（逆総当たり攻撃）は、パスワードを固定し、多数の異なるIDに対して1回ずつ試行を行うため、IDベースのアカウントロックは機能しません。\n\n**対策（20字以内、”パスワード”を含む）:**\n**解答:** パスワードの誤入力が続いた利用者のIDをロックする。",
      "subQuestions": [
        { "label": "(1)", "text": "c: 総当たり, d: リスト型" },
        { "label": "(2)", "text": "パスワードの誤入力が続いた利用者のIDをロックする。" }
      ]
    },
    {
      "subQNo": "設問3",
      "text": "[パスワード設定規則とパスワード管理策]について、(1), (2)に答えよ。\n(1) 本文中の下線②について、ハッシュ化する理由を、ハッシュ化の特性を踏まえ25字以内で述べよ。\n(2) 本文中の下線③の処理によって、パスワードの割出しがしにくくなる最も適切な理由を解答群の中から選び、記号で答えよ。",
      "explanation": "### (1) パスワードをハッシュ化する理由\n下線②は、パスワードをハッシュ化し、平文の代わりにハッシュ値をデータベースに登録することです。\nハッシュ関数の主な特性は「一方向性」であり、ハッシュ値から元の平文（パスワード）を復元することは極めて困難です。\n\n**理由 (25字以内):**\n**解答:** データベース流出時の平文パスワードの漏えいを防止する。\n\n### (2) ソルト処理の目的\n下線③は、レインボー攻撃対策としてソルト（会員ごとに異なるバイト列）をパスワードに結合してハッシュ化し、ソルトもデータベースに登録する処理です。\n\n**レインボー攻撃の仕組み:**\n攻撃者は事前に膨大なパスワード候補に対応するハッシュ値を計算したRテーブルを作成します。DBから流出したハッシュ値がRテーブルにあれば、パスワードを割り出せます。\n\n**ソルトの効果:**\nソルトを加えることで、同じ平文パスワードでもユーザーごとに異なるハッシュ値が生成されます。これにより、攻撃者は事前に作成した普遍的なRテーブルを使用できなくなります。攻撃者が特定のユーザーのパスワードを割り出すためには、そのユーザーのソルトに対応した専用のRテーブルを作成する必要があり、Rテーブルの作成（事前計算）が非現実的になります。\n\n```mermaid\ngraph TD\n    A[パスワード単体] --> B{ハッシュ化} --> C[DBにH(P)を保存]\n    D[レインボー攻撃] --> B\n    E[パスワード + ソルト] --> F{ハッシュ化} --> G[DBにH(P+S), Sを保存]\n    H[レインボー攻撃] --> I{Rテーブルがユーザ毎に必要} --> J[攻撃の困難化]\n```\n\n**解答群の検討:**\nイは「ソルトの値が不明だから」としていますが、本文ではソルトもデータベースに登録するとあるため、データベースが漏洩した場合はソルトは既知となります。したがってイは不適切です。\n最も適切な理由は、個別のRテーブルをユーザごとに大量に作成することが非現実的になるため、Rテーブル全体としての作成が困難になることです。\n\n**解答:** ア (Rテーブルの作成が難しくなるから)",
      "subQuestions": [
        { "label": "(1)", "text": "データベース流出時の平文パスワードの漏えいを防止する。" },
        { "label": "(2)", "text": "ア" }
      ]
    },
    {
      "subQNo": "設問4",
      "text": "本文中の下線④について、パスワードの使い回しによって M社ECサイトで発生するリスクを,35字以内で述べよ。",
      "explanation": "### パスワード使い回しのリスク\n下線④は、会員に対して他サイトと同一のパスワードを使い回さないよう求めるルールです。\nもしユーザーがパスワードを使い回しており、セキュリティ強度の低い他サイトからそのIDとパスワードの組み合わせが流出した場合、攻撃者はそのリスト（リスト型攻撃で使用されるリスト）を使ってM社ECサイトへの不正ログインを試行します。\n\n**リスク (35字以内):**\n**解答:** 他サイトからIDとパスワードが流出した際、M社ECサイトがリスト型攻撃の標的となるリスク。"
    }
  ]
}