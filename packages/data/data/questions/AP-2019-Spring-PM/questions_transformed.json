{
  "questions": [
    {
      "qNo": 1,
      "theme": "利用者認証方式の調査と適用性",
      "context": {
        "title": "利用者認証方式の分類とECサイトへの適用",
        "background": "\n\n本問は、ID/パスワード認証におけるリスク調査の結果（{{diagram:table1}}）に基づき、適切な対策を検討する問題である。設問2の解説には、総当たり攻撃に対する対策シーケンスが示されている（{{diagram:seq1}}）。\n\n本設問は、システム導入・運用フェーズにおけるパスワード管理策に関する記述に基づいている。設問を解くにあたっては、以下のパスワード処理フロー図を参照せよ。\n\n{{diagram:fig1}}\n\nこの設問は、M社ECサイトに関するセキュリティポリシーの文書に基づいており、会員のパスワード管理について言及された下線④を参照している。\n\n[注記: 元の本文（下線④を含む記述）が提供されていないため、具体的な内容は省略する。]",
        "diagrams": [
          {
            "id": "table1",
            "label": "表1 ID, パスワード認証のリスクに関する調査結果",
            "type": "markdown",
            "content": "| 項番 | ID試行パターン | パスワード試行パターン | 攻撃名 | 備考 |\n|---|---|---|---|---|\n| 1 | 固定 | 全組み合わせ試行 | [ c ] 攻撃 | 特定IDアカウントの突破を目的とする |\n| 2 | 全組み合わせ試行 | 固定 | 逆総当たり攻撃 | 存在するIDアカウントの特定を目的とする |\n| 5 | リスト内のID | リスト内のパスワード | [ d ] 攻撃 | 他サイトからの情報漏えいを利用する |"
          },
          {
            "id": "seq1",
            "label": "項番1（総当たり攻撃）に対するアカウントロックのシーケンス",
            "type": "mermaid",
            "content": "sequenceDiagram\n    participant A as 攻撃者(ID固定)\n    participant S as システム\n    A->>S: PWD 1 (誤)\n    S->>S: 失敗回数カウント++\n    A->>S: PWD 2 (誤)\n    S->>S: 失敗回数カウント++\n    Note right of S: カウントが上限に達する\n    S->>S: IDをロック"
          },
          {
            "id": "fig1",
            "label": "パスワードハッシュ化とソルト処理の比較",
            "type": "mermaid",
            "content": "graph TD\n    A[パスワード単体] --> B{ハッシュ化} --> C[DBにH(P)を保存]\n    D[レインボー攻撃] --> B\n    E[パスワード + ソルト] --> F{ハッシュ化} --> G[DBにH(P+S), Sを保存]\n    H[レインボー攻撃] --> I{Rテーブルがユーザ毎に必要} --> J[攻撃の困難化]"
          }
        ]
      },
      "questions": [
        {
          "subQNo": "設問1",
          "text": "[利用者認証の方式の調査]について、(1), (2) に答えよ。",
          "references": [],
          "explanation": "### (1) 認証方式の分類\n利用者認証の方式は、一般的に「知識情報」「所有情報」「生体情報」の3種類に分類されます。\n\n| 分類 | 説明 | 具体例 (解答群より) |\n| :--- | :--- | :--- |\n| (i) 知識情報 | 記憶、知識を基にしたもの | パスワード、パスフレーズ（オ） |\n| (ii) 所有情報 | 利用者の所有物を基にしたもの | **ディジタル証明書（ウ）**、ICカード、トークン |\n| (iii) 生体情報 | 利用者の生体の特徴を基にしたもの | **虹彩（ア）**、指紋、動脈（エ） |\n\n(ii)は「所有物を基にしたもの」であり、解答群から適切なものは「ウ ディジタル証明書」です。\n(iii)は「生体の特徴を基にしたもの」であり、解答群から適切なものは「ア 虹彩」または「エ 動脈」です。どちらもバイオメトリクス認証ですが、(ii)の代表例であるウと対応させる形で、(iii)の代表例の一つであるアを選択します。\n\n### (2) ECサイトでの適用難度\n下線①では、(ii)所有物認証や(iii)生体認証はセキュリティ面で高いが、多数の会員獲得を目指すECサイトには適さないとされています。\nECサイトは不特定多数の利用者が利用し、利便性が重視されます。(ii)や(iii)の方式を採用する場合、利用者は認証に使う専用のデバイス（ICカードリーダー、生体認証デバイス）を用意するか、登録作業（生体情報登録、証明書インストール）を行う必要があります。これは新規会員にとって障壁となります。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ a ], [ b ] に入れる適切な字句を解答群の中から選び、記号で答えよ。\n解答群:\nア 虹彩\nイ 体温\nウ ディジタル証明書\nエ 動脈\nオ パスフレーズ\nカ パソコンの製造番号",
              "answer": "a: ウ, b: ア",
              "explanation": "(ii)所有物情報に該当する[a]はディジタル証明書（ウ）、(iii)生体情報に該当する[b]は虹彩（ア）が適切です。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線①について, (ii)又は(iii)の方式の適用が難しいと考えられる適切な理由を解答群の中から選び、記号で答えよ。",
              "answer": "ウ",
              "explanation": "所有物認証や生体認証は、利用者側に専用デバイスの用意や認証情報の登録が必要となり、多数の会員獲得を目指すECサイトの利便性を損なうためです。"
            }
          ],
          "point": 25
        },
        {
          "subQNo": "設問2",
          "text": "[ID, パスワード認証のリスクの調査]について、(1), (2)に答えよ。",
          "references": [
            "table1"
          ],
          "answer": "設問(1): c: 総当たり, d: リスト型; 設問(2): パスワードの誤入力が続いた利用者のIDをロックする。",
          "explanation": "### (1) 攻撃名の特定\n**項番1 (c 攻撃)**: IDを固定し、パスワードの全ての組み合わせを試す攻撃です。これは「総当たり攻撃 (Brute Force Attack)」です。\n**項番2 (逆 c 攻撃)**: パスワードを固定し、IDの全ての組み合わせを試す攻撃です。これは「逆総当たり攻撃 (Reverse Brute Force Attack)」です。\n**項番5 (d 攻撃)**: 他サイトから流出したIDとパスワードのリストを使って、他のサイトへのログインを試す攻撃です。これは「リスト型攻撃 (Credential Stuffing Attack)」です。\n\n**解答:** c: 総当たり, d: リスト型\n\n### (2) アカウントロック対策の検討\n項番1（総当たり攻撃）は、特定のIDに対して大量のパスワード試行を行うため、パスワードの入力失敗回数に上限を設ける（アカウントロック）ことで有効に対策できます。\n\n{{diagram:seq1}}\n\nしかし、項番2（逆総当たり攻撃）は、パスワードを固定し、多数の異なるIDに対して1回ずつ試行を行うため、IDベースのアカウントロックは機能しません。\n\n**対策（20字以内、”パスワード”を含む）:**\n**解答:** パスワードの誤入力が続いた利用者のIDをロックする。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "表1中の [ c ], [ d ] に入れる適切な字句を答えよ。",
              "answer": "c: 総当たり, d: リスト型"
            },
            {
              "label": "(2)",
              "text": "表1中の項番1の攻撃には有効であるが、項番2の攻撃には効果が期待できない対策を、“パスワード”という字句を用いて,20字以内で答えよ。",
              "answer": "パスワードの誤入力が続いた利用者のIDをロックする。"
            }
          ],
          "point": 25
        },
        {
          "subQNo": "設問3",
          "text": "[パスワード設定規則とパスワード管理策]について、(1), (2)に答えよ。",
          "references": [
            "fig1"
          ],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線②について、ハッシュ化する理由を、ハッシュ化の特性を踏まえ25字以内で述べよ。",
              "answer": "データベース流出時の平文パスワードの漏えいを防止する。",
              "explanation": "下線②は、パスワードをハッシュ化し、平文の代わりにハッシュ値をデータベースに登録することです。\nハッシュ関数の主な特性は「一方向性」であり、ハッシュ値から元の平文（パスワード）を復元することは極めて困難です。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線③の処理によって、パスワードの割出しがしにくくなる最も適切な理由を解答群の中から選び、記号で答えよ。",
              "answer": "ア",
              "explanation": "下線③は、レインボー攻撃対策としてソルト（会員ごとに異なるバイト列）をパスワードに結合してハッシュ化し、ソルトもデータベースに登録する処理です。\n**レインボー攻撃の仕組み:**\n攻撃者は事前に膨大なパスワード候補に対応するハッシュ値を計算したRテーブルを作成します。DBから流出したハッシュ値がRテーブルにあれば、パスワードを割り出せます。\n**ソルトの効果:**\nソルトを加えることで、同じ平文パスワードでもユーザーごとに異なるハッシュ値が生成されます。これにより、攻撃者は事前に作成した普遍的なRテーブルを使用できなくなります。攻撃者が特定のユーザーのパスワードを割り出すためには、そのユーザーのソルトに対応した専用のRテーブルを作成する必要があり、Rテーブルの作成（事前計算）が非現実的になります。\n**解答群の検討:**\nイは「ソルトの値が不明だから」としていますが、本文ではソルトもデータベースに登録するとあるため、データベースが漏洩した場合はソルトは既知となります。したがってイは不適切です。\n最も適切な理由は、個別のRテーブルをユーザごとに大量に作成することが非現実的になるため、Rテーブル全体としての作成が困難になることです。\n(Rテーブルの作成が難しくなるから)"
            }
          ],
          "point": 25
        },
        {
          "subQNo": "設問4",
          "text": "本文中の下線④について、パスワードの使い回しによって M社ECサイトで発生するリスクを,35字以内で述べよ。",
          "references": [],
          "answer": "他サイトからIDとパスワードが流出した際、M社ECサイトがリスト型攻撃の標的となるリスク。",
          "explanation": "下線④は、会員に対して他サイトと同一のパスワードを使い回さないよう求めるルールです。もしユーザーがパスワードを使い回しており、セキュリティ強度の低い他サイトからそのIDとパスワードの組み合わせが流出した場合、攻撃者はそのリスト（リスト型攻撃で使用されるリスト）を使ってM社ECサイトへの不正ログインを試行します。",
          "point": 25
        }
      ],
      "description": "ID/パスワード認証におけるリスク調査の結果に基づき、適切な対策を検討する問題。"
    }
  ]
}