{
  "questions": [
    {
      "qNo": 1,
      "theme": "クラウド環境におけるセキュリティ対策",
      "description": "## 問1 クラウド環境におけるセキュリティ対策に関する次の記述を読んで、設問1～5に答えよ。\n\n### [X社の概要]\n\nX社は、日本、米国、欧州に事業を展開している従業員数 80,000名の製造会社であり、重要インフラ設備を製造している。日本国内の従業員数は 40,000名である。\nX社のシステムは、サーバ、ネットワーク機器及びPCで構成されている。X社の日本国内のネットワークの論理構成を、図1に示す。\n\n```mermaid\ngraph LR\n    subgraph Internet [インターネット]\n        IPS[IPS]\n        FW[FW]\n    end\n    subgraph EastDC [東日本データセンタ]\n        HR_Srv[人事サーバ Windows]\n        Biz_Srv_W[業務サーバ Windows]\n        Biz_Srv_L[業務サーバ Linux]\n        Biz_Srv_U[業務サーバ 商用UNIX]\n        Prod_Srv[生産関連サーバ]\n        Auth_A1[認証サーバ A1]\n        Auth_B1[認証サーバ B1]\n    end\n    subgraph X_WAN [X社 社内WAN]\n        Factory[X社工場]\n        Site[X社拠点]\n        WestDC[西日本データセンタ]\n    end\n    subgraph ProjectRoom [プロジェクトルーム]\n        Proj_Srv[プロジェクト専用サーバ]\n        Proj_PC[プロジェクト専用PC]\n        Internal_PC[社内PC]\n    end\n\n    Internet --- FW\n    FW --- IPS\n    IPS --- X_WAN\n    X_WAN --- EastDC\n    X_WAN --- Factory\n    X_WAN --- Site\n    X_WAN --- WestDC\n    Site --- ProjectRoom\n    Factory --- Prod_Srv_F[生産関連サーバ]\n```\n\n図1 X社の日本国内のネットワークの論理構成\n\n- FW：ファイアウォール\n- 人事サーバ：X社の人事管理を行うサーバ\n- 業務サーバ：X社の様々な業務のためのサーバ。部門ごとの業務システムや、国又は地域ごとのメールシステムなどが稼働\n- 認証サーバA1：Windows用の認証サーバ\n- 認証サーバB1：Linux及び商用UNIX上で稼働するWebアプリケーションにアクセスする際の利用者認証に用いるリバースプロキシ型の認証サーバ\n- R&D情報：基礎研究、並びに開発中の重要インフラ設備の設計及び生産技術に関する情報\n- プロジェクト専用サーバ：R&D情報を取り扱うプロジェクトで利用するサーバ\n- プロジェクト専用PC：プロジェクト専用サーバを利用するためのWindows PC\n- 社内PC：プロジェクト専用サーバ以外の一般業務のためのWindows PC\n- 生産関連サーバ：重要インフラ設備を製造する工場の設備管理、生産管理、製造に必要な物品の物流管理を行うシステムのサーバ\n\n従業員が社内PC、並びにWindowsの業務サーバ及び人事サーバにログオンする際は、認証サーバ A1による利用者認証が行われる。従業員がWebブラウザを用いてLinux及び商用UNIXの業務サーバにログオンする際は、認証サーバ B1による利用者認証が行われる。認証サーバ A1は、人事サーバと連携しており、人事サーバの従業員の情報を日次で反映している。認証サーバ B1は、認証サーバ A1のLDAPサービスを利用している。\n\nX社のシステムには、X社の情報セキュリティ標準、X社が事業を展開している各国及び各地域において特定の製品とそれら製品の技術情報を他国又は他地域に持ち出すことを制限した輸出管理規制、並びに(1)各国及び各地域の個人情報保護に関する法規制の三つに準拠すること（以下、三つに準拠することを基本要件という）が求められる。\n\n### [クラウド環境への移行に関する検討]\n\nX社は、ビジネスの強化、ITを活用した新しいビジネスの開発、並びにシステム部門の役割をシステム運用からビジネス企画及びシステム企画へシフトするために、各国及び各地域のシステムをクラウド環境に移行することにした。X社の経営層は、クラウド環境への移行に関して次の方針を示した。\n\n- 方針1：メールシステムをクラウドベンダM社のSaaS Qに、業務システムのうち二つのシステムをクラウドベンダS社のSaaS Sに、それぞれ1年以内に移行する。\n- 方針2：他のシステムは、クラウドベンダH社が提供するIaaS Cの仮想マシン上に5年間で段階的に移行する。OS及びミドルウェアの運用管理にはSIベンダJ社の運用サービスを利用する。\n\nIaaS Cの主なサービス仕様：\n- データセンタは日本国内1か所、海外60か所に配置され、高速な閉域網で接続されている。データセンタ間の通信は課金されない。\n- 災害対策サービスがあり、日本国内のデータセンタが被災した場合はシンガポールのデータセンタでサービスが継続される。\n- ネットワーク及び仮想サーバは、H社の情報セキュリティ標準に基づきセキュリティ管理が行われており、監査法人による報告書が開示される。\n\nX社システム部門は、次の条件のいずれかに該当するシステム及びサーバは、IaaS Cに移行できない又は移行すると基本要件を満たせなくなるとして、現状のまま配置することにした。\n- 条件1：IaaS Cが提供する仮想サーバでは稼働しないOSを用いているサーバ\n- 条件2：プロジェクト専用サーバ\n- 条件3：X社が取り扱う個人情報を管理するシステム\n- 条件4：生産関連サーバ\n\n### [ID管理及び利用者認証の検討]\n\nX社システム部門は、ハイブリッドクラウド環境におけるID管理及び利用者認証を次のように設計した。\n- IaaS Cに配置するWindowsの業務サーバに従業員がアクセスする際に利用者認証を行う認証サーバとして、認証サーバ A1と同じ製品を用いた認証サーバ A2をIaaS Cの環境に新たに配置する。\n- 認証サーバ A2には認証サーバ A1とSAML 2.0プロトコルで通信させる。\n- 認証サーバ B1をバージョンアップし、SPNEGOプロトコルによって、認証サーバ B1が認証サーバ A1と通信し、認証サーバ A1が発行するトークンを用いて利用者認証を行うようにする。\n- SaaS Q及びSaaS Sは、認証サーバ B1とSAML 2.0プロトコルで通信し、認証サーバ B1が発行するトークンを用いて利用者認証を行う。\n\nX社システム部門は、認証サーバ B1の配置について「案1：現行のままオンプレミス環境」と「案2：IaaS Cに移行」を比較検討し、移行初期段階では案1とした。図2に論理構成を示す。\n\n```mermaid\ngraph LR\n    subgraph OnPremise [オンプレミス]\n        subgraph EastDC [東日本データセンタ]\n            HR[人事]\n            Biz_W[業務W]\n            Biz_L[業務L]\n            Biz_U[業務U]\n            Prod[生産]\n            Auth_A1[認証A1]\n            Auth_B1[認証B1]\n            FW1[FW1]\n            IPS1[IPS]\n        end\n    end\n    subgraph Cloud [クラウド]\n        subgraph IaaS_C [IaaS C]\n            FW2[FW2]\n            Biz_CW[業務W]\n            Biz_CL[業務L]\n            Auth_A2[認証A2]\n        end\n        subgraph SaaS [SaaS]\n            SaaS_Q[SaaS Q]\n            SaaS_S[SaaS S]\n        end\n    end\n    OnPremise --- Internet\n    Internet --- Cloud\n```\n\n### [エンドポイント管理の検討]\nX社は、NIST サイバーセキュリティフレームワーク(NIST CSF)を基に独自の情報セキュリティ標準を改定することにした。NIST CSFでは組織の対応レベルをティア1からティア4までの段階で定義している。\n\n改定案：\n1. 構成管理システムへの登録：ハードウェア、OS、ソフトウェア、ファームウェアのバージョン等を登録管理する。\n2. サーバ及びPCのセキュリティチェックの実施：脆弱性修正プログラム（パッチ）の適用状況を定期的にチェックする。\n3. 脆弱性管理の実施：脆弱性情報が新たに公開された場合、重要度を評価し期限内にパッチを適用する。\n\nSIベンダJ社からは、製品Dを用いた運用サービスが提案された。製品Dはサーバ及びPCのパッチ適用状況及びセキュリティ設定を日次で監視・一括適用できる仕様である。\n\n### [モバイル環境の検討]\nX社システム部門は、外出先や自宅からも業務ができるよう、モバイルPCとスマートフォンを貸与し、インターネット経由で社内システムやクラウド環境にアクセスできる環境を検討した。\n\n対策：\n1. スマートフォンにMDM製品Fを導入し、セキュリティ設定を強制する。\n2. VPNサーバ及びVPNクライアントを導入し、クライアント証明書を組み込む。VPN接続後に認証サーバ B1による利用者認証を行い、トークンを発行する。\n\n```mermaid\nsequenceDiagram\n    participant Mobile as スマートフォン\n    participant VPN as VPNサーバ\n    participant B1 as 認証サーバ B1\n    participant A1 as 認証サーバ A1\n    participant Q as SaaS Q\n\n    Mobile->>Q: アクセス要求（トークンなし）\n    Q-->>Mobile: a (認証先へのリダイレクト)\n    Note over Mobile: 認証サーバB1へのアクセスに必要なVPNクライアントの起動\n    Mobile->>VPN: b (接続要求)\n    VPN-->>Mobile: c (証明書要求)\n    Mobile->>VPN: d (クライアント証明書提示)\n    Note over VPN: クライアント証明書の検証\n    VPN-->>Mobile: 接続OK (IPアドレス割当て)\n    Mobile->>B1: e (アクセス要求)\n    B1-->>Mobile: f (ID・パスワード要求)\n    Mobile->>B1: g (ID・パスワード提示)\n    B1->>A1: 利用者ID, パスワードの検証要求\n    A1-->>B1: 検証OK\n    B1->>Mobile: パッチ適用状況及びセキュリティ設定の確認要求\n    Mobile-->>B1: 確認結果\n    Note over B1: 確認結果の検証\n    B1-->>Mobile: h (トークン発行)\n    Mobile->>Q: アクセス要求（認証サーバB1が発行したトークン）\n```\n図4 従業員がスマートフォンからSaaS Qにアクセスする際の通信シーケンス",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "本文中の下線①について、2018年5月25日に適用が開始された欧州連合の規則の略称を英字4字で答えよ。",
          "explanation": "本文の(1)は「各国及び各地域の個人情報保護に関する法規制」を指しています。欧州連合(EU)で2018年5月から適用されたのは、**GDPR** (General Data Protection Regulation: 一般データ保護規則)です。"
        },
        {
          "subQNo": "設問2",
          "text": "〔クラウド環境への移行に関する検討〕について、(1)〜(3)に答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "条件2について、プロジェクト専用サーバをクラウド環境に移行した場合に満たせなくなる基本要件の具体的内容を、60字以内で述べよ。"
            },
            {
              "label": "(2)",
              "text": "条件4について、生産関連サーバを全て利用した場合に満たせなくなる基本要件の具体的内容を三つ挙げ、それぞれ50字以内で述べよ。また、挙げた三つのうちの一つの理由となるIaaS Cのサービス仕様の内容を、50字以内で述べよ。"
            },
            {
              "label": "(3)",
              "text": "X社社内ネットワークとIaaS Cとの接続において、FWのNAT機能を用いることにしたのはどのような問題を回避するためだと考えられるか。IaaS Cのサービス仕様の制約から起こる問題を70字以内で述べよ。"
            }
          ],
          "explanation": "(1) 基本要件には「輸出管理規制」が含まれます。プロジェクト専用サーバにはR&D情報（設計・生産技術）が含まれており、これを海外データセンタがあるクラウドに置くと、技術情報の他国への持ち出し制限に抵触する可能性があります。\n(2) 生産関連サーバの要件は「事業継続」に関わります。IaaS Cの仕様にある「日本国内が被災するとシンガポールで継続」という点は、国内2箇所以上に配置するというX社の基準に反する可能性があります。\n(3) IaaS Cの仕様に「あらかじめ予約されているプライベートIPアドレスがあり、利用者はそれらを使うことができない」とあります。社内のIPアドレス体系とIaaS C側の予約アドレスが重複し、通信ができなくなる問題をNATで回避しようとしています。"
        },
        {
          "subQNo": "設問3",
          "text": "〔ID管理及び利用者認証の検討〕について、(1), (2)に答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "各認証サーバ及び各SaaSをSAML 2.0プロトコルやSPNEGOプロトコルで通信させることによって、X社の従業員にはどのような利便性が提供されるか。30字以内で述べよ。"
            },
            {
              "label": "(2)",
              "text": "案2を選択した場合、案1と比べて、利用者認証後の通信経路上の構成要素の負荷が高くなるのは、社内PCからどの業務サーバへの通信か。図2中の記号⑦〜㋵で答えよ。また、負荷が高くなる構成要素を全て選び、同様に答えよ。"
            }
          ],
          "explanation": "(1) SAMLやSPNEGOによる連携の最大のメリットは、一度のログインで複数のシステムが利用可能になる**シングルサインオン(SSO)**です。\n(2) 案2（認証サーバB1をIaaS Cに配置）にすると、認証のたびに社内からクラウドへのトラフィックが発生します。特にリバースプロキシ型であるB1を介する通信は、全てのデータがB1を通過するため、経路上のFWや回線の負荷が増大します。"
        },
        {
          "subQNo": "設問4",
          "text": "〔エンドポイント管理の検討〕について、(1)〜(3)に答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線②について、ティア1からティア3に該当するものを、解答群の中から選び、記号で答えよ。",
              "subQuestions": [
                {
                  "label": "ア",
                  "text": "繰返し適用可能である (Repeatable)"
                },
                {
                  "label": "イ",
                  "text": "部分的である (Partial)"
                },
                {
                  "label": "ウ",
                  "text": "リスク情報を活用している (Risk Informed)"
                }
              ]
            },
            {
              "label": "(2)",
              "text": "運用サービス1及び2が提供される場合、標準ソフトウェア以外のソフトウェアがサーバ又はPCに導入されていたとすると、セキュリティ管理上どのような不都合が生じるか。40字以内で述べよ。"
            },
            {
              "label": "(3)",
              "text": "情報セキュリティ標準を基に手作業及び目視でセキュリティ設定パラメータの設定値をチェックする方法と比べて、製品Dによる方法は、どのような利点があるか。二つ挙げ、それぞれ15字以内で答えよ。"
            }
          ],
          "explanation": "(1) NIST CSFのティア定義：ティア1=部分的(Partial)、ティア2=リスク高配慮(Risk Informed)、ティア3=繰り返し適用可能(Repeatable)、ティア4=適応的(Adaptive)です。\n(2) 運用サービスは「標準ソフトウェア」を対象としているため、それ以外のソフトは脆弱性情報の収集やパッチ適応の自動化の対象外となり、管理漏れが生じます。\n(3) 手作業に比べ、自動化ツール(製品D)は「短時間で実施可能」「ヒューマンエラーの排除（正確性）」という利点があります。"
        },
        {
          "subQNo": "設問5",
          "text": "〔モバイル環境の検討〕について、(1), (2)に答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "案A及びBにおける利用者認証後の通信経路のうち、案Cに比べて通信経路上の構成要素の負荷が高くなるのは、どのクライアントからどの業務サーバへの通信か。図3中の記号A〜Lで答えよ。"
            },
            {
              "label": "(2)",
              "text": "図4中の [ a ] 〜 [ h ] に入れる適切な通信メッセージを、解答群から選べ。"
            }
          ],
          "explanation": "(1) 図3の構成を確認し、認証サーバB1の配置場所とリバースプロキシとしての動作を考慮します。案A/BではB1が特定の場所に固定されるため、遠回りの通信が発生し負荷が偏ります。\n(2) シーケンス図の穴埋めです。SAML認証の流れに沿って、認証要求のリダイレクト、証明書の提示、資格情報の送信、トークンの発行という順序になります。"
        }
      ],
      "correctOption": "b",
      "point": 50
    },
    {
      "qNo": 2,
      "theme": "セキュリティインシデントへの対応",
      "description": "## 問2 セキュリティインシデントへの対応に関する次の記述を読んで、設問1～5に答えよ。\n\n### [A社の概要]\n\nA社は、玩具を製造販売する従業員数 1,500名の企業である。A社の組織図を図1に示す。\n\n```mermaid\ngraph TD\n    CEO[社長]\n    Audit[内部監査室]\n    Sales[営業部]\n    Dev[開発部]\n    System[システム部]\n    Admin[総務部]\n    HR[人事部]\n    Finance[財務経理部]\n\n    CEO --- Audit\n    CEO --- Sales\n    CEO --- Dev\n    CEO --- System\n    CEO --- Admin\n    CEO --- HR\n    CEO --- Finance\n```\n図1 A社の組織図\n\nA社は、情報セキュリティ委員会を設けている。委員会は、各部の部長で構成され、事務局は総務部が担当する。下部組織として、セキュリティインシデントに対応する非常時対応チームをもつ。しかし、具体的な活動内容は明文化されておらず、活動実績は極めて少ない。\n\n### [ネットワーク構成]\nA社は、国内に本社を置き、海外に工場をもつ。ネットワーク構成を図2に示す。\n\n```mermaid\ngraph LR\n    subgraph DMZ\n        DNS[外部DNSサーバ]\n        Mail[外部メールサーバ]\n        Proxy[プロキシサーバ]\n    end\n    subgraph Internal [A社本社 業務PC-LAN]\n        BizPC[業務PC]\n        SrvLAN[サーバLAN]\n        Auth[認証サーバ]\n        DeptSrv[部門サーバ]\n    end\n    subgraph DevLAN [開発LAN]\n        DevSrv[開発用サーバ]\n    end\n    Internet((インターネット)) -- FW --- DMZ\n    DMZ --- L3SW\n    L3SW --- Internal\n    L3SW --- DevLAN\n    L3SW --- Factory[A社工場 海外]\n```\n図2 A社のネットワーク構成（概要）\n\n- DMZ内のサーバにはグローバルIPが付与されている。\n- 業務PCからインターネットへは、プロキシサーバを介してのみアクセス可能。プロキシは直近60日分のログを保存している。\n\n### [情報漏えいの発生]\n2018年9月11日、インシデントP（未発表の新製品αの操作説明書「漏えい文書X」が掲示板Uに投稿された）が発覚した。開発部の担当者が確認したところ、間違いなくA社の文書であった。\n情報セキュリティ委員会は、インシデントPを、非常時対応チームではなく当該文書を所管する開発部が対応することを決定した。理由は、個人情報の漏えいが見つかっておらず緊急度が低いこと、非常時対応チームの権限が不明確であることなどであった。\n\n### [調査結果]\n開発部対応チームの調査により、以下のことが判明した。\n- 漏えい文書Xは、開発部の部門サーバに保管されていた文書Yと同じだった。\n- 文書Yには開発部のメンバなら誰でもアクセス可能だった。\n- 委託先のV社と共同で執筆しており、データの受け渡しに利用したUSBメモリRを紛失していた。\n\n### [インシデントQの発生]\n10月10日、ある民間組織から「A社の機器のうち1台がサイトMにアクセスし、遠隔操作機能をもつマルウェアKをダウンロードした可能性がある」との通知があった。調査の結果、開発部のDさんの業務PC-Aがマルウェアに感染し、外部の不審なサイトと頻繁に通信していることが判明した（インシデントQ）。\n\n```mermaid\ngraph TD\n    subgraph Incident_Q_Flow\n        A[PC-Aにマルウェア感染]\n        B[不審なサイトMへアクセス]\n        C[マルウェアK/Lのダウンロード]\n        D[遠隔操作による情報探索]\n        E[開発LAN内PC-Bへの侵入試行]\n        F[設計資料の窃取]\n    end\n```",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔早期に取り組むべき事項のとりまとめ〕について、(1), (2)に答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図4中の [ a ], [ b ] に入れる適切な字句を、解答群から選び記号で答えよ。"
            },
            {
              "label": "(2)",
              "text": "図5中の [ c ] 〜 [ e ] に入れる適切な字句を、解答群から選び記号で答えよ。"
            }
          ],
          "explanation": "(1) インシデント対応チーム(CSIRT)の役割として、NIST SP 800-61では「脆弱性や脅威についてのアドバイザリの配信」や「インシデント対応に関する他のサービスの提供」が挙げられます。図4の文脈では [a] は「教育と意識向上」、[b] は「インシデント」が適当です。\n(2) インシデント対応ポリシには、組織のリーダーによる「ポリシの責任表明」や、インシデントの「優先順位付け」の基準などを記載します。"
        },
        {
          "subQNo": "設問2",
          "text": "〔インシデント対応能力の向上への取組み〕について、(1)〜(3)に答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ f ] 〜 [ h ] に入れる適切な字句を、それぞれ12字以内で答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の [ i ], [ j ] に入れる適切な字句を、それぞれ8字以内で答えよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線①について、取得した通常時プロファイルの利用方法を35字以内で具体的に述べよ。"
            }
          ],
          "explanation": "(1) ログ管理の要件として、どのような「ログの種類」を、どの程度の「保存期間」取得するかを定める必要があります。\n(2) 時刻同期に関しては「NTPサーバ」を用いて「時刻を同期」することが重要です。ログ解析において、各機器の時刻がずれているとイベントの前後関係が特定できなくなるためです。\n(3) 通常時のネットワークトラフィック量などを把握しておくことで、インシデント発生時の「異常な通信量や挙動の検知」に役立てます。"
        },
        {
          "subQNo": "設問3",
          "text": "〔マルウェアについての通知〕について、(1)〜(7)に答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線②について、サイトMにアクセスしたPCを特定した方法を、60字以内で具体的に述べよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線③について、このアクセスによってマルウェアが何を行っていたと考えられるか。HTTPリクエストとHTTPレスポンスに分けて述べよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線④について、調査の観点から見たときの問題は何か。また軽減策は何か。"
            },
            {
              "label": "(4)",
              "text": "本文中の [ k ] に入れる適切な調査内容を、40字以内で述べよ。"
            }
          ],
          "explanation": "(1) プロキシサーバのログを確認し、サイトMのIPアドレス（またはFQDN）への送信元IPアドレスを特定することで、PC-Aを見つけ出しました。\n(2) HTTPリクエストで「C&Cサーバへの情報送信」を行い、HTTPレスポンスで「攻撃者からのコマンド」を受け取っていたと考えられます（いわゆるビーコニング）。\n(4) マルウェアKが他機器に感染を広げていないか確認するため、「マルウェアKの特徴的な通信先へのアクセスログ」などを調査します。"
        },
        {
          "subQNo": "設問4",
          "text": "〔インシデントQのタイムラインと措置〕について、(1), (2)に答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "表2中の [ ア ] 〜 [ ウ ] に入れる適切な日時を答えよ。"
            },
            {
              "label": "(2)",
              "text": "表2中の [ m ] 〜 [ s ] に入れる適切な字句を答えよ。"
            }
          ],
          "explanation": "表2は、プロキシログ(図6)や調査結果(図7)からタイムラインを再構成する問題です。ログのタイムスタンプと、Dさんの行動履歴を突き合わせることで、いつマルウェアがダウンロードされ、いつ外部への情報送信が始まったかを特定します。"
        },
        {
          "subQNo": "設問5",
          "text": "本文中の下線⑦について、図3中の(6)に示された課題a〜dの中から、この時点で未対応の課題を選び記号で答えよ。また、その課題を解決するための措置を、25字以内で具体的に述べよ。",
          "explanation": "インシデントQの調査でも、ログが不足していたり、個人のスキルに依存して調査が難航したりした場面が見られます。特に「ログ取得のポリシが徹底されていない」点は、インシデントPの時からの継続課題(d)です。"
        }
      ],
      "correctOption": "c",
      "point": 50
    }
  ]
}