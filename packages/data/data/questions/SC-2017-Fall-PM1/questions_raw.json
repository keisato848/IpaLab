{
  "qNo": 1,
  "theme": "ランサムウェアへの対策",
  "description": "B社は，従業員数 300 名の建築資材販売会社であり，本社，営業店 10 か所の他に倉庫がある。本社，各営業店及び倉庫のネットワークは IP-VPN で接続されており，インターネットとの接続は本社に集約されている。\n\n### システム構成と業務の流れ\nB社のシステム構成を図1に，受注から出荷までの業務の流れを図2に示す。\n\n```mermaid\ngraph TD\n    Internet((インターネット)) -- \"FW/R\" --- HQ[本社]\n    HQ --- IP-VPN{IP-VPN}\n    IP-VPN --- SalesOffice[営業店 1-10]\n    IP-VPN --- Warehouse[倉庫]\n    \n    subgraph HQ [本社]\n        D_Server[Dサーバ: 業務AP / 共有フォルダ]\n        G_Server[Gサーバ: 共有フォルダ]\n        PC_HQ[本社用PC01-50]\n    end\n\n    subgraph SalesOffice [営業店]\n        R1[R/L2SW]\n        PC_Sales[営業用PC01-05]\n    end\n\n    subgraph Warehouse [倉庫]\n        R2[R/L2SW]\n        PC_Work[作業用PC01-50]\n        HT[HT: ハンディターミナル]\n        PC_Work --- HT\n    end\n```\n\n#### 図2 受注から出荷までの業務の流れ\n1. 営業担当者が，自分の利用者IDで営業用PCにログオンし，Aアプリを使って業務APに接続し，受注情報を登録する。\n2. 本社スタッフが，自分の利用者IDで本社用PCにログオンし，Aアプリを使って業務APに接続し，受注情報を基に出荷指示情報を登録する。\n3. 業務APでは，出荷指示情報が登録されるとDサーバ上の共有フォルダに，出荷指示1件につき，CSV形式による出荷指示ファイルを1ファイルとして出力する。\n4. 出荷担当者が，自分の利用者IDで作業用PCにログオンする。\n5. 出荷担当者が，作業用PCにHTを接続し，Aアプリを使ってDドライブ上の自分が担当する出荷指示ファイルを“出荷処理中”にステータス更新した上で，出荷指示情報をHTに取り込む。\n6. 出荷担当者は，出荷が完了すると，Aアプリを使ってDドライブの該当する出荷指示ファイルを“出荷完了”にステータス更新する。\n7. 営業担当者及び本社スタッフが，Aアプリを使ってDドライブ上の出荷指示ファイルを閲覧し，最新の出荷状況を確認する。\n\n### セキュリティインシデントの発生\nある日の 9:50 に，出荷担当者のVさんからITシステム担当者のL君に，出荷指示ファイルが破損しているとの連絡が入った。L君は調査のため，①破損した出荷指示ファイルを削除せず，別のフォルダに移動しておいた。その後，10:30 に営業担当者のSさんから，PC05の画面に脅迫文が表示されていると連絡があった。L君は営業用PC05がマルウェアに感染したと判断し，ネットワークから切り離した。\n\n### セキュリティインシデントの調査\nL君とJ氏はログファイル等を収集し，表1のタイムラインを作成した。\n\n#### 表1 セキュリティインシデントのタイムライン\n| No | 時刻 | 事象 | 対象機器 |\n| :--- | :--- | :--- | :--- |\n| 1 | 7:50 | PCが起動された。 | 営業用PC05 |\n| 2 | 7:51 | 営業利用者05でログオンされた。 | 営業用PC05 |\n| 3 | 7:51 | 営業用PC05から営業利用者05でログオンされた。 | Dサーバ |\n| 4 | 8:25 | Aアプリが実行された。 | 営業用PC05 |\n| 5 | 8:29 | メール閲覧ソフトが実行された。 | 営業用PC05 |\n| 6 | 8:30 | invoice.fdp.exe が実行された。 | 営業用PC05 |\n| 7 | 8:32 | 提案書.docx ファイルが暗号化された。 | 営業用PC05 |\n| | 以降 | 9:11 までファイルの暗号化が繰り返された。 | 営業用PC05 |\n| 8 | 9:11 | 出荷指示_01_00001.csv ファイルが暗号化された。 | Dサーバ |\n| | 以降 | 9:40 までファイルの暗号化が繰り返された。 | Dサーバ |\n| 9 | 10:10 | 脅迫文のファイルが作成され，画面に表示された。 | 営業用PC05 |\n\n調査の結果，マルウェアはメールに添付された PDF ファイルに偽装したものであった。ファイル名には Unicode 制御文字の [ a ] が使われていた。また，メールヘッダの [ b ] フィールドから，外部から送信されたことが判明した。\n\n### ランサムウェア X の特徴\nランサムウェア X は，アクセス可能なドライブをアルファベット順に探索し，文書ファイル等を暗号化して上書き保存する。OSのシステムファイルは対象外である。また，暗号化には共通鍵暗号方式が使われるが，J氏によると，検体を解析しても復号が困難な「④このタイプ」と，メモリ上に共通鍵が残る「⑤PCをハイバネーション状態で保管」すれば復号できる可能性があるタイプがある。\n\n### 被害拡大防止策の実施\nL君は，Dサーバ上のアクセス権限を表2のとおり見直した。\n\n#### 表2 Dサーバ上の出荷指示ファイルを格納しているフォルダのアクセス権限設定（抜粋）\n| 利用者のグループ | 見直し前（読み / 書き） | 見直し後（読み / 書き） |\n| :--- | :--- | :--- |\n| 出荷担当者グループ | 可 / 可 | [ c ] / [ d ] |\n| 営業担当者グループ | 可 / 可 | [ e ] / [ f ] |\n| 本社スタッフグループ | 可 / 可 | [ g ] / [ h ] |",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "本文中の下線①のファイルについて，タイムラインを作成する際に用いたタイムスタンプ情報を解答群の中から選び，記号で答えよ。",
      "explanation": "L君は、破損（暗号化）されたファイルがいつ作成または更新されたかを特定することで、マルウェアがいつから活動を開始したかを調査しました。タイムラインのNo.8にある通り、特定のファイルが暗号化された時刻を特定するには、ファイルの「更新日時」を確認するのが一般的です。\n\n### ファイル操作とタイムスタンプの変化\n```mermaid\ngraph LR\n    Create[作成] --> |作成日時記録| File[ファイル]\n    Modify[内容変更/暗号化] --> |更新日時記録| File\n    Access[読み取り] --> |アクセス日時記録| File\n```",
      "subQuestions": [
        {
          "label": "解答群",
          "text": "ア アクセス日時、イ 更新日時、ウ 削除日時、エ 作成日時"
        }
      ]
    },
    {
      "subQNo": "設問2",
      "text": "〔セキュリティインシデントの調査〕について，(1)〜(4)に答えよ。",
      "explanation": "マルウェアの偽装手法と、感染の仕組み、被害の範囲についての理解を問う問題です。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の [ a ]，[ b ] に入れる適切な字句を解答群の中から選び，記号で答えよ。",
          "explanation": "Unicode制御文字 **RLO (Right-to-Left Override)** は、文字の表示順序を右から左へ逆転させます。これを利用して `invoice.fdp.exe` を `invoice.exe.pdf` と見せかける手法が有名です。また、メールの経路情報は **Received** ヘッダに記録されます。"
        },
        {
          "label": "(2)",
          "text": "本文中の下線②について，復元に利用するバックアップデータを選択する際，感染開始時刻と，何の時刻を比較すべきか。15文字以内で答えよ。",
          "explanation": "バックアップデータは、暗号化される「直前」の正常な状態である必要があります。したがって、バックアップが完了した時刻（作成された時刻）を比較対象とします。\n\n### バックアップ選択のロジック\n```mermaid\ngraph TD\n    Start((感染開始時刻)) -->|以前のものを探す| Backup[バックアップ完了時刻]\n    Backup -->|最新を選択| Success[復元成功]\n```"
        },
        {
          "label": "(3)",
          "text": "本文中の下線③について，感染していない D サーバも，ランサムウェア X によってファイルが暗号化された。その原因となる，営業用 PC の設定とランサムウェア X の特徴を，それぞれ 35 文字以内で述べよ。",
          "explanation": "原因(設定): Dサーバの共有フォルダがネットワークドライブとして割り当てられていた。 \n原因(特徴): アクセス可能なネットワークドライブを探索してファイルを暗号化する特徴。"
        },
        {
          "label": "(4)",
          "text": "ランサムウェア X が起動した直後に感染を検知し，営業用 PC05 をネットワークから切り離していれば，今回の被害を一部防ぐことができたと考えられる。どのような被害を防ぐことができたか。25 文字以内で述べよ。",
          "explanation": "ランサムウェア X はドライブをアルファベット順に処理します。PC05（ローカル）の後にDサーバ（ネットワーク）を処理するため、早期遮断により「Dサーバ上のファイルの暗号化」を防げたはずです。"
        }
      ]
    },
    {
      "subQNo": "設問3",
      "text": "〔被害拡大防止策の実施〕について，(1)〜(3)に答えよ。",
      "explanation": "権限の最小化（最小権限の原則）と、ランサムウェアの暗号化方式の違いによる対応策についての問題です。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "表 2 中の [ c ] 〜 [ h ] に入れる適切なアクセス権限を，可又は不可で答えよ。",
          "explanation": "業務フローに基づき、必要な権限のみを与えます。出荷担当者は更新（書き込み）が必要ですが、営業や本社スタッフは閲覧（読み込み）のみで十分なはずです。"
        },
        {
          "label": "(2)",
          "text": "本文中の下線④について，検体を解析してもファイルの復号が困難である理由を，30 文字以内で述べよ。",
          "explanation": "ファイルごとに異なる共通鍵が公開鍵で暗号化されているから。"
        },
        {
          "label": "(3)",
          "text": "本文中の下線⑤のように，PC を休止状態で保管しておけばファイルを復号できる可能性があるが，シャットダウンしてしまうとその可能性が低くなる。可能性が低くなる理由を，ランサムウェア X の動作を踏まえて 35 文字以内で述べよ。",
          "explanation": "シャットダウンによってメモリ上の共通鍵が消去されてしまうから。"
        }
      ]
    },
    {
      "subQNo": "設問4",
      "text": "本文中の下線⑥について，セキュリティパッチ P を適用せずに放置した場合，営業用 PC がランサムウェア Y に感染すると，他のサーバや PC に感染が広がり，甚大な被害が生じるおそれがある。G サーバにおいて，ランサムウェア X では起きないが，ランサムウェア Y では起きる被害を，40 文字以内で述べよ。",
      "explanation": "ランサムウェア Y は OS の脆弱性を悪用して「感染自体を広める（自己拡散）」特徴があります。X は感染 PC からアクセスできるファイルを暗号化するだけですが、Y は G サーバ自体に感染し、そこからさらに被害を拡大させます。\n\n### XとYの違い\n```mermaid\ngraph TD\n    X[ランサムウェアX] -->|ファイル操作| Data[共有フォルダ暗号化]\n    Y[ランサムウェアY] -->|OS脆弱性悪用| Infect[Gサーバ自体が感染]\n    Infect -->|自己増殖| Broad[全社への被害拡大]\n```"
    }
  ]
}