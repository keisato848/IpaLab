{
  "questions": [
    {
      "qNo": 1,
      "theme": "メール運用におけるセキュリティ対策",
      "description": "S/MIMEの電子署名及び暗号化の仕組みに関する問題。",
      "context": {
        "title": "現在のメール運用の問題点と対策",
        "background": "【注記】この設問を解くために必要な本文（下線①、下線②を含む）は、入力データとして提供されていません。\n\nL社では、電子メールの送受信におけるセキュリティ強化のため、S/MIME（Secure/Multipurpose Internet Mail Extensions）の導入を検討している。S/MIMEは、電子メールに電子署名機能と暗号化機能を提供する標準的な技術である。\n\nS/MIMEが提供する主要な機能は、主に以下の二つに分けられる。\n\n1. 電子署名による送信者の認証と改ざん検知\n2. 公開鍵暗号と共通鍵暗号を併用したメール内容の盗聴防止\n\n### 1. 電子署名の仕組み\n\n電子署名は、送信者が自身の秘密鍵を用いてメッセージのハッシュ値を暗号化し、受信者が送信者の公開鍵を用いて復号することで、メッセージが送信者本人から送られたこと（認証）と、途中で改ざんされていないこと（完全性）を保証する。\n\n電子署名の具体的な手順の一部を{{diagram:table1}}に示す。\n\n{{diagram:table1}}\n\n### 2. メール内容の暗号化の仕組み\n\nメール内容の暗号化では、処理速度の速い共通鍵暗号方式をメインで利用し、その共通鍵を安全に相手に配送するために公開鍵暗号方式を併用するハイブリッド方式が用いられる。\n\nメール内容の暗号化・復号の具体的な手順の一部を{{diagram:table2}}に示す。\n\n{{diagram:table2}}",
        "diagrams": [
          {
            "id": "table1",
            "label": "表1 S/MIMEにおける電子署名の手順（抜粋）",
            "type": "markdown",
            "content": "| 手順 | 内容 |\n|:---:|:---|\n| 1.1 | 送信メッセージ全体のハッシュ値 x を計算する。 |\n| 1.2 | x を [ a ] で暗号化し、電子署名を作成する。 |\n| 1.3 | 電子署名を添付し、受信者に送信する。 |\n| 1.4 | 受信者が、添付された電子署名を [ b ] で復号し、ハッシュ値 x' を取り出す。 |\n| 1.5 | 受信メッセージ全体のハッシュ値 y を計算する。 |\n| 1.6 | x' と y を比較し、一致しなければ 下線③メール内容の改ざんが検知できる。 |"
          },
          {
            "id": "table2",
            "label": "表2 S/MIMEにおけるメール内容の暗号化・復号の手順（抜粋）",
            "type": "markdown",
            "content": "| 手順 | 内容 |\n|:---:|:---|\n| 2.1 | ランダムな共通鍵 K を生成する。 |\n| 2.2 | 共通鍵 K を [ c ] で暗号化する。 |\n| 2.3 | 下線④メール内容を共通鍵 K を用いた共通鍵暗号方式で暗号化する。 |\n| 2.4 | 暗号化された共通鍵 K と暗号化されたメール内容を受信者に送信する。 |\n| 2.5 | 受信者が暗号化された共通鍵 K を [ d ] で復号し、共通鍵 K を取り出す。 |\n| 2.6 | 共通鍵 K を用いてメール内容を復号する。 |"
          }
        ]
      },
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔現在のメール運用の問題点と対策〕について答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線①によって発生するおそれのある、情報漏えいにつながる問題を、40字以内で答えよ。",
              "answer": "誤送信が発生した場合に、PWメールも誤った宛先に送られ、添付ファイルの内容が情報漏えいすること。",
              "explanation": "下線①は、本文メールを誤送信した場合でも、確認せずにパスワード(PWメール)も同じ宛先に送ってしまうという運用上の問題点です。これにより、誤って送信された宛先の相手が添付ファイルを開封できてしまい、情報漏えいにつながります。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線②について、盗聴による情報漏えいリスクを低減させる運用上の改善策を、30字以内で答えよ。",
              "answer": "",
              "explanation": ""
            }
          ],
          "point": 33
        },
        {
          "subQNo": "設問2",
          "text": "[S/MIME の調査〕について答えよ。\n解答群\nア CAの公開鍵\nイ CAの秘密鍵\nウ 受信者の公開鍵\nエ 受信者の秘密鍵\nオ 送信者の公開鍵\nカ 送信者の秘密鍵",
          "explanation": "S/MIMEでは、**電子署名**と**暗号化**に公開鍵暗号方式と共通鍵暗号方式を組み合わせて使用します。\n\n**電子署名 (表1)**: 送信者の身元保証と改ざん防止が目的です。\n1.2 [ a ]: 送信者がハッシュ値を暗号化して署名を作成するため、**送信者の秘密鍵**を使用します。（カ）\n1.4 [ b ]: 受信者が署名を復号してハッシュ値を取り出すため、対となる**送信者の公開鍵**を使用します。（オ）\n\n**暗号化・復号 (表2)**: 内容の盗聴防止が目的です。共通鍵暗号（高速）と公開鍵暗号（鍵交換）のハイブリッド方式です。\n2.2 [ c ]: 共通鍵自体を暗号化して安全に送るために、受信者しか復号できないように、**受信者の公開鍵**を使用します。（ウ）\n2.4 [ d ]: 暗号化された共通鍵を受信者が復号するために、対となる**受信者の秘密鍵**を使用します。（エ）",
          "references": [
            "table1",
            "table2"
          ],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線③が検知される手順はどれか。表1,2中の手順の番号で答えよ。",
              "answer": "1.6",
              "explanation": "下線③は「メール内容の改ざんが検知できる」という電子署名の機能について問われています。電子署名の検証（表1）は、送信時に計算・暗号化されたハッシュ値xと、受信後に受信内容から計算されたハッシュ値yを比較することで、途中で内容が改ざんされていないかを確認します。この比較が行われるのは手順1.6です。"
            },
            {
              "label": "(2)",
              "text": "表1,2中の [ a ] ~ [ d ] に入れる適切な字句を解答群の中から選び、記号で答えよ。",
              "answer": "a: カ, b: オ, c: ウ, d: エ"
            },
            {
              "label": "(3)",
              "text": "表2中の下線④について、メール内容の暗号化に公開鍵暗号ではなく共通鍵暗号を利用する理由を、20字以内で答えよ。",
              "answer": "大量のデータであるメール内容の暗号化の処理速度が速いため。",
              "explanation": "メール本文や添付ファイルといった大量のデータを暗号化する際、共通鍵暗号方式（対称鍵暗号）は、公開鍵暗号方式（非対称鍵暗号）に比べて処理速度が非常に速いという利点があります。そのため、S/MIMEでは、データ量が多いメール内容の暗号化に共通鍵暗号を使用し、その共通鍵を安全に送るためだけに公開鍵暗号を利用します。"
            }
          ],
          "point": 33
        },
        {
          "subQNo": "設問3",
          "text": "本文中の下線⑤について,電子証明書の正当性の検証に必要となる鍵の種類を解答群の中から選び、記号で答えよ。",
          "references": [],
          "answer": "ア",
          "explanation": "下線⑤は、受信した電子証明書が認証局(CA)によって正しく発行されたもの（正当なもの）であるかを検証することです。CAが発行する電子証明書には、CAの秘密鍵で署名がされています。受信側は、この署名を検証するために、あらかじめ信頼できるCAの公開鍵（ルート証明書などに含まれる）を使用して復号し、正当性を確認します。",
          "point": 33
        }
      ]
    }
  ]
}