[
  {
    "qNo": 1,
    "theme": "組込み機器を利用したシステムのセキュリティ対策",
    "description": "C社は,製造事業者向けの機械及び制御用コンピュータを製作・販売している従業員数 1,200 名の会社である。保守サービスの事業拡大を目的として,顧客の工場に設置されたC社製品の稼働状況を遠隔で監視するシステム(以下,工場遠隔監視システムという)を開発することになった。\n\n工場遠隔監視システムは,機械に取り付けられているセンサの情報を制御用コンピュータ経由でリアルタイムにクラウドサービス上の監視サーバへ送信し,それをC社保守員が遠隔で監視する。センサ情報には,異常や故障を知らせる“障害情報”及び部品交換時期の目安となる使用回数などの“統計情報”が含まれる。\n\n携帯電話網を通じてインターネットにアクセスするために,C社は自社が保有する組込み機器の開発技術を生かして Linux で動作する LTE (Long Term Evolution) 対応ルータ(以下,LTEルータという)を開発することにした。制御用コンピュータは,LTEルータを使用することによって,機械から収集したセンサの情報をクラウドサービス上の監視サーバに送信できるようになる。監視サーバでは,通信プログラムが制御用コンピュータからセンサの情報を受信して,データベースに格納する。格納したデータは,保守員が使用する監視端末に表示される。また,顧客は Web ブラウザで監視サーバにアクセスし,稼働状況を確認できる。監視端末から LTEルータの設定変更ができるように,LTEルータでは SSH サービスを稼働させる。\n\n### [試験環境の構築]\n開発担当のE君は,工場遠隔監視システムの試験環境(以下,試験環境という)を構築した。試験環境の構成を図1に示す。\n\n```mermaid\ngraph LR\n    subgraph \"C社開発環境\"\n        A[機械] --- C[制御用コンピュータ]\n        B[機械] --- C\n        C --- D[LTEルータ]\n    end\n\n    D -- \"LTE回線\" --> E((携帯電話網))\n    E --- F((インターネット))\n\n    subgraph \"監視端末側\"\n        G[監視端末] --- H[VPNルータ]\n        I[Webブラウザ] --- G\n    end\n\n    H --- F\n\n    subgraph \"クラウドサービス\"\n        J[VPNルータ] --- K[監視サーバ]\n        K --- L[通信プログラム]\n        K --- M[Webサーバ]\n        K --- N[データベース]\n    end\n\n    J --- F\n\n    style D fill:#fff,stroke:#333,stroke-width:2px\n    style H fill:#fff,stroke:#333,stroke-width:2px\n    style J fill:#fff,stroke:#333,stroke-width:2px\n```\n\nインターネットを流れる通信は, Web ブラウザから監視サーバへの通信を除き, 全て IPsec を使って暗号化する。IPsec では,通信モードに [  a  ] モードを使用し,ルータ間の通信を全て暗号化する。鍵交換には,IKEv2 を使用し,認証方式には,事前共有鍵方式を選択する。片側のルータの IP アドレスが動的に変わる環境においては, IKEv1 の場合, [  b  ] モードを使用する必要があるが, IKEv2 の場合は標準で対応している。\n\n### [試験環境における情報セキュリティインシデントの発生]\n試験を開始してから7日後,E君が監視端末から LTEルータに SSH でログインしたところ,見覚えのない IP アドレスからログインされていることに気付いた。E君は,不正アクセスを受けている可能性があることをプロジェクト責任者のW主任に報告し,調査を開始した。\n\nLTEルータにおいて, netstat コマンドを実行したところ, 表1に示すとおり, 試験環境と無関係のグローバル IP アドレスとの接続が複数あること, 及び [  c  ] を送信元として SSH サービスにログインされていることが分かった。\n\n**表1 netstat コマンドの実行結果(抜粋)**\n\n| プロトコル | ローカルアドレス | 外部アドレス | 状態 | プロセス ID |\n| :--- | :--- | :--- | :--- | :--- |\n| TCP | 0.0.0.0:22 | 0.0.0.0:* | LISTEN | 1543 |\n| UDP | 0.0.0.0:53 | 0.0.0.0:* | LISTEN | 1145 |\n| UDP | 0.0.0.0:123 | 0.0.0.0:* | LISTEN | 1380 |\n| UDP | 0.0.0.0:500 | 0.0.0.0:* | LISTEN | 1417 |\n| TCP | 192.168.10.1:22 | 192.168.20.123:54433 | ESTABLISHED | 1545 |\n| TCP | z1.z2.z3.z4:22 | x1.x2.x3.x4:32489 | ESTABLISHED | 1547 |\n| TCP | z1.z2.z3.z4:45532 | y1.y2.y3.y4:25 | ESTABLISHED | 1689 |\n| TCP | z1.z2.z3.z4:45533 | y1.y2.y3.y4:25 | SYN_SENT | 1689 |\n\n注記 x1.x2.x3.x4, y1.y2.y3.y4 及び z1.z2.z3.z4 は, グローバル IP アドレスである。\n\n更に調査したところ, 攻撃者が SSH のポートフォワード機能を使って, [  d  ] を宛先として SMTP で電子メールを転送していることが分かった。LTE ルータのログには, SSH サービスがパスワードの辞書攻撃を受けた痕跡が残っていた。\n\nE君は, IPsec を経由しなくても, インターネットから LTEルータの SSH サービスにアクセスできる状態になっていることに気付いた。不正にログインされないための暫定対策として, ①<u>SSH のログイン認証をパスワード強度に依存しない方式に設定変更した</u>。\n\n### [セキュリティ対策の検討]\n情報セキュリティインシデントの発生を受けて, C社は, LTEルータのセキュリティ対策について, セキュリティ専門業者 N社のS氏に相談した。\n次は, セキュリティ対策に関するE君とS氏との会話である。\n\nE君 : SSH サービスについて暫定対策を行いましたが, 工場遠隔監視システムのリリースに向けてどのような対策を行う必要がありますか。\nS氏 : LTEルータでは, 監視端末を利用した場合にだけ, SSH サービスにアクセスできる仕様にすべきです。\nE君 : そのようにします。具体的には, どのように実現すればよいでしょうか。\nS氏 : TCP Wrapper を使って, [  e  ] することで実現できます。\nE君 : SSH サービスに関して, 他に気を付ける点はありますか。\nS氏 : 市販の幾つかの組込み機器について, ②<u>SSH のホスト鍵が同一モデルで全て同じになっているという脆弱性が, セキュリティ機関から注意喚起されています</u>。C社でも, SSH のホスト鍵は, 機器 1台ごとに異なるものを使用するように設定してください。\nE君 : 出荷する前に, いろいろとセキュリティ設定を行う必要があるのですね。\nS氏 : さらに, 新たな脆弱性が発見された場合の対応として, LTEルータのファームウェアを更新する仕組みを実装しておく必要があります。\nE君 : インターネット又は外部記憶媒体経由で, ファームウェアの更新用イメージファイル(以下, イメージファイルという)を LTEルータに読み込んで保存し, コマンドを使って更新するという機能を実装したいと考えています。どのようなことに注意が必要ですか。\nS氏 : ファームウェアの更新機能において, イメージファイルが③<u>改ざんされていないか検証できるようにする必要があります</u>。\nE君 : イメージファイルを暗号化しておく必要はありますか。\nS氏 : イメージファイルの解析ツールを使うことで, パスワードなどの重要な情報がファームウェアにハードコードされているという脆弱性が見つかった事例が報告されており, 解析されないように暗号化することも対策の一つです。④<u>しかし, イメージファイルを暗号化しても, 攻撃者が暗号化の鍵を入手して, イメージファイルを復号するという可能性を排除できません</u>。解析されても問題がないように設計することが重要です。\n\nE君は, セキュリティに関する仕様を明確化し, 基本仕様書に反映します。また, 顧客に引き渡す前に, チェックリストを基にセキュリティに関する設定項目についてレビューするようにしたいと思います。\n\nE君は, LTEルータのセキュリティ対策を実施し, W主任の承認を得ることができた。E君は, 工場遠隔監視システムのリリースに向けて作業を開始した。",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "本文中の [  a  ], [  b  ] に入れる適切な字句を解答群の中から選び, 記号で答えよ。",
        "explanation": "### 解説\n*   **[ a ]**: IPsecには「トランスポートモード」と「トンネルモード」があります。ルータ間で元のIPパケット全体を暗号化し、新しいIPヘッダを付与してカプセル化するのは**トンネルモード**です。設問では「ルータ間の通信を全て暗号化する」とあり、図1の構成からも拠点間VPN（トンネルモード）であることがわかります。正解：エ\n*   **[ b ]**: IKEv1において、片側のIPアドレスが動的に変化する場合（例えばモバイル網経由など）、IPアドレスを識別子としない**アグレッシブモード**を使用する必要があります。メインモードではIPアドレスが固定である必要があります。正解：ア\n\n### 解答群\nア アグレッシブ  イ アドホック  ウ トランスポート\nエ トンネル  オ パッシブ  カ ブロック",
        "subQuestions": [
          {
            "label": "a",
            "text": "IPsecの通信モード"
          },
          {
            "label": "b",
            "text": "IKEv1での動的IP対応モード"
          }
        ]
      },
      {
        "subQNo": "設問2",
        "text": "〔試験環境における情報セキュリティインシデントの発生〕について, (1), (2)に答えよ。",
        "explanation": "### 解説\n(1) \n*   **[ c ]**: netstatの結果表より、外部アドレス「x1.x2.x3.x4」からポート22（SSH）に接続（ESTABLISHED）されていることがわかります。これが攻撃者の送信元IPです。\n*   **[ d ]**: 文脈から、SSHポートフォワード機能でSMTP（25番ポート）に転送しています。表1のローカルアドレス z1.z2.z3.z4（LTEルータ）から宛先 y1.y2.y3.y4 の25番ポートへ接続している行が見つかります。よって宛先は y1.y2.y3.y4 です。\n\n(2) パスワードに依存しない方式とは、一般的に**公開鍵認証**方式を指します。攻撃者がパスワードを推測する「辞書攻撃」や「総当たり攻撃」を無効化できます。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の [  c  ], [  d  ] に入れる IP アドレスを答えよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の下線①について, 実施した SSH の設定変更を 30 字以内で述べよ。"
          }
        ]
      },
      {
        "subQNo": "設問3",
        "text": "〔セキュリティ対策の検討〕について, (1)～(4)に答えよ。",
        "explanation": "### 解説\n(1) TCP Wrapperは `/etc/hosts.allow` や `/etc/hosts.deny` を用いてアクセス制御を行う仕組みです。「監視端末のみ許可する」ためには、監視端末のIP（またはセグメント）を許可し、それ以外を拒否する設定を書きます。\n\n(2) 全ての機器で同一のホスト鍵を持つと、1台から秘密鍵が漏えいした場合、**中間者攻撃（Man-in-the-Middle攻撃）**により、他の全ての機器への通信が復号されたり、なりすまされたりする危険があります。\n\n(3) 改ざん検知にはデジタル署名が有効です。作成時に**秘密鍵**で署名し、検証（更新）時に対応する**公開鍵**で検証します。\n\n(4) 実行バイナリやフラッシュメモリの中から、暗号化/復号処理に使われるプログラムを解析し、コード内に埋め込まれた（ハードコードされた）鍵を探し出す手法が考えられます。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の [  e  ] に入れる適切な設定内容を 30 字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の下線②の脆弱性を悪用する攻撃手法にはどのようなものが考えられるか。 20 字以内で述べよ。"
          },
          {
            "label": "(3)",
            "text": "本文中の下線③について, どのようにして実現するか。イメージファイルの作成時と更新時に行うディジタル署名に関連した処理を, 使用する鍵の種類を明示した上で, それぞれ 35 字以内で述べよ。"
          },
          {
            "label": "(4)",
            "text": "本文中の下線④について, 攻撃者はどのような方法で復号のための鍵を入手するか。 35 字以内で具体的に述べよ。"
          }
        ]
      }
    ]
  },
  {
    "qNo": 2,
    "theme": "ソフトウェア開発における脆弱性対策",
    "description": "V 社は, ディジタル機器の開発及びソフトウェアの受託開発を行う, 従業員数 400 名の企業である。昨今, ソフトウェアの重大な脆弱性が相次いで報告されているので, V 社開発部のL氏は, セキュリティ専門業者 S 社の情報セキュリティスペシャリストの K 氏から, ソフトウェア開発についてのアドバイスを受けることとした。\n\n### 〔脆弱性及びその悪用〕\nソフトウェアの脆弱性の情報を組織間で一意に特定し共有できる仕組みが運用されている。例えば, 脆弱性が報告されると, [  a  ] 識別子が付番され, 日本国内では JPCERT/CC などが公表し注意喚起している。ただし, 公表前に悪用されるものもあり, [  b  ] 脆弱性と呼ばれる。[  b  ] 脆弱性は, 特定の組織を狙う攻撃, つまり [  c  ] 型攻撃でしばしば悪用される。\n\n脆弱性の中でも, バッファオーバフロー脆弱性(以下, BOF 脆弱性という)は, 最近開発されたソフトウェアにおいても数多く報告されている。BOF 脆弱性は, 主に, スタックベース BOF 脆弱性とヒープベース BOF 脆弱性に分類される。ソフトウェアに BOF 脆弱性がある場合, 当該ソフトウェアへの入力によって, ①<u>開発者が想定しないメモリ領域に書き込まれ, 開発者の意図しない命令が実行されることがある</u>。\n\n今, Linux において実行可能ファイルが四つあるとする。図1は, それらが存在するディレクトリでの ls コマンドの出力である。実行権限の属性に “s” が表示されているファイルは, ファイルの所有者権限で実行されることを示している。四つのファイルのうち [  ア  ] は, 一般利用者 suzuki によって起動された場合でも root 権限で動作する。[  ア  ] に BOF 脆弱性があると, 外部の攻撃者やマルウェアによって, 開発者の意図しない命令が root 権限で実行されてしまう。\n\n```\nsuzuki@linux:~/temp$ ls -al\n合計 40\ndrwxrwxr-x 2 suzuki suzuki 4096 1月 18 16:19 .\ndrwxr-xr-x 22 suzuki suzuki 4096 1月 18 15:54 ..\n-rwsrwxr-x 1 root   root   7205 1月 18 16:08 sample1\n-rwsrwxr-x 1 root   root   7205 1月 18 16:10 sample2\n-rwxrwxr-x 1 suzuki suzuki 7205 1月 18 16:10 sample3\n-rwsrwxr-x 1 suzuki suzuki 7205 1月 18 16:10 sample4\nsuzuki@linux:~/temp$\n```\n**図1 ls コマンドの出力**\n\n### 〔ヒープベース BOF 脆弱性〕\nK 氏によると, 最近, ヒープベース BOF 脆弱性を悪用する攻撃の報告が増えているという。L氏は, 出荷前の V 社製品のソフトウェアについてヒープベース BOF 脆弱性がないか, K 氏のレビューを受けることにした。\n\n図2のプログラム Y は, 起動時に, 第1引数は利用者 ID を, 第2引数はパスワードを受け取る。このプログラム用にあらかじめ登録された “利用者 ID とパスワード” の組と引数で与えられた組を比較し, 利用者認証する。“利用者 ID とパスワード” は, いずれも半角英数字, 最小 6 文字最大 8 文字の文字列と仕様で定められている。\n\n```cpp\n1: #include <iostream>\n2: #include <cstring>\n3: (省略)\n4: #define UID_SIZE 8   // 利用者 ID の文字列の上限値\n5: #define PASS_SIZE 8  // パスワードの文字列の上限値\n6: (省略)\n7: using namespace std;\n8:\n9: void getPass(char *pass, char *uid)\n10: {\n11: (省略, uid で指定された利用者 ID を基に登録済パスワードを取得し pass に格納, 利用者\n    ID が存在しない場合は長さ 0 の文字列を pass に格納)\n12: }\n13: (省略)\n14:\n15: int main(int argc, char **argv)\n16: {\n17:     static char *uid;\n18:     static char *pass;\n19:     (省略, 引数の個数をチェック)\n20:     uid = new char[UID_SIZE+1];\n21:     pass = new char[PASS_SIZE+1];\n22:     getPass(pass, argv[1]);\n23:     strcpy(uid, argv[1]);\n24:\n25:     if (strlen(pass) == 0 || strcmp(argv[2], pass) != 0) {\n26:         cout << \"認証失敗\" << endl;\n27:         (省略, uid を出力, 認証失敗時の処理)\n28:     } else {\n29:         cout << \"認証成功\" << endl;\n30:         (省略, uid を出力)\n31:     }\n32: }\n```\n**図2 ヒープベース BOF 脆弱性のあるプログラム Y**\n\nプログラム Y にはヒープベース BOF 脆弱性があり, ②<u>引数によっては, 利用者認証を回避される可能性がある</u>と, L氏は K 氏に指摘された。ただし, K 氏によると, ③<u>このプログラム Y は引数が同じでも, 実行環境によっては利用者認証を回避されないとのことだった</u>。L氏は, V 社の開発した他のプログラムについても確認することとした。\n\n### 〔V 社の脆弱性対策〕\nBOF 脆弱性は, メモリを直接操作することが可能なプログラム言語 C や C++ などで発生する。その対策として, 例えば, Windows ではハードウェア DEP (Data Execution Prevention) のようなデータ実行防止機能を適用することで, 一部の BOF 脆弱性を悪用する攻撃を抑制できる。しかし, ④<u>プログラム Y での利用者認証を回避する攻撃に対しては有効に機能しない</u>。そこで, V 社では, C や C++ の利用が避けられない場合を除き, BOF 脆弱性が起きにくい他のプログラム言語を利用することとした。一般的には, 開発時に, 静的解析ツールを利用したり, 通常の利用では想定しないデータを入力し, その応答から脆弱性を探す [  d  ] 検査を行うツールを利用したりして, 脆弱性を洗い出すことも効果的である。また, V 社では, ソフトウェアのリリース後, 脆弱性が発見された場合に備え, V 社製品の利用者に更新プログラムを提供するサイトを準備することとした。",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "本文中の [  a  ] ～ [  d  ] に入れる最も適切な字句を解答群の中から選び, 記号で答えよ。",
        "explanation": "### 解説\n*   **[ a ]**: 脆弱性を識別するための番号は **CVE** (Common Vulnerabilities and Exposures) です。正解：ア\n*   **[ b ]**: 修正プログラムが提供される前に攻撃されることを **ゼロデイ** (Zero-day) 攻撃と呼びます。正解：イ\n*   **[ c ]**: 特定の組織や人を狙う攻撃は **標的型** 攻撃です。正解：ウ\n*   **[ d ]**: 予期しないデータを入力してバグや脆弱性を探す手法は **ファジング** (Fuzzing) です。正解：エ\n\n### 解答群\nア CVE  イ ゼロデイ  ウ 標的型  エ ファジング",
        "subQuestions": [
          {
            "label": "a",
            "text": "脆弱性識別子"
          },
          {
            "label": "b",
            "text": "公表前の脆弱性"
          },
          {
            "label": "c",
            "text": "特定の組織を狙う攻撃"
          },
          {
            "label": "d",
            "text": "動的検査手法"
          }
        ]
      },
      {
        "subQNo": "設問2",
        "text": "脆弱性を悪用する攻撃について, (1), (2)に答えよ。",
        "explanation": "### 解説\n(1) スタックベースBOFでは、関数の呼び出し元の実行箇所へ戻るための**戻り番地（リターンアドレス）**を、攻撃者の用意した命令の開始アドレスに書き換えることで、不正なコードを実行させます。\n\n(2) 図1のls結果で「s」ビット（SetUID）が立っており、所有者が「root」であるファイルを探します。`sample1`と`sample2`が該当します。`sample4`も「s」がありますが、所有者は`suzuki`なので、実行しても`suzuki`権限のままです。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線①について, スタックベース BOF 脆弱性を悪用する攻撃の場合, 関数呼出し時にスタックに必ず積まれるはずの, 何の値を書き換えることによって攻撃が開始されるか。 20 字以内で答えよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の [  ア  ] に入れるファイル名を全て答えよ。"
          }
        ]
      },
      {
        "subQNo": "設問3",
        "text": "図2のプログラムの脆弱性について, (1)～(3)に答えよ。",
        "explanation": "### 解説\n(1) プログラムYの20-21行目で`uid`と`pass`がヒープ上に確保されます。23行目の`strcpy(uid, argv[1])`において、`argv[1]`が`UID_SIZE`(8)を超えると、隣接する`pass`領域を上書きできます。利用者認証を回避するには、`argv[2]`（入力パスワード）と`pass`の中身を一致させる必要があります。選択肢アのように、`argv[1]`の溢れた部分で`pass`を「0111111111...」と書き換え、`argv[2]`に同じ値を入れれば認証を通過します。正解：ア\n\n(2) 23行目の`strcpy(uid, argv[1])`です。`argv[1]`のサイズチェックがないため、ここでバッファオーバフローが発生します。\n\n(3) `strcpy`の代わりに、コピーする最大サイズを指定できる`strncpy`を使用します。サイズは確保したバッファサイズ（UID_SIZE+1）に合わせるのが適切です。正解：エ, オ",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線②はどのような引数で利用者認証を回避されるか。引数の組を解答群の中から選び, 記号で答えよ。"
          },
          {
            "label": "(2)",
            "text": "利用者認証を回避される原因となるヒープベース BOF 脆弱性の存在箇所を, 実際にバッファがオーバフローするコードの行番号で答えよ。"
          },
          {
            "label": "(3)",
            "text": "(2)で示した行番号の行を差し替えて行う改修案として適切なものを解答群の中から全て選び, 記号で答えよ。"
          }
        ]
      },
      {
        "subQNo": "設問4",
        "text": "利用者認証の回避について, (1), (2)に答えよ。",
        "explanation": "### 解説\n(1) ヒープ上の領域の配置順序は、コンパイラやOSのメモリアロケータ、実行時の状況（フラグメンテーション等）に依存します。`uid`の直後に必ずしも`pass`が配置されるとは限らないため、回避できない場合があります。\n\n(2) DEP（データ実行防止）は「メモリ上のデータ領域にあるコードを実行させない」機能です。しかし、今回の攻撃は「メモリ上の変数の値を書き換えてプログラムの論理（比較処理）を欺く」ものであり、不正なコードを実行させているわけではないため、DEPでは防げません。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線③について, 利用者認証が回避されない理由を, 攻撃のタイミングではなく実行環境の観点で, 40 字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の下線④について, 有効に機能しない理由を, 30 字以内で述べよ。"
          }
        ]
      }
    ]
  },
  {
    "qNo": 3,
    "theme": "プロキシサーバによるマルウェア対策",
    "description": "Q 社は従業員数 1,000 名の医薬品製造会社である。Q 社では, セキュリティ対策を強化するために, ブラックリスト指定の URL フィルタリング機能だけを有しているプロキシサーバ(以下, プロキシ 1 という)を, セキュリティ機能が豊富な新しいプロキシサーバ(以下, プロキシ 2 という)に更新するプロジェクトを開始した。Q 社のネットワーク構成を図1に示す。\n\n```mermaid\ngraph TD\n    Internet((インターネット)) --- Router[ルータ]\n    Router --- FW[FW]\n    \n    subgraph \"DMZ\"\n        FW --- L2SW1[L2SW]\n        L2SW1 --- Proxy1[プロキシ 1]\n        L2SW1 --- Proxy2[プロキシ 2]\n        L2SW1 --- ExtDNS[外部DNSサーバ]\n        L2SW1 --- ExtMail[外部メールサーバ]\n    end\n\n    FW --- L3SW[L3SW]\n    \n    subgraph \"サーバセグメント\"\n        L3SW --- IntMail[内部メールサーバ]\n        L3SW --- IntDNS[内部DNSサーバ]\n        L3SW --- PCMgmt[PC管理サーバ]\n        L3SW --- L2SW2[L2SW]\n    end\n\n    subgraph \"利用者セグメント\"\n        L3SW --- Users((利用者))\n    end\n\n    %% 注記の表現\n    style Proxy2 stroke-dasharray: 5 5\n```\n\n注記1 プロキシ 2 は, プロジェクトの途中で設置される。\n注記2 Q社の管理 PC 及び社員 PC は, 利用者セグメントに接続されている。\n**図1 Q社のネットワーク構成**\n\n情報システム部(以下, 情シ部という)は, 情報システムの管理及び情報セキュリティインシデントの対応を行っている。サーバ管理業務は, 情シ部のサーバ管理者が行う。情シ部にはサーバ管理者が複数人いる。サーバ管理者は各種設定などのサーバ管理業務を行う場合だけ, 1 台の管理 PC に自分の管理者 ID でログオンし, OS の管理用のコマンドなどを使用する。OS の管理用のコマンドは, 一般利用者でも起動可能なものもある。管理 PC はサーバ管理業務だけに用い, Web ブラウザによるインターネット接続及び電子メール(以下, メールという)の送受信はできないように設定されている。管理 PC での作業後には, 開始日時, 終了日時及び作業者名を記録する運用が徹底されている。\n\nQ 社の従業員は, 一人 1 台貸与された社員 PC を使用している。管理 PC 及び社員 PC には, 全て, 固定 IP アドレスが割り振られている。社員 PC からインターネットへの通信は, 外部メールサーバ経由のメールの送受信と, プロキシ 1 経由の HTTP 及び HTTP over TLS での Web アクセスだけが利用できるようになっている。社員 PC の Web ブラウザは, インターネット接続時に, プロキシ 1 を経由するように設定されている。社員 PC には OS の管理用のコマンドはインストールされていない。\n\nPC のプログラム起動禁止設定は, PC 管理サーバによって, 全て一括管理されている。プログラム起動禁止設定には, プログラム名が一致した場合にプログラムの起動を禁止する方式と, プログラムの実行ファイルのハッシュ値が一致した場合に禁止する方式があり, 両方の方式を組み合わせた設定もできる。Q 社は, 複数の P2P プログラムのプログラム名を指定して起動を禁止している。\n\nサーバ及び PC では, ログオン, ログオフ及び操作のログを, ネットワーク機器では通信ログをそれぞれ取得している。プロキシ 1 では, 日時, 接続先 URL, 送信元 IP アドレス, ステータスコード, 応答のサイズなどのログを取得している。プロキシ 2 の機能を表1に示す。\n\n**表1 プロキシ 2 の機能**\n| 機能 | 説明 |\n| :--- | :--- |\n| フィルタリング機能 | URL フィルタ機能：ホワイトリスト/ブラックリスト設定した URL を許可/遮断する。 |\n| | カテゴリ単位フィルタリング機能：カテゴリ単位で “許可”, “検知”, “遮断” を指定する。 |\n| プロキシ認証機能 | PC からインターネットの Web サイトへの接続時に利用者 ID とパスワードによる利用者認証を行い, 認証結果をログに記録する。 |\n| [  a  ] 機能 | インターネットから Web サーバへの通信を中継する。 (注1) |\n\n注1) Q社では本機能は使用しない。\n\nプロキシ 2 のカテゴリ単位フィルタリング機能のために, ニュース, ゲーム, 外部ストレージサービスなどのカテゴリが用意されており, これらについては, カテゴリごとに分類された URL リストが随時更新され, プロキシベンダの Web サイトを通じて提供される。サーバ管理者がカテゴリを選んで, 通常は “遮断” を指定する。URL フィルタリングとカテゴリ単位フィルタリングで同じ URL が設定された場合は, URL フィルタリングによる設定が優先される。URL フィルタリングのホワイトリスト, ブラックリストで同じ URL が設定された場合は, ホワイトリストの設定が優先される。\n\n### 〔プロキシ更新〕\n情シ部ではプロキシ 1 からプロキシ 2 への更新を, 次に述べるフェーズ 1～3 の 3 段階で行うことにした。\n*   フェーズ 1 では, プロキシ 1 と社員 PC との通信方法を変えずに, DMZ にプロキシ 2 を導入し, プロキシ 1 とインターネット間の通信を, 全てプロキシ 2 経由とする。プロキシ 1 の URL フィルタリング機能を無効にして, プロキシ 2 のフィルタリング機能の一部だけを有効にする。ログについては, プロキシ 2 で, プロキシ 1 と同じ項目のログを取得するように設定する。\n*   フェーズ 2 では, プロキシ 2 のフィルタリング機能及びプロキシ認証機能を強化する。\n*   フェーズ 3 では, 社員 PC の Web ブラウザのプロキシ設定をプロキシ 1 からプロキシ 2 に変更し, プロキシ 1 を撤去する。\n\nこのようなフェーズ分けを行うのは, 情シ部の次の二つの判断による。\n*   社員 PC の導入時期が異なるので, 複数種類, 複数バージョンの Web ブラウザが使用されており, プロキシ 2 に切り替えると不具合が発生する可能性が高い。\n*   何らかの不具合が発生した場合に, 迅速に旧環境への切り戻しができる。\n\n### 〔情報セキュリティインシデントの発生と対応〕\nフェーズ 1 開始後まもなく, 海外のセキュリティ専門業者から, C&C (Command & Control) サーバに Q 社からの通信の記録があるとの連絡があった。情シ部の J 部長が経営陣に報告し, 情報セキュリティスペシャリストの T さんとともに調査したところ, 次のことが分かった。\n*   文書ファイルが添付されたメールが複数の従業員宛てに届いた。\n*   そのうち, 営業部の U さんが添付ファイルを開いたので, U さんの社員 PC がマルウェア(以下, マルウェア Z という)に感染した。\n*   マルウェア Z は, 文書ファイルのマクロとして実装されていた。マルウェア Z は, U さんの社員 PC 上で動作し, 文書閲覧ソフトの脆弱性を悪用して C&C サーバと通信し, 攻撃用プログラムを当該 PC 上にダウンロードして起動させた。\n*   攻撃用プログラムは, OS の管理用のコマンドを U さんの社員 PC 上に複数ダウンロードして起動させ, サーバ情報を窃取した。\n*   マルウェア Z には, ネットワーク接続された他の PC やサーバに感染を広げる機能がある。\n*   U さんの社員 PC 以外には感染した PC やサーバはなかった。\n\nJ 部長は, 不審なメールを受信した場合, 添付ファイルや, メール内に記載されている URL をクリックしないよう全従業員に注意喚起を行った。次に, J 部長は次の二つを指示した。\n*   社員 PC で, [  b  ] のプログラム起動禁止設定を行う。\n*   管理 PC で, [  c  ] のプログラム起動禁止設定を行う。\n\n### 〔プロキシサーバにおける追加設定〕\n情シ部は, C&C サーバの URL をプロキシ 2 のブラックリストに設定した。また, マルウェアの感染の拡大に備えて, 今後はプロキシ 2 によって C&C サーバへの接続が遮断された PC をプロキシサーバのログから特定し, 直ちに LAN から切り離すことにした。ところが, T さんは, 次の問題があることに気付いた。\n*   プロキシ 1 のログだけでは, プロキシ 2 で遮断したことが確認できない。\n*   ①<u>プロキシ 2 のログだけでは送信元 PC が特定できない</u>。\n\nそこで, プロキシ 1 では, HTTP ヘッダとして [  d  ] ヘッダフィールドを追加するように設定し, プロキシ 2 では, [  d  ] ヘッダフィールドをログに出力するように設定した。\n\n情シ部は, インシデント対応を完了し, プロジェクトをフェーズ 2 に進めた。\n\n### 〔フェーズ 2 の開始〕\nフェーズ 2 において, 情シ部は, まず, ②<u>プロキシ認証に対応したマルウェアも多いとの調査報告を踏まえ, 効果が完全ではないことを認識しながらも</u>, プロキシ 2 のプロキシ認証機能を有効にした。\n\n次に, 計画どおりプロキシ 2 のカテゴリ単位フィルタリング機能を用いて, 業務に不要と思われるカテゴリを “遮断” に設定した。すると, 一部の部門から, 業務で使用している Web サイトが使用できなくなったとの連絡があった。そこで, 業務に不要と思われるカテゴリを “検知” に設定し, 1 か月間運用した後, ③<u>業務に必要かつ安全であることを確認した URL は許可し, それ以外の URL は遮断することにした</u>。\n\n情シ部は, 問題がないことを確認後, プロジェクトをフェーズ 3 に進めた。",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "表 1 中の [  a  ] に入れる適切な字句を解答群の中から選び, 記号で答えよ。",
        "explanation": "### 解説\n*   **[ a ]**: 「インターネットから Web サーバへの通信を中継する」機能は、**リバースプロキシ**と呼ばれます。通常のプロキシ（フォワードプロキシ）はクライアントからインターネットへの通信を中継しますが、その逆の役割を果たします。正解：エ\n\n### 解答群\nア DMZ  イ フォワードプロキシ  ウ プロキシ ARP  エ リバースプロキシ",
        "subQuestions": [
          {
            "label": "a",
            "text": "プロキシ2の機能"
          }
        ]
      },
      {
        "subQNo": "設問2",
        "text": "〔情報セキュリティインシデントの発生と対応〕について, (1), (2)に答えよ。",
        "explanation": "### 解説\n(1) \n*   **社員 PC (b)**: 本文中に「OS の管理用のコマンドはインストールされていない」が、「攻撃用プログラムは OS の管理用コマンドを…ダウンロードして起動させ」たとあります。これを防ぐには「(i) OS の管理用のコマンド」の起動を禁止すべきです。\n*   **管理 PC (c)**: 本来サーバ管理者が(i)を使用しますが、不審なメールから(iii)マルウェアZや(ii)攻撃用プログラムが実行されるのを防ぐ必要があります。管理PCはWeb/メール不可なので、特に(ii), (iii)の起動を禁止すべきです。\n正解：b = ア(i), c = カ(ii, iii)\n\n(2) 攻撃者が**正規のプログラムをリネーム（名前変更）**したり、**内容を一部改変してハッシュ値を変えたり**した場合、名前一致やハッシュ値一致による単純な禁止設定を回避される可能性があります。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の [  b  ], [  c  ] に入れる次の(i)～(iii)の適切な組合せを, それぞれ解答群の中から選び, 記号で答えよ。 (i) OS の管理用のコマンド, (ii) 攻撃用プログラム, (iii) マルウェア Z"
          },
          {
            "label": "(2)",
            "text": "プログラム名を指定する方法とハッシュ値を指定する方法の両方でプログラム起動禁止設定を行ったとしても, 攻撃用プログラムの起動を防ぎきれない場合がある。それは, どのような攻撃用プログラムの場合か。 30 字以内で具体的に述べよ。"
          }
        ]
      },
      {
        "subQNo": "設問3",
        "text": "〔プロキシサーバにおける追加設定〕について, (1), (2)に答えよ。",
        "explanation": "### 解説\n(1) フェーズ1の構成では、プロキシ2から見ると、全ての通信の送信元は「プロキシ1」のIPアドレスになってしまいます。そのため、プロキシ2のログだけでは、真の送信元である「社員PC」を特定できません。\n\n(2) **[ d ]**: HTTPプロキシが中継する際に、元のクライアントのIPアドレスを付加するために使われる標準的なヘッダは **X-Forwarded-For** です。正解：オ",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線①について, プロキシ 2 のログだけでは送信元 PC が特定できない理由を, 30 字以内において述べよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の [  d  ] に入れる適切な字句を解答群の中から選び, 記号で答えよ。"
          }
        ]
      },
      {
        "subQNo": "設問4",
        "text": "〔フェーズ 2 の開始〕について, (1), (2)に答えよ。",
        "explanation": "### 解説\n(1) マルウェアは、感染したPCのWebブラウザの設定やOSの機能（認証情報のキャッシュ）を利用したり、メモリ上から認証情報を盗み取ったりすることで、利用者になりすまして認証を成功させます。\n\n(2) カテゴリ単位フィルタリングで「検知」設定にしている間に記録されたログを確認し、業務でアクセスが必要なURLをホワイトリスト（URLフィルタリング）に追加し、それ以外の業務外カテゴリを「遮断」に設定します。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線②について, マルウェアは, どのようにして, 認証を成功させるか。 50 字以内で具体的に述べよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の下線③について, プロキシ 2 でどのように設定すべきか。 URL フィルタリング機能及びカテゴリ単位フィルタリング機能について, それぞれ 40 字以内で具体的に述べよ。"
          }
        ]
      }
    ]
  }
]