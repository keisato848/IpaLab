{
  "qNo": 1,
  "theme": "セキュリティインシデントに関する次の記述を読んで、設問1~3に答えよ。",
  "description": "J社は、従業員1,000名の小売業である。J社では、顧客情報を顧客管理サーバで管理している。J社のネットワーク構成を図1に示す。\n\n## 図1 J社ネットワーク構成(抜粋)\n\n```mermaid\ngraph LR\n    Internet --> FW\n    subgraph J社\n        FW --> DMZ_L2SW[DMZ L2SW]\n        FW --> PC_L2SW[PC-LAN L2SW]\n        FW --> Server_L2SW[サーバLAN L2SW]\n\n        subgraph DMZ\n            DMZ_L2SW --> IntermediaryServer[保守用中継サーバ]\n        end\n\n        subgraph PC-LAN\n            PC_L2SW --> PC_A[保守PC-A]\n            PC_L2SW --> RPC[業務PC]\n        end\n\n        subgraph サーバLAN\n            Server_L2SW --> FileServer[ファイルサーバ]\n            Server_L2SW --> CustomerServer[顧客管理サーバ]\n        end\n    end\n\n    Internet -- 携帯電話回線 --> SmartPhone1[スマートフォン]\n    Internet -- 携帯電話回線 --> SmartPhone2[スマートフォン]\n    SmartPhone1 -- 無線LAN --> PC_B[保守PC-B]\n    SmartPhone2 -- 無線LAN --> PC_C[保守PC-C]\n\n    note bottom of FW: FW: ステートフルパケットインスペクション型ファイアウォール\n    note bottom of PC_L2SW: L2SW: レイヤ2スイッチ\n    note bottom of PC_A: 保守PC: 顧客管理サーバの保守作業に使うPC\n    note for Server_L2SW: 注記1: 保守 PC-A 及びサーバ LAN 上のサーバには、固定のプライベートIPアドレスを割り当てている。\n    note for IntermediaryServer: 注記2: DMZ 上のサーバには、固定のグローバルIPアドレスを割り当てている。\n```\n\n### 顧客管理サーバの保守方法\n顧客管理サーバの保守作業は、図2に示す保守方法に従って行われる。\n\n## 図2 顧客管理サーバの保守方法\n顧客管理サーバの保守はM社に委託している。M社の保守員2名(以下,保守員1,保守員2という)が、通常は保守 PC-Aから、必要に応じて保守 PC-B 又は保守 PC-C から保守を行っている。\n\n### 保守 PC-A\n*   未使用時はロッカーに保管している。\n\n### 保守 PC-B, 保守 PC-C\n*   M社が保守員ごとに貸与する。\n\n### 接続経路と接続方法\n*   保守 PCのいずれかから保守用中継サーバにSSH接続し、さらに、保守用中継サーバから顧客管理サーバにSSH接続する。\n*   保守 PC-B 及び保守 PC-Cは、M社が貸与するスマートフォンでテザリングし、インターネットに接続する。固定のグローバルIPアドレスは付与されない。\n\n### 保守用中継サーバに初めて SSH接続する際の接続先確認方法\n1.  保守員が保守 PC-B又は保守PC-CをJ社に持参する。\n2.  保守 PC-B又は保守 PC-Cをスマートフォンでテザリングし、インターネット経由で保守用中継サーバに SSH接続する。\n3.  接続したサーバのフィンガプリントが表示されるので、保守員はJ社のシステム管理者が紙に印刷しておいた保守用中継サーバのフィンガプリントと一致することを確認する。\n4.  一致する場合は、次の確認メッセージに対して“yes”を選択する。\"Are you sure you want to continue connecting (yes/no)?\"\n5.  当該接続先確認の手順が正常に完了すると、次回以降は確認メッセージが表示されなくなる。もし、SSH接続する際に警告メッセージが表示され、接続が切断された場合,保守用中継サーバのフィンガプリントが変わったか、[ a ]という状況が想定されるので、J社に確認する。\n\n### 識別・認証・認可方法\n#### a. 保守用中継サーバ\n*   保守員の着任時に、利用者IDとして、保守員1にはop1,保守員2にはop2を割り当てる。\n*   ①当該利用者IDには、一般利用者の権限を与える。\n*   パスワード認証を行う。パスワードは保守員自身が設定する。\n*   保守員の離任時、パスワードをJ社のシステム管理者が変更する。\n\n#### b. 顧客管理サーバ\n*   保守員の着任時に、保守用中継サーバの利用者 ID と同じ名称のop1, op2を割り当てる。\n*   当該利用者IDには、特権利用者の権限を与える。\n*   パスワード認証を行う。パスワードはJ社のシステム管理者が設定し、安全な方法で保守員に伝える。\n*   保守員の離任時、パスワードをJ社のシステム管理者が変更する。\n\n### ログ\n*   SSH 認証について、成功と失敗が接続先のサーバ上にSSH 認証ログとして記録される。\n*   保守用中継サーバでのコマンド実行及びその結果、並びに顧客管理サーバでのコマンド実行及びその結果が、保守用中継サーバ上に操作ログとして記録される。\n*   SSH認証ログ及び操作ログへのアクセスには特権利用者の権限が必要であり、それらのログの確認はJ社のシステム管理者が実施する。\n\n### 備考\n*   保守員は、保守作業に当たってJ社への事前申請及び事後の作業報告が必要である。\n\nFWのフィルタリングルールを表1に示す。\n\n## 表1 FWのフィルタリングルール\n\n| 項番 | 送信元 | 宛先 | サービス | 動作 | ログの記録 |\n|:---|:---|:---|:---|:---|:---|\n| 1 | PC-LAN | インターネット | HTTP, HTTPS | 許可 | する |\n| 2 | PC-LAN | サーバ LAN | HTTP, HTTPS, SMB | 許可 | する |\n| 3 | [ b ] | 保守用中継サーバ | SSH | 許可 | する |\n| 4 | [ c ] | 保守用中継サーバ | SSH | 拒否 注1) | する |\n| 5 | 保守用中継サーバ | 顧客管理サーバ 注2) | SSH | 許可 | する |\n| 6 | DMZ | インターネット | 全て | 拒否 | する |\n| : | : | : | : | : | : |\n| 15 | 全て | 全て | 全て | 拒否 | しない |\n\n注記1: 項番が小さいルールから順に、最初に合致したルールが適用される。\n注記2: 項番7~14には、保守用中継サーバ、DMZ, SSHに関するルールはない。\n注 1): 保守 PC-B又は保守PC-Cからの保守作業の際は、事前申請に記載された作業時間帯だけ、J社のシステム管理者が“許可”に変更する。\n注 2): 複数台の顧客管理サーバそれぞれのIPアドレスが指定されている。\n\n### セキュリティインシデントの発生と対応\n6月16日に、J社のシステム管理者であるFさんが、FWのフィルタリングルールに基づいて記録されたログ(以下,FWログという)から不審なログを発見した。調査したところ、暗号資産を採掘するプログラム(以下、プログラム H という)が保守用中継サーバで動作しており、②定期的にインターネット上のサーバに通信を試みていたことが分かった。そこで、外部の情報処理安全確保支援士(登録セキスペ)のS氏の助言の下,影響範囲及び原因の調査並びに対策方法の検討をすることにした。S氏からは、保守作業関連書類,FWログ, SSH 認証ログ及び操作ログの調査並びに保守員へのヒアリングをするように助言があった。\n翌日,Fさんは、S氏に図3に示す保守作業関連書類及び各種ログの調査結果並びに図4に示すヒアリング結果を報告した。\n\n## 図3 保守作業関連書類及び各種ログの調査結果\n\n### 事前申請及びFWの設定変更\n*   保守員2から、顧客管理サーバの保守を、保守 PC-Cを使って6月14日7時から9時30分に行うという事前申請が出されていた。事前申請に従って、J社のシステム管理者はFWの設定を変更した。\n\n### FW ログの調査結果\n*   申請された保守作業時間帯に、二つのグローバル IP アドレスから保守用中継サーバに SSH 接続されていた。\n\n### 操作ログの調査結果\n*   6月14日8時に,op1 がプログラムHを設置した。\n*   6月14日7時20分から9時10分の間に、op2 による顧客管理サーバの保守作業の操作が行われた。操作内容は事前申請のとおりだった。\n\n### 保守用中継サーバ上の SSH 認証ログの調査結果\n*   op1は6月14日7時30分から認証の失敗が84回続き、7時40分に認証に成功していた。\n*   op2は6月14日7時20分に認証に成功していた。\n\n### 保守作業報告\n*   保守員2から,6月14日7時20分から9時10分の保守作業について報告されていた。\n\n## 図4 保守員へのヒアリング結果\n\n### 6月14日の保守作業に関するヒアリング結果\n*   保守員1からは、保守作業は実施していないと回答があった。\n*   保守員2からは、保守 PC-Cを使い事前申請どおりに作業を行い、ほかの作業はしていないと回答があった。事前申請,操作ログ及び事後の作業報告と矛盾する回答はなかった。\n\n### そのほかの調査結果\n*   op1 に設定されているパスワードが、推測の容易な文字列であることが分かった。\n\nS氏は、この報告から、第三者がop1 のパスワードを推測してインターネット経由で不正アクセスした可能性が高いと判断し、被害範囲の特定のために各種ログを追加調査するように助言した。Fさんによる追加調査の結果,FWログ、SSH 認証ログ及び操作ログからは、保守用中継サーバにプログラム H を設置した記録は見つかったが、保守用中継サーバから顧客管理サーバを含む他機器へのアクセスの記録は見つからなかった。FさんとS氏は、これらの調査結果から,影響範囲は保守用中継サーバだけにとどまり、情報漏えいの被害もなかったと結論付けた。\n\n### セキュリティインシデントの再発防止\nS氏から、今回のセキュリティインシデントの再発防止について、幾つか提言があった。\n\n一つ目の提言は、サーバに対する認証の強化である。保守用中継サーバ及び顧客管理サーバへの SSH 接続の認証方式を、パスワード認証から公開鍵認証に変更するというものである。Fさんは、図5に示す公開鍵認証の初期登録手順を作成した。\n\n## 図5 公開鍵認証の初期登録手順(抜粋)\n\n### 保守用中継サーバへの SSH接続に用いる公開鍵認証の初期登録手順\n*   公開鍵認証に使う鍵ペアは、各保守員が保守 PCごとに作成し、管理する。\n*   ③鍵ペアの秘密鍵には、十分な強度のパスフレーズを設定する。\n*   公開鍵は、J社のシステム管理者が保守用中継サーバに登録する。\n*   SSHサーバの設定では、公開鍵認証を有効にするとともに、[ d ]を無効にする。\n\n次は、図5に関するS氏とFさんの会話である。\nS氏:万一,保守用中継サーバが不正アクセスされた場合を想定して、顧客管理サーバへの SSH接続に必要な [ e ] を利用されないように、保守用中継サーバに保存しない運用にしましょう。SSH Agent Forwarding と呼ばれる機能を使うと、保守作業のSSH接続に必要な [ e ] の全てを保守 PC にだけ保存する運用にできます。\nFさん: 承知しました。\n\n二つ目の提言は、SSHの接続元の制限である。FWで接続元を制限することができれば、万一,SSH サーバソフトウェアで認証バイパスなどの脆弱性が発見されて悪用された場合にも有効な対策となる。\nそこで、Fさんは、保守 PC-B 及び保守 PC-Cを,VPN 装置を介して又は直接,M社内のネットワークに接続させた後に、インターネット経由で保守用中継サーバにアクセスさせることを考えた。このとき、[ f ] ことができれば、保守用中継サーバへのアクセスを表1の項番4のルールを変更することによって制限できる。そこで、これらへの対応をM社に打診した。\nそのほかの再発防止策についても、FさんはS氏の提言について検討を重ね、保守用中継サーバ及び顧客管理サーバに関するセキュリティを強化した。",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "[顧客管理サーバの保守方法]について、(1)~(3)に答えよ。\n(1) 図2中の [ a ] に入れる適切な字句を20字以内で答えよ。\n(2) 図2中の下線①の設定にした目的を、“操作ログ”という字句を用いて25字以内で述べよ。\n(3) 表1中の [ b ], [ c ] に入れる適切な字句を、図1中の字句を用いて答えよ。",
      "explanation": "### 設問1の解説\n#### (1) [ a ] について\nSSH接続において、接続先サーバのフィンガプリントが変わった場合、それは中間者攻撃（MITM攻撃）によって、意図しない第三者のサーバに接続されている可能性（なりすまし）を示します。そのため、J社に確認すべき状況は「サーバのなりすまし」が発生したかどうかです。\n\n**解答:** サーバのなりすましが発生した。\n\n#### (2) 下線①の設定目的について\n図2の識別・認証・認可方法では、保守用中継サーバの保守員ID（op1, op2）に「一般利用者の権限」を与える（下線①）とあります。一方、ログの項目には、操作ログへのアクセスには特権利用者の権限が必要であり、確認はJ社のシステム管理者が行うとあります。\nこれは、保守員が特権を持たないことで、自身の不正な操作（プログラムHの設置など）の証拠となる操作ログを、保守員自身が意図的にアクセス・改ざんできないようにすることを目的としています。\n\n**解答:** 保守員が操作ログを改ざんできないようにするため。\n\n#### (3) [ b ], [ c ] について\n表1のルールは、保守用中継サーバ（DMZ）へのSSHアクセスを制御しています。\n\n*   保守 PC-AはPC-LAN内にあり、通常アクセスに使用されます。これは恒久的に許可されるべき接続元です。よって、[ b ] は **PC-LAN** であり、項番3で許可されます。\n*   保守 PC-B/Cはインターネット経由でアクセスし、固定のグローバルIPアドレスを持ちません。通常はアクセスを拒否する必要がありますが、必要な時だけ注記1に基づき許可に変更されます。よって、[ c ] は **インターネット** であり、項番4でデフォルト拒否設定されます。\n\n**解答:** \nb: PC-LAN \nc: インターネット",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "図2中の [ a ] に入れる適切な字句を20字以内で答えよ。",
          "point": 12
        },
        {
          "label": "(2)",
          "text": "図2中の下線①の設定にした目的を、“操作ログ”という字句を用いて25字以内で述べよ。",
          "point": 11
        },
        {
          "label": "(3)",
          "text": "表1中の [ b ], [ c ] に入れる適切な字句を、図1中の字句を用いて答えよ。",
          "point": 11
        }
      ]
    },
    {
      "subQNo": "設問2",
      "text": "[セキュリティインシデントの発生と対応]について、(1), (2)に答えよ。\n(1) 本文中の下線②の通信は、表1のどのルールによってFWログに記録されるか。表1中の項番で答えよ。\n(2) 今回のセキュリティインシデントにおいて、第三者が保守用中継サーバにSSH 接続可能だった期間は何月何日の何時何分から何月何日の何時何分までか。期間を答えよ。",
      "explanation": "### 設問2の解説\n#### (1) 下線②の通信について\n下線②は、保守用中継サーバ（DMZ）からインターネット上のサーバへの定期的な通信試行です。送信元はDMZ、宛先はインターネットです。\n表1の項番6は「送信元: DMZ、宛先: インターネット、サービス: 全て、動作: 拒否、ログの記録: する」となっており、この不審な通信試行を拒否し、ログに記録していたと考えられます。\n\n**解答:** 6\n\n#### (2) SSH接続可能期間について\n第三者による不正アクセスは、保守員2の事前申請に基づき、J社のシステム管理者がFWの設定（項番4）を一時的に「許可」に変更した期間に可能となりました。\n図3によると、事前申請された保守作業期間は6月14日7時00分から9時30分までです。この期間にFWルールが変更され、外部からのSSH接続が一時的に許可されていました。\n\n**解答:** 6月14日7時00分から6月14日9時30分まで",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の下線②の通信は、表1のどのルールによってFWログに記録されるか。表1中の項番で答えよ。",
          "point": 11
        },
        {
          "label": "(2)",
          "text": "今回のセキュリティインシデントにおいて、第三者が保守用中継サーバにSSH 接続可能だった期間は何月何日の何時何分から何月何日の何時何分までか。期間を答えよ。",
          "point": 11
        }
      ]
    },
    {
      "subQNo": "設問3",
      "text": "[セキュリティインシデントの再発防止]について, (1)~(4)に答えよ。\n(1) 図5中の下線③について、パスフレーズを設定する目的を30字以内で具体的に述べよ。\n(2) 図5中の [ d ] に入れる適切な字句を10字以内で答えよ。\n(3) 本文中の [ e ] に入れる適切な字句を5字以内で答えよ。\n(4) 本文中の [ f ] に入れる適切な字句を20字以内で答えよ。",
      "explanation": "### 設問3の解説\n#### (1) 下線③の目的について\n下線③は、公開鍵認証に用いる鍵ペアの「秘密鍵」にパスフレーズを設定することです。パスフレーズは、秘密鍵ファイル自体を暗号化するためのものです。これにより、秘密鍵が不正に取得された場合でも、パスフレーズを知らない第三者による不正な認証や利用を防ぐことができます。\n\n**解答:** 秘密鍵が盗まれた場合などに、第三者による不正使用を防ぐため。\n\n#### (2) [ d ] について\nSSH認証方式を従来のパスワード認証から公開鍵認証へ強化するため、公開鍵認証を有効化すると同時に、従来の認証方式であるパスワード認証を無効化する必要があります。\n\n**解答:** パスワード認証\n\n#### (3) [ e ] について\nS氏の提言は、SSH Agent Forwarding機能を利用して、保守用中継サーバ（踏み台）が侵害された場合でも、顧客管理サーバへの接続に必要な認証情報が漏洩しないように、中継サーバに保存しないようにすることです。\n顧客管理サーバへのSSH接続に必要となる認証情報は、利用者に対応する「秘密鍵」です。\n\n**解答:** 秘密鍵\n\n#### (4) [ f ] について\n二つ目の提言は接続元の制限です。保守 PC-B/Cからのアクセスを、VPN経由でM社内ネットワークに接続させた後にインターネット経由で行うことで、アクセス元のIPアドレスを特定できるようにします。\n表1の項番4（送信元: インターネット）を制限するために必要な条件は、外部からのアクセスであっても、その発信元（M社側のゲートウェイ）のグローバルIPアドレスが特定できること、すなわち固定であることです。\n\n**解答:** アクセス元のグローバルIPアドレスを固定にできる",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "図5中の下線③について、パスフレーズを設定する目的を30字以内で具体的に述べよ。",
          "point": 11
        },
        {
          "label": "(2)",
          "text": "図5中の [ d ] に入れる適切な字句を10字以内で答えよ。",
          "point": 11
        },
        {
          "label": "(3)",
          "text": "本文中の [ e ] に入れる適切な字句を5字以内で答えよ。",
          "point": 11
        },
        {
          "label": "(4)",
          "text": "本文中の [ f ] に入れる適切な字句を20字以内で答えよ。",
          "point": 11
        }
      ]
    }
  ]
}