{
  "questions": [
    {
      "qNo": 1,
      "theme": "セキュリティ対策の評価に関する記述",
      "description": "R 団体はある科学技術分野のノウハウを有する、職員数 300 名の一般社団法人である。特殊な用途に用いる精密機器のプロトタイプ製作、民間企業や教育機関への技術情報の提供、安全基準の助言などを行っている。R 団体とステークホルダとの関係を図 1 に、ステークホルダの概要を表 1 に示す。\n\n```mermaid\ngraph TD\n    subgraph R_Group [R団体]\n        RD[R団体]\n    end\n    \n    Member[会員組織（民間企業、教育機関）] -- 情報提供 / プロトタイプ貸出 --> RD\n    RD -- プロトタイプ納品 --> Member\n    \n    Council[審議会（民間企業、教育機関の代表者）] -- 要件協議 --> RD\n    \n    Partner[製作パートナ（民間企業）] -- プロトタイプ発注 --> RD\n    RD -- 製作依頼 --> Partner\n```\n\n### 表 1 ステークホルダの概要\n| 名称 | 概要 |\n| :--- | :--- |\n| 会員組織 | R 団体に入会を申請し、R 団体が入会を認めた組織。会員組織は、自組織の活動を有利に進めるために、R 団体が提供する情報や貸し出すプロトタイプを活用する。 |\n| 審議会 | 一部の会員組織の代表者で構成される会議体。R 団体に製作を要請するプロトタイプの要件を取りまとめる。R 団体が要求仕様書や図面を作成するに当たって、R 団体と打合せを行う。打合せは不定期に R 団体の会議室で行われ、議事録などは主に電子メール（以下、メールという）で共有される。 |\n| 製作パートナ | 要求仕様書と図面を基に、プロトタイプを製作する業者。原則として、プロトタイプごとに公募され、入札で選ばれる。R 団体と製作パートナとの契約後の情報のやり取りは、R 団体が運用するポータルサイト（以下、R ポータルという）で行う。 |\n\nR 団体の各部署の業務内容を表 2 に示す。\n\n### 表 2 各部署の業務内容（抜粋）\n| 部署名 | 業務名 | 業務内容 |\n| :--- | :--- | :--- |\n| システム企画課 | システム企画 | R 団体の情報システムの要件をまとめ、設計や構築を開発業者に依頼する。 |\n| システム企画課 | セキュリティ管理 | R 団体全体のセキュリティ維持に責任をもち、情報システムのセキュリティの見直しを行う。 |\n| システム運用課 | R ポータルのサーバ管理 | システム運用課員が運用管理に利用する PC（以下、運用管理 PC という）から SSH で Web アプリケーションサーバ（以下、WebAP サーバという）やデータベースサーバ（以下、DB サーバという）にアクセスし、設定情報変更などを行う。 |\n| 設計第 1 課 | プロトタイプ製作 | 審議会と打合せを行い、要求仕様書や図面を作成する。製作パートナと情報共有する場合、PC で作成した図面などのファイルを、R ポータルの Web インタフェースを用いて、アップロードする。 |\n| 人事総務課 | 人事サーバ管理 | サーバセグメントに設置されている人事サーバのデータを更新する。 |\n\n### R 団体のネットワーク構成\nR 団体では、一般業務用の PC が職員に 1 台ずつ貸与されており、Web 閲覧、メール送受信、図面作成などに利用されている。各 PC には固定 IP アドレスが割り当てられている。PC にログインする際には各職員の利用者 ID を入力する。R 団体のネットワーク構成を図 2 に示す。\n\n```mermaid\ngraph TD\n    Internet((インターネット)) --- FW[FW]\n    FW --- L3SW[L3SW]\n    \n    subgraph DataCenter [データセンタ]\n        L3SW --- L2SW_DMZ[L2SW]\n        subgraph DMZ\n            L2SW_DMZ --- R_Portal[Rポータル]\n            R_Portal --- WebAP[WebAPサーバ]\n            WebAP --- DB[DBサーバ]\n            L2SW_DMZ --- Proxy[プロキシサーバ]\n            L2SW_DMZ --- DNS_Auth[権威DNSサーバ]\n            L2SW_DMZ --- Mail_Ext[外部メールサーバ]\n            L2SW_DMZ --- SSL_Acc[SSLアクセラレータ]\n        end\n    end\n    \n    subgraph R_Office [R団体]\n        L3SW --- L2SW_SRV[L2SW]\n        subgraph Server_Segment [サーバセグメント]\n            L2SW_SRV --- HR_Srv[人事サーバ]\n            L2SW_SRV --- Step_Srv[踏み台サーバ]\n            L2SW_SRV --- Mail_Int[内部メールサーバ]\n            L2SW_SRV --- DNS_Cache[キャッシュDNSサーバ]\n        end\n        \n        L3SW --- L2SW_USR[L2SW]\n        subgraph User_Segment [利用者セグメント]\n            L2SW_USR --- PC[PC]\n            L2SW_USR --- Admin_PC[運用管理PC]\n        end\n    end\n\n    style DMZ fill:#f9f,stroke:#333,stroke-width:2px\n    style Server_Segment fill:#ccf,stroke:#333,stroke-width:2px\n    style User_Segment fill:#cfc,stroke:#333,stroke-width:2px\n```\n\n### R ポータルの構成とアクセス制御\nR ポータルは、利用者の認証機能、利用者ごとに権限を定義できるアクセス制御機能、ファイルをアップロード及びダウンロードできる文書共有機能、問合せ内容や回答の履歴を記録する掲示板機能を備えている。R ポータルの利用者 ID は、職員、会員組織、及び製作パートナに発行される。\nまた、R ポータルは、フロントエンドの WebAP サーバと、会員組織情報、要求仕様書や図面が保存されるバックエンドの DB サーバで構成され、WebAP サーバと DB サーバは ODBC を用いて特定のポート間で通信している。R 団体のセキュリティ対策基準にのっとり、DB サーバには、システム運用課員によるログインと、WebAP サーバからの接続だけが許可されている。利用者セグメントから DB サーバへのアクセスは、FW によって運用管理 PC の IP アドレスからのアクセスだけが許可されている。\n\n### 踏み台サーバの利用\nサーバセグメント内のサーバでは、表 3 のアクセスだけを許可している。\n\n### 表 3 サーバへのアクセス許可\n| 項番 | アクセス元 | アクセス先 | アクセス制御方法 | サービス |\n| :--- | :--- | :--- | :--- | :--- |\n| 1 | 人事総務課の一部職員の PC | 踏み台サーバ | 管理 ID とパスワードによる認証 | リモートデスクトップ |\n| 2 | 運用管理 PC | 踏み台サーバ | 管理 ID とパスワードによる認証 | リモートデスクトップ |\n| 3 | 踏み台サーバ | サーバセグメントの全てのサーバ | サーバの共通管理者アカウントによる認証 | リモートデスクトップを含むメンテナンス用のサービス |\n| 4 | 利用者セグメントの全ての PC | サーバセグメントの全てのサーバ | IP アドレスによるフィルタリング、又は職員の利用者 ID とパスワードによる認証 | 職員に許可されている必要最小限のサービス |\n\nFW のフィルタリングルールを表 4 に示す。\n\n### 表 4 FW のフィルタリングルール\n| 項番 | 送信元 | 宛先 | サービス | 動作 |\n| :--- | :--- | :--- | :--- | :--- |\n| 1 | インターネット | SSL アクセラレータ | HTTP over TLS | 許可 |\n| 2 | インターネット | 外部メールサーバ | SMTP | 許可 |\n| 3 | インターネット | 権威 DNS サーバ | DNS | 許可 |\n| 4 | プロキシサーバ | インターネット | HTTP, HTTP over TLS | 許可 |\n| 5 | 外部メールサーバ | インターネット | SMTP | 許可 |\n| 6 | 外部メールサーバ | 内部メールサーバ | SMTP | 許可 |\n| 7 | 権威 DNS サーバ | インターネット | DNS | 許可 |\n| 8 | 運用管理 PC | WebAP サーバ | SSH | 許可 |\n| 9 | 運用管理 PC | DB サーバ | SSH | 許可 |\n| 10 | 運用管理 PC | プロキシサーバ | SSH | 許可 |\n| 11 | 運用管理 PC | 権威 DNS サーバ | SSH | 許可 |\n| 12 | 運用管理 PC | 外部メールサーバ | SSH | 許可 |\n| 13 | 利用者セグメント | プロキシサーバ | HTTP, HTTP over TLS | 許可 |\n| :--- | :--- | :--- | :--- | :--- |\n| 30 | 全て | 全て | 全て | 拒否 |\n\n### セキュリティ対策の評価\nコンサルタントによる評価の結果、以下の検出事項が報告された（図 3）。\n\n### 図 3 評価結果の詳細（抜粋）\n- 検出事項 1: R ポータルの脆弱性検査を実施したところ、クロスサイトスクリプティング（XSS）脆弱性が存在する。\n- 検出事項 2: 踏み台サーバを除く全てのサーバの管理者用アカウントに、共通管理者アカウントが使用されている。\n- 検出事項 3: DB サーバは、利用者セグメントからのアクセスを運用管理 PC からだけに限定している点は良いが、DMZ に設置されている点が課題である。DB サーバは、DMZ よりも安全性の高いセグメントに設置することが望まれる。\n- 検出事項 4: 製作パートナに貸与する図面の機密性の担保が、包括的な基本契約の中の守秘義務条項だけであり、製作パートナが実施すべきセキュリティ対策の具体的内容が定められていない。\n\n検出された XSS 脆弱性の詳細は図 4 の通りである。\n\n### 図 4 2 件の XSS 脆弱性\n- 脆弱性 1: 図面を検索するページ（検索ページ）に反射型 XSS が存在する。\n- 脆弱性 2: 検索ページで使用されるスクリプトに DOM-based XSS が存在する。攻撃者が \"#\" から始まるフラグメント識別子に攻撃コードを記述できる。",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "検出事項 1 について、(1)〜(3)に答えよ。",
          "explanation": "### (1) 検知できない理由の解説\n脆弱性検査ツール（スキャナ）は通常、リクエストを送信し、その**レスポンスの HTML 内容**を解析して脆弱性を判断します。\nしかし、DOM-based XSS の場合、攻撃コードが含まれる「フラグメント識別子（`#` 以降）」はブラウザ側で処理され、**サーバには送信されません**。したがって、サーバからのレスポンスには攻撃コードが含まれず、単純なレスポンス解析ツールでは検知できないのです。\n\n### (2) 攻撃者の分析方法の解説\nDOM-based XSS は、JavaScript が URL の一部（フラグメントなど）を読み取り、適切にエスケープせずに DOM (Document Object Model) に出力することで発生します。\n攻撃者は、検索ページで使用されている JavaScript ソースコードを読み、どのパラメータがどのように動的にページへ反映されるかを調査することで、脆弱性を分析します。\n\n### (3) 実装方法の解説\nセッション管理を Cookie で行っている場合、JavaScript から `document.cookie` を介してセッション ID が盗まれるリスクがあります。これを防ぐのが `HttpOnly` 属性です。この属性が付与されていると、ブラウザ上のスクリプトからは Cookie にアクセスできなくなり、XSS があってもセッション奪取を阻止できます。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線①について、サーバからのレスポンスの内容を見て脆弱性を判断するツールを用いた場合、脆弱性 2 を検知できないのはなぜか。その理由を 35 字以内で具体的に述べよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線②について、脆弱性の原理を踏まえ、攻撃者が分析する方法を 40 字以内で述べよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線③について、R ポータルがどのような実装方法を用いている場合に動作に影響があるか。45 字以内で述べよ。"
            }
          ]
        },
        {
          "subQNo": "設問2",
          "text": "本文中の下線④について、サーバセグメント内のサーバで共通管理者アカウントを用いる R 団体では、どのような機能を使ってどのような証跡を取得しているか。本文中の字句を用いて、70 字以内で具体的に述べよ。",
          "explanation": "踏み台サーバの役割とログ記録について問われています。本文 5 ページに「踏み台サーバには操作記録機能があり、ログインした利用者のデスクトップ画面が数秒間隔で画像データとして記録され、実行したコマンドやキーボード入力がテキストで記録される」とあります。\n共通管理者アカウント（Administrator や root など）を使うと「誰が」操作したかサーバ側のログだけでは判別できませんが、踏み台サーバの操作記録を併せて見ることで、ログインした「利用者 ID」と紐付けた証跡を得ることができます。"
        },
        {
          "subQNo": "設問3",
          "text": "検出事項 3 について、(1)〜(3)に答えよ。",
          "explanation": "DB サーバを DMZ からサーバセグメント（より安全な内部）に移動させる「案 2」に関する問題です。\n\n- (1) 案 2 では、WebAP から DB へのアクセスを許可する必要があります。WebAP サーバの IP は DMZ 内、DB サーバの宛先 IP は新セグメント内のものになります。サービスは ODBC 通信（本文 4 ページ）に対応するもの（具体的には SQL 通信等ですが、表 4 に習うならポートやプロトコル指定）が必要です。\n- (2) セキュリティ対策基準違反の懸念：本文 4 ページに「DB サーバには、運用管理 PC からのアクセスだけが許可されている」とありますが、案 2 でサーバセグメント全体へのアクセスを許可する（表 3 の項番 4 のようなルール）を設定してしまうと、基準に反する可能性があります。\n- (3) 検出事項 2（共通アカウント）への対策を併せて行う必要があります。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "表 5 中の [ a ] 〜 [ c ] に入れる適切な字句を答えよ。また、表 4 のルールのうち不要となるものを項番で答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線⑤について、誰がどのようなアクセス経路で何を行うと、セキュリティ対策基準違反になるか。違反になる行為を本文の内容を基に、55 字以内で具体的に述べよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の [ d ] に入れる、適切な検出事項の番号を答えよ。"
            }
          ]
        },
        {
          "subQNo": "設問4",
          "text": "検出事項 4 について、(1)〜(3)に答えよ。",
          "explanation": "図面の流出を技術的に防ぐ「DRM 方式」と「コンテナ方式」の比較です。\n\n- (1) コンテナ方式は PC 自体を隔離するため、製作パートナの PC 環境（OS や他の常駐ソフト等）との競合が起きます。そのため「動作環境（OS バージョン等）」を確認する必要があります。\n- (2) 不正行為の手口：コンテナ方式では外部との通信が遮断されますが、唯一の出口である「コンテナサーバ」の共有フォルダへ、外部公開を意図した操作（公開用フォルダへの移動など）を行うことが考えられます。\n- (3) DRM 方式は WebAP サーバを通じた配信になるため、FW で特定の宛先（DRM サーバ等）への通信のみを許可することで制御が可能です。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ e ] に入れる、製作パートナに確認する必要がある事項を 20 字以内で具体的に述べよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の [ f ] に入れる、コンテナ方式における不正行為の手口を 30 字以内で述べよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の [ g ] に入れる、適切な技術的対策を、45 字以内で述べよ。"
            }
          ]
        }
      ],
      "point": 50
    },
    {
      "qNo": 2,
      "theme": "Web サイトのセキュリティに関する記述",
      "description": "A 社は、従業員数 1,200 名のマスメディア関連会社である。A 社では、提供するサービスごとに Web サイトを用意し、インターネット上に公開している。\n\n### 現状のセキュリティ施策\nA 社では、Web セキュリティガイドを整備している（図 1）。\n\n### 図 1 Web セキュリティガイド第 1 版（抜粋）\n- 工程 3. 実装\n    - Web アプリの実装時に、クロスサイトスクリプティング（XSS）、SQL インジェクションへの対策をすること\n- 工程 4. テスト\n    - リリース前に Web アプリの脆弱性診断を実施すること\n\n### Web サイトの運用について\nWeb サイト X とシステム構成が全く同じ Web サイト Y を、別のデータセンタ Y に災害対策用として設置している。Web サイト X 稼働時には Web サイト Y はインターネットに公開しておらず、ホットスタンバイの状態で運用している。システム構成を図 2 に示す。\n\n```mermaid\ngraph TD\n    Internet((インターネット)) --- FW1[FW]\n    \n    subgraph DataCenter_X [データセンタX]\n        FW1 --- L2SW1[L2SW]\n        subgraph DMZ_X [DMZ]\n            L2SW1 --- Web_Srv_X[WebサーバX]\n            L2SW1 --- Mail_Srv_X[外部メールサーバ]\n            L2SW1 --- DNS_Srv_X[DNSサーバ]\n        end\n        L2SW1 --- L2SW_DB[L2SW]\n        subgraph DB_Net [DBネットワーク]\n            L2SW_DB --- DB_Srv_X[DBサーバX]\n        end\n    end\n\n    subgraph B_Office [B社本社]\n        PC_LAN[B社PC-LAN] --- FW2[FW]\n        FW2 --- L2SW2[L2SW]\n        L2SW2 --- Admin_PC[PC]\n    end\n\n    Internet --- FW2\n```\n\n### セキュリティインシデントの発生\nある日、Web サイト X のダウンロードページでファイルへのリンクが外部の URL に改ざんされていた。調査の結果、Web アプリフレームワーク WF-K の既知の脆弱性 K を悪用されたことが判明した。\n\n### 診断体制の整備\nA 社では、外部業者に頼らずに自社で診断できる体制を作ることにした。H 課長は Q さんと共に A 社診断項目を図 4 のとおり定めた。\n\n### 図 4 A 社診断項目\n- XSS\n- SQL インジェクション\n- OS コマンドインジェクション\n- [ c ] トラバーサル\n- [ d ] リクエストフォージェリ\n- セッション管理の不備\n- アクセス制御の不備や認可制御の欠落\n- [ e ] ヘッダインジェクション\n- メールヘッダインジェクション\n- クリック [ f ]",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔セキュリティ専門業者による調査〕について、(1)〜(3)に答えよ。",
          "explanation": "### (1) 調査手法の解説\n下線①はアクセスログに残らない攻撃について言及しています。Web サーバ上のファイルが改ざんされている可能性があるため、全ての静的ファイルやスクリプトのハッシュ値を計算して、元々の正しい状態と比較する（または `diff` を取る）ことで、ログに残らない改ざんを検知できます。\n\n### (2) 脆弱性 K の解説\nWF-K の脆弱性は「特定の文字列を含む HTTP リクエストを送信すると、任意のファイルの読出しと書込みができる」ものです。したがって、Web サーバ上のファイルが期待通りの内容であるか（改ざんされていないか）を「完全性」の観点で確認する必要があります。\n\n### (3) SSH 認証方式の解説\n「SSH サービスは B 社 PC-LAN からだけアクセスできるように設定している」という記述がありますが、パスワード認証では辞書攻撃に弱いため、秘密鍵と公開鍵を用いた「公開鍵認証方式（または証明書認証方式）」を設定すべきです。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "表 1 中の下線①について、アクセスログに残らないのは、どのような攻撃の場合か。35 字以内で述べよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の [ a ] に入れる適切な確認方法を、表 1 の結果を考慮し、20 字以内で具体的に述べよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線②について、設定すべき認証方式の名称を、10 字以内で答えよ。"
            }
          ]
        },
        {
          "subQNo": "設問2",
          "text": "本文中の [ b ] に入れる適切な報告内容を、50 字以内で具体的に述べよ。",
          "explanation": "18 ページの文脈より、各 Web サイトの担当者に「脆弱性への対応状況」を報告させることで、全社的なリスク管理を把握できるようにします。具体的には「脆弱性の有無、およびパッチ適用などの対策状況」を報告させます。"
        },
        {
          "subQNo": "設問3",
          "text": "図 4 中の [ c ]、本文中、図 4 中、図 5 中、表 3 及び図 10 中の [ d ]、図 4 中の [ e ]、図 4 中の [ f ] に入れる適切な字句を、それぞれ 10 字以内で答えよ。",
          "explanation": "Web セキュリティの標準的な脆弱性名を入れる穴埋め問題です。\n- c: パス (ディレクトリ)\n- d: クロスサイト (CSRF のこと)\n- e: HTTP (HTTP ヘッダインジェクション)\n- f: ジャッキング (クリックジャッキング)"
        },
        {
          "subQNo": "設問4",
          "text": "〔Web サイト Z に対する診断の実施〕について、(1)〜(4)に答えよ。",
          "explanation": "### (1) SQL インジェクションの判定\n表 4 の自動診断ツール J の結果を見ると、項番 1（`'='1`）と 2（`'='2`）で「該当商品数」が異なります。通常 bag で 30 件なら、`'='1` (常に真) の場合は全件（100 件、本文注記参照）が表示されるはずです。g は「100」、h は「0」（`'='2` は常に偽のため）が適切です。\n\n### (2) XSS の攻撃コード\n図 8/9 より、親ウィンドウの DOM にアクセスするスクリプトです。`alert('NG')` を実行させるコードとして適切なものを選びます。カレンダ機能（子画面）から親画面の `input` に値をセットする挙動を悪用するため、適切なクォータ処理が必要です。正解は「ア」です。\n\n### (3) アクセス制御の欠落\n表 5 の項番 2「商品一覧画面で [ j ]」。有料会員限定商品が一般会員でも買える脆弱性（イ）についてです。商品一覧画面で「限定商品の URL (またはコード) を直接入力」することで、本来表示されないはずの画面に遷移できることを確認します。\n\n### (4) CSRF の診断\nCSRF 対策（トークン）の有無を確認します。k には「[ d ] (クロスサイト) リクエストフォージェリ」、l には「トークンなどのパラメータの有無」などの確認事項が入ります。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "表 4 中の [ g ], [ h ] に入れる適切な数値を答えよ。"
            },
            {
              "label": "(2)",
              "text": "図 8 中及び図 9 中の [ i ] に入れる適切な文字列を解答群の中から選び、記号で答えよ。"
            },
            {
              "label": "(3)",
              "text": "表 5 中の [ j ] に入れる適切な操作内容を、表 2 中の画面遷移を指定して 40 字以内で述べよ。"
            },
            {
              "label": "(4)",
              "text": "図 10 中の [ k ] に入れる適切な字句を答えよ。また、図 10 中の [ l ] に入れる適切な字句を、表 5 の方法を踏まえて、20 字以内で具体的に述べよ。"
            }
          ]
        },
        {
          "subQNo": "設問5",
          "text": "本文中の下線③について、検収条件に追加すべき記載内容は何か。40 字以内で具体的に述べよ。",
          "explanation": "外部委託先が作成した Web アプリの品質を保証するため、「Web セキュリティガイドに準拠して開発され、脆弱性がないことを確認した診断結果報告書の提出」を条件とします。"
        },
        {
          "subQNo": "設問6",
          "text": "診断で見つかった個々の脆弱性は Web セキュリティガイドを改善するためにどのように利用できるか。40 字以内で述べよ。",
          "explanation": "見つかった脆弱性の「発生原因」を分析し、それを「工程 3. 実装」などの対策手法（具体的なコーディング規約など）としてフィードバックすることで、同様の脆弱性の再発を防止します。"
        }
      ],
      "point": 50
    }
  ]
}