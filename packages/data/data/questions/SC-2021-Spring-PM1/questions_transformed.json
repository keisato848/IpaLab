{
  "questions": [
    {
      "qNo": 1,
      "theme": "ID連携と認証（OAuth/OIDC）",
      "description": "入力データに大問の本文が提供されていません。設問内容から、SサービスとTサービスのID連携（OAuth/OIDC）に関する問題であると推定されます。",
      "context": {
        "title": "Sサービスの改修とID連携",
        "background": "\n\n※本設問は、図2（OAuthシーケンス）および図4（攻撃シーケンス）、並びに本文中の特定箇所（下線②、[β]、[γ]）を参照して解答する問題の一部です。元の問題文は提供されていません。\n\n【注記】元の問題文の本文（背景情報、下線③、下線④）は提供されていません。設問の構造化に必要な最小限のプレースホルダと引用記述を配置します。\n\n下線③: S サービスがTサービスに要求する権限が必要最小限のものになっていないこと。\n\n{{diagram:fig3}}\n\n下線④: [Tサービスの脆弱性報告により、ID連携が一時停止した際にサービス利用ができなくなったS会員を指す記述]\n\n本設問は、SサービスがTサービスと連携して利用者認証を行う仕組み（OAuthフロー）に関するものです。具体的な背景文、ネットワーク構成図、および本文中の下線⑤（認証連携に関する具体的な記述箇所）の情報は提供されていません。設問の解説文から、OAuthを利用し、Tサービスで認証されたアカウント名(T-ID)を取得・照合することでSサービスが利用者認証を実現していることが推測されます。",
        "diagrams": [
          {
            "id": "fig3",
            "label": "図3 TサービスがSサービスに提供する権限の選択肢",
            "type": "markdown",
            "content": "| ID | 権限内容 |\n|----|----------|\n| (ア) | 利用者のファイルシステムへの完全なアクセス権 |\n| (イ) | Tサービスの全ユーザーの情報の参照権限 |\n| (ウ) | Tサービス上で利用者に代わって投稿を行う権限 |\n| (エ) | 利用者のアカウント名、電子メールアドレスなど登録情報を取得する権限 |"
          },
          {
            "id": "fig2",
            "label": "図2 OAuthのフロー",
            "type": "image",
            "content": "図2の具体的な内容は提供されていませんが、解説文でOAuthのフローを参照しています。"
          }
        ]
      },
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔Sサービスの改修〕について、(1)~(4)に答えよ。",
          "references": [
            "line1",
            "fig2"
          ],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線①について, S社の課題に即した利点を 30 字以内で具体的に述べよ。",
              "answer": "Tサービスの多要素認証などの機能を利用できること。",
              "explanation": "### 解説\nS社の課題は、脆弱性診断で多要素認証が推奨されたものの、自社での対処が課題であった点です。Tサービスは多要素認証の機能を持っています。ID連携により、Sサービス自身が多要素認証を実装する手間なく、Tサービスが提供する高度な認証機能を利用できるようになります。\n\n**解答:** Tサービスの多要素認証などの機能を利用できること。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線①について、可用性の観点での欠点を30字以内で述べよ。",
              "answer": "Tサービスが停止した場合、Sサービスにログインできなくなること。",
              "explanation": "### 解説\nID連携は外部サービスであるTサービスに依存します。可用性の観点では、Tサービス側でシステム障害やサービス停止が発生した場合、Sサービスの認証機能が利用できなくなります。\n\n**解答:** Tサービスが停止した場合、Sサービスにログインできなくなること。"
            },
            {
              "label": "(3)",
              "text": "本文中の [ a ], [ c ] に入れる適切な字句を解答群の中から選び、記号で答えよ。\n解答群: ア Sサービス, イ Tサービス, ウ 利用者",
              "answer": "a: ア, c: ウ",
              "explanation": "### 解説\nOAuthの定義に基づき、リソースにアクセスできる主体 [ a ] はクライアントであるSサービス（ア）です。リソースにアクセスする権限をSサービスに与える主体 [ c ] はリソースオーナーである利用者（ウ）です。\n\n**解答:** a: ア, c: ウ"
            },
            {
              "label": "(4)",
              "text": "本文中の [ α ] に入れる適切な字句を、図2中の(あ)~(こ)から選び、記号で答えよ。",
              "answer": "(え)",
              "explanation": "### 解説\n「利用者はSサービスに与える権限を、図2中の [ α ] の通信の際に確認する」とあります。これは利用者がTサービス上で認証を済ませた後、Sサービスが要求しているスコープ（権限）に対して同意を与えるステップです。図2では「(え) 認証,権限付与の確認」がこれに該当します。\n\n**解答:** (え)"
            }
          ],
          "point": 25
        },
        {
          "subQNo": "設問2",
          "text": "〔一つ目の問題〕について、(1)~(3)に答えよ。",
          "references": [
            "fig2",
            "fig4"
          ],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図4中の [ d ], [ e ] に入れる適切な字句を解答群の中から選び、記号で答えよ。\n解答群: ア アクセストークンの要求, イ アクセストークン, ウ 認可コード, エ 認可の要求, オ 認証,権限付与の確認",
              "answer": "d: ウ, e: イ",
              "explanation": "### 解説\n図4はAuthorization Code GrantにおけるCSRF攻撃（認可コードの横取り）を示しています。\n\n1.  **[ d ]**: 認可サーバー（Tサービス）からリダイレクトで返され、攻撃者に渡ってしまう短い有効期限のトークンです。これは**認可コード**です (図2の(お), (か)に対応)。→ ウ\n2.  **[ e ]**: Sサービスが認可コード(d)と引き換えにTサービスから取得する、リソースアクセスに使用するトークンです。これは**アクセストークン**です (図2の(く)に対応)。→ イ\n\n**解答:** d: ウ, e: イ"
            },
            {
              "label": "(2)",
              "text": "本文中の下線②について、ファイルのアップロードと、ファイルのダウンロードは、それぞれTサービスの誰のアカウントによって行われるか。それぞれ6字以内で答えよ。",
              "answer": "アップロード: 利用者, ダウンロード: 利用者",
              "explanation": "### 解説\n下線②は「利用者が攻撃を受けているとは知らずにSサービスにファイルをアップロード」する操作です。これは**利用者**自身が行います。\n攻撃の目的は、アップロードされたファイルを攻撃者がダウンロードすることですが、攻撃者はシーケンスXによって利用者の権限を乗っ取っているため、Sサービスは当該操作を**利用者**アカウントの権限で行おうとします。\n\n**解答:** アップロード: 利用者, ダウンロード: 利用者"
            },
            {
              "label": "(3)",
              "text": "本文中の [ β ], [ γ ] に入れる適切な字句を、図2中の(あ)~(こ)から選び、記号で答えよ。",
              "answer": "β: (い), γ: (か)",
              "explanation": "### 解説\nstateパラメータはCSRF対策として、クライアント（Sサービス）が認可リクエストを開始する際に発行し、認可レスポンスを受け取る際に検証します。\n\n1.  **[ β ] (送信する際)**: Sサービスが認可サーバーTに認可を要求する際です。図2の **(い) 認可の要求** が該当します。\n2.  **[ γ ] (受信する際)**: 認可コードをリダイレクト経由で受け取る際です。図2の **(か) 認可コード** を受け取る際に、stateパラメータも併せて確認します。\n\n**解答:** β: (い), γ: (か)"
            }
          ],
          "point": 25
        },
        {
          "subQNo": "設問3",
          "text": "〔二つ目と三つ目の問題〕について、(1), (2)に答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線③について、必要最小限の権限を図3中の(ア)~(エ)から一つ選び、記号で答えよ。",
              "references": [
                "fig3"
              ],
              "answer": "(エ)",
              "explanation": "### 解説\n下線③は「S サービスがTサービスに要求する権限が必要最小限のものになっていないこと」です。SサービスがTサービスとのID連携を行う目的は、新規S会員の登録と認証です。この目的を達成するために必要な最小限の権限は、Tサービス側で利用者を一意に識別し、Sサービスに登録するための情報（アカウント名、メールアドレスなど）を取得する権限です。\nこれは **(エ) 利用者のアカウント名、電子メールアドレスなど登録情報を取得する権限** に該当します。\n\n**解答:** (エ)"
            },
            {
              "label": "(2)",
              "text": "本文中の下線④に該当するS会員を、35字以内で述べよ。",
              "answer": "TサービスとのID連携でのみ登録した新規登録のS会員",
              "explanation": "### 解説\nTサービスに脆弱性が報告された際、S社はID連携を一時的に停止し、S認証モジュールのみを稼働させました。S認証モジュールは**既存のS会員**のために継続稼働させているものであり、ID連携でのみ登録した新規S会員はS認証モジュールによる認証情報を持っていません。したがって、利用できなくなるのは、ID連携でのみ登録した会員です。\n\n**解答:** TサービスとのID連携でのみ登録した新規登録のS会員"
            }
          ],
          "point": 25
        },
        {
          "subQNo": "設問4",
          "text": "本文中の下線⑤について、Sサービスは、Tサービスと連携して、どのように利用者認証を実現しているか。実現の方法を50字以内で具体的に述べよ。",
          "references": [
            "fig2"
          ],
          "answer": "Tサービスで認証された利用者のアカウント名(T-ID)を取得し、Sサービス内に登録済みのT-IDと照合することで認証を実現している。",
          "explanation": "### 解説\nSサービスは利用者自身を直接認証していません。OAuthのフロー（図2）を利用し、Tサービス側で認証が行われた結果として得られる利用者のアカウント情報（T-ID）を利用して、Sサービス内の登録情報と紐づけています。\n\n図2の注記にある通り、Sサービスは初回利用時にTサービスから取得したアカウント名(T-ID)をSサービス内に登録し、2回目以降は、TサービスからT-IDを取得し、初回登録されたT-IDと照合することで利用者認証を実現しています。\n\n**解答:** Tサービスで認証された利用者のアカウント名(T-ID)を取得し、Sサービス内に登録済みのT-IDと照合することで認証を実現している。",
          "point": 25
        }
      ]
    }
  ]
}