[
  {
    "qNo": 1,
    "theme": "IoT システムのセキュリティ対策",
    "description": "### Z システムの概要\nZ 社は，従業員数 100 名のファブレス企業であり，ネットワークカメラを使ったクラウド型ビデオ監視システム（以下，Z システムという）を開発し，個人及び小規模事業者向けに提供している。Z システムの概要を図 1 に示す。\n\n```mermaid\ngraph TD\n    subgraph Z_Cloud [Z クラウド]\n        Storage[大容量ストレージ]\n        Storage --- Video[動画]\n        WebApps[Web アプリケーションサーバ]\n        DB_Srv[DB サーバ]\n        DB_Srv --- DB[(DB)]\n        WebApps --- DB_Srv\n        FW1[FW]\n        Web_Srv[Web サーバ]\n        FW1 --- Web_Srv\n    end\n\n    Internet((インターネット)) --- Web_Srv\n    Internet --- FW1\n    \n    subgraph Mobile [モバイル端末]\n        Browser[Web ブラウザ]\n        App[Z アプリ]\n    end\n    \n    Internet --- Browser\n    Internet --- App\n    \n    subgraph Local [利用者宅など]\n        AP[無線 LAN アクセスポイント]\n        Camera[Z カメラ]\n        Camera --- AP\n        AP --- Internet\n        App -.->|Bluetooth| Camera\n    end\n\n    %% Legend\n    %% DB: データベース, FW: ファイアウォール\n    %% Z クラウド: Z カメラを利用するためのクラウドサービス\n    %% Z アプリ: 設定・操作用モバイルアプリ\n```\n\n### Z カメラの詳細\n- 組込み OS である L-OS を使用し，無線 LAN を通じて Z クラウドに接続される。\n- 全ての操作は Z アプリから Z クラウド経由で行われる。物理的な操作インタフェース（HDMI, USB 等）はない。\n- 撮影した動画は Z クラウドの大容量ストレージに転送され，カメラ内のバッファは速やかに消去される。\n\n### IoT 機器のマルウェア感染\nセキュリティ研究者 X 氏から，Z カメラに脆弱性がありマルウェア M に感染するリスクがあるとの連絡があった。マルウェア M の感染の仕組みを図 2 に示す。\n\n```mermaid\ngraph LR\n    CC[C&Cサーバ] -- 1 --> MalM[マルウェアMに感染したIoT機器]\n    MalM -- 2,3 --> Target[脆弱性をもったIoT機器]\n    Target -- 4 --> SrvP[サーバP]\n    SrvP -- 5 --> SrvR[サーバR]\n    SrvR -- 6 --> Target\n    Target -- 7 --> NewMal[マルウェアMに感染]\n```\n\n| 項番 | 動作の概要 |\n| :--- | :--- |\n| 1 | HTTP を用いて C&C サーバと通信し，ボットとして活動する。 |\n| 2 | ランダムに IP アドレスを選び，TCP 23, 2323, 22, 6789 への接続を要求する。 |\n| 3 | TELNET 又は SSH 接続に成功した場合，工場出荷時の ID とパスワードのリストを用いてログインを試行する。 |\n| 4 | ログイン成功時，接続先情報（IP, ポート, ID, PW）をサーバ P に送信する。 |\n| 5 | サーバ P は受信情報をサーバ R に送信する。 |\n| 6 | サーバ R は情報に基づき対象機器にログインし，wget 又は tftp でマルウェア M をダウンロード，実行させる。 |\n\n### セキュリティ検査と対策\nB 主任は，D 社にセキュリティ検査を依頼した。検査結果を表 3 に示す。\n\n| 項番 | 検査項目 | 検査内容 | 検査結果 |\n| :--- | :--- | :--- | :--- |\n| 1 | [ a ] | 1〜65535 の TCP ポートに SYN を送信し，応答を確認する。 | TCP ポート 2323 が開いていた。 |\n| 2 | プロトコル確認 | 開いているポートに対し，様々なプロトコルで接続を試みる。 | TELNET で接続できた。 |\n| 3 | ログイン試行 | 項番 2 で確認したプロトコルで，マルウェア M が使用するリストを用いてログインを試みる。 | 最終的にログインできた。 |\n| 4 | ダウンロード | ログイン後に wget, tftp を用いて外部からファイルがダウンロードできるか確認する。 | wgat コマンドでダウンロードできた。 |\n| 5 | プロセス起動 | 項番 4 でダウンロードしたファイルが起動できるか確認する。 | 起動できた。 |\n| 6 | (省略) | 項番 5 で起動したプロセスが，[ b ] できるか確認する。 | (省略) |\n",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "[Z カメラのセキュリティ検査と対策] について，(1)～(4)に答えよ。",
        "explanation": "IoT機器のセキュリティの基本であるポートスキャンと、不要なサービスの停止に関する問題です。\n\n### 検査プロセスの論理\n```mermaid\ngraph TD\n    A[全ポートスキャン] --> B{応答あり?}\n    B -- Yes --> C[プロトコル特定: TELNET等]\n    C --> D[辞書攻撃: 初期パスワード試行]\n    D -- 成功 --> E[外部コマンド実行: wget等]\n    E --> F[マルウェア実行確認]\n```",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "表 3 中の [ a ] に入れる検査項目の名称を答えよ。"
          },
          {
            "label": "(2)",
            "text": "表 3 中の下線①(応答結果)について，ポートが開いている場合と閉じている場合に期待される応答結果を，解答群の中から全て選び，記号で答えよ。 (ア: ACK受信, イ: FIN ACK受信, ウ: FIN受信, エ: RST ACK受信, オ: RST受信, カ: SYN ACK受信, キ: SYN受信, ク: 応答なし)"
          },
          {
            "label": "(3)",
            "text": "表 3 中の [ b ] に入れるプロセスの動作を，30 字以内で具体的に述べよ。"
          },
          {
            "label": "(4)",
            "text": "本文中の下線②(対策)について，出荷済みの Z カメラに対する対策を，60 字以内で具体的に述べよ。"
          }
        ]
      },
      {
        "subQNo": "設問2",
        "text": "[カメラ IF 通信に対する脅威] について，(1)～(3)に答えよ。",
        "explanation": "通信経路における中間者攻撃(MITM)とその防御策としての証明書検証に関する問題です。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "表 4 中の [ c ], [ d ] に入れる攻撃手法を解答群の中から選び，記号で答えよ。 (ア: DNSキャッシュポイズニング攻撃, イ: サービス不能攻撃, ウ: サイドチャネル攻撃, エ: 辞書攻撃, オ: セッション固定攻撃, カ: 中間者攻撃, キ: 水飲み場型攻撃, ク: リフレクション攻撃)"
          },
          {
            "label": "(2)",
            "text": "本文中の [ e ] に入れる適切な字句を英字で答えよ。"
          },
          {
            "label": "(3)",
            "text": "本文中の下線③(プライベート認証局のルート証明書を信頼されたものとして登録しない理由)について，30 字以内で述べよ。"
          }
        ]
      },
      {
        "subQNo": "設問3",
        "text": "[Z クラウドに対する脅威] について，(1)～(10)に答えよ。",
        "explanation": "クラウド側でのなりすまし対策や、ブルートフォース攻撃への防御策、内部不正対策としての暗号化設計を問う内容です。\n\n### リバースブルートフォース攻撃の概念\n```mermaid\ngraph LR\n    Attacker[攻撃者] -->|固定パスワード| User1[利用者A]\n    Attacker -->|固定パスワード| User2[利用者B]\n    Attacker -->|固定パスワード| User3[利用者C]\n    Note over Attacker: 1つのパスワードで<br/>複数のIDを試行する\n```",
        "subQuestions": [
          { "label": "(1)", "text": "表 5 中の下線④について，アクセス元の端末を制限する方法として Z システムに適した方法を，25 字以内で具体的に述べよ。" },
          { "label": "(2)", "text": "本文中の [ f ] に該当する全ての脅威を，表 5 中の整理番号で答えよ。" },
          { "label": "(3)", "text": "リバースブルートフォース攻撃の攻撃手法を，40 字以内で述べよ。" },
          { "label": "(4)", "text": "本文中の下線⑤について，ログイン制限では防ぐのが難しい理由を，40 字以内で述べよ。" },
          { "label": "(5)", "text": "本文中の下線⑥について，防げないのはどのような場合か。50 字以内で具体的に述べよ。" },
          { "label": "(6)", "text": "本文中の下線⑦について，Z カメラが譲渡や転売される可能性を考慮に入れて，追加認証する適切な方法を，25 字以内で述べよ。" },
          { "label": "(7)", "text": "本文中の下線⑧について，平常時と異なる状況だと判断されるのはどのような場合か。40 字以内で述べよ。" },
          { "label": "(8)", "text": "本文中の下線⑨について，委託契約に盛り込むべき条項を，25 字以内で具体的に述べよ。" },
          { "label": "(9)", "text": "本文中の下線⑩について，構成管理を導入していない場合の問題点を，40 字以内で述べよ。" },
          { "label": "(10)", "text": "本文中の下線⑪について，内部者への対策として共通鍵暗号方式による暗号化を検討する。図 1 の構成要素を選び，共通鍵の安全な共有方法を 25 字以内で述べよ。" }
        ]
      }
    ]
  },
  {
    "qNo": 2,
    "theme": "データ暗号化の設計",
    "description": "### K1 システムの概要\nX 社は，生命保険会社であり，契約情報を管理する K1 システムを運用している。K1 システムは X 社データセンタに設置されており，DB サーバ，Web アプリサーバ，LDAP サーバ，認証サーバ等で構成される。\n\n```mermaid\ngraph TD\n    subgraph Local_Branch [X社本社、支店]\n        PC[社内PC / Webブラウザ]\n    end\n    \n    subgraph Network [広域イーサネット網]\n        Line --- PC\n    end\n    \n    subgraph DataCenter [X社データセンタ]\n        Auth[認証サーバ]\n        LDAP[LDAPサーバ]\n        WebApps[Webアプリケーションサーバ]\n        DB_Srv[DBサーバ]\n        Storage[共有ストレージ]\n        \n        Line --- Auth\n        Auth --- LDAP\n        Auth --- WebApps\n        WebApps --- DB_Srv\n        WebApps --- Storage\n        DB_Srv --- Storage\n    end\n```\n\n### K1 システムにおける課題と移行\nX 社は次期システム K2 への改修を計画している。システム開発ベンダ Y 社は K1 の暗号化設計に以下の問題を指摘した。\n- 指摘 1: 56bitDES が使われている。AES (256bit) に変更すべき。\n- 指摘 2: 暗号鍵が平文でファイルに保管されている。\n\n### 暗号方式の検討 (K2 システム)\nX 社は，FIPS 140-2 Level 4 の要件を満たす製品 H (HSM: Hardware Security Module) を採用することとした。製品 H は PCI Express カードであり，マスタ鍵の管理やデータ鍵の生成・暗号化を行う。\n\n### 初期化処理のシーケンス\n```mermaid\nsequenceDiagram\n    participant Manager as 管理者\n    participant ProdD as 製品D (DB)\n    participant HCl as Hクライアント\n    participant HSrv as Hサーバ\n    participant ProdH as 製品H (HSM)\n\n    Manager->>ProdD: DB作成コマンド\n    ProdD->>ProdD: 鍵生成()\n    ProdD->>HCl: データ鍵IDの採番\n    HCl->>HSrv: 鍵生成要求(API-X)\n    HSrv->>ProdH: 鍵生成\n    Note over ProdH: データ鍵生成・マスタ鍵で暗号化・保存\n    ProdH-->>HSrv: 応答\n    HSrv-->>HCl: 応答\n    HCl-->>ProdD: データ鍵ID\n    \n    Manager->>ProdD: 表領域作成コマンド\n    ProdD->>HCl: 乱数生成要求\n    HCl->>HSrv: 乱数生成要求\n    HSrv->>ProdH: 乱数生成\n    ProdH-->>HSrv: 乱数 (DBデータ鍵)\n    HSrv-->>HCl: 乱数\n    HCl-->>ProdD: 乱数\n    \n    ProdD->>HCl: 暗号化要求(DBデータ鍵, DBマスタ鍵ID)\n    HCl->>HSrv: 暗号化要求\n    HSrv->>ProdH: 暗号化処理\n    ProdH-->>HSrv: 暗号化されたDBデータ鍵\n    HSrv-->>HCl: 暗号化されたDBデータ鍵\n    HCl-->>ProdD: 暗号化されたDBデータ鍵\n```",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "[K1 システムにおける課題] について，(1)～(3)に答えよ。",
        "explanation": "DESの脆弱性と計算機能力の向上による解読リスクの評価、および鍵管理の不備に関する問題です。",
        "subQuestions": [
          { "label": "(1)", "text": "本文中の [ a ], [ b ] に入れる適切な字句を，それぞれ英字 4 字、英字 8 字で答えよ。" },
          { "label": "(2)", "text": "2017 年製の PC を利用した場合，56bitDES を 40 日間で解読するのに必要な PC は最低何台か。整数で答えよ。" },
          { "label": "(3)", "text": "指摘 2 の状況によって，誰が，どのような方法で契約情報を取得するリスクが発生するか。60 字以内で述べよ。" }
        ]
      },
      {
        "subQNo": "設問2",
        "text": "[暗号方式の検討] について，(1)～(5)に答えよ。",
        "explanation": "HSMの物理的セキュリティ特性（耐タンパ性）と、秘密分散法による管理体制の強化に関する設問です。",
        "subQuestions": [
          { "label": "(1)", "text": "本文中の [ c ] に入れる適切な英字 4 字を答えよ。" },
          { "label": "(2)", "text": "製品 H の仕様 1 (3つの部分鍵)の効果を，25 字以内で述べよ。" },
          { "label": "(3)", "text": "IC カードに記録される部分鍵は，何を実施した場合にどのような目的のために必要か。15 字以内で述べよ。" },
          { "label": "(4)", "text": "本文中の下線①(センサによるゼロ化)によって実現される暗号モジュールの性質を，7 字以内で答えよ。" },
          { "label": "(5)", "text": "製品 H を運搬する場合に静電気防止シートで覆わなかった場合に発生し得る不都合な事象を，40 字以内で述べよ。" }
        ]
      },
      {
        "subQNo": "設問3",
        "text": "[DB サーバ及び HSM サーバの構成設計] について，(1)，(2)に答えよ。",
        "explanation": "冗長化構成におけるHSMの排他制御や鍵情報の共有方法に関する実務的な問題です。",
        "subQuestions": [
          { "label": "(1)", "text": "DB作成手順中，HSMサーバ1と2の両方を稼働させていた場合にエラーとなる手順を答え，その原因を 35 字以内で具体的に述べよ。" },
          { "label": "(2)", "text": "H クライアント ID をデータ鍵 ID に付け加える機能がなかった場合，特定の条件において DB 作成がエラーになる条件を 40 字以内で述べよ。" }
        ]
      },
      {
        "subQNo": "設問4",
        "text": "[K2 システムにおけるリスク対策の補完] について，(1)，(2)に答えよ。",
        "explanation": "内部不正対策としてのログ監視と、物理的な情報の持ち出し（メモリダンプ）への対策を問う内容です。",
        "subQuestions": [
          { "label": "(1)", "text": "対策 1 は，誰がどのような方法で契約情報を取得するリスクに対する対策か。45 字以内で述べよ。" },
          { "label": "(2)", "text": "対策 2 は，誰がどのような方法で契約情報を取得するリスクに対する対策か。50 字以内で述べよ。" }
        ]
      }
    ]
  }
]