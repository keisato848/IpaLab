{
  "questions": [
    {
      "qNo": 1,
      "theme": "社内で発生したセキュリティインシデントに関する調査と対策",
      "description": "D社は、従業員数100名のシステム開発会社である。D社のネットワーク構成を図1に示す。\n\n### 図1 D社のネットワーク構成\n```mermaid\ngraph TD\n    Internet((インターネット)) --- FW[FW]\n\n    subgraph Server_Seg [サーバセグメント 192.168.1.0/24]\n        L2SW1[L2SW]\n        LDAP[LDAPサーバ] --- L2SW1\n        CRM[CRMサーバ] --- L2SW1\n    end\n\n    subgraph PC_Seg [PCセグメント 192.168.0.0/24]\n        L2SW2[L2SW]\n        PC[PC]\n        AdminPC[管理用PC]\n        PC --- L2SW2\n        AdminPC --- L2SW2\n    end\n\n    FW --- L2SW1\n    FW --- L2SW2\n\n    %% 注記等のテキスト表現\n    %% FW: ファイアウォール\n    %% L2SW: レイヤ2スイッチ\n    %% (イ) MAC: zz:zz:zz:bb:bb:01 / IP: 192.168.1.1\n    %% (ア) MAC: zz:zz:zz:bb:bb:02 / IP: 192.168.1.2 (CRMサーバ)\n    %% (オ) MAC: xx:xx:xx:aa:aa:01 / IP: 192.168.0.1 (FW)\n    %% (カ) MAC: xx:xx:xx:aa:aa:02 / IP: 192.168.0.2 (AdminPC)\n    %% (キ) MAC: xx:xx:xx:aa:aa:c8 / IP: 192.168.0.200 (PC)\n```\n\nD社のネットワークでは静的にIPアドレスが付与され、各セグメント間の通信はステートフルパケットインスペクション型のFWで制限されている。FWのフィルタリングルールを表1に示す。\n\n### 表1 FWのフィルタリングルール\n| 項番 | 送信元 | 宛先 | サービス | 動作 | ログの記録 |\n| :--- | :--- | :--- | :--- | :--- | :--- |\n| 1 | PCセグメント | インターネット | HTTP, HTTP over TLS | 許可 | する |\n| 2 | PCセグメント | LDAPサーバ | LDAP | 許可 | しない |\n| 3 | PCセグメント | CRMサーバ | HTTP over TLS | 許可 | する |\n| 4 | 管理用PC | サーバセグメント | SSH | 許可 | する |\n| 5 | PCセグメント | サーバセグメント | 全て | 拒否 | する |\n| ... | ... | ... | ... | ... | ... |\n| 20 | 全て | 全て | 全て | 拒否 | しない |\n\n[セキュリティインシデントの発生]\nある日、管理用PCからCRMサーバにログインしたことを示す通知がN部長に届いた。Y主任に確認したところ、その時間帯にはログインしていないとのことだった。Y主任がCRMサーバのSSH認証ログを確認すると、身に覚えのないログイン（以下、不審ログイン）の記録が残っていた。専門業者Z社のW氏が調査したところ、従業員AさんのPCがマルウェアに感染し、ARPポイズニングによって通信が盗聴されていたことが判明した。\n\n### 図3 W氏が推測したサーバへの不正侵入手順（抜粋）\n1. マルウェアに感染したAさんのPCを遠隔操作する。\n2. AさんのPC上でARPポイズニングを用いて、通信を盗聴する。\n3. AさんのPC上で通信を盗聴して、LDAPサーバのIPアドレスを特定する。\n4. AさんのPC上でLDAP通信を盗聴して、従業員の利用者IDとパスワードを収集する。\n5. AさんのPCからLDAPサーバ及びCRMサーバのSSHポートへのアクセスを試みるが、失敗する。\n6. AさんのPC上で通信を盗聴して、管理用PCのIPアドレスを特定する。\n7. AさんのPC上で通信を盗聴して、サーバ管理者であるY主任の利用者IDとパスワードを入手する。\n8. AさんのPC上で管理用PCのIPアドレスを詐称して、LDAPサーバ及びCRMサーバのSSHポートにアクセスし、Y主任のIDとパスワードでログインする。",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔サーバへの侵入手口の調査〕について、(1)〜(3)に答えよ。",
          "explanation": "ARPポイズニングとFWログの仕様に関する問題です。不審な通信が発生した際のARPテーブルの状態や、どの通信が盗聴可能だったかをネットワーク構成とフィルタリングルールから読み解く必要があります。\n\n### ARPポイズニングの仕組み\n```mermaid\ngraph LR\n    AdminPC[管理用PC\n192.168.0.2] -- 通常の経路 --> FW[FW\n192.168.0.1]\n    AdminPC -. 攻撃後の経路 .-> Attacker[AさんのPC\n攻撃者]\n    Attacker -.-> FW\n    Note over Attacker: ARPポイズニングにより\n各端末のARPテーブルを書き換える\n```",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "表3中の[ a ]及び表4中の[ b ], [ c ]に入れる適切な字句を、図1中の機器のMACアドレスから選び、(ア)〜(キ)の記号で答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の[ d ]に入れる適切なフィルタリングルールを、表1中の項番1〜5から選び、数字で答えよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線①について、攻撃者が管理用PCのIPアドレスを特定するために盗聴したのはどのような通信か。送信元、宛先及びサービスを、解答群の中から選び、記号で答えよ。"
            }
          ]
        },
        {
          "subQNo": "設問2",
          "text": "本文中の下線②について、このような設定にすることは、AさんのPCに侵入した攻撃者によって行われるどのような攻撃への対策になるか。攻撃名を10字以内で答えよ。また、攻撃に際して詐称する対象の機器名を図1中から選び、答えよ。",
          "explanation": "下線②は「サーバ証明書の検証に失敗した場合は接続しない設定」を指します。これは、攻撃者がサーバになりすまして通信を中継・改ざんする攻撃を阻止するためのものです。\n\n### 中間者攻撃のイメージ\n```mermaid\nsequenceDiagram\n    participant Client as AさんのPC\n    participant Attacker as 攻撃者(偽装)\n    participant Server as CRMサーバ\n    Client->>Attacker: SSL/TLS接続要求\n    Attacker->>Server: 接続要求を転送\n    Server-->>Attacker: 正規の証明書を送信\n    Attacker-->>Client: 自己署名等の偽証明書を送信\n    Note right of Client: ここで検証に失敗すれば切断すべき\n```"
        },
        {
          "subQNo": "設問3",
          "text": "〔セキュリティ対策の実施〕について、(1), (2)に答えよ。",
          "explanation": "ネットワーク構成の変更とFWルールの強化に関する問題です。セグメントを分離し、宛先制限を厳格にすることで、なりすましや不正アクセスを防御する設計を理解しましょう。\n\n### 変更後のネットワーク（図4）\n```mermaid\ngraph TD\n    Internet((インターネット)) --- FW[FW]\n    FW --- SegA[サーバセグメントA]\n    FW --- SegB[サーバ管理セグメントB]\n    FW --- SegC[PCセグメントC]\n    SegB --- AdminPC[管理用PC]\n    SegC --- PC[一般PC]\n```",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線③について、防ぐことができる理由を35字以内で具体的に述べよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線④について、TCPコネクション確立開始時のSYNパケットとSYN-ACKパケットはそれぞれどのような経路をたどるか。図4中の経路を通る順に選び、(A)〜(C)の記号で答えよ。"
            }
          ]
        }
      ],
      "point": 34
    },
    {
      "qNo": 2,
      "theme": "Webサイトのセキュリティ対策",
      "description": "E社は、会員制の飲食店情報提供サービス「サイトα」を運営している。サイトαでは、飲食店の検索、掲示板への投稿、会員情報変更などの機能を提供している。\n\n### 図1 サイトαの画面遷移図（抜粋）\n```mermaid\ngraph LR\n    Login[ログインページ] -- (あ) --> MyPage[マイページ]\n    MyPage --> Search[検索ページ]\n    MyPage --> Board[掲示板] --> BoardConfirm[掲示板投稿確認] --> BoardDone[掲示板投稿完了]\n    MyPage --> MemberMenu[会員メニュー]\n    MemberMenu --> EmailChange[メールアドレス変更] --> EmailConfirm --> EmailDone\n    MemberMenu --> PassChange[パスワード変更] -- (い) --> PassConfirm --> PassDone\n    MemberMenu --> ProfileChange[プロフィール入力・変更] -- (う) --> ProfileConfirm --> ProfileDone\n    MemberMenu --> Quit[退会処理] -- (え) --> QuitConfirm -- (お) --> QuitDone\n    Login -.-> PassReset[パスワード再設定]\n```\n\nある日、利用者L氏から「急にログアウトさせられ、その後ログインできなくなった。退会処理が完了していた」との問合せがあった。調査の結果、Webアプリケーションの脆弱性が悪用されたことが判明した。",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "本文中の下線①について、L氏のアカウントが不正ログインされていないとの結論に至るには、L氏に確認した内容から分かる何の値と、ログイン記録から分かる何のアドレスを抽出して、一致していることが確認できればよいか。それぞれ25字以内で述べよ。",
          "explanation": "不正ログインがないことを確認するには、本人の正規セッションと、記録された操作時のセッション/接続情報が一致するかを検証します。"
        },
        {
          "subQNo": "設問2",
          "text": "〔脆弱性1について〕について、(1)〜(4)に答えよ。",
          "explanation": "脆弱性1はCSRF（クロスサイトリクエストフォージェリ）に関するものです。退会処理など重要な操作が、本人の意図しないリンククリックで実行される問題です。\n\n### CSRF攻撃の仕組み\n```mermaid\nsequenceDiagram\n    participant User as 利用者のブラウザ\n    participant Mall as 攻撃者の罠サイト\n    participant App as サイトα\n\n    Note over User: サイトαにログイン中\n    User->>Mall: 閲覧\n    Mall-->>User: 自動送信するHTML(図2)\n    User->>App: (退会リクエスト)\n    Note right of App: ログインセッションを伴うため\n正規の要求として受理してしまう\n```",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の[ a ]に入れる脆弱性の名称を、カタカナ20字以内で答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の[ b ]に入れる表2中の項番を1〜5から選び、数字で答えよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の[ c ], [ d ]に入れる適切な字句を、それぞれ10字以内で答えよ。"
            },
            {
              "label": "(4)",
              "text": "図2中の[ e ], [ f ]に入れる適切な文字列を、それぞれ10字以内で答えよ。"
            }
          ]
        },
        {
          "subQNo": "設問3",
          "text": "〔脆弱性2について〕について、(1)〜(3)に答えよ。",
          "explanation": "脆弱性2はXSS（クロスサイトスクリプティング）に関するものです。入力されたスクリプトが他の利用者のブラウザ上で実行され、Cookieの窃取や勝手な操作が行われる危険性を検討します。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線②に該当する属性を解答群の中から全て選び、記号で答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の[ g ]に入れる攻撃の名称を15字以内で答えよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の[ h ]に入れる仕様を25字以内で具体的に述べよ。"
            }
          ]
        }
      ],
      "point": 33
    },
    {
      "qNo": 3,
      "theme": "クラウドサービスの認証連携と接続制限",
      "description": "F社は、社外のクラウドサービス（交通費精算、グループウェア、オンラインストレージ）を利用している。ある日、従業員Rさんの振込先口座が勝手に変更される不正アクセスが発生した。C主任は、原因がフィッシングサイトによるID・パスワードの流出と判断し、対策としてSAMLを用いた認証連携の導入を検討することにした。\n\n### 図1 導入を検討している方式のシーケンス\n```mermaid\nsequenceDiagram\n    participant Browser as 利用者端末のWebブラウザ (c)\n    participant SP as SP (a)\n    participant IdP as IdP (b)\n    participant LDAP as LDAPサーバ (d)\n\n    Browser->>SP: (1) サービス要求\n    SP->>Browser: (2) リダイレクト指示\n    Browser->>IdP: (3) ログイン画面要求\n    IdP-->>Browser: (4) ログイン画面応答\n    Browser->>IdP: (5) 認証要求\n    IdP->>LDAP: (6) 認証要求\n    LDAP-->>IdP: (7) 認証結果を応答\n    IdP-->>Browser: (8) SAML Responseの送信フォームを応答\n    Browser->>SP: (9) SAML Responseを送信\n    SP->>Browser: (10) サービス提供\n```\n\nこの方式により、IdPを自社ネットワーク内に設置し、認証を社内に限定することで、社外からの直接ログインを制限する計画である。",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "本文中の下線①について、条件を満たす利用者IDを特定するためには、どのような条件を満たすログイン記録を抽出すればよいか。満たすべき条件を35字以内で述べよ。",
          "explanation": "「F社以外からのログイン」を特定するための条件を考えます。F社のグローバルIPアドレス以外からのアクセス記録を抽出する必要があります。"
        },
        {
          "subQNo": "設問2",
          "text": "〔SAMLを用いた認証連携と接続制限方式の概要〕について、(1)〜(5)に答えよ。",
          "explanation": "SAMLの基本的なシーケンスと、SP・IdP・ブラウザの役割分担を理解しましょう。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図1中の[ a ]〜[ d ]に入れる適切な字句を解答群の中から選び、記号で答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の[ e ], [ f ]に入れる適切な処理番号を、表1中の処理1〜4の中から選び、答えよ。"
            },
            {
              "label": "(3)",
              "text": "表1中の[ g ]に入れる適切な字句を解答群の中から選び、記号で答えよ。"
            },
            {
              "label": "(4)",
              "text": "表1中の[ h ], [ i ]に入れる適切な字句を、それぞれ5字以内で答えよ。"
            },
            {
              "label": "(5)",
              "text": "本文中の下線②について、SPとIdPが直接通信できないにもかかわらず、認証の連携が成立するのはなぜか。その理由を、35字以内で述べよ。"
            }
          ]
        },
        {
          "subQNo": "設問3",
          "text": "本文中の下線③について、社外から交通費精算サービスとグループウェアサービスにアクセスしたとき、それぞれのサービスは、異なる理由でログインに失敗する。それらは、図1中のどの通信ができないことによるものか。(1)〜(10)から選び、答えよ。また、その理由を、それぞれ35字以内で述べよ。",
          "explanation": "サービスごとに設定されている制限（IP制限の有無など）によって、どのステップで通信が遮断されるかが異なります。"
        }
      ],
      "point": 33
    }
  ]
}