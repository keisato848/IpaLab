[
  {
    "qNo": 1,
    "theme": "電子メールのセキュリティ対策 (SPF, DKIM, DMARC)",
    "description": "N社は、従業員数500名の情報サービス事業者である。N社の情報システムの構成を図1に示す。\n\n### 図1 N社の情報システムの構成\n\n```mermaid\ngraph TD\n  Internet((インターネット)) --- Router[ルータ]\n  Router --- FW[FW: ファイアウォール]\n\n  subgraph N_Company [N社]\n    FW --- L2SW1[L2SW]\n    \n    subgraph DMZ\n      L2SW1 --- Proxy[プロキシサーバ]\n      L2SW1 --- ExtDNS[外部DNSサーバ]\n      L2SW1 --- ExtMail[外部メールサーバ]\n    end\n\n    FW --- L3SW[L3SW]\n    \n    L3SW --- L2SW2[L2SW]\n    subgraph Server_Segment [サーバセグメント]\n      L2SW2 --- IntMail[内部メールサーバ]\n      L2SW2 --- IntDNS[内部DNSサーバ]\n    end\n\n    L3SW --- L2SW3[L2SW]\n    subgraph PC_Segment [PCセグメント]\n      L2SW3 --- PC[PC]\n    end\n  end\n\n  style N_Company fill:#f9f,stroke:#333,stroke-width:2px\n  style DMZ fill:#dfd,stroke:#333,stroke-dasharray: 5 5\n```\n\nN社では、外部DNSサーバに電子メールに関して図2のように設定している。\n\n### 図2 N社の外部DNSサーバのメールに関する設定\n\n| 名前 | クラス | タイプ | 値 |\n| :--- | :--- | :--- | :--- |\n| n-sha.co.jp. | IN | MX 10 | mail.n-sha.co.jp. |\n| mail.n-sha.co.jp. | IN | A | x1.y1.z1.1 |\n\n送信者メールアドレスには、SMTPの [ a ] コマンドで指定されるエンベロープの送信者メールアドレス（Envelope-FROM）と、メールデータ内のメールヘッダで指定される送信者メールアドレス（Header-FROM）がある。\n\n昨今、なりすましメールによる攻撃を抑えるため、SPF、DKIM、DMARCといった送信ドメイン認証技術の導入を検討することになった。\n\n### 図3 なりすましメールによる攻撃の例\n- **攻撃1**: N社の取引先のメールアドレスを送信者として設定したメールを、攻撃者のメールサーバからN社に送信する。\n- **攻撃2**: N社のメールアドレスを送信者として設定したメールを、攻撃者のメールサーバからN社の取引先に送信する。\n\n### 表1 SPFへの対応状況と各攻撃に対する効果\n| 項番 | N社の外部DNS設定 | N社のメールサーバ対応 | 取引先の外部DNS設定 | 取引先のメールサーバ対応 | 攻撃1に対する効果 | 攻撃2に対する効果 |\n| :--- | :--- | :--- | :--- | :--- | :--- | :--- |\n| 1 | 設定済み | 実施する | 設定済み | 実施する | ○ | ○ |\n| 4 | 設定済み | 実施する | 未設定 | 実施しない | [ b ] | [ c ] |\n| 6 | 設定済み | 実施しない | 設定済み | 実施しない | [ d ] | [ e ] |\n| 7 | 設定済み | 実施しない | 未設定 | 実施しない | [ f ] | [ g ] |\n| 13 | 未設定 | 実施しない | 設定済み | 実施する | [ h ] | [ i ] |\n| 16 | 未設定 | 実施しない | 未設定 | 実施しない | × | × |\n\n注：「○」は送信者メールアドレスが詐称されているかを判断可、「×」は判断不可を示す。\n\n### 図4 TXTレコードの例\n```\nn-sha.co.jp. IN TXT \"v=spf1 +ip4: [ j ] -all\"\n```\n\n### 図5 DKIM利用のシーケンス\n\n```mermaid\nsequenceDiagram\n  participant ExtMail as 外部メールサーバ\n  participant ExtDNS as 外部DNSサーバ\n  participant RecvMail as 受信側メールサーバ\n  \n  ExtMail->>RecvMail: 1. DKIM-Signatureヘッダ付メールの送信\n  RecvMail->>ExtDNS: 2. 公開鍵の要求\n  ExtDNS->>RecvMail: 3. 公開鍵の送信\n  Note right of RecvMail: 4. 検証\n```\n\n### 表2 DMARCの主なタグ（概要）\n| タグ | タグの説明 | 値と説明 |\n| :--- | :--- | :--- |\n| p | ポリシー（必須） | none, quarantine, reject |\n| aspf | SPF認証の調整パラメタ | r: 組織ドメイン一致, s: 完全修飾ドメイン名一致 |\n| adkim | DKIM認証の調整パラメタ | r: 組織ドメイン一致, s: 完全修飾ドメイン名一致 |",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "本文中の [ a ] に入れる適切な字句を答えよ。",
        "explanation": "SMTP通信において、エンベロープの送信者（Envelope-FROM）を指定するコマンドは `MAIL FROM` です。メールデータ（DATAコマンド以降）で指定される `From:` ヘッダ（Header-FROM）とは区別されます。"
      },
      {
        "subQNo": "設問2",
        "text": "〔送信ドメイン認証技術の検討〕について、(1)〜(4)に答えよ。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "表1中の [ b ] 〜 [ i ] に入れる適切な内容を、\"○\" 又は \"×\" のいずれかで答えよ。"
          },
          {
            "label": "(2)",
            "text": "図4中の [ j ] に入れる適切な字句を答えよ。"
          },
          {
            "label": "(3)",
            "text": "本文中の下線①について、SPF認証が失敗する理由を、SPF認証の仕組みを踏まえて、50字以内で具体的に述べよ。"
          },
          {
            "label": "(4)",
            "text": "図6中の下線②の検証によってメールの送信元の正当性以外に確認できる事項を、20字以内で述べよ。"
          }
        ],
        "explanation": "### 表1の解説\nSPF認証が成功（○）するためには、「送信側のDNSにSPFレコードが設定されていること」かつ「受信側のメールサーバでSPF検証を実施していること」の両方が必要です。\n- b, d, f: 攻撃1は「取引先ドメイン」を騙る攻撃です。取引先のDNSが「未設定」であれば、N社が検証を実施しても判断不可のため **×** です。\n- c, e, g: 攻撃2は「N社ドメイン」を騙る攻撃です。N社のDNSは「設定済み」です。受信側（取引先）が検証を「実施しない」場合（c, e, g）は、判断不可のため **×** です。\n- h, i: 送信側のN社のDNSが「未設定」なので、検証を実施しても **×** です。\n\n### 図4 [ j ] の解説\nN社の外部メールサーバのIPアドレスを指定します。図2より、`mail.n-sha.co.jp` のIPアドレスは `x1.y1.z1.1` です。\n\n### 下線①の解説\nメール転送時は、送信元IPアドレスが転送元サーバのものに変わるため、送信ドメインのSPFレコードに記載されたIPアドレスと一致しなくなるからです。\n\n### 下線②の解説\nデジタル署名を使用しているため、「メール本文やヘッダが改ざんされていないこと（完全性）」が確認できます。"
      },
      {
        "subQNo": "設問3",
        "text": "図7中の [ k ], [ l ]、表3中の [ m ], [ n ] に入れる適切な字句を答えよ。",
        "explanation": "ニュースレター配信サービスXを利用する場合の設定です。\n- [ k ]: サブドメイン `a-sub.n-sha.co.jp` のメール転送先（MXレコード）として、サービスXのメールサーバ `mail.x-sha.co.jp.` を指定します。\n- [ l ]: サービスXの送信サーバのIPアドレス `x2.y2.z2.1` を追加します。\n- [ m ]: 検証失敗メールを隔離するため、ポリシー `quarantine` を指定します。\n- [ n ]: サブドメインを使用しているため、組織ドメイン一致で許容する `r`（relaxed）を指定します。"
      },
      {
        "subQNo": "設問4",
        "text": "攻撃者がどのようにN社の取引先になりすましてN社にメールを送信すると、N社がSPF、DKIM及びDMARCでは防ぐことができなくなるのか。その方法を50字以内で具体的に述べよ。",
        "explanation": "送信ドメイン認証は「ドメイン」を認証する技術です。攻撃者が「取引先のドメインに酷似した別ドメイン」を取得し、そのドメインで正しくSPF/DKIM/DMARCを設定して送信した場合、認証自体はパスしてしまいます。"
      }
    ]
  },
  {
    "qNo": 2,
    "theme": "サイバーセキュリティ情報の活用とインシデント対応",
    "description": "Z社は、従業員数150名の金融事業者である。Z社のネットワーク構成を図1に示す。\n\n### 図1 Z社のネットワーク構成\n\n```mermaid\ngraph TD\n  Internet((インターネット)) --- FW[FW]\n\n  subgraph DMZ\n    FW --- L2SW_DMZ[L2SW]\n    L2SW_DMZ --- ExtDNS[外部DNSサーバ]\n    L2SW_DMZ --- PubWeb[公開Webサーバ]\n  end\n\n  subgraph Office_Segment [オフィスセグメント]\n    FW --- L2SW_Office[L2SW]\n    L2SW_Office --- PC[PC]\n  end\n\n  subgraph Internal_Server_Segment [内部サーバセグメント]\n    FW --- L2SW_Int[L2SW]\n    L2SW_Int --- Proxy[プロキシサーバ]\n    L2SW_Int --- Mail[メールサーバ]\n    L2SW_Int --- IntWeb[内部Webサーバ]\n    L2SW_Int --- Auth[認証サーバ]\n    L2SW_Int --- IntDNS[内部DNSサーバ]\n  end\n```\n\n### 表1 FWのフィルタリングルール（抜粋）\n| 項番 | 送信元 | 宛先 | サービス | 動作 |\n| :--- | :--- | :--- | :--- | :--- |\n| 1 | オフィスセグメント | DMZ | HTTP, HTTPS, DNS, POP, SMTP | 許可 |\n| 2 | オフィスセグメント | 内部サーバセグメント | HTTP, HTTPS, 認証サービス, DNS | 許可 |\n| 7 | 全て | 全て | 全て | 拒否 |\n\nZ社はISACから「攻撃グループXがマルウェアPを用いて金融機関を攻撃している」という情報提供を受けた。調査の結果、PC-VがマルウェアPに感染していることが判明した。",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "〔ISACからの情報提供と対応〕について、(1)〜(4)に答えよ。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "図3中の下線①について、通信が遮断された理由を20字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "図3中の [ a ] に入れる適切な機器を答えよ。"
          },
          {
            "label": "(3)",
            "text": "図3中の下線②について、情報持ち出しが成功した可能性が高いとZ社が判断可能な痕跡は何か。2つ挙げよ。"
          }
        ],
        "explanation": "### 下線①の解説\nオフィスセグメントからインターネット（グローバルIP M）への直接のHTTP通信は、FWルールで許可されていない（ルール7で拒否される）ためです。通常、Web閲覧はプロキシ経由で行う必要があります。\n\n### [ a ] の解説\nプロキシを経由しない直接の通信試行は、ファイアウォールの「拒否（deny）」ログに記録されます。よって [ a ] は **FW** です。\n\n### 下線②の解説\n「持ち出し」の痕跡としては、(1)プロキシサーバのアクセスログにおける外部への大量のデータ送信、(2)FWの動作ログにおける外部への異常な通信量、などが考えられます。"
      }
    ]
  },
  {
    "qNo": 3,
    "theme": "標的型攻撃への対応とインシデント対応手順の改善",
    "description": "J社は、ビッグデータ解析を専門とする従業員数150名の調査会社である。標的型攻撃への対策として、監視サービス（Pサービス）とマルウェア対策製品（Rシステム）を導入した。\n\n### 図1 J社情報システムの概要\n\n```mermaid\ngraph TD\n  Internet((インターネット)) --- FW[FW]\n  \n  subgraph J_Company [J社]\n    FW --- L2SW_Int[L2SW]\n    \n    subgraph DMZ\n      L2SW_Int --- ExtMail[外部メールサーバ]\n      L2SW_Int --- ExtDNS[外部DNSサーバ]\n    end\n\n    subgraph User_LAN [利用者LAN]\n      L2SW_Int --- PC[PC]\n    end\n\n    subgraph Internal_System_LAN [内部システムLAN]\n      L2SW_Int --- LogServer[ログ蓄積サーバ]\n      L2SW_Int --- IntMail[内部メールサーバ]\n      L2SW_Int --- AdminServer[管理サーバ: Rシステム]\n      L2SW_Int --- IntDNS[内部DNSサーバ]\n      L2SW_Int --- BusinessServer[業務サーバ]\n    end\n  end\n\n  P_Service[Pサービス] --- Internet\n```\n\n### 表2 Gさんによるインシデント対応の記録（抜粋）\n| 時刻 | 対応内容 |\n| :--- | :--- |\n| 13:27 | Pサービスから、L-PC（192.168.1.20）がC&Cサーバ（w1.x1.y1.z1）と通信したとの通知を受けた。 |\n| 13:43 | L-PCの電源を入れたまま、LANケーブルを抜くように指示した。 |\n| 14:03 | FWに宛先 w1.x1.y1.z1 への通信を拒否するルールを登録した。 |\n\n### 表3 L-PC上で実行されていたコマンド（抜粋）\n| コマンド | 想定される攻撃フェーズ | 想定される攻撃者の目的 |\n| :--- | :--- | :--- |\n| ipconfig /all | 初期調査 | [ a ] |\n| systeminfo | 初期調査 | [ b ] |\n| tasklist | 初期調査 | [ c ] |\n| dir /a | 探索活動 | 秘密情報を含むファイル等の発見 |\n| net view | 探索活動 | [ d ] |",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "〔標的型攻撃対策〕について、(1), (2)に答えよ。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "図2中の(2)のようにする目的を、25字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "図2中の(3)について、不審PCをLANから切り離さない場合、J社にとって望ましくないものを二つ挙げよ。"
          }
        ],
        "explanation": "### (1) の解説\n「電源を入れたまま」にするのは、メモリ上の情報（実行中のプロセスや通信ログなど）が消えないようにし、フォレンジック調査に役立てるためです。\n\n### (2) の解説\n切り離さない場合の懸念点は、(1)マルウェアによる他の端末への感染拡大、(2)C&Cサーバを通じたさらなる情報漏洩や遠隔操作、が挙げられます。"
      },
      {
        "subQNo": "設問2",
        "text": "表3中の [ a ] 〜 [ d ] に入れる適切なものを解答群から選べ。",
        "explanation": "- [ a ]: `ipconfig` はネットワーク構成を知るためのコマンドなので、ウ（IPアドレス、MACアドレス等の取得）です。\n- [ b ]: `systeminfo` はOSのバージョンやパッチ適用状況を知るためのコマンドなので、イ（OSのバージョンや脆弱性修正プログラムの適用状況確認）です。\n- [ c ]: `tasklist` は実行中のプロセスを知るためのコマンドなので、オ（実行中のプロセス一覧を取得）です。\n- [ d ]: `net view` はネットワーク上の共有リソースを一覧表示するコマンドなので、ア（接続可能な端末の一覧を取得）です。"
      },
      {
        "subQNo": "設問3",
        "text": "〔インシデント対応手順の改善〕について、(1)〜(3)に答えよ。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の [ e ] に入れる適切な内容を25字以内で具体的に述べよ。"
          }
        ],
        "explanation": "Pサービスからの通知より前に、FWログに「C&CサーバのIPアドレスとの通信」が含まれていないかを確認する必要があります。よって [ e ] は `C&CサーバのIPアドレス`（または w1.x1.y1.z1）です。"
      }
    ]
  }
]