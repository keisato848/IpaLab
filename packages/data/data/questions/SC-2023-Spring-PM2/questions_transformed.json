{
  "questions": [
    {
      "qNo": 1,
      "theme": "Webアプリケーション診断における対象URLの特定",
      "description": "IPA情報処理安全確保支援士試験 午後問題。提供された入力データは単一の設問のみで、大問の全体的なコンテキストや背景情報は含まれていません。",
      "context": {
        "title": "Webサイトの診断対象URL特定方法",
        "background": "提供された入力データには、この設問の前提となる背景情報（L社の概要、システム構成、診断実施体制など）は含まれていませんでした。この設問は、Webサイトの脆弱性診断において、通常の方法では検出が困難なURLを漏れなく診断対象に含めるための手段を問うものです。\n\n※本設問は、元の問題文（本文、図表）が存在することを前提としています。[ d ] や下線⑥ の具体的な箇所は、提供されたデータからは特定できません。",
        "diagrams": [
          {
            "id": "table2",
            "label": "表2 URL特定方法 (参照)",
            "type": "markdown",
            "content": "※ 表2の内容は入力データから欠落しています。設問文の記述内容から、Webサイトの診断対象URLを特定・登録する際の方法比較が記載されていたと推定されます。"
          },
          {
            "id": "fig4",
            "label": "L社のWebアプリケーションの画面遷移（推定）",
            "type": "image",
            "content": "元の問題には、L社のWebアプリケーションの画面遷移図と注記（注1: キャンペーン申込みは1回限り、注2: 新規会員情報入力はメール送付された登録URLから到達、注4: 検索結果画面への遷移URLはJavaScriptで動的に生成、など）を含む図4が存在した。図中の画面遷移記号として(A)〜(E)が使われていた。"
          }
        ]
      },
      "questions": [
        {
          "subQNo": "設問1",
          "text": "表2中の下線①について、別の方法を,30字以内で答えよ。",
          "references": [
            "table2"
          ],
          "answer": "開発部門からWebサイトの構成情報を入手し、診断対象URLの一覧を取得する。(30字)",
          "explanation": "### 解説\n下線①は、手動登録機能を利用する際、「Webサイトの全てのURLを診断対象とする場合, 診断対象 URL を別の方法で調べる必要がある」という点です。これは、手動でたどったり、自動で探査しても見つけられないURLが存在するためです。これらの隠れたURLを確実に発見するためには、開発時に作成されたURLリストや、アプリケーションのソースコード、設定ファイルなどを参照するのが最も確実です。",
          "subQuestions": [],
          "point": 16
        },
        {
          "subQNo": "設問2",
          "text": "〔フェーズ3:ZさんとB社での診断の実施と結果比較〕について答えよ。",
          "references": [
            "fig1",
            "table3"
          ],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "表3中及び本文中の [ a ] , [ b ] に入れる適切な字句を、解答群の中から選び、記号で答えよ。\n解答群\nア ' and 'a' =' a\nイ ' and 'a' =' b\nウ ' and 'a' =' b\nエ and 1=0\nオ and 1=1",
              "references": [
                "table3"
              ],
              "answer": "a: ア, b: イ",
              "explanation": "SQLインジェクションの検出は、特定のキーワード（keyword）に対して、SQL構文を操作する特殊文字や論理演算子を挿入し、検索結果数の変化（True/False）を比較することで行われます。\n\nB社は、ベースライン `keyword=manual` (10件) に対して、\n1.  `keyword=manual'` (0件): SQL構文エラーにより失敗。\n2.  `keyword=manual [ a ]` (10件): True条件の注入により成功し、ベースラインと同じ結果件数を返す。\n3.  `keyword=manual [ b ]` (0件): False条件の注入により失敗し、結果件数を返さない。\n\nこのTrue/Falseテストが成り立つには、`[ a ]`がTrue、`[ b ]`がFalseとなるペイロードでなければなりません。キーワードがシングルクォートで囲まれてSQLに組み込まれると仮定すると、`'`で既存のクォートを閉じ、`AND`を使って論理式を追加します。\n\n-   True条件: `' and 'a'='a` (ア)\n-   False条件: `' and 'a'='b` (イ)\n\n**解答:** a: ア, b: イ"
            },
            {
              "label": "(2)",
              "text": "本文中の [ c ] に入れる適切な機能を、図1中の(1-1)〜(8-1)から選び答えよ。",
              "references": [
                "fig1"
              ],
              "answer": "(2-3)",
              "explanation": "Zさんは、入力したスクリプトが2画面先の応答で出力されるXSSを見逃しました。DASTツールが脆弱性を検出するためには、入力が発生したURLだけでなく、その影響が発現する後のURLの応答も判定対象にする必要があります。\n\n図1の仕様 (2-3)「診断対象 URLの拡張機能」は、「診断対象 URL の応答だけでなく、別の URL の応答も判定対象になる」機能であり、これが必要な要件を満たします。\n\n**解答:** (2-3)"
            },
            {
              "label": "(3)",
              "text": "本文中の下線②について,どのような設定が必要か。設定の内容を、図2中の画面名を用いて60字以内で答えよ。",
              "references": [],
              "answer": "診断対象URLの拡張機能により、アンケート入力1から遷移するアンケート確認のURLを判定対象に追加登録する。",
              "explanation": "検出できなかったXSSは、アンケート入力1の画面での入力が、2画面先のアンケート確認の画面でエスケープされずに出力されていました。したがって、ツールVの診断対象に、アンケート確認の画面の応答を含める設定が必要です。\n\n**解答:** 診断対象URLの拡張機能により、アンケート入力1から遷移するアンケート確認のURLを判定対象に追加登録する。(60字)"
            },
            {
              "label": "(4)",
              "text": "本文中の下線③について, keyword の初期値をどのような値に設定する必要があるか。初期値が満たすべき条件を、40字以内で具体的に答えよ。",
              "references": [],
              "answer": "検索対象となるトピックが存在し、診断時のベースラインリクエスト実行において、検索結果が0件ではない件数を返す値であること。",
              "explanation": "Zさんの診断が失敗した原因は、初期値`xyz`を使った場合、ベースラインの検索結果も0件だったため、SQLiペイロードを送信しても結果が0件であり、脆弱性による0件なのか、単なる検索結果の不一致による0件なのか判別できなかったことです。\n\nSQLインジェクションを検出するためには、ベースラインとなる検索が成功し、かつ、そのベースラインの件数と比較できることが必要です。\n\n**解答:** 検索対象となるトピックが存在し、診断時のベースラインリクエスト実行において、検索結果が0件ではない件数を返す値であること。(40字)"
            }
          ],
          "point": 16
        },
        {
          "subQNo": "設問3",
          "text": "〔フェーズ5:診断手順案に従った診断の実施〕について答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線④について、URLが登録されなかった画面名を、解答群の中から全て選び、記号で答えよ。\n解答群\nア 会員情報変更入力\nイ キャンペーン申込み\nウ 検索結果\nエ 新規会員情報入力",
              "answer": "ウ, エ",
              "explanation": "自動登録機能はリンクやフォームをたどりますが、JavaScriptで動的に生成されるURLや、外部の手段（メールなど）でアクセスされるURLは登録が漏れる場合があります。\n\n1. ウ 検索結果: {{diagram:fig4}}注記4により、検索結果画面への遷移URLはJavaScriptで動的に生成されるため、自動登録では漏れる可能性が高い。\n2. エ 新規会員情報入力: この画面は、電子メールで送付された登録URLにアクセスすることで到達するため（{{diagram:fig4}}注記2）、トップページからの自動探査ではたどり着けず、登録が漏れる。\n\nア（会員情報変更入力）とイ（キャンペーン申込み）は、ログイン後のトップページから静的なリンクで到達可能であるため、通常は登録されます。",
              "references": [
                "fig4"
              ]
            },
            {
              "label": "(2)",
              "text": "本文中の下線⑤について、該当する画面遷移とエラーになってしまう理由を2組み挙げ、画面遷移は図4中の(A)〜(E)から選び、理由は40字以内で答えよ。",
              "answer": "1組目: 画面遷移: D\n理由: 会員Nが1回しか申込みできないキャンペーンに診断ツールが繰り返し申込みを行うため。\n\n2組目: 画面遷移: B\n理由: 会員情報変更完了へのリクエストが、一度きり有効なパラメータの再利用で拒否されるため。",
              "explanation": "下線⑤は、特定パラメータが同じ値だと複数回リクエスト送信でエラーになり遷移できないというY氏からの指摘です。これは、サーバー側でリソースの利用回数を制限している場合や、CSRF対策などで一時的なトークンを利用している場合に発生しやすいです。\n\n1. キャンペーン申込み（Dと推定）: {{diagram:fig4}}注記1により、会員Nは一つのキャンペーンに1回しか申込みできません。診断ツールがこれを繰り返すと拒否されます。\n2. 会員情報変更確認（B）: 確認画面(B)から完了画面(C)への遷移は、通常、一意なトランザクションIDやトークンが使われます。ツールがこれを繰り返し再送すると、サーバーが既に処理済みとして拒否されます。",
              "references": [
                "fig4"
              ]
            }
          ],
          "point": 16
        },
        {
          "subQNo": "設問4",
          "text": "〔XSS〕について答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ d ] に入れる適切な字句を、30字以内で答えよ。",
              "answer": "JavaScriptによるcookieの読み出し",
              "explanation": "開発部Nは、`cookie`に`HttpOnly`属性が付いているため、XSSによって`[ d ]`が禁止されると説明しました。`HttpOnly`は、クライアントサイドのスクリプトからCookieへのアクセスを防ぐための属性です。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線⑥について、攻撃の手口を、40字以内で答えよ。",
              "answer": "XSSにより、ユーザーの画面表示内容や入力途中の情報などをJavaScriptで読み取り、外部へ送信する。",
              "explanation": "XSSが成功した場合、`HttpOnly`によってCookieが保護されていても、攻撃者はJavaScriptを用いてDOMを操作・読み取りすることが可能です。これにより、画面に表示されている機密情報や、ユーザーが入力中のデータを窃取できます。"
            }
          ],
          "point": 16
        },
        {
          "subQNo": "設問5",
          "text": "〔アクセス制御の回避〕について答えよ。",
          "references": [
            "fig5",
            "fig6"
          ],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線⑦について、リクエストの内容を,30 字以内で具体的に答えよ。",
              "answer": "リクエストボディから会員の所属グループを識別するためのパラメータ group_code を削除する。",
              "explanation": "正常なリクエスト（図5）は、会員NのグループIDである`group_code=0001`を含んでおり、A社キャンペーンのみが表示されます。脆弱性を検出したリクエスト（図6）は、`group_code`パラメータ自体がリクエストボディから削除されていますが、本来閲覧できないはずのキャンペーンが表示されました。"
            },
            {
              "label": "(2)",
              "text": "本文中の [ e ] , [ f ] に入れる適切なパラメータ名を、図5中から選び、それぞれ15字以内で答えよ。",
              "answer": "e: JSESSIONID, f: group_code",
              "explanation": "修正後のソースコードは、リクエスト中の`[ e ]`から会員Nを特定し、会員Nが所属しているグループが`[ f ]`の値と一致するかを検証します。\\n\\n1.  会員Nの特定は、リクエストに含まれるセッションID（`JSESSIONID`）によって行われます。したがって、`[ e ]`は`JSESSIONID`です。\\n2.  検証対象は、会員Nの所属グループと、リクエストで指定されたグループフィルタのパラメータの値です。このグループ識別パラメータは`group_code`です。"
            }
          ],
          "point": 16
        }
      ],
      "point": 16
    },
    {
      "qNo": 99,
      "theme": "Webアプリケーション診断手順の改善と運用",
      "description": "",
      "context": {
        "title": "A社グループの診断手順の制定",
        "background": "",
        "diagrams": []
      },
      "questions": [
        {
          "subQNo": "設問6",
          "text": "〔フェーズ6:A社グループの診断手順の制定〕について答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "診断開始までに要する時間の課題について、A社で取り入れている管理策を参考にした対策を、40字以内で具体的に答えよ。",
              "answer": "Webサイトの立ち上げ時に、診断に必要な情報を資産管理システムへ登録する手順を必須化する。",
              "explanation": "フェーズ5において、サイトNの診断情報（URL、アカウントなど）が一元管理されていなかったため、確認に1週間を要しました。A社ではWebサイト立ち上げ時に資産管理システムへの登録を必須としています。この管理策を利用し、診断に必要な情報を事前に登録するように手順を強化します。"
            },
            {
              "label": "(2)",
              "text": "B社のサポート費用の課題について、B社に対して同じ問合せを行わず、問合せ件数を削減するために、A社グループではどのような対策を実施すべきか。セキュアコーディング規約の必須化や開発者への教育以外で、実施すべき対策を,50字以内で具体的に答えよ。",
              "answer": "セキュリティ推進部が診断結果の偽陽性判断や、リスク及び対策に関する問い合わせの一次対応を担う手順を設ける。",
              "explanation": "B社へのサポート費用が高額になった原因は、開発者からの問い合わせがB社へ頻繁に行われたためです。これを削減するには、セキュリティ推進部（Zさんのチーム）が開発者とB社の間に立ち、問い合わせの一次対応や、診断結果の分析を行う必要があります。これにより、B社へエスカレーションするチケット数を削減できます。"
            }
          ],
          "point": 16
        }
      ],
      "point": 16
    }
  ]
}