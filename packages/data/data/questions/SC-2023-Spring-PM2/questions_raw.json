{
  "qNo": 1,
  "theme": "Webセキュリティに関する脆弱性診断と内製化プロジェクト",
  "description": "A社グループは、全体で従業員 20,000名の製造業グループである。技術開発や新製品の製造・販売を行うA社のほか、特化型の製品の製造・販売を行う複数の子会社(以下、グループ各社という)がある。A社及びグループ各社には、様々な Web サイトがある。A社では、資産管理システムを利用し、IT資産の管理を効率化している。Web サイトの立上げ時は、資産管理システムへの Web サイトの概要、システム構成, IPアドレス、担当者などの登録申請が必要である。\n\nA社には、CISOが率いるセキュリティ推進部がある。セキュリティ推進部の業務は、主に次の三つである。\n・A社の情報セキュリティマネジメントを統括する。\n・A社の Web サイトの脆弱性診断(以下,脆弱性診断を診断という)を管理する。例えば、A社の会員サイトなど、重要な Web サイトについて、診断を新規リリース前に実施し、その後も年1回実施する。なお、診断は、セキュリティ専門業者のB社に委託している。\n・グループ各社に対して、情報セキュリティポリシーやセキュアコーディング規約を配布する。なお、診断の実施有無や内容はグループ各社の判断に任せている。\n\nIoT 製品の市場拡大によってグループ各社による新規 Web サイト開発の増加が予想されている中、A社の経営陣は、グループ各社の Web サイトのセキュリティが十分かどうかを懸念し始めた。そこで、グループ各社の重要な Web サイトも、A社のセキュリティ推進部がグループ各社と協議しつつ診断を管理することになった。\n\nセキュリティ推進部がB社に診断対象となる Web サイトのリリーススケジュールを伝えたところ、同時期に多数の診断を依頼されても対応することができない可能性があるとのことだった。そこで、グループ各社の一部の Web サイトに対する診断を A社グループ内で実施できるようにするための内製化推進プロジェクト(以下,S プロジェクトという)を立ち上げた。\n\nセキュリティ推進部のZさんは、Sプロジェクトを担当することになった。ZさんはこれまでもB社への診断の依頼を担当しており、診断の準備から診断結果の報告まで、診断全体をおおむね把握していた。\n\n### Sプロジェクトの進め方\nSプロジェクトは、B社の支援を得ながら、表1のとおり進めることにした。B社からは、セキュリティコンサルタントで情報処理安全確保支援士(登録セキスペ)であるY氏の支援を受けることになった。\n\n**表1 Sプロジェクトの進め方**\n| フェーズ | 作業内容 | 説明 |\n| :--- | :--- | :--- |\n| フェーズ 1 | 診断項目の決定 | 診断項目を決める。 |\n| フェーズ 2 | 診断ツールの選定 | 診断ツールを選定する。 |\n| フェーズ 3 | ZさんとB社での診断の実施と結果比較 | A社グループである K社の製品のアンケートサイト(以下,サイトMという)について、ZさんとB社がそれぞれ診断を実施する。Zさんは、B社の診断結果との差異を評価する。 |\n| フェーズ 4 | A社グループの診断手順案の作成 | フェーズ3の評価を基に、A社グループの診断手順案を作成する。 |\n| フェーズ 5 | 診断手順案に従った診断の実施 | K社の会員サイト(以下,サイトNという)に対し、A社グループの診断手順案に従って、診断を実施する。 |\n| フェーズ 6 | A社グループの診断手順の制定 | フェーズ 5 の診断で残った課題についての対策を検討した上で、A社グループの診断手順を制定する。 |\n\n### フェーズ1:診断項目の決定\nSプロジェクトでは、診断項目を決めた。\n\n### フェーズ2:診断ツールの選定\nB社が Web サイトの診断にツール V を使っていることもあり、A社はツール V を購入することに決めた。ツール V の仕様を図1に示す。\n\n**図1 ツールVの仕様(抜粋)**\n1. 機能概要: Dynamic Application Security Testing (DAST) のツールである。パラメータを初期値から何通りもの値に変更した HTTP リクエストを順に送信し、応答から脆弱性の有無を判定する。\n2. **機能**\n(1) プロジェクト作成機能 (1-1) プロジェクト作成機能: 診断対象とする Web サイトのFQDN を登録してプロジェクトを作成する。\n(2) **診断対象 URL の登録機能**\n(2-1) 診断対象 URL の自動登録機能: 探査を開始する URL を指定すると、自動探査によって、指定された URL の画面に含まれるリンク、フォームの送信先などをたどり、診断対象 URL を自動的に登録していく。診断対象 URL にひも付くパラメータ (注1) とその初期値も自動的に登録される。\n(2-2) 診断対象 URL の手動登録機能: 診断対象 URL を手動で登録する。診断対象 URL にひも付くパラメータとその初期値は自動的に登録される。\n(2-3) 診断対象 URLの拡張機能: 診断対象 URL ごとに設定できる。本機能を設定すると、診断対象 URL の応答だけでなく、別の URL の応答も判定対象になる。本機能を設定するには、診断対象 URL の拡張機能設定画面を開き、拡張機能設定に、判定対象に含める URL を登録する。\n(3) **拒否回避機能** (3-1) 拒否回避機能: 特定のパラメータが同じ値であるリクエストを複数回送信すると拒否されてしまう診断対象 URL については、URL ごとに本機能を設定することで、拒否を回避できる。\n(4) **URL にひも付くパラメータの設定機能** (4-1) パラメータ手動設定機能: パラメータの初期値を、任意の値に手動で修正して登録する。\n(5) **診断項目の設定機能** (5-1)診断項目設定機能: 診断項目を選択して設定する。\n(6) **アカウント設定機能** (6-1) 利用者 IDとパスワードの設定機能: ログイン機能がある Web サイトの場合は、ログイン後の画面の URL に対して診断するために、診断用のアカウントの利用者 IDとパスワードを設定する。(6-2) アカウントの拡張機能の設定: 診断用のアカウントを複数設定できる。\n(7) **診断機能** (7-1) 診断機能: 診断項目について診断を行う。診断用のアカウントが設定されている場合は、それらを順番に使う。\n(8) **レポート出力機能** (8-1) レポート出力機能: 診断結果をPDFで出力する。\n注1) 例えば、検索画面から検索結果が表示される画面に遷移する URL が診断対象 URL の場合,診断時に送信される検索ワードを含むパラメータを指す。\n\n**表2 診断対象 URL の自動登録機能及び手動登録機能の特徴**\n| 自動登録機能の特徴 | 手動登録機能の特徴 |\n| :--- | :--- |\n| ・登録に作業者の工数がほぼ不要である。 | ・登録に作業者の工数が必要である。 |\n| ・常に一定の品質で登録できる。 | ・Webブラウザを使ってトップページから順に手動でたどっても、登録が漏れる場合がある。Webサイトの全てのURLを診断対象とする場合, **①診断対象 URL を別の方法で調べる**必要がある。 |\n| ・Webサイトによっては、登録が漏れる場合がある。例えば、遷移先の URL が JavaScriptなどで動的に生成されるような場合である。 | |\n| ・必須入力項目に適切な値を入力できず、正常に遷移できないことがある。 | |\n\nA社は、診断項目のうち、ツール V では診断ができないものは手動で診断を実施することにした。\n\n### フェーズ3:ZさんとB社での診断の実施と結果比較\nZさんとB社は、サイトMに対して診断を実施した。サイトMの画面遷移を図2に示す。\n\n**図2 サイトMの画面遷移(抜粋)**\n```mermaid\ngraph LR\n    TP[トップページ] --> A1(アンケート入力1);\n    A1 --> A2(アンケート入力2);\n    A1 --> TL(トピック一覧);\n    A2 --> AC(アンケート確認);\n    AC --> AS(アンケート送信完了);\n    AS --> T1(トピック);\n    TL --> TS(トピック検索);\n    TL --> T2(トピック);\n    TS --> TR(トピック検索結果);\n    TR --> T3(トピック);\n```\n\nZさんは、Zさんの診断結果とB社の診断結果とを比較した。その結果、Zさんは脆弱性の一部を検出できていないことが分かった。検出できなかった脆弱性は、アンケート入力1の画面での入力値に起因するクロスサイトスクリプティング(以下,クロスサイトスクリプティングをXSS という)と、トピック検索の画面での入力値に起因する SQL インジェクションであった。サイトMのアンケート入力1からの画面遷移を図3に示す。\n\n**図3 サイトMのアンケート入力1からの画面遷移**\n```mermaid\ngraph LR\n    A1[アンケート入力1] -- i --> A2(アンケート入力2);\n    A2 -- ii --> AC(アンケート確認);\n    AC -- iii --> AS(アンケート送信完了);\n```\n注記 画面遷移時に Web ブラウザから送られたパラメータの値は、次のとおりである。\ni: last_name=%E5%B1%B1%E7%94%B0&first_name=%E5%A4%AA%E9%83%8E&member=Y\nii: text=%E5%95%86%E5%93%81%E3%81%AE%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3%E3%81%8C%E5%A5%BD%E3%81%8D%E3%80%82\niii: submit=Yes\n\nトピック検索の画面で検索条件として入力した値の処理に関する診断で、ツール V が送ったパラメータと検索結果の件数を表3に示す。なお、トピック検索の画面で検索条件として入力した値は、パラメータ keyword に格納される。\n\n**表3 ツールVが送ったパラメータと検索結果の件数(抜粋)**\n| 診断者 | 送ったパラメータ | 検索結果の件数 |\n| :--- | :--- | :--- |\n| B社 | keyword=manual | 10件 |\n| | keyword=manual' | 0件 |\n| | keyword=manual [ a ] | 10件 |\n| | keyword=manual [ b ] | 0件 |\n| Zさん | keyword=xyz | 0件 |\n| | keyword=xyz' | 0件 |\n| | keyword=xyz [ a ] | 0件 |\n| | keyword=xyz [ b ] | 0件 |\n注記1 B社はパラメータ keyword の初期値を manual としている。\n注記2 Zさんはパラメータ keyword の初期値を xyz としている。\n\nツール Vは、B社の診断では, keyword=manual [ a ] と keyword=manual [ b ] の検索結果を比較してSQLインジェクションを検出できたが、Zさんの診断ではSQLインジェクションを検出できなかった。\n\nZさんは、検出できなかった二つの脆弱性について、どうすれば検出できるのかをY氏に尋ねた。次は、その際のY氏とZさんの会話である。\n\nY氏: XSS については、入力したスクリプトが二つ先の画面でエスケープ処理されずに出力されていました。XSS の検出には、ツール V において図 1 中の [ c ] の②設定が必要でした。SQLインジェクションについては、keyword の値が文字列として扱われる仕様となっており, SQL の構文エラーが発生するような文字列を送ると検索結果が0件で返ってくるようです。そこで、[ ③ ] keyword の初期値として SQL インジェクションを検出できる“manual”のような値を設定する必要がありました。\nZさん:なるほど。ツールVは、Webサイトに応じた初期値を設定する必要があるのですね。\n\nその後、Zさんは、Y氏とともに、フェーズ3での診断結果を分析した。その際、偽陽性を除いてから開発者に報告することは難しいことが問題となった。\nそこで、Zさんは、“開発者への報告の際に、診断結果の報告内容が脆弱性なのか偽陽性なのか、その判断を開発者に委ねる。一方、診断結果の報告内容における脆弱性の内容、リスク及び対策について、開発者がB社に直接問い合わせる。”という案にした。なお、B社のサポート費用は、問合せ件数に比例するチケット制である。グループ各社がB社とサポート契約を結ぶが、費用は、当面A社がまとめて支払い,後日グループ各社と精算する。\n\nこれまでの検討を踏まえて、Zさんは、フェーズ4でA社グループの診断手順案を作成した。\n\n### フェーズ5:診断手順案に従った診断の実施\nY氏の協力の下、Zさんは、診断手順案に従ってサイトNの診断を実施することにした。サイトNは既にリリースされている。サイトNの会員(以下,会員Nという)は、幾つかのグループに分けられており、申し込むことができるキャンペーンが会員の所属しているグループによって異なる。サイトNの画面遷移を図4に示す。\n\n**図4 サイトNの画面遷移(抜粋)**\n```mermaid\ngraph TD\n    TP[トップページ] --> L(ログイン);\n    L --> A(ログイン後のトップページ);\n    \n    A --> SA(会員情報変更入力);\n    SA -- (A) --> SB(会員情報変更確認);\n    SB -- (B) --> SC(会員情報変更完了);\n    \n    A --> CA(キャンペーン一覧);\n    CA --> CB(キャンペーン申込み);\n    CB -- (C) --> CC(キャンペーン申込み完了);\n    \n    A --> DU(製品情報一覧);\n    DU -- (D) --> DL(製品情報);\n    \n    A --> EA(よくある質問検索);\n    EA --> EB(検索結果);\n    EB -- (E) --> EC(よくある質問);\n    \n    TP --> N1(新規会員登録申込み);\n    N1 --> N2(電子メールで登録URLを送付);\n    N2 -- 登録URLアクセス --> N3(新規会員情報入力);\n    N3 --> N4(新規会員情報確認);\n    N4 --> N5(新規会員登録完了);\n```\n注記1 一つのキャンペーンに対して、会員Nは1回だけ申込みできる。\n注記2 既に登録されているメールアドレスでは、新規会員登録の申込みはできない。\n注記3 ログインすると、会員Nが所属しているグループを識別するための group_code というパラメータがリクエストに追加される。\n注記4 よくある質問検索の画面で検索する際に、次の画面に遷移する URL が JavaScript で動的に生成される。\n注1) パスワードを連続5回間違えるとアカウントがロックされる。ログイン時に発行されるセッション IDである JSESSIONID は cookie に保持される。ログイン後しばらくアクセスしないとセッションIDは破棄され、再度ログインが必要になる。\n注2) 新規会員登録の申込み時に電子メールで送付された登録URLにアクセスすると表示される。\n\nまず、Zさんは、診断対象 URL, アカウントなど、診断に必要な情報をK社に確認した。しかし、サイトNについては診断に必要な情報が一元管理されていなかったので、確認の回答までに1週間掛かった。診断開始までに要する時間が課題として残った。\n\n次に、Zさんは、アカウントの設定を行った後、④探査を開始する URL に図4のトップページを指定してツールVの診断対象 URL の自動登録機能を使用したが、一部のURLは登録されなかった。その後、登録されなかった URL を手動で登録した。診断を実施してもよいか、Y氏に確認したところ、注意点の指摘を受けた。具体的には、⑤特定のパラメータが同じ値であるリクエストを複数回送信するとエラーになり、遷移できない箇所があることに注意せよとのことであった。適切な診断を行うために、ツールVの拒否回避機能を設定して診断を実施した。診断では、次に示す脆弱性が検出された。\n・XSS\n・アクセス制御の回避\n\nZさんは、これらの脆弱性について、サイトNの開発部門(以下,開発部Nという)に通知し、偽陽性かどうかの判断、リスクの評価及び対策の立案を依頼した。\n\n### XSS\nXSS の脆弱性は、複数の画面で検出された。開発部Nから, “cookieに HttpOnly 属性が付いていると、[ d ] が禁止される。そのため、cookie が漏えいすることはなく、修正は不要である。”という回答があった。Zさんは、この回答を受けてY氏に相談し、“XSS を悪用しても cookie を盗めないのは確かである。しかし、⑥XSS を悪用して cookie 以外の情報を盗む攻撃があるので、修正が必要である。”と開発部 Nに伝えた。\n\n### アクセス制御の回避\nZさんは、手動で診断し、アクセス制御の回避の脆弱性を、図4中のキャンペーン一覧の画面などで検出した。ある会員Nが⑦アクセス制御を回避するように細工されたリクエストを送ることで、その会員Nが本来閲覧できないはずのキャンペーンへのリンクが表示され、さらに、リンクをたどってそのキャンペーンに申し込むことが可能であった。正常なリクエストとそのレスポンスを図5に、脆弱性を検出するのに使ったリクエストとそのレスポンスを図6に示す。\n\n**図5 正常なリクエストとそのレスポンス**\n```text\n[リクエスト]\nPOST /campaignSearch HTTP/1.1\nHost: site-n.▲▲▲▲.jp\nCookie: JSESSIONID=KCRQ88ERH2G8MGT319E50SMOAJFDIVEM\ngroup_code=0001&keyword=new\n\n[レスポンス]\n<html>\n(省略)\n<h1>申込み可能キャンペーン</h1>\n<a href=\"/a_campaign1\">1 A社キャンペーン1</a>\n<a href=\"/a_campaign2\">2 A社キャンペーン2</a>\n<h1>注意事項</h1>\n(省略)\n```\n注記1 リクエストヘッダ部分は、設問に必要なものだけ記載している。\n注記2 レスポンスは、レスポンスボディから記載している。\n\n**図6 脆弱性を検出するのに使ったリクエストとそのレスポンス**\n```text\n[リクエスト]\nPOST /campaignSearch HTTP/1.1\nHost: site-n.▲▲▲▲.jp\nCookie: JSESSIONID=KCRQ88ERH2G8MGT319E50SMOAJFDIVEM\nkeyword=new\n\n[レスポンス]\n<html>\n(省略)\n<h1>申込み可能キャンペーン</h1>\n<a href=\"/a_campaign1\">1 A社キャンペーン1</a>\n<a href=\"/a_campaign2\">2 A社キャンペーン2</a>\n<a href=\"/b_campaign1\">3 B社キャンペーン1</a>\n<a href=\"/c_campaign1\">4 C社キャンペーン1</a>\n(省略)\n<a href=\"/z_campaign2\">30 Z社キャンペーン2</a>\n<h1>注意事項</h1>\n(省略)\n```\n注記1 リクエストヘッダ部分は、設問に必要なものだけ記載している。\n注記2 レスポンスは、レスポンスボディから記載している。\n\n開発部Nは、サイトNへ送られてきたリクエスト中の [ e ] から、ログインしている会員Nを特定し、その会員Nが所属しているグループが [ f ] の値と一致するかを検証するように、ソースコードを修正することにした。\n\n開発部Nは、B社の支援によって対応を終えることができたが、B社へ頻繁に問い合わせることになった結果、B社のサポート費用が高額になった。サポート費用をどう抑えるかが課題として残った。\n\n### フェーズ6:A社グループの診断手順の制定\nZさんは、フェーズ5の診断で残った二つの課題についての対策を検討し、グループ各社から同意を得た上で、A社グループの診断手順を完成させた。\n\nセキュリティ推進部は、制定したA社グループの診断手順をグループ各社に展開した。\n",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "表2中の下線①について、別の方法を,30字以内で答えよ。",
      "explanation": "### 解説\n下線①は、手動登録機能を利用する際、「Webサイトの全てのURLを診断対象とする場合, 診断対象 URL を別の方法で調べる必要がある」という点です。これは、手動でたどったり、自動で探査しても見つけられないURLが存在するためです。これらの隠れたURLを確実に発見するためには、開発時に作成されたURLリストや、アプリケーションのソースコード、設定ファイルなどを参照するのが最も確実です。\n\n**解答:** 開発部門からWebサイトの構成情報を入手し、診断対象URLの一覧を取得する。(30字)",
      "subQuestions": [],
      "point": 8
    },
    {
      "subQNo": "設問2",
      "text": "〔フェーズ3:ZさんとB社での診断の実施と結果比較〕について答えよ。",
      "explanation": "### 解説\n#### (1) SQLインジェクション検出のペイロード\nSQLインジェクションの検出は、特定のキーワード（keyword）に対して、SQL構文を操作する特殊文字や論理演算子を挿入し、検索結果数の変化（True/False）を比較することで行われます。\n\nB社は、ベースライン `keyword=manual` (10件) に対して、\n1.  `keyword=manual'` (0件): SQL構文エラーにより失敗。\n2.  `keyword=manual [ a ]` (10件): True条件の注入により成功し、ベースラインと同じ結果件数を返す。\n3.  `keyword=manual [ b ]` (0件): False条件の注入により失敗し、結果件数を返さない。\n\nこのTrue/Falseテストが成り立つには、`[ a ]`がTrue、`[ b ]`がFalseとなるペイロードでなければなりません。キーワードがシングルクォートで囲まれてSQLに組み込まれると仮定すると、`'`で既存のクォートを閉じ、`AND`を使って論理式を追加します。\n\n-   True条件: `' and 'a'='a` (ア)\n-   False条件: `' and 'a'='b` (イ)\n\n**解答:** a: ア, b: イ\n\n#### (2) XSS検出に必要な機能\nZさんは、入力したスクリプトが2画面先の応答で出力されるXSSを見逃しました。DASTツールが脆弱性を検出するためには、入力が発生したURLだけでなく、その影響が発現する後のURLの応答も判定対象にする必要があります。\n\n図1の仕様 (2-3)「診断対象 URLの拡張機能」は、「診断対象 URL の応答だけでなく、別の URL の応答も判定対象になる」機能であり、これが必要な要件を満たします。\n\n**解答:** (2-3)\n\n#### (3) XSS検出の設定内容\n検出できなかったXSSは、アンケート入力1の画面での入力が、2画面先のアンケート確認の画面でエスケープされずに出力されていました。したがって、ツールVの診断対象に、アンケート確認の画面の応答を含める設定が必要です。\n\n**解答:** 診断対象URLの拡張機能により、アンケート入力1から遷移するアンケート確認のURLを判定対象に追加登録する。(60字)\n\n#### (4) SQLi検出のための初期値\nZさんの診断が失敗した原因は、初期値`xyz`を使った場合、ベースラインの検索結果も0件だったため、SQLiペイロードを送信しても結果が0件であり、脆弱性による0件なのか、単なる検索結果の不一致による0件なのか判別できなかったことです。\n\nSQLインジェクションを検出するためには、ベースラインとなる検索が成功し、かつ、そのベースラインの件数と比較できることが必要です。\n\n**解答:** 検索対象となるトピックが存在し、診断時のベースラインリクエスト実行において、検索結果が0件ではない件数を返す値であること。(40字)",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "表3中及び本文中の [ a ] , [ b ] に入れる適切な字句を、解答群の中から選び、記号で答えよ。\n解答群\nア ' and 'a' =' a\nイ ' and 'a' =' b\nウ ' and 'a' =' b\nエ and 1=0\nオ and 1=1",
          "point": 8
        },
        {
          "label": "(2)",
          "text": "本文中の [ c ] に入れる適切な機能を、図1中の(1-1)〜(8-1)から選び答えよ。",
          "point": 8
        },
        {
          "label": "(3)",
          "text": "本文中の下線②について,どのような設定が必要か。設定の内容を、図2中の画面名を用いて60字以内で答えよ。",
          "point": 8
        },
        {
          "label": "(4)",
          "text": "本文中の下線③について, keyword の初期値をどのような値に設定する必要があるか。初期値が満たすべき条件を、40字以内で具体的に答えよ。",
          "point": 8
        }
      ]
    },
    {
      "subQNo": "設問3",
      "text": "〔フェーズ5:診断手順案に従った診断の実施〕について答えよ。",
      "explanation": "### 解説\n#### (1) URLが登録されなかった画面名\n自動登録機能はリンクやフォームをたどりますが、JavaScriptで動的に生成されるURLや、外部の手段（メールなど）でアクセスされるURLは登録が漏れる場合があります。\n\n1.  **ウ 検索結果**: 図4注記4により、検索結果画面への遷移URLはJavaScriptで動的に生成されるため、自動登録では漏れる可能性が高い。\n2.  **エ 新規会員情報入力**: この画面は、電子メールで送付された登録URLにアクセスすることで到達するため（図4注記2）、トップページからの自動探査ではたどり着けず、登録が漏れる。\n\nア（会員情報変更入力）とイ（キャンペーン申込み）は、ログイン後のトップページから静的なリンクで到達可能であるため、通常は登録されます。\n\n**解答:** ウ, エ\n\n#### (2) エラーになってしまう理由\n下線⑤は、特定パラメータが同じ値だと複数回リクエスト送信でエラーになり遷移できないというY氏からの指摘です。これは、サーバー側でリソースの利用回数を制限している場合や、CSRF対策などで一時的なトークンを利用している場合に発生しやすいです。\n\n1.  **キャンペーン申込み**: 図4注記1により、会員Nは一つのキャンペーンに1回しか申込みできません。診断ツールがこれを繰り返すと拒否されます。\n2.  **会員情報変更確認**: 確認画面(B)から完了画面(C)への遷移は、通常、一意なトランザクションIDやトークンが使われます。ツールがこれを繰り返し再送すると、サーバーが既に処理済みとして拒否します。\n\n**1組目:**\n画面遷移: イ (キャンペーン申込み)\n理由: 会員Nが1回しか申込みできないキャンペーンに診断ツールが繰り返し申込みを行うため。(40字)\n\n**2組目:**\n画面遷移: B (会員情報変更確認)\n理由: 会員情報変更完了へのリクエストが、一度きり有効なパラメータの再利用で拒否されるため。(40字)",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の下線④について、URLが登録されなかった画面名を、解答群の中から全て選び、記号で答えよ。\n解答群\nア 会員情報変更入力\nイ キャンペーン申込み\nウ 検索結果\nエ 新規会員情報入力",
          "point": 8
        },
        {
          "label": "(2)",
          "text": "本文中の下線⑤について、該当する画面遷移とエラーになってしまう理由を2組み挙げ、画面遷移は図4中の(A)〜(E)から選び、理由は40字以内で答えよ。",
          "point": 8
        }
      ]
    },
    {
      "subQNo": "設問4",
      "text": "〔XSS〕について答えよ。",
      "explanation": "### 解説\n#### (1) HttpOnly属性による防御\n開発部Nは、`cookie`に`HttpOnly`属性が付いているため、XSSによって`[ d ]`が禁止されると説明しました。`HttpOnly`は、クライアントサイドのスクリプトからCookieへのアクセスを防ぐための属性です。\n\n**解答:** JavaScriptによるcookieの読み出し (22字)\n\n#### (2) cookie以外の情報を盗む攻撃の手口\nXSSが成功した場合、`HttpOnly`によってCookieが保護されていても、攻撃者はJavaScriptを用いてDOMを操作・読み取りすることが可能です。これにより、画面に表示されている機密情報や、ユーザーが入力中のデータを窃取できます。\n\n**解答:** XSSにより、ユーザーの画面表示内容や入力途中の情報などをJavaScriptで読み取り、外部へ送信する。(40字)",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の [ d ] に入れる適切な字句を、30字以内で答えよ。",
          "point": 8
        },
        {
          "label": "(2)",
          "text": "本文中の下線⑥について、攻撃の手口を、40字以内で答えよ。",
          "point": 8
        }
      ]
    },
    {
      "subQNo": "設問5",
      "text": "〔アクセス制御の回避〕について答えよ。",
      "explanation": "### 解説\n#### (1) リクエストの内容\n正常なリクエスト（図5）は、会員NのグループIDである`group_code=0001`を含んでおり、A社キャンペーンのみが表示されます。脆弱性を検出したリクエスト（図6）は、`group_code`パラメータ自体がリクエストボディから削除されていますが、本来閲覧できないはずのキャンペーンが表示されました。\n\n**解答:** リクエストボディから会員の所属グループを識別するためのパラメータ group_code を削除する。(30字)\n\n#### (2) パラメータ名\n修正後のソースコードは、リクエスト中の`[ e ]`から会員Nを特定し、会員Nが所属しているグループが`[ f ]`の値と一致するかを検証します。\n\n1.  会員Nの特定は、リクエストに含まれるセッションID（`JSESSIONID`）によって行われます。したがって、`[ e ]`は`JSESSIONID`です。\n2.  検証対象は、会員Nの所属グループと、リクエストで指定されたグループフィルタのパラメータの値です。このグループ識別パラメータは`group_code`です。\n\n**解答:** e: JSESSIONID, f: group_code",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の下線⑦について、リクエストの内容を,30 字以内で具体的に答えよ。",
          "point": 7
        },
        {
          "label": "(2)",
          "text": "本文中の [ e ] , [ f ] に入れる適切なパラメータ名を、図5中から選び、それぞれ15字以内で答えよ。",
          "point": 7
        }
      ]
    },
    {
      "subQNo": "設問6",
      "text": "〔フェーズ6:A社グループの診断手順の制定〕について答えよ。",
      "explanation": "### 解説\n#### (1) 診断開始までの時間の課題\nフェーズ5において、サイトNの診断情報（URL、アカウントなど）が一元管理されていなかったため、確認に1週間を要しました。A社ではWebサイト立ち上げ時に資産管理システムへの登録を必須としています。この管理策を利用し、診断に必要な情報を事前に登録するように手順を強化します。\n\n**解答:** Webサイトの立ち上げ時に、診断に必要な情報を資産管理システムへ登録する手順を必須化する。(40字)\n\n#### (2) B社サポート費用削減の課題\nB社へのサポート費用が高額になった原因は、開発者からの問い合わせがB社へ頻繁に行われたためです。これを削減するには、セキュリティ推進部（Zさんのチーム）が開発者とB社の間に立ち、問い合わせの一次対応や、診断結果の分析を行う必要があります。これにより、B社へエスカレーションするチケット数を削減できます。\n\n**解答:** セキュリティ推進部が診断結果の偽陽性判断や、リスク及び対策に関する問い合わせの一次対応を担う手順を設ける。(50字)",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "診断開始までに要する時間の課題について、A社で取り入れている管理策を参考にした対策を、40字以内で具体的に答えよ。",
          "point": 7
        },
        {
          "label": "(2)",
          "text": "B社のサポート費用の課題について、B社に対して同じ問合せを行わず、問合せ件数を削減するために、A社グループではどのような対策を実施すべきか。セキュアコーディング規約の必須化や開発者への教育以外で、実施すべき対策を,50字以内で具体的に答えよ。",
          "point": 7
        }
      ]
    }
  ]
}