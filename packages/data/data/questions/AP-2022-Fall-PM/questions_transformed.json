{
  "questions": [
    {
      "qNo": 1,
      "theme": "ネットワーク構成とセキュリティ対策",
      "description": "P社のネットワーク構成図に基づき、現在のセキュリティ対策（ファイアウォール、メールセキュリティ、パッチ管理、DNS対策）に関する現状分析と、関連する攻撃手法について問う問題。",
      "context": {
        "title": "P社のネットワーク構成とセキュリティ対策の評価",
        "background": "P社は、企業ネットワークのセキュリティ強化策を検討している。現在のネットワーク構成は{{diagram:fig1}}のとおりであり、以下のセキュリティ対策を導入済みである。\n\n### セキュリティ対策の現状\n\n1.  **ファイアウォール (FW)**: インターネットと DMZ 間及び内部 LAN と DMZ 間で業務に必要な通信だけを許可し、通信ログ及び遮断ログを取得する機器として、[ a ]を設置している。\n2.  **メールセキュリティ**: DMZ内にメール中継サーバ（MCS）を設置し、SPF (Sender Policy Framework) 機能によって送信元ドメイン送信元メールアドレスがなりすまされた電子メールを隔離する対策を、[ b ]に適用している。（注2）\n3.  **パッチ管理**: PC向けのOSパッチやマルウェア定義ファイルをダウンロードし、PCが電源投入時にアクセスして更新処理を行う機器として、[ c ]を設置している。\n4.  **DNS対策**: 外部DNSサーバを[ ①DDoS ]の踏み台とする攻撃への対策を実施している。\n\n注1: 配布サーバは、PCにセキュリティパッチなどを配布するサーバである。\n注2: P社のネットワーク構成図は{{diagram:fig1}}のとおりである。DNSリフレクション攻撃のシーケンスについては、{{diagram:fig_dns_reflection}}を参照。\n\nこの設問の元となる本文（下線②、③、④の具体的な記述）は提供されていません。設問内容はマルウェアXのネットワーク探索動作（ホスト稼働状態確認、ポートスキャン）と、感染したPCからの送信メールがSPFで検出されない理由に関するものです。",
        "diagrams": [
          {
            "id": "fig1",
            "label": "P社のネットワーク構成図",
            "type": "image",
            "content": "（本文中で参照されているが、図の具体的な内容は提供されていないため、画像として扱います。DMZ内にメール中継サーバや配布サーバが設置され、FWによって内部LANとDMZが分離されている構成が想定されます。）"
          },
          {
            "id": "fig_dns_reflection",
            "label": "DNSリフレクション攻撃シーケンス",
            "type": "mermaid",
            "content": "sequenceDiagram\n    actor Attacker\n    participant DNS_Server\n    participant Victim\n    Attacker->>DNS_Server: 偽装送信元IP(Victim)で問合せ\n    Note right of Attacker: 問合せを大量送信\n    DNS_Server->>Victim: 大量応答パケット\n    Note right of Victim: 帯域を圧迫"
          }
        ]
      },
      "questions": [
        {
          "subQNo": "設問1",
          "text": "[セキュリティ対策の現状]について答えよ。",
          "references": [
            "fig1"
          ],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の[ a ]～[ c ]に入れる適切な機器を、解答群の中から選び記号で答えよ。\n解答群\nア FW\nイ L2SW\nウ L3SW\nエ 外部 DNS サーバ\nオ 検証用サーバ\nカ 社内メールサーバ\nキ 内部 DNS サーバ\nク 配布サーバ\nケ メール中継サーバ",
              "answer": "a: ア, b: ケ, c: ク",
              "explanation": "### 設問1(1) 解説\n\n*   **空欄[ a ]**: 「インターネットと DMZ 間及び内部 LAN と DMZ 間で業務に必要な通信だけを許可し、通信ログ及び遮断ログを取得する」機能を持つ機器は、パケットフィルタリングやアクセス制御を行う**ファイアウォール（FW）**です。したがって、アが該当します。\n*   **空欄[ b ]**: 「SPF (Sender Policy Framework) 機能によって送信元ドメイン送信元メールアドレスがなりすまされた電子メールを隔離する」のは、**メール中継サーバ**または**社内メールサーバ**に実装される機能です。P社のネットワーク構成図（図1）を見ると、DMZ内にメール中継サーバ（MCS）があり、メールはこのサーバを経由して内部に入ります。SPFは通常、外部からのメールが最初に到達するメールゲートウェイ（メール中継サーバなど）で実施されます。したがって、ケ（メール中継サーバ）が適切です。\n*   **空欄[ c ]**: PC向けのOSパッチやマルウェア定義ファイルをダウンロードし、PCが電源投入時にアクセスして更新処理を行う機器です。本文の注記1に「配布サーバは、PCにセキュリティパッチなどを配布するサーバである」とあるため、ク（配布サーバ）が該当します。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線①の攻撃名を、解答群の中から選び記号で答えよ。\n解答群\nア DNS リフレクション攻撃\nイ セッションハイジャック攻撃\nウ メール不正中継攻撃",
              "answer": "ア",
              "explanation": "### 設問1(2) 解説\n\n下線①は「外部DNSサーバを[ ①DDoS ]の踏み台とする攻撃への対策」です。DNSサーバの機能を悪用し、大量の応答パケットを送りつけるDDoS攻撃は、**DNSリフレクション攻撃**（DNS反射攻撃）と呼ばれます。\n\n解答群より、ア「DNS リフレクション攻撃」が適切です。"
            }
          ],
          "point": 33
        },
        {
          "subQNo": "設問2",
          "text": "[マルウェアXの調査]について答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線②の処理によって取得できる情報を、20字以内で答えよ。",
              "answer": "ホストの稼働状態",
              "explanation": "下線②は、マルウェアXがICMPエコー要求パケット（Ping）を連続送信し、ホストアドレスからの応答を確認する処理です。これは、そのアドレスに存在するホストが現在ネットワーク上で起動し、通信可能であるか（稼働状態にあるか）を調査するためです。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線③の処理を行う目的を、解答群の中から選び記号で答えよ。\n解答群\nア DoS攻撃を行うため\nイ 稼働中のOSのバージョンを知るため\nウ 攻撃対象のサービスの稼働状態を知るため\nエ ホストの稼働状態を知るため",
              "answer": "ウ",
              "explanation": "下線③は、(a)で取得した稼働中のホストに対して、TCPのSYNパケットを特定のポート番号で送信し、応答内容（SYN/ACK）を確認する処理です。これは、そのホストの特定ポートで何らかのサービス（アプリケーション）が動いているか、つまりサービスの稼働状態を確認する、**ポートスキャン**の動作です。マルウェアXは、この情報をもとに(c)で脆弱性を悪用して窃取を試みるため、目的はウ「攻撃対象のサービスの稼働状態を知るため」です。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線④について、発見できない理由として最も適切なものを解答群の中から選び、記号で答えよ。\n解答群\nア 送信者のドメインが詐称されたものでないから\nイ 添付ファイルが暗号化されているので、チェックできないから\nウ メールに付与された署名が正規のドメインで生成されたものだから\nエ メール本文に不審な箇所がないから",
              "answer": "ア",
              "explanation": "下線④は、マルウェアXに感染した社外PCから送られたメールが、SPF機能によってなりすましとして発見されなかった理由を問いています。\n\nSPFは、メールのエンベロープFromアドレスのドメインに対し、そのメールを送信したサーバのIPアドレスが、あらかじめドメイン管理者が許可したIPアドレスリストに含まれているかを確認する仕組みです。感染したPCが正規の取引先のPCである場合、そのPCのメールは、その取引先の正規のメールサーバを経由して送られることが多いため、SPFチェックは通過してしまいます。\n\nSPFは、送信元ドメインの詐称を検出する機能であるため、感染した正規のPCから送られた場合、ドメイン自体は詐称されていないため、SPFは機能しません。\n\n解答群より、ア「送信者のドメインが詐称されたものでないから」が最も適切です。"
            }
          ],
          "point": 33
        },
        {
          "subQNo": "設問3",
          "text": "[マルウェアXへの対応策]について答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線⑤について、どのような事象を検知した場合に、マルウェアXの侵入を疑うことができるのかを、25字以内で答えよ。",
              "answer": "ICMPエコー要求パケットやTCPのSYNパケットを送信する活動",
              "explanation": "下線⑤は、マルウェアXの活動(a)～(c)を検知する条件です。活動(a)はICMPエコー要求パケットの連続送信（ホスト探索）、活動(b)はTCP SYNパケットの送信（ポートスキャン）です。これらの活動は、通常の業務PCでは行わない不正なネットワーク探索行為にあたるため、これらを検知することで侵入を疑うことができます。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線⑥について、緊急措置の内容を25字以内で答えよ。",
              "answer": "内部ネットワークの探索を防ぐなどの緊急措置",
              "explanation": "下線⑥は「内部ネットワークの探索を防ぐ」ための緊急措置です。侵入後の感染拡大や情報窃取を防ぐためには、マルウェアに感染したPCをネットワークから隔離することが最も効果的です。"
            },
            {
              "label": "(3)",
              "text": "EDR導入後にマルウェア X の被害が発生したとき、被害内容を早期に明らかにするために実施すべきことは何か。本文中の字句を用いて 20 字以内で答えよ。",
              "answer": "エージェントから受信したログの保存、分析",
              "explanation": "EDR導入の目的の一つは「被害内容の把握」です。EDRの機能概要によると、管理サーバはエージェントから受信したログ（コマンド、通信内容、ファイル操作など）を保存・分析し、可視化する機能を持っています。被害内容を早期に明らかにするためには、これらのログを利用します。"
            }
          ],
          "point": 33
        }
      ]
    }
  ]
}