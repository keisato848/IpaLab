{
  "qNo": 1,
  "theme": "情報セキュリティ / マルウェアへの対応策",
  "description": "P社は、従業員数400名のIT関連製品の卸売会社であり、300社の販売代理店をもっている。P社では、販売代理店向けに、インターネット経由で商品情報の提供、見積書の作成を行う代理店サーバを運用している。また、従業員向けに、代理店ごとの卸価格や担当者の情報を管理する顧客サーバを運用している。代理店サーバ及び顧客サーバには,HTTP Over TLSでアクセスする。\nP社のネットワークの運用及び情報セキュリティインシデント対応は、情報システム部(以下,システム部という)の運用グループが行っている。\n\n## 図1 P社のネットワーク構成\n\n```mermaid\ngraph TD\n    Internet[インターネット] --> FW(FW)\n    FW --> DMZ\n    FW --> L3SW(L3SW)\n\n    subgraph DMZ\n        L2SW_DMZ(L2SW)\n        ADNS_Out[外部 DNS サーバ] --> L2SW_DMZ\n        MCS[メール中継 サーバ] --> L2SW_DMZ\n        AS[代理店 サーバ] --> L2SW_DMZ\n        PS[プロキシ サーバ] --> L2SW_DMZ\n    end\n\n    L2SW_DMZ --> FW\n\n    subgraph P社内部\n        L3SW --> PDNS[内部 DNS サーバ]\n        L3SW --> IMS[社内メール サーバ]\n        L3SW --> CS[顧客 サーバ]\n        L3SW --> DS[配布 サーバ]\n\n        subgraph 内部LAN\n            L2SW_In[L2SW]\n            L3SW --> L2SW_In\n            L2SW_In --> PC1(PC)\n            L2SW_In --> PC2(PC)\n        end\n\n        subgraph 検証LAN\n            L2SW_V[L2SW]\n            L3SW --> L2SW_V\n            L2SW_V --> VS[検証用 サーバ]\n            L2SW_V --> VPC[検証用 PC]\n        end\n    end\n    \n    L2SW_DMZ <--> L3SW\n\n    note for FW: FW: ファイアウォール\n    note for L2SW_DMZ: L2SW: レイヤー2スイッチ\n    note for L3SW: L3SW: レイヤー3スイッチ\n```\n\n## セキュリティ対策の現状\nP社では、複数のサーバ、PC及びネットワーク機器を運用しており、それらには次のセキュリティ対策を実施している。\n・[ a ]では、インターネットと DMZ 間及び内部 LAN と DMZ 間で業務に必要な通信だけを許可し、通信ログ及び遮断ログを取得する。\n・[ b ]では、SPF (Sender Policy Framework) 機能によって送信元ドメイン送信元メールアドレスがなりすまされた電子メール(以下,電子メールをメールという)を隔離する。\n・外部 DNS サーバでは、DMZのゾーン情報の管理のほかに、キャッシュサーバの機能を稼働させており、外部DNSサーバを[ ①DDoS ]の踏み台とする攻撃への対策を行う。\n・P社からインターネット上の Web サーバへのアクセスは、DMZ のプロキシサーバを経由し、プロキシサーバでは、通信ログを取得する。\n・PC 及びサーバで稼働するマルウェア対策ソフトは,毎日、決められた時刻にベンダーの Web サイトをチェックし、マルウェア定義ファイルが新たに登録されている場合は、ダウンロードして更新する。\n・システム部の担当者は、毎日、ベンダーの Web サイトをチェックし、OS のセキュリティパッチやアップデート版の有無を確認する。最新版が更新されている場合は,ダウンロードして検証 LANで動作確認を1週間程度行う。動作に問題がなければ、PC向けのもの は[ c ]に登録し、サーバ向けのもの は、休日に担当者が各サーバに対して更新作業を行う。\n・PCは、電源投入時に[ c ]にアクセスし、更新が必要な新しい版が登録されている場合は、ダウンロードして更新処理を行う。\n・FW 及びプロキシサーバのログの検査は、担当者が週に1回実施する。\n\n## マルウェアXの調査\nある日、システム部のQ課長は、マルウェアXの被害が社外で多発していることを知り、R主任にマルウェアXの調査を指示した。R主任による調査結果を次に示す。\n(1) 攻撃者は、不正なマクロを含む文書ファイル(以下、マクロ付き文書ファイルAという)をメールに添付して送信する。\n(2) 受信者が、添付されたマクロ付き文書ファイル A を開きマクロを実行させると,マルウェアへの指令や不正アクセスの制御を行うインターネット上のC&Cサーバと通信が行われ、マルウェアXの本体がダウンロードされる。\n(3) PC に侵入したマルウェアXは、内部ネットワークの探索,情報の窃取,窃取した情報のC&Cサーバへの送信及び感染拡大を、次の(a)～(d)の手順で試みる。\n(a) [ ②PC ]が接続するセグメント及び社内の他のセグメントの全てのホストアドレス宛てに、宛先アドレスを変えながら ICMP エコー要求パケットを送信し、連続してホストの情報を取得する。\n(b) [ ③(a) ]によって情報を取得できたホストに対して、攻撃対象のポート番号をセットした TCPのSYN パケットを送信し、応答内容を確認する。\n(c) (b)で SYN/ACK の応答があった場合、指定したポート番号のサービスの脆弱性を悪用して個人情報や秘密情報などを窃取し、C&Cサーバに送信する。\n(d) 侵入した PC に保存されている過去にやり取りされたメールを悪用し、当該PC 上でマクロ付き文書ファイルAを添付した返信メールを作成し、このメールを取引先などに送信して感染拡大を試みる。\n\nR主任が調査結果をQ課長に報告したときの、2人の会話を次に示す。\nQ課長:マルウェアXに対して、現在の対策で十分だろうか。\nR主任:十分ではないと考えます。文書ファイルに組み込まれたマクロは、容易に処理内容が分析できない構造になっており、マルウェア対策ソフトでは発見できない場合があります。また、[ ④マルウェア X ]に感染した社外のPCから送られてきたメールは、SPF 機能ではなりすましが発見できません。\nQ課長:それでは、マルウェアXに対する有効な対策を考えてくれないか。\nR主任:分かりました。セキュリティサービス会社のS社に相談してみます。\n\n## マルウェアXへの対応策\nR主任は、現在のセキュリティ対策の内容をS社に説明し、マルウェアXに対する対応策の提案を求めた。S社から、セキュリティパッチの適用やログの検査が迅速に行われていないという問題が指摘され、マルウェアX侵入の早期発見、侵入後の活動の抑止及び被害内容の把握を目的として, EDR (Endpoint Detection and Response)システム(以下, EDR という)の導入を提案された。\nS社が提案したEDR の構成と機能概要を次に示す。\n・EDRは、管理サーバ、及びPCに導入するエージェントから構成される。\n・管理サーバは,エージェントの設定、エージェントから受信したログの保存、分析及び分析結果の可視化などの機能をもつ。\n・エージェントは、次の(i), (ii)の処理を行うことができる。\n(i) PC で実行されたコマンド、通信内容,ファイル操作などのイベントのログを管理サーバに送信する。\n(ii) PCのプロセスを監視し、あらかじめ設定した条件に合致した動作が行われたことを検知した場合に、設定した対応策を実施する。例えば、EDR は, (a)～(c)に示した[ ⑤マルウェア X の活動 ]を検知した場合に、[ ⑥内部ネットワークの探索を防ぐ ]などの緊急措置をPCに対して実施することができる。\nR主任は、S社の提案を基に、マルウェアXの侵入時の対応策をまとめ、Q課長にEDR の導入を提案した。提案内容は承認され, EDR の導入が決定した。\n",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "[セキュリティ対策の現状]について答えよ。\n(1) 本文中の[ a ]～[ c ]に入れる適切な機器を、解答群の中から選び記号で答えよ。\n解答群\nア FW\nイ L2SW\nウ L3SW\nエ 外部 DNS サーバ\nオ 検証用サーバ\nカ 社内メールサーバ\nキ 内部 DNS サーバ\nク 配布サーバ\nケ メール中継サーバ\n(2) 本文中の下線①の攻撃名を、解答群の中から選び記号で答えよ。\n解答群\nア DNS リフレクション攻撃\nイ セッションハイジャック攻撃\nウ メール不正中継攻撃",
      "explanation": "### 設問1(1) 解説\n\n*   **空欄[ a ]**: 「インターネットと DMZ 間及び内部 LAN と DMZ 間で業務に必要な通信だけを許可し、通信ログ及び遮断ログを取得する」機能を持つ機器は、パケットフィルタリングやアクセス制御を行う**ファイアウォール（FW）**です。したがって、アが該当します。\n*   **空欄[ b ]**: 「SPF (Sender Policy Framework) 機能によって送信元ドメイン送信元メールアドレスがなりすまされた電子メールを隔離する」のは、**メール中継サーバ**または**社内メールサーバ**に実装される機能です。P社のネットワーク構成図（図1）を見ると、DMZ内にメール中継サーバ（MCS）があり、メールはこのサーバを経由して内部に入ります。SPFは通常、外部からのメールが最初に到達するメールゲートウェイ（メール中継サーバなど）で実施されます。したがって、ケ（メール中継サーバ）が適切です。\n*   **空欄[ c ]**: PC向けのOSパッチやマルウェア定義ファイルをダウンロードし、PCが電源投入時にアクセスして更新処理を行う機器です。本文の注記1に「配布サーバは、PCにセキュリティパッチなどを配布するサーバである」とあるため、ク（配布サーバ）が該当します。\n\n### 設問1(2) 解説\n\n下線①は「外部DNSサーバを[ ①DDoS ]の踏み台とする攻撃への対策」です。DNSサーバの機能を悪用し、大量の応答パケットを送りつけるDDoS攻撃は、**DNSリフレクション攻撃**（DNS反射攻撃）と呼ばれます。\n\n```mermaid\nsequenceDiagram\n    actor Attacker\n    participant DNS_Server\n    participant Victim\n    Attacker->>DNS_Server: 偽装送信元IP(Victim)で問合せ\n    Note right of Attacker: 問合せを大量送信\n    DNS_Server->>Victim: 大量応答パケット\n    Note right of Victim: 帯域を圧迫\n```\n\n解答群より、ア「DNS リフレクション攻撃」が適切です。",
      "subQuestions": [
        {
          "label": "(1)",
          "answer": "a: ア, b: ケ, c: ク",
          "point": 13
        },
        {
          "label": "(2)",
          "answer": "ア",
          "point": 13
        }
      ],
      "subCategory": "その他"
    },
    {
      "subQNo": "設問2",
      "text": "[マルウェアXの調査]について答えよ。\n(1) 本文中の下線②の処理によって取得できる情報を、20字以内で答えよ。\n(2) 本文中の下線③の処理を行う目的を、解答群の中から選び記号で答えよ。\n解答群\nア DoS攻撃を行うため\nイ 稼働中のOSのバージョンを知るため\nウ 攻撃対象のサービスの稼働状態を知るため\nエ ホストの稼働状態を知るため\n(3) 本文中の下線④について、発見できない理由として最も適切なものを解答群の中から選び、記号で答えよ。\n解答群\nア 送信者のドメインが詐称されたものでないから\nイ 添付ファイルが暗号化されているので、チェックできないから\nウ メールに付与された署名が正規のドメインで生成されたものだから\nエ メール本文に不審な箇所がないから",
      "explanation": "### 設問2(1) 解説\n\n下線②は、マルウェアXがICMPエコー要求パケット（Ping）を連続送信し、ホストアドレスからの応答を確認する処理です。これは、そのアドレスに存在するホストが現在ネットワーク上で起動し、通信可能であるか（稼働状態にあるか）を調査するためです。\n\n*   解答: ホストの稼働状態\n\n### 設問2(2) 解説\n\n下線③は、(a)で取得した稼働中のホストに対して、TCPのSYNパケットを特定のポート番号で送信し、応答内容（SYN/ACK）を確認する処理です。これは、そのホストの特定ポートで何らかのサービス（アプリケーション）が動いているか、つまりサービスの稼働状態を確認する、**ポートスキャン**の動作です。マルウェアXは、この情報をもとに(c)で脆弱性を悪用して窃取を試みるため、目的はウ「攻撃対象のサービスの稼働状態を知るため」です。\n\n### 設問2(3) 解説\n\n下線④は、マルウェアXに感染した社外PCから送られたメールが、SPF機能によってなりすましとして発見されなかった理由を問いています。\n\nSPFは、メールのエンベロープFromアドレスのドメインに対し、そのメールを送信したサーバのIPアドレスが、あらかじめドメイン管理者が許可したIPアドレスリストに含まれているかを確認する仕組みです。感染したPCが正規の取引先のPCである場合、そのPCのメールは、その取引先の正規のメールサーバを経由して送られることが多いため、SPFチェックは通過してしまいます。\n\nSPFは、送信元ドメインの詐称を検出する機能であるため、感染した正規のPCから送られた場合、ドメイン自体は詐称されていないため、SPFは機能しません。\n\n解答群より、ア「送信者のドメインが詐称されたものでないから」が最も適切です。",
      "subQuestions": [
        {
          "label": "(1)",
          "answer": "ホストの稼働状態",
          "point": 13
        },
        {
          "label": "(2)",
          "answer": "ウ",
          "point": 13
        },
        {
          "label": "(3)",
          "answer": "ア",
          "point": 12
        }
      ],
      "subCategory": "その他"
    },
    {
      "subQNo": "設問3",
      "text": "[マルウェアXへの対応策]について答えよ。\n(1) 本文中の下線⑤について、どのような事象を検知した場合に、マルウェアXの侵入を疑うことができるのかを、25字以内で答えよ。\n(2) 本文中の下線⑥について、緊急措置の内容を25字以内で答えよ。\n(3) EDR導入後にマルウェア X の被害が発生したとき、被害内容を早期に明らかにするために実施すべきことは何か。本文中の字句を用いて 20 字以内で答えよ。",
      "explanation": "### 設問3(1) 解説\n\n下線⑤は、マルウェアXの活動(a)～(c)を検知する条件です。活動(a)はICMPエコー要求パケットの連続送信（ホスト探索）、活動(b)はTCP SYNパケットの送信（ポートスキャン）です。これらの活動は、通常の業務PCでは行わない不正なネットワーク探索行為にあたるため、これらを検知することで侵入を疑うことができます。\n\n*   解答: ICMPエコー要求パケットやTCPのSYNパケットを送信する活動\n\n### 設問3(2) 解説\n\n下線⑥は「内部ネットワークの探索を防ぐ」ための緊急措置です。侵入後の感染拡大や情報窃取を防ぐためには、マルウェアに感染したPCをネットワークから隔離することが最も効果的です。\n\n*   解答: 内部ネットワークの探索を防ぐために感染PCを隔離する措置\n    *   （または、文中の表現をそのまま利用し）内部ネットワークの探索を防ぐなどの緊急措置\n\n### 設問3(3) 解説\n\nEDR導入の目的の一つは「被害内容の把握」です。EDRの機能概要によると、管理サーバはエージェントから受信したログ（コマンド、通信内容、ファイル操作など）を保存・分析し、可視化する機能を持っています。被害内容を早期に明らかにするためには、これらのログを利用します。\n\n*   解答: エージェントから受信したログの保存、分析",
      "subQuestions": [
        {
          "label": "(1)",
          "answer": "ICMPエコー要求パケットやTCPのSYNパケットを送信する活動",
          "point": 12
        },
        {
          "label": "(2)",
          "answer": "内部ネットワークの探索を防ぐなどの緊急措置",
          "point": 12
        },
        {
          "label": "(3)",
          "answer": "エージェントから受信したログの保存、分析",
          "point": 12
        }
      ],
      "subCategory": "その他"
    }
  ]
}