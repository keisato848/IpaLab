{
  "qNo": 1,
  "theme": "Web サイトのセキュリティ",
  "description": "F 社は、日用雑貨を製造・販売する中堅企業である。このたび、販路拡大を目的として自社製品を販売する Web サイト(以下、本システムという)を新規に開発した。本システムは、D社クラウドサービス上に構築しており, Web サーバとデータベース(以下,DB という) サーバから成り、D社クラウドサービスが提供するファイアウォール(以下,FWという) 及び Web アプリケーションファイアウォール(以下,WAF という)を経由してインターネットからアクセスされる予定である。\n本システムの開発環境のネットワーク構成(抜粋)を図1に示す。なお、本システムはリリース前であり、F社開発環境の特定の IP アドレスからだけアクセスできるように FW で制限している。\n\n## 図1 本システムの開発環境のネットワーク構成(抜粋)\n\n```mermaid\ngraph LR\n    subgraph F社開発環境\n        F_PC[PC]\n    end\n    \n    F_PC -- インターネット --> FW[FW]\n    FW --> WAF[WAF]\n    \n    subgraph D社クラウドサービス\n        WAF --> Web_S[Webサーバ]\n        Web_S --> DB_S[DBサーバ]\n    end\n```\n\n本システムの主な仕様を次に示す。\n・会員登録時に自動で発行される会員番号と会員が設定したパスワードをログインフォームに入力してログインする。商品の購入はログイン後に行う。\n・パスワードとして使用できる文字は、英数字に一部の記号を加えた70種類である。\n・パスワードは、6字以上16字以下で設定する。\n・会員テーブルは、会員番号、メールアドレス、パスワードのハッシュ値,姓,名,住所,電話番号の7フィールドで構成されている。①<u>パスワードのハッシュ値</u>は,会員が設定したパスワードをハッシュ関数によってハッシュ化したものである。\n\nF社情報セキュリティ部のG部長は、本システムのリリース前にペネトレーションテストを実施することを決定し,H 主任をリーダーに任命した。H主任は、セキュリティベンダーであるU社に本システムのペネトレーションテストの実施を依頼した。ペネトレーションテストは、U社内のPCからインターネット, FW 及び WAF を経由して本システムにアクセスする経路で実施した。\nペネトレーションテスト期間中は、FW及びWAF に対して次の変更を行った。\n・FWに対する変更\n通信を許可するアクセス元 IP アドレスとして、ペネトレーションテストに用いるU社のIPアドレスを追加する。\n・WAF に対する変更\n攻撃を検知した際には、通信の遮断は行わず、検知したことだけを記録する。\n\n### [ペネトレーションテストの結果]\n\nペネトレーションテストの結果、次の手順(以下、本シナリオという)で会員のパスワードが推測されて、不正にアクセスされてしまうことが確認された。\n1. ②<u>SQL インジェクション攻撃</u>によって会員テーブルのデータを取得する。このとき取得した会員テーブルのデータ(抜粋)を表1に示す。\n2. レインボーテーブル攻撃によって、手順1で取得した会員テーブル中のパスワードのハッシュ値から元のパスワードを推測する。\n3. 推測したパスワードを利用して、会員になりすまして本システムにログインする。\n\n**表1 取得した会員テーブルのデータ (抜粋)**\n\n| 会員番号 | パスワードのハッシュ値 | 姓 | 名 |\n| :--- | :--- | :--- | :--- |\n| 21717202 | 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8 | T中 | T郎 |\n| 21717203 | 2597a7caf656e89e9ab35e12326d557ebfe9b7b5dcbe4c564e74070fa5cfcbe5 | S藤 | H子 |\n| 30781985 | 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8 | S藤 | J郎 |\n| 36150833 | ac9689e2272427085e35b9d3e3e8bed88cb3434828b43b86fc0596cad4c6e270 | S木 | H子 |\n| 45905900 | ac9689e2272427085e35b9d3e3e8bed88cb3434828b43b86fc0596cad4c6e270 | Y田 | J郎 |\n| 45917046 | d82494f05d6917ba02f7aaa29689ccb444bb73f20380876cb05d1f37537b7892 | T中 | T郎 |\n\n稼働中のシステムのログインフォームに対してパスワードを総当たりで試行する [ a ] 攻撃では、システム側で試行回数に制限を設けて対策することができるが、レインボーテーブル攻撃ではそれができない。\n\nH 主任は、本システムの修正方針を整理するために、SQL インジェクション攻撃及びレインボーテーブル攻撃への対策を検討することにした。なお、ペネトレーションテスト期間中に WAF で SQL インジェクション攻撃が検知できていたが、③<u>仮に対策の一つが破られても他の対策で攻撃を防ぐという考え方</u>に基づき、攻撃への対策を WAF だけに頼らず本システム自体でも行うことにした。\n\n### [SQLインジェクション攻撃への対策の検討]\n\n本システムのソースコードを調査したところ、一部の処理で外部からの入力値をそのまま SQL 文に埋め込んでいる箇所が存在していた。そこで、対策として、 [ b ] を利用する方式を採用することにした。この方式では、外部からの入力値が埋め込まれる箇所を専用の記号で置き換えた SQL 文の雛形をあらかじめ作成しておき、専用の記号で置き換えた箇所に DB 管理システム側で外部からの入力値を割り当てる。\n\n### [レインボーテーブル攻撃への対策の検討]\n\n本システムでは会員のパスワードをハッシュ化して保存しているが、パスワードそのものにハッシュ関数を1回適用しただけであったので、レインボーテーブル攻撃に対して脆弱であった。そこで、パスワードをハッシュ化する際に、次の三つの処理を組み合わせて実施することにした。\n\n1. ソルトを用いた処理\n・パスワードをハッシュ化する際に、ソルトを付加した上でハッシュ化する。\n・ソルトとして、会員ごとに異なるランダムな文字列を用意し、会員テーブルに格納する。\n2. ④<u>ペッパーを用いた処理</u>\n・パスワードをハッシュ化する際に、ペッパーを付加した上でハッシュ化する。\n・ペッパーとして、全ての会員に共通のランダムな文字列を用意し, Web サーバ内の外部からアクセスできない安全な領域に格納する。\n3. ストレッチング\n・ハッシュ関数を複数回適用する。\n\nさらに、ハッシュ化処理の変更に加えて、会員が設定可能なパスワード長を10字以上64字以下に変更した。本システムにおいて、パスワード長が10字の場合,6字の場合と比べてパスワードとして使用可能な文字列のパターン数が [ c ] 倍になるのでレインボーテーブル攻撃がより困難になる。\nH主任は、これらの対策を取りまとめてG部長に報告し、承認された。",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "本文中の下線①について、会員のパスワードをハッシュ関数でハッシュ化して保存することは、情報漏えいの脅威に対してメリットがある。それは、ハッシュ値にどのような特性があるからか。25字以内で答えよ。"
    },
    {
      "subQNo": "設問2",
      "text": "本文中の下線②について、会員テーブルのデータが漏えいした場合,情報セキュリティの3要素のどれが直接的に侵害されたといえるか。漢字3字で答えよ。"
    },
    {
      "subQNo": "設問3",
      "text": "本文中の [ a ], [ b ] に入れる適切な字句を解答群の中から選び、記号で答えよ。\n\n解答群\nア エスケープ\nイ 許可リスト\nウ サニタイズ\nエ 中間者\nオ ブルートフォース\nカ プレースホルダ\nキ リプレイ"
    },
    {
      "subQNo": "設問4",
      "text": "本シナリオによって、表1に示す会員テーブルのデータが窃取され、会員番号 “21717202” の会員のパスワードが推測され不正アクセスを受けたとすると、推測されたパスワードを利用して不正アクセスを受けるおそれが最も強い他の会員は誰か。該当する会員の会員番号を解答群の中から選び、記号で答えよ。\n\n解答群\nア 21717203\nイ 30781985\nウ 36150833\nエ 45905900\nオ 45917046"
    },
    {
      "subQNo": "設問5",
      "text": "本文中の下線③の考え方を、漢字4字で答えよ。"
    },
    {
      "subQNo": "設問6",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の下線④について、ペッパーを付加してハッシュ化することで本シナリオにおいてレインボーテーブル攻撃が困難になる理由を、ソルトを用いた処理との違いに着目して35字以内で答えよ。"
        },
        {
          "label": "(2)",
          "text": "本文中の [ c ] に入れる適切な数を、x^yのような指数を用いた表記で答えよ。"
        }
      ]
    }
  ]
}