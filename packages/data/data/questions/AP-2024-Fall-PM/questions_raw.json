{
  "qNo": 1,
  "theme": "情報セキュリティ / Web サイトのセキュリティ",
  "description": "F社は、日用雑貨を製造・販売する中堅企業である。このたび、販路拡大を目的として自社製品を販売する Web サイト(以下、本システムという)を新規に開発した。\n本システムは、D社クラウドサービス上に構築しており, Web サーバとデータベース(以下,DBという) サーバから成り、D社クラウドサービスが提供するファイアウォール(以下,FWという) 及び Web アプリケーションファイアウォール(以下,WAFという)を経由してインターネットからアクセスされる予定である。\n本システムの開発環境のネットワーク構成(抜粋)を図1に示す。なお、本システムはリリース前であり、F社開発環境の特定の IP アドレスからだけアクセスできるようにFWで制限している。\n\n## 図1 本システムの開発環境のネットワーク構成(抜粋)\n```mermaid\ngraph LR\n    subgraph F社開発環境\n        PC_F[PC]\n    end\n    PC_F -- インターネット --> FW\n    subgraph D社クラウドサービス\n        FW --> WAF\n        WAF --> WS(Webサーバ)\n        WS --> DB(DBサーバ)\n        direction LR\n    end\n```\n\n本システムの主な仕様を次に示す。\n・会員登録時に自動で発行される会員番号と会員が設定したパスワードをログインフォームに入力してログインする。商品の購入はログイン後に行う。\n・パスワードとして使用できる文字は、英数字に一部の記号を加えた70種類である。\n・パスワードは、6字以上16字以下で設定する。\n・会員テーブルは、会員番号、メールアドレス、パスワードのハッシュ値,姓,名,住所,電話番号の7フィールドで構成されている。①パスワードのハッシュ値は,会員が設定したパスワードをハッシュ関数によってハッシュ化したものである。\n\nF社情報セキュリティ部のG部長は、本システムのリリース前にペネトレーションテストを実施することを決定し,H 主任をリーダーに任命した。H主任は、セキュリティベンダーであるU社に本システムのペネトレーションテストの実施を依頼した。\nペネトレーションテストは、U社内のPCからインターネット, FW 及び WAF を経由して本システムにアクセスする経路で実施した。\nペネトレーションテスト期間中は、FW及びWAF に対して次の変更を行った。\n\n・FWに対する変更\n通信を許可するアクセス元 IP アドレスとして、ペネトレーションテストに用いる U社のIPアドレスを追加する。\n・WAF に対する変更\n攻撃を検知した際には、通信の遮断はせず、検知したことだけを記録する。\n\n### [ペネトレーションテストの結果]\nペネトレーションテストの結果、次の手順(以下、本シナリオという)で会員のパスワードが推測されて、不正にアクセスされてしまうことが確認された。\n1. ② SQL インジェクション攻撃によって会員テーブルのデータを取得する。このとき取得した会員テーブルのデータ (抜粋)を表1に示す。\n2. レインボーテーブル攻撃によって、手順1で取得した会員テーブル中のパスワードのハッシュ値から元のパスワードを推測する。\n3. 推測したパスワードを利用して、会員になりすまして本システムにログインする。\n\n## 表1 取得した会員テーブルのデータ (抜粋)\n| 会員番号 | パスワードのハッシュ値 | 姓 | 名 |\n| :--- | :--- | :--- | :--- |\n| 21717202 | 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8 | T中 | T郎 |\n| 21717203 | 2597a7caf656e89e9ab35e12326d557ebfe9b7b5dcbe4c564e74070fa5cfcbe5 | S藤 | H子 |\n| 30781985 | 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8 | S藤 | J郎 |\n| 36150833 | ac9689e2272427085e35b9d3e3e8bed88cb3434828b43b86fc0596cad4c6e270 | S木 | H子 |\n| 45905900 | ac9689e2272427085e35b9d3e3e8bed88cb3434828b43b86fc0596cad4c6e270 | Y田 | J郎 |\n| 45917046 | d82494f05d6917ba02f7aaa29689ccb444bb73f20380876cb05d1f37537b7892 | T中 | T郎 |\n\n稼働中のシステムのログインフォームに対してパスワードを総当たりで試行する [ a ] 攻撃では、システム側で試行回数に制限を設けて対策することができるが、レインボーテーブル攻撃ではそれができない。\n\nH 主任は、本システムの修正方針を整理するために、SQL インジェクション攻撃及びレインボーテーブル攻撃への対策を検討することにした。なお、ペネトレーションテスト期間中にWAFでSQLインジェクション攻撃が検知できていたが、③仮に対策の一つが破られても他の対策で攻撃を防ぐという考え方に基づき、攻撃への対策を WAF だけに頼らず本システム自体でも行うことにした。\n\n### [SQLインジェクション攻撃への対策の検討]\n本システムのソースコードを調査したところ、一部の処理で外部からの入力値をそのまま SQL 文に埋め込んでいる箇所が存在していた。そこで、対策として、[ b ] を利用する方式を採用することにした。この方式では、外部からの入力値が埋め込まれる箇所を専用の記号に置き換えたSQL 文の雛形をあらかじめ作成しておき、専用の記号で置き換えた箇所に DB 管理システム側で外部からの入力値を割り当てる。\n\n### [レインボーテーブル攻撃への対策の検討]\n本システムでは会員のパスワードをハッシュ化して保存しているが、パスワードそのものにハッシュ関数を1回適用しただけであったので、レインボーテーブル攻撃に対して脆弱であった。そこで、パスワードをハッシュ化する際に、次の三つの処理を組み合わせて実施することにした。\n\n1. ソルトを用いた処理\n・パスワードをハッシュ化する際に、ソルトを付加した上でハッシュ化する。\n・ソルトとして、会員ごとに異なるランダムな文字列を用意し、会員テーブルに格納する。\n\n2. ④ペッパーを用いた処理\n・パスワードをハッシュ化する際に、ペッパーを付加した上でハッシュ化する。\n・ペッパーとして、全ての会員に共通のランダムな文字列を用意し, Web サーバ内の外部からアクセスできない安全な領域に格納する。\n\n3. ストレッチング\n・ハッシュ関数を複数回適用する。\n\nさらに、ハッシュ化処理の変更に加えて、会員が設定可能なパスワード長を10字以上64字以下に変更した。本システムにおいて、パスワード長が10字の場合,6字の場合と比べてパスワードとして使用可能な文字列のパターン数が [ c ] 倍になるのでレインボーテーブル攻撃がより困難になる。\n\nH主任は、これらの対策を取りまとめてG部長に報告し、承認された。",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "本文中の下線①について、会員のパスワードをハッシュ関数でハッシュ化して保存することは、情報漏えいの脅威に対してメリットがある。それは、ハッシュ値にどのような特性があるからか。25字以内で答えよ。",
      "explanation": "### 解説\n下線①は「パスワードのハッシュ値は,会員が設定したパスワードをハッシュ関数によってハッシュ化したものである」という記述です。\nハッシュ関数は、ある入力（パスワード）に対して一定の長さの出力（ハッシュ値）を生成する関数ですが、その最も重要な特性の一つは**一方向性**です。つまり、出力されたハッシュ値から元の入力（パスワード）を効率的に逆算することが非常に困難であることです。\n\n情報漏えいが発生し、ハッシュ値が外部に流出したとしても、この特性により、元のパスワードの機密性が保たれます。\n\n```mermaid\ngraph TD\n    A[パスワード] -->|ハッシュ関数| B(ハッシュ値)\n    B -->|逆算が困難| A\n    B -->|DB漏洩| C[攻撃者]\n    C --|パスワードは入手しにくい| A\n```\n\n**解答:** ハッシュ値から元のパスワードを復元することが困難な特性があるから。",
      "point": 13
    },
    {
      "subQNo": "設問2",
      "text": "本文中の下線②について、会員テーブルのデータが漏えいした場合,情報セキュリティの3要素のどれが直接的に侵害されたといえるか。漢字3字で答えよ。",
      "explanation": "### 解説\n情報セキュリティの3要素（C.I.A.トライアド）は以下の通りです。\n1.  **機密性 (Confidentiality):** 許可された者だけが情報にアクセスできること。\n2.  **完全性 (Integrity):** 情報が正確であり、改ざんされていないこと。\n3.  **可用性 (Availability):** 許可された者が情報やシステムを必要なときに利用できること。\n\n下線②は「SQLインジェクション攻撃によって会員テーブルのデータを取得する」ことで、個人情報（氏名、住所、ハッシュ値など）が外部に漏えいしたことを示しています。\n情報が意図せず外部に流出することは、**機密性**の侵害に該当します。\n\n**解答:** 機密性",
      "point": 13
    },
    {
      "subQNo": "設問3",
      "text": "本文中の [ a ] , [ b ] に入れる適切な字句を解答群の中から選び、記号で答えよ。\n解答群\nア エスケープ\nイ 許可リスト\nウ サニタイズ\nエ 中間者\nオ ブルートフォース\nカ プレースホルダ\nキ リプレイ",
      "explanation": "### 解説\n#### [ a ] について\n[ a ] は「稼働中のシステムのログインフォームに対してパスワードを総当たりで試行する [ a ] 攻撃」です。\nログイン試行を繰り返す攻撃は**ブルートフォース攻撃（総当たり攻撃）**です。\n\n#### [ b ] について\n[ b ] は、SQLインジェクション対策として導入された方法を指します。外部からの入力値が埋め込まれる箇所を専用の記号（プレースホルダ）に置き換えたSQL文の雛形をあらかじめ作成し、DB管理システム側で入力値を割り当てる方式です。これは**プリペアドステートメント**と呼ばれる手法であり、この手法で使用される専用の記号が**プレースホルダ**です。\n\n**解答:** a: オ, b: カ",
      "point": 13
    },
    {
      "subQNo": "設問4",
      "text": "本シナリオによって、表1に示す会員テーブルのデータが窃取され、会員番号 “21717202” の会員のパスワードが推測され不正アクセスを受けたとすると、推測されたパスワードを利用して不正アクセスを受けるおそれが最も強い他の会員は誰か。該当する会員の会員番号を解答群の中から選び、記号で答えよ。\n解答群\nア 21717203\nイ 30781985\nウ 36150833\nエ 45905900\nオ 45917046",
      "explanation": "### 解説\n本システムでは、ソルト（salt）を用いずにパスワードをハッシュ化しています（下線①の記述およびレインボーテーブル対策の検討より）。ソルトがない場合、異なるユーザーが全く同じパスワードを設定していると、そのハッシュ値も完全に一致します。\n\n攻撃者は会員番号「21717202」のハッシュ値から元のパスワードをレインボーテーブル攻撃で推測しました。この推測されたパスワードを使って、同じハッシュ値を持つ他の会員になりすましてログインするおそれが最も高いです。\n\n表1を確認すると、会員番号「21717202」のハッシュ値と一致する会員番号は「30781985」です。\n\n| 会員番号 | パスワードのハッシュ値 | \n| :--- | :--- |\n| 21717202 | `5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8` |\n| 30781985 | `5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8` |\n\n**解答:** イ",
      "point": 13
    },
    {
      "subQNo": "設問5",
      "text": "本文中の下線③の考え方を、漢字4字で答えよ。",
      "explanation": "### 解説\n下線③は「仮に対策の一つが破られても他の対策で攻撃を防ぐという考え方に基づき、攻撃への対策を WAF だけに頼らず本システム自体でも行うことにした」という記述です。\n\nこれは、単一の防御手段に頼るのではなく、複数の異なるセキュリティ対策を組み合わせて導入し、いずれか一つが破られてもシステム全体を守るという防御戦略を指します。\n\nこの考え方は**多層防御（たそうぼうぎょ）**と呼ばれます。\n\n**解答:** 多層防御",
      "point": 12
    },
    {
      "subQNo": "設問6",
      "text": "〔レインボーテーブル攻撃への対策の検討〕について答えよ。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の下線④について、ペッパーを付加してハッシュ化することで本シナリオにおいてレインボーテーブル攻撃が困難になる理由を、ソルトを用いた処理との違いに着目して35字以内で答えよ。",
          "point": 12
        },
        {
          "label": "(2)",
          "text": "本文中の [ c ] に入れる適切な数を、$x^y$ のような指数を用いた表記で答えよ。",
          "point": 12
        }
      ],
      "explanation": "### 解説\n#### (1) ペッパーの役割とソルトとの違い\n**ソルト**はユーザーごとに異なり、DB内のハッシュ値と一緒に保存されます。DB全体が漏洩した場合、攻撃者はハッシュ値とソルトの両方を入手できます。\n**ペッパー**は全ての会員に共通ですが、Webサーバ内の外部からアクセスできない安全な領域に格納されます（DB内には保存されない）。\n\n本シナリオでは、SQLインジェクションによって会員テーブル（DB）のデータが漏洩しました。ソルトがあってもDBが漏洩すればソルトも流出しますが、ペッパーはDBとは別の安全な場所に保管されているため、DB漏洩時にもペッパーは流出しません。\n\n**解答:** DBが漏えいしてもペッパーは安全な領域に格納されハッシュ化に必要な情報が揃わないため。(33字)"
    },
    {
      "subQNo": "設問6(2)",
      "text": "本文中の [ c ] に入れる適切な数を、$x^y$ のような指数を用いた表記で答えよ。",
      "explanation": "### 解説\nパスワードに使用可能な文字数は70種類です。パスワード長が$L$字のとき、可能な文字列のパターン数は $70^L$ で計算されます。\n\n比較対象は以下の通りです。\n*   パスワード長 10字の場合のパターン数: $70^{10}$\n*   パスワード長 6字の場合のパターン数: $70^6$\n\n10字の場合が6字の場合と比べて何倍になるかを求めます。\n$$\\frac{70^{10}}{70^6} = 70^{(10-6)} = 70^4$$\n\n**解答:** $70^4$",
      "point": 12
    }
  ]
}