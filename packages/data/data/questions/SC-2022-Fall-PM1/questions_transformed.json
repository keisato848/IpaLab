{
  "questions": [
    {
      "qNo": 1,
      "theme": "DNSキャッシュポイズニングと製品のファームウェア更新のセキュリティ対策",
      "description": "本問題は、DNSキャッシュポイズニング攻撃と、製品のファームウェア更新におけるセキュリティ対策（HTTPSによる通信検証、デジタル署名による真正性検証）に関する内容です。",
      "context": {
        "title": "DNSキャッシュポイズニングと製品のファームウェア更新",
        "background": "\n\n本文が提供されていないため、背景情報はありません。設問の解説から、脆弱性AはIPアドレス設定機能におけるシェルインジェクション攻撃に関連していることが推測されます。攻撃の検証には図4と図5が参照されています。\n\nこの問題は、WebアプリケーションRに存在する二つの脆弱性（脆弱性A, 脆弱性B）について、該当するCWE（Common Weakness Enumeration）を問うものです。\n\n解説文によると、脆弱性AはOSコマンドインジェクションに関するものであり、その攻撃経路を示す{{diagram:fig5}}や{{diagram:fig6}}が存在すると推測されます。",
        "diagrams": [
          {
            "id": "fig5",
            "label": "図5 脆弱性Aに関連する情報 (推測)",
            "type": "image",
            "content": "元の図の内容は提供されていません。"
          },
          {
            "id": "fig6",
            "label": "図6 脆弱性Aに関連する情報 (推測)",
            "type": "image",
            "content": "元の図の内容は提供されていません。"
          }
        ]
      },
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔各機能のセキュリティ対策の検討〕について答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ a ] に入れる攻撃手法の名称を15字以内で答えよ。",
              "answer": "DNSキャッシュポイズニング",
              "explanation": "攻撃者が偽装したDNS応答を送信することで、DNSキャッシュサーバに誤った名前解決情報（WサーバのIPアドレスとして攻撃者のサーバのIPアドレス）を登録させる手法です。これはDNSキャッシュポイズニングと呼ばれます。"
            },
            {
              "label": "(2)",
              "text": "本文中の [ b ] に入れる適切な字句を、解答群の中から選び、記号で答えよ。",
              "answer": "エ",
              "explanation": "DNSの名前解決要求（標準的な問い合わせ）は、通常、効率を優先してコネクションレス型プロトコルであるUDPが用いられます。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線①について、攻撃者が送信した DNS 応答が攻撃として成功するために満たすべき条件のうちの一つを、30字以内で答えよ。",
              "answer": "DNS問い合わせのトランザクションIDを推測して一致させること",
              "explanation": "DNSキャッシュポイズニング攻撃を成功させるためには、攻撃者が偽の応答パケットを正規の応答よりも早くキャッシュサーバに到達させる必要があります。この際、偽の応答が正規の問い合わせに対応していると認められるためには、攻撃者はDNS問い合わせに含まれるランダムな識別子であるトランザクションID（Query ID）を正確に推測して、応答パケットに含める必要があります。"
            },
            {
              "label": "(4)",
              "text": "本文中の下線②について、どのような実装か。40字以内で答えよ。",
              "answer": "Wサーバの証明書の正当性を検証する機能を実装している",
              "explanation": "製品RがWサーバとの通信にHTTPSを使用している場合、中間者攻撃（Man-in-the-Middle attack）によって偽のサーバに誘導されても、通信相手の正当性を検証できます。HTTPS通信では、TLSプロトコルを使用し、Wサーバから提供される証明書が信頼できる認証局によって発行されたものであり、かつその証明書がWサーバ（J社）のものであることを確認します。"
            },
            {
              "label": "(5)",
              "text": "本文中の [ c ] に入れる適切な字句を10字以内で答えよ。",
              "answer": "デジタル署名",
              "explanation": "ファームウェアの改ざんを防ぎ、J社が提供した本物であることを検証するためには、ファームウェア自体に**デジタル署名**を施します。製品Rは、この署名を検証することで、ダウンロードしたファームウェアの真正性を確認できます。"
            }
          ],
          "point": 25
        },
        {
          "subQNo": "設問2",
          "text": "本文中の [ d ] に入れる適切な字句を35字以内で答えよ。",
          "references": [],
          "answer": "パラメータをシェルで実行するコマンドにそのまま渡す",
          "explanation": "### 設問2の解説\n\n脆弱性Aは、IPアドレス設定機能において、ユーザーが入力したパラメータをそのままシェルコマンドの一部として実行していることに起因します。\n\n図5のリクエスト例を見ると、`netmask`の値の末尾に `\";` が挿入され、コマンド文字列を一旦終了させた後、意図しないコマンド（`ping`）を挿入しています。\n\n図4で示されているように、本来の処理は `ifconfig eth1 \"IP\" netmask \"MASK\"` のようなコマンドを生成することです。入力値を適切にエスケープ処理せず、コマンドの一部として連結してしまっているため、ユーザー入力がシェルの区切り文字（;や|など）を使って新しいコマンドを挿入できてしまいます。\n\n**解答:** パラメータをシェルで実行するコマンドにそのまま渡す",
          "subQuestions": [],
          "point": 25
        },
        {
          "subQNo": "設問3",
          "text": "〔脆弱性の修正〕について答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線③について,罠サイトではどのような仕組みを使って利用者に脆弱性Bを悪用する攻撃リクエストを送信させることができるか。仕組みを50字以内で具体的に答えよ。",
              "answer": "罠サイトに配置したHTMLフォーム要素やimgタグなどを用いて、ログイン済みの利用者から製品Rに対してPOSTリクエストを自動的に送信させる",
              "explanation": "脆弱性Bは、ログイン済みの利用者セッションを利用して意図しないリクエストを送信させるクロスサイトリクエストフォージェリ（CSRF）です。\n\n罠サイトでは、利用者がサイトを訪問した際に、ブラウザが自動的にPOSTリクエストを製品Rに送信するように仕組む必要があります。これには、目に見えないフォーム要素（<form>）を作成し、JavaScriptや自動送信属性を使ってPOSTリクエストをトリガーするか、あるいはPOSTリクエストを送信するHTML要素（例えば、スタイルを工夫した画像タグなど、POSTを実行できる方法）を利用します。"
            },
            {
              "label": "(2)",
              "text": "本文中の [ e ] に入れる、トークンがもつべき特徴を 15字以内で答えよ。",
              "answer": "推測が困難である",
              "explanation": "CSRF対策として導入するトークン（CSRFトークン）は、攻撃者が推測できないようにすることで、偽のリクエストの送信を無効化します。もし推測可能だと、攻撃者はリクエストに正しいトークンを含めてしまうことができます。"
            }
          ],
          "point": 25
        },
        {
          "subQNo": "設問4",
          "text": "脆弱性A及び脆弱性Bが該当する CWEを、それぞれ解答群の中から選び、記号で答えよ。\n解答群\nア CWE-78 OS コマンドインジェクション\nイ CWE-79 クロスサイトスクリプティング\nウ CWE-89 SQL インジェクション\nエ CWE-94 コードインジェクション\nオ CWE-352 クロスサイトリクエストフォージェリ\nカ CWE-918 サーバサイドリクエストフォージェリ",
          "references": [
            "fig5",
            "fig6"
          ],
          "answer": "脆弱性A: ア (CWE-78 OS コマンドインジェクション), 脆弱性B: オ (CWE-352 クロスサイトリクエストフォージェリ)",
          "explanation": "### 設問4の解説\n\n#### 脆弱性A\n\nユーザーからの入力値（IPアドレス情報）を検証せずに、OSのシェルコマンドの一部として連結し実行してしまう脆弱性です。これにより、図5や図6のように、攻撃者は任意のOSコマンドを実行できます。これは、CWE-78 (OSコマンドインジェクション)に該当します。\n\n**脆弱性Aの解答:** ア (CWE-78 OS コマンドインジェクション)\n\n#### 脆弱性B\n\nログイン済みの利用者を罠サイトに誘導し、その利用者の権限で意図しないリクエスト（POST /setvalue）をWebアプリRに送信させてしまう脆弱性です。これは、CWE-352 (クロスサイトリクエストフォージェリ)に該当します。\n\n**脆弱性Bの解答:** オ (CWE-352 クロスサイトリクエストフォージェリ)",
          "subQuestions": [],
          "point": 25
        }
      ]
    }
  ]
}