{
  "questions": [
    {
      "qNo": 1,
      "theme": "ICカードを用いた認証システム",
      "description": "## 問1 ICカードを用いた認証システムに関する次の記述を読んで、設問1〜4に答えよ。\n\nD社は、全国でマンションの開発・メンテナンスを手掛ける中堅の不動産デベロッパである。D社は各地域を担当する四つの子会社をもち、各子会社はそれぞれ複数の事業部門をもつ。D社及び子会社（以下、D社グループという）は、積極的に人材交流を行い、人材育成及び人材活用を推進している。D社グループの構成を表1に示す。\n\n### 表1 D社グループの構成\n| 会社名 | 役割 |\n| :--- | :--- |\n| D社 | 持株会社であり、D社グループの戦略立案を担当する。グループ人事部門、グループ財務部門、研究部門などが、それぞれD社グループ全体の業務を担当する。 |\n| E社 | D社の子会社であり、東日本地域の事業を担当する。 |\n| F社 | D社の子会社であり、西日本地域の事業を担当する。 |\n| G社 | D社の子会社であり、南日本地域の事業を担当する。 |\n| H社 | D社の子会社であり、北日本地域の事業を担当する。 |\n\nD社グループの従業員（以下、グループ従業員という）には、D社グループ内で一意となる番号（以下、グループ従業員番号という）が付与されている。また、オフィスや現場事務所の入室及び退室時に必要となる専用のICカード（以下、入退室カードという）が貸与されている。D社グループ各社にはそれぞれIT部門がある。D社グループの全ての入退室カードは、D社のIT部門が管理している。各社のIT部門は、自社従業員が利用するPC及びネットワークを管理しており、D社のIT部門は、それらに加えて人事、経理などのバックオフィス系のシステムを管理している。\n\n各事業部門は、それぞれ専用のWebシステム（以下、事業用システムという）を多数運用している。D社の子会社が実施するプロジェクトに参加するD社グループ及び取引先のプロジェクトメンバには、必要に応じて事業用システムのアカウントが付与される。事業用システムは、今後も新しいシステムの導入や既存システムの更新が見込まれている。\n\n### [IT部門の統合]\nD社では、ITによる業務効率向上、コスト削減及び情報セキュリティ強化を目的に、D社グループ各社のIT部門を統合し、D社内にシステム部を創設することにした。システム部長に任命されたMさんは、体制の整備とともに、D社グループ各社のシステムに関する調査を進めた。事業用システムの多くは、利用者IDとパスワードで利用者を認証していた。調査の結果、各事業用システムは、類似した利用者認証機能を備えており、利用者認証の統合又は共通化によって業務の効率向上が可能であることが分かった。また、事業用システムの多くはTLSを利用していた。このうち、社内向け事業用システムでは、D社グループ各社が個別にプライベート認証局を準備し、サーバ証明書を発行していた。事業用システムの利用者認証には、次の問題点があることが分かった。\n\n- **問題点1**: 現場事務所において、現場担当者が自身の利用者IDとパスワードを紙に書いてPCに貼り付けているケースが散見された。また、利用者IDとパスワードを、他人に教えたケースも複数あった。\n- **問題点2**: 取引先に付与したアカウントについても問題点1と同様のケースがあった。\n- **問題点3**: 一部の事業用システムでは、取引先の従業員間でアカウントを共用することを許可している。\n- **問題点4**: パスワード忘れへの対応及び新規利用者への初期パスワードの発行は、事業部門にとって大きな負担となっている。\n\n### [新システムの導入]\n議論の結果、システム部が汎用的な利用者認証の仕組み（以下、共通サービスという）を構築し、事業用システムに提供することが最善と判断された。各事業用システムは、今後、既存の利用者認証機能の代わりに、共通サービスを利用する。\n共通サービスでは、利用者IDとパスワードに代えて、新規に発行するICカード（以下、認証カードという）を利用者認証に利用する。利用者は、PCに接続されたカードリーダに認証カードを挿入することで、事業用システムにログインする。\nシステム部は、共通サービスを提供するために、認証カードの発行機能と認証局の機能を備えた新システム（以下、Jシステムという）を導入することにし、Jシステムの基本要件を図1のとおりに整理した。\n\n### 図1 Jシステムの基本要件\n- 事業用システムに対して、利用者認証の仕組みを提供する。事業用システムにおける利用者の権限については、Jシステムで取り扱わない。\n- 利用者認証の対象者（以下、認証対象者という）は、業務上、いずれかの事業用システムを利用する必要があるグループ従業員及び取引先の従業員に限る。\n- 認証対象者に、本人用の公開鍵証明書（以下、利用者証明書という）を発行し、利用者証明書と、対応する秘密鍵とを格納した認証カードを貸与する。事業用システムは、利用者証明書のsubjectフィールドに記載された認証対象者の情報を用いて、認証対象者を識別する。\n- グループ従業員に貸与する認証カードは、一人1枚とする。役職の変更、部署異動、D社グループ内での出向・転籍があっても、認証カード及び利用者証明書は再発行せず、そのまま継続利用する。ただし、更新などの認証カード切替え時においては、各地域と郵送でのやり取りが必要なので、最長1か月間、新旧2枚を貸与する。\n- 認証カードには有効期間をもたせ、認証カードの有効期間と利用者証明書の有効期間を一致させる。有効期間内に認証カードを失効させる場合、Jシステムは、当該認証カードの利用者証明書についての失効情報を事業用システムに開示し、提供する。失効情報の開示は、失効の必要性が生じてから1営業日以内に行う。\n- 事業用システムのサーバのサーバ証明書を発行する。\n- サーバ証明書に依拠するPCなどの機器向けに、サーバ証明書の失効情報を開示し、提供する。\n\n### [認証カードの方式設計]\nM部長は、部下のNさんに対して、D社の情報セキュリティ室のR主任の支援を受けつつ、方式設計を進めるように指示した。次は、認証カードの方式設計についての、NさんとR主任との会話である。\n\n**Nさん**: パスワードを用いる利用者認証では、ログインする人の [ a ] を確認していました。認証カードを利用する利用者認証では、認証カードの [ b ] を確認することになりますね。\n**R主任**: そうだね。加えて、認証カードの利用時にPINを入力させることで、2種類の方法を組み合わせた [ c ] 認証にすることができる。ただし、①認証対象者が不適切な行為をすると、その効果は望めない。\n**Nさん**: 認証カードを導入すると、利用者IDとパスワードを使わなくなるので、問題点1と問題点2は解決しますね。ICカードにPKIを組み合わせるのはなぜですか。\n**R主任**: ICカードを利用者認証に用いる二つの方法を比べてみよう。一つ目は、PKIを用いない方法で、ICカードに利用者認証情報を記録し、利用者認証時にこれを読み出してその値を比較することによって認証する方法だ。この方法では、ICカードに記録された利用者認証情報を読み出して処理するため、それが何らかの理由で漏えいした場合に、簡単に悪用されるおそれがある。\n二つ目は、PKIを用いて、ICカードに公開鍵暗号方式の秘密鍵とそれに対応する利用者証明書を格納する方法だ。\n**Nさん**: 後者の方法では、どのように認証するのですか。\n**R主任**: 公開鍵暗号技術を用いてエンティティ認証を行うプロトコルを、図2に示す。これは片方向認証の場合で、検証者Bが要求者Aを認証している。Jシステムでは、検証者Bは [ d ] に相当し、要求者Aは [ e ] に相当する。\n\n### 図2 公開鍵暗号技術を用いたエンティティ認証のプロトコル\n\n```mermaid\nsequenceDiagram\n    participant A as 要求者A\n    participant B as 検証者B\n    Note over A: [事前準備]<br/>1. 要求者Aの鍵(Kp, Ks)及び [ f ] を用意する。\n    A->>B: 2. エンティティ認証の開始を要求する。\n    B->>B: 3. Rbを求める。<br/>Rb = rand()\n    B->>A: 4. Rbを送信する。\n    Note over A: 5. RaとXを求める。<br/>Ra = rand()<br/>X = sign(Ks, [ g ])\n    A->>B: 6. [ f ], Ra, Xを送信する。\n    Note over B: 7. 次の関数が \"True\" を返すことを確認する。<br/>verify([ i ], [ j ], Ra||Rb||Sn)\n```\n\n- Kp : 要求者Aの公開鍵である。\n- Ks : 要求者Aの秘密鍵である。\n- rand() : 擬似乱数生成関数。ランダムな値を生成して返す。\n- sign(x, y) : ディジタル署名生成関数。秘密鍵xと署名対象データyを受け取り、署名値を返す。\n- verify(s, t, u) : ディジタル署名検証関数。公開鍵s、署名値t及び署名対象データuを受け取り、tがuに対する正しい署名値であれば \"True\"、それ以外の場合は \"False\" を返す。\n- Sn : 検証者Bの名称。公知の情報である。\n- || : この記号の左右のデータを連結することを示す。\n- 注記: 公開鍵証明書の正当性の確認についての記述は省略している。\n\n**Nさん**: 図2のプロトコルを使う上での注意点はありますか。\n**R主任**: 2点ある。1点目は、認証が成立するためには、鍵が [ k ] していないことが必要であることだ。事業用システムは、利用者証明書の失効情報を確認しなければならない。認証カードの紛失時などの場合、認証局は速やかに当該利用者証明書についての失効情報を提供する。失効情報は、CRLの配布により、又は [ 1 ] を使って提供されることが多い。\n2点目は、暗号技術は常に攻撃にさらされているので、米国国立標準技術研究所 (NIST) や②CRYPTRECの文書などを参考に、適切な暗号技術を利用するようにしなければならないことだ。\n**Nさん**: よく分かりました。\n\n市販されているICカードの中には、認証カードとして利用できるとともに、D社グループの入退室管理システムにおいて入退室カードとしても利用できるものがあり、Nさんは、そのうちの一つを採用することにした。\nJシステムの導入は、次の四つのフェーズに分けて行う。\n\n- **試験フェーズ1**: グループ従業員の一部だけに認証カードを貸与し、サーバ証明書の発行を開始する。認証カードは、事業用システムの利用者認証のためだけに利用する。\n- **試験フェーズ2**: 一部の取引先の従業員にも認証カードを貸与する。\n- **試験フェーズ3**: 認証カードを入退室カードとしても利用する。認証カードを貸与された者は、それまで利用していた入退室カードが無効化され、利用できなくなる。\n- **本番フェーズ**: 事業用システムにアクセスする必要がある全グループ従業員と取引先の従業員に対して、認証カードの貸与を開始する。\n\n### [認証カードの運用設計]\nNさんは、試験フェーズ1における認証カードの利用開始及び失効の手順について、図3及び図4に示す案を作成した。\n\n### 図3 認証カードの利用開始手順案\n1. グループ従業員は、システム部が準備する申請受付用のサーバ（以下、受付サーバという）にアクセスし、認証カードの利用を申請する。\n2. システム部は、毎週月曜日に、前週の月曜日から前日の日曜日までの受付分について、グループ従業員本人による申請であることの確認及び③他の必要な確認を行う。\n3. システム部は、認証カード作成専用PCを用いて認証カードを作成する。申請者専用の鍵と利用者証明書を作成し、認証カードに登録する。認証カードにはそれぞれ固有の識別番号を付与する。識別番号は認証カードの裏面に記す。\n4. システム部は、作成した認証カードを申請者に送付する。別途、識別番号を記した紙を申請者に配布する。\n5. 申請者は、認証カードを用いて受付サーバにログインし、認証カードの受領を登録する。\n\n### 図4 認証カードの失効手順案\n1. グループ従業員又はその上長が、受付サーバにログインし、失効させる認証カードの識別番号又はグループ従業員番号と、失効させる事由を入力し、失効を申請する。失効させる事由は、表2に示す選択肢から選ぶ。\n2. 失効の申請者は、可能であれば、当該認証カードをシステム部に送付して返却する。\n3. システム部は、毎週火曜日に、前週の月曜日から前々日の日曜日までの受付分について、グループ従業員本人又はその上長による申請であることを確認した後、利用者証明書の失効を失効情報サーバに登録して公開する。表2に示す失効事由の値を公開情報に含める。\n\n### 表2 失効事由\n| 失効申請時の失効事由の選択肢 | 失効事由の値<sup>1)</sup> |\n| :--- | :--- |\n| 退職又は事業用システムの利用終了 | affiliationChanged |\n| 認証カードの紛失 | keyCompromise |\n| 認証カードの故障 | cessationOfOperation |\n| 認証カードの更新 | superseded |\n| 鍵の不正利用のおそれ | keyCompromise |\n注1) 失効事由の値は、JIS X 5731-8:2003 (ITU-T X.509) に規定された \"CRLReason\" に相当する。\n\nJシステムの運用に係る補足情報を図5に示す。\n\n### 図5 Jシステムの運用に係る補足情報（抜粋）\n1. **システム部の定常業務**\n   - 認証カードの利用開始、失効などを、認証カード管理簿に記録し、管理する。\n   - 認証カードの申請者に認証カードを送付した後、1週間たっても受領の登録がない場合、上長経由の確認など何らかの対応を行う。\n   - 人事情報を基に退職者の利用者証明書を失効させる。認証カードは退職時に返却を求める。\n2. **その他の補足事項**\n   - 認証カードと利用者証明書の有効期間は5年とする。継続利用の場合には、新しい認証カードを発行する。有効期間終了時、認証カードを回収する。\n\nR主任は、Nさんの設計案をレビューし、④失効情報の提供手順に不備があるので改善すべきであると指摘した。Nさんが設計案を修正した後、R主任は再レビューを行い、指摘した不備が解決していることを確認した。\n\n### [認証局階層とサーバ証明書]\nJシステムは、複数の認証局の鍵を管理し、利用者証明書及びサーバ証明書を発行する機能をもつ。D社の認証局の階層案を図6に示す。\n\n### 図6 D社の認証局の階層案\n```mermaid\ngraph TD\n    Root[\"D社ルートCA\"] --> CA1[\"CA-1: グループ従業員用の利用者証明書を発行\"]\n    Root -.-> CA2[\"CA-2: 取引先の従業員用の利用者証明書を発行\"]\n    Root --> CA3[\"CA-3: サーバ証明書を発行\"]\n```\n注記: 破線は、試験フェーズ2で整備する予定のものを示す。\n\nCA-3が発行したサーバ証明書は、社内向け事業用システムのサーバに加え、特定の取引先がアクセスする社外向け事業用システムのサーバにも利用される予定である。サーバ証明書の失効情報は、D社グループ社内の各機器及び取引先からアクセス可能な場所で開示する。システム部は、D社グループ各社の要請に従い、サーバ証明書の発行・失効を行う。\nシステム部は、既存のPC管理の仕組み及びPCのメンテナンスの機会を利用し、⑤グループ従業員が利用するPCにD社ルートCAの公開鍵証明書を登録する。取引先の従業員がアクセスするサーバでJシステムのサーバ証明書を利用する場合には、当該サーバを利用する全ての取引先に対して、D社ルートCAの公開鍵証明書を配布する。この際、D社の認証局が万が一何らかの原因で不正操作される可能性を想定し、⑥取引先においては、D社ルートCAの公開鍵証明書を、当該サーバだけにアクセスする専用のPCにインストールするよう要請する。\nこれらの設計案はM部長に報告された。Jシステムは実装され、試験フェーズ1が開始された。一部の事業用システムは、Jシステムの利用者証明書を用いて認証を行うように改修された。また、一部のサーバでは、CA-3が発行したサーバ証明書の利用が開始された。\n\n### [取引先の従業員への認証カードの貸与]\n試験フェーズ1の開始から3か月後に、試験フェーズ2の準備が開始された。\nNさんは、取引先に認証カードを貸与する方式を設計し、表3の二つの案にまとめた。取引先へ認証カードを導入するに当たっての機能要件は、従業員を個人ごとに識別・認証できること、及び事業用システムの操作履歴を記録し、プロジェクトごとに表示できることである。Nさんは、方式A及び方式Bはともに機能要件を満たしていると判断した。また、方式の選択に際して優先される非機能要件は、第1に事業部門での管理工数が少ないこと、第2にシステム部での管理工数が少ないことである。\n\n### 表3 取引先の従業員への認証カード貸与方式案（抜粋）\n| 項目 | 方式A | 方式B |\n| :--- | :--- | :--- |\n| 概要 | プロジェクトごとに、取引先の従業員に認証カードを貸与。複数のプロジェクトに参加する者には、複数枚を貸与 | 取引先の従業員に、認証カードを一人1枚貸与 |\n| 貸与対象者 | \\<取引先の従業員（ただし、試験フェーズ中は一部の取引先の従業員に限定）\\> | |\n| 貸与枚数 | 貸与対象者に対してプロジェクトごとに1枚 | 貸与対象者ごとに1枚 |\n| 貸与期間 | プロジェクトへの参加期間 | いずれかのプロジェクトへの参加期間（ただし、半年以内に次のプロジェクトへの参加が見込まれる場合は貸与を継続） |\n| 管理責任者 | プロジェクト責任者 | システム部（ただし、プロジェクト責任者は、プロジェクトへの参加期間を届け出る。） |\n| システムの権限管理 | 事業用システムの利用権限は、プロジェクト責任者の要請に従い、事業部門で登録及び解除。事業部門は、プロジェクトへの参加期間だけ有効な権限をシステムに登録 | |\n| 操作履歴の取得 | 複数のプロジェクトに参加する従業員の操作履歴は、認証のログを基に、プロジェクトごとに識別可 | 複数のプロジェクトに参加する従業員の操作履歴は、認証のログと事業用システムの利用権限に係るログを組み合わせることで、プロジェクトごとに識別可 |\n| その他の補足事項 | 業務上の役割と認証カードを結び付け、権限管理をシンプルかつ柔軟に運用可 | |\n注記1: 管理責任者は、貸与対象者への認証カードの配布及び貸与対象者からの回収を行う。\n注記2: 認証カードに登録された利用者証明書は、認証カードの紛失時を除き、管理責任者が認証カードを回収した後にシステム部が失効処理を行う。紛失時は、遅滞なく失効処理を行う。\n\nNさんが取引先について過去数年分のプロジェクトへの参加状況を調査したところ、取引先の従業員は最多で五つのプロジェクトに同時に参加していた。また、専門技術をもつ工事関係取引先の従業員は、各プロジェクトへの参加期間は短いが、1か月以内に次のプロジェクトに参加することが多いことが分かった。取引先の従業員の3割程度が、このような工事関係取引先の従業員であった。\n検討の結果、Nさんは、方式Bが非機能要件の面で優位と考え、M部長に提案した。M部長は提案された方式を承認し、実装が開始された。その後、試験フェーズ2が開始され、取引先の従業員への認証カードの貸与が始まった。\n試験フェーズ2は、おおむね順調だったが、問題が二つ確認された。\n- グループ従業員が認証カードをオフィスに置き忘れ、現場事務所で同僚に認証カードを借りて利用するケースがあった。\n- グループ従業員が現場事務所に認証カードを保管し、本人以外に利用させているケースがあった。\n\nこれらの不正の防止には、当初から計画されていた、⑦認証カードを入退室カードとしても利用するという措置が一定の効果をもつと判断された。試験フェーズ3では、この措置が実施された。\n\n### [本番フェーズの開始]\nその後、本番フェーズへの移行は順調に進んだ。事業用システムは全て、Jシステムの利用者証明書を用いて認証を行うように改修が進められた。また、TLSを利用する社内向け事業用システムのサーバは全て、CA-3が発行したサーバ証明書を利用することになった。Jシステムの導入によって、事業用システムに係る問題点1〜4は全て解決した。",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔認証カードの方式設計〕について、(1)〜(5)に答えよ。",
          "explanation": "### 認証方式の理解\nパスワード認証は「記憶(Something you know)」に基づきます。ICカード認証は「所持(Something you have)」に基づきます。これらを組み合わせ、さらにPIN（暗証番号）を加えることで「多要素認証(Multi-Factor Authentication)」が実現されます。\n\n### エンティティ認証プロトコル (図2)\nこれは**チャレンジレスポンス方式**です。\n1. B(検証者)がランダムな値(Rb)をA(要求者)に送る（チャレンジ）。\n2. AはRbとRa(Aが生成した乱数)を組み合わせて自身の秘密鍵(Ks)で署名し(X)、Bに返す（レスポンス）。\n3. BはAの公開鍵(Kp)で署名を検証する。これにより、Aが秘密鍵を持っていること（本人であること）が証明されます。\n\n### 証明書の失効情報\n公開鍵証明書が信頼できるためには、それが「失効(Compromise)」していないことが不可欠です。失効情報を確認する手段としては、**CRL**(Certificate Revocation List: 証明書失効リスト)の配布や、**OCSP**(Online Certificate Status Protocol)によるリアルタイム照会があります。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ a ] 〜 [ c ], [ k ] 及び [ 1 ] に入れる適切な字句を解答群の中から選び、記号で答えよ。",
              "subQuestions": [
                {
                  "label": "a",
                  "text": "ウ（記憶）"
                },
                {
                  "label": "b",
                  "text": "オ（所持）"
                },
                {
                  "label": "c",
                  "text": "ス（複数要素）"
                },
                {
                  "label": "k",
                  "text": "エ（危殆化）"
                },
                {
                  "label": "1",
                  "text": "イ（OCSP）"
                }
              ]
            },
            {
              "label": "(2)",
              "text": "本文中の下線①について、R主任が想定している不適切な行為を、35文字以内で具体的に述べよ。",
              "text_ans": "認証カードにPINを書き込んだり、PINを他人に教えたりする行為"
            },
            {
              "label": "(3)",
              "text": "本文中の [ d ], [ e ] 及び図2中の [ f ] に入れる適切な字句を解答群の中から選び、記号で答えよ。",
              "subQuestions": [
                {
                  "label": "d",
                  "text": "ウ（事業用システム）"
                },
                {
                  "label": "e",
                  "text": "カ（認証対象者）"
                },
                {
                  "label": "f",
                  "text": "ク（利用者証明書）"
                }
              ]
            },
            {
              "label": "(4)",
              "text": "本文中の下線②について、CRYPTRECの“電子政府推奨暗号リスト”に含まれている暗号技術を解答群の中から全て選び、記号で答えよ。",
              "text_ans": "ア、イ、エ、ク、ケ"
            },
            {
              "label": "(5)",
              "text": "図2中の [ g ] 〜 [ j ] に入れる適切な式を解答群の中から選び、記号で答えよ。",
              "subQuestions": [
                {
                  "label": "g",
                  "text": "オ (Ra||Rb||Sn)"
                },
                {
                  "label": "h",
                  "text": "セ (X)"
                },
                {
                  "label": "i",
                  "text": "ア (Kp)"
                },
                {
                  "label": "j",
                  "text": "セ (X)"
                }
              ]
            }
          ]
        },
        {
          "subQNo": "設問2",
          "text": "〔認証カードの運用設計〕について、(1)〜(3)に答えよ。",
          "explanation": "### 運用上のリスク管理\n認証カードの利用開始時には、なりすまし申請を防ぐために本人確認が不可欠です。\nまた、証明書の失効（図4、表2）においては、特に「秘密鍵の漏えい(keyCompromise)」が最も深刻なリスクであり、迅速な対応（失効情報の開示）が求められます。Nさんの当初の案では週1回の更新でしたが、それでは1営業日以内という要件（図1）を満たせません。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図3中の下線③について、Jシステムの基本要件を満たすために、システム部が確認すべき事項を二つ挙げ、それぞれ30文字以内で述べよ。",
              "text_ans": "申請者が認証対象者の条件を満たしていること / 申請者に対し、既に有効な認証カードを貸与中でないこと"
            },
            {
              "label": "(2)",
              "text": "グループ従業員用の利用者証明書のsubjectフィールドに記載するグループ従業員の情報について、必要不可欠なものを解答群の中から全て選び、記号で答えよ。",
              "text_ans": "ア (グループ従業員番号)"
            },
            {
              "label": "(3)",
              "text": "本文中の下線④について、改善すべき不備を40文字以内で具体的に述べよ。また、この不備は、失効事由の値がどのような値となっている場合に事業用システムの不正利用に結び付く可能性が高いか。該当する失効事由の値を解答群の中から全て選び、記号で答えよ。",
              "text_ans": "失効情報の開示が、失効の必要性が生じてから1営業日以内に行われない点 / 該当記号：ウ (keyCompromise)"
            }
          ]
        },
        {
          "subQNo": "設問3",
          "text": "〔認証局階層とサーバ証明書〕について、(1)、(2)に答えよ。",
          "explanation": "### 信頼の連鎖 (Trust Anchor)\nブラウザがサーバ証明書を信頼するためには、その発行元であるルート認証局(Root CA)の証明書が「信頼されたルート証明書」としてブラウザに登録されている必要があります。社内PCには一括配布できますが、取引先のPCには手動で要請する必要があります。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線⑤について、この措置を行わない場合、CA-3が発行したサーバ証明書を利用するサーバにグループ従業員がWebブラウザでアクセスすると、どのような不都合が生じるか。30文字以内で具体的に述べよ。",
              "text_ans": "ブラウザに、信頼できないサイトである旨の警告が表示される。"
            },
            {
              "label": "(2)",
              "text": "本文中の下線⑥の要請は、取引先のどのようなリスクを軽減するためか。45文字以内で具体的に述べよ。",
              "text_ans": "D社の認証局の不正操作によって発行された偽の証明書を、取引先が信頼してしまうリスク"
            }
          ]
        },
        {
          "subQNo": "設問4",
          "text": "〔取引先の従業員への認証カードの貸与〕について、(1)〜(3)に答えよ。",
          "explanation": "### 管理工数と不正防止のトレードオフ\n取引先への貸与方式B（一人1枚）は、複数のプロジェクトを掛け持つ従業員にとってカードが1枚で済むため、利便性が高く、管理工数も削減されます。しかし、物理的なカードの管理が甘くなるリスクがあります。そこで「入退室管理」と連携させることで、オフィス外への持ち出し忘れや、他者への貸与を防ぐ（カードがないと入館できない、あるいは常に携帯せざるを得ない状況を作る）効果を狙っています。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "方式A及び方式Bでは、管理責任者による認証カードの回収の遅れ又は漏れがあっても事業用システムの不正利用の影響を抑えることができる。この理由について、“認証”、“認可”の二つの字句を用いて、40文字内で述べよ。",
              "text_ans": "認証が成功しても、事業部門が認可した権限が有効でなければ利用できないから。"
            },
            {
              "label": "(2)",
              "text": "方式Bの方が非機能要件に適合している理由を表3の内容に基づいて二つ挙げ、それぞれ40文字以内で具体的に述べよ。",
              "text_ans": "複数参加者への貸与枚数が少なく、システム部でのカード作成工数が少ないから。 / 参加プロジェクト変更時のカード回収・再貸与が不要で、管理責任者の工数が少ないから。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線⑦について、見つかった不正に対して、この措置が効果をもつと判断した根拠を、40文字以内で述べよ。",
              "text_ans": "認証カードを他人に貸したり忘れたりすると、本人のオフィスへの入退室ができなくなるから。"
            }
          ]
        }
      ],
      "point": 50
    },
    {
      "qNo": 2,
      "theme": "脆弱性対策",
      "description": "## 問2 脆弱性対策に関する次の記述を読んで、設問1〜5に答えよ。\n\nA社は、従業員数3,000名の製造会社である。A社の組織構成は図1のとおりであり、全社を統括する経営管理本部、及び製品の製造・販売を行う三つの製品本部がある。三つの製品本部は、それぞれ取り扱う製品分野が異なっている。経営管理本部には、データセンタ部（以下、センタ部という）、総務部などがある。\n\n### 図1 A社の組織構成\n```mermaid\ngraph TD\n    Board[\"取締役会\"] --- CEO[\"社長\"]\n    CEO --- MGMT[\"経営管理本部\"]\n    CEO --- PA[\"α製品本部\"]\n    CEO --- PB[\"β製品本部\"]\n    CEO --- PC[\"γ製品本部\"]\n    MGMT --- DC[\"センタ部\"]\n    MGMT --- GA[\"総務部など\"]\n```\n\n### 〔A社の情報システムの構成〕\n経営管理本部では、センタ部に所属する20名の運用担当者が、A社内で共同利用される機器群（以下、センタ部機器という）を運用している。各製品本部では、情報システム担当チームが、各製品本部が独自に導入している機器群（以下、製品本部機器という）を運用している。A社の情報システムの構成は、図2のとおりである。\n\n### 図2 A社の情報システムの構成\n```mermaid\ngraph TD\n    subgraph Internet\n        ExtSite[攻撃者のサイト]\n    end\n    Internet --- FW[ファイアウォール]\n    FW --- DMZ\n    subgraph DMZ\n        DNS[DNSサーバ]\n        Mail[メールサーバ]\n        PubWeb[公開Webサーバ]\n        Proxy[プロキシサーバ]\n    end\n    FW --- InternalSegment[社内サーバセグメント]\n    subgraph InternalSegment\n        IntBiz[社内業務サーバ]\n        Update[アップデート用サーバ]\n        AlphaWeb[α社内Web]\n        AlphaDB[αDB]\n        BetaWeb[β社内Web]\n        BetaDB[βDB]\n        GammaWeb[γ社内Web]\n        GammaDB[γDB]\n    end\n    Router[ルータ] --- InternalSegment\n    Router --- PCSegAdmin[経営管理本部のPCセグメント]\n    Router --- PCSegAlpha[α製品本本のPCセグメント]\n    Router --- PCSegBeta[β製品本本のPCセグメント]\n    Router --- PCSegGamma[γ製品本本のPCセグメント]\n```\n- FW : ファイアウォール\n- DBサーバ : データベースサーバ\n- 公開Webサーバ : 会社情報提供用Webサーバ、広報用Webサーバ、一般消費者向けインターネット通販用Webサーバなどの社外に公開しているWebサーバ、及び社外の取引先と情報共有するためのWebサーバ\n- 社内Webサーバ : 社内での情報共有に利用する、社外に公開していないWebサーバ\n- 社内業務サーバ : 人事管理などの業務に利用するサーバ\n\n各製品本部には、5〜10台の公開Webサーバがある。センタ部機器のアップデート用サーバは、社内で利用しているソフトウェアパッケージのセキュリティパッチ（以下、パッチという）を含む修正プログラムをインターネットからダウンロードし、格納している。社内サーバセグメントと各PCセグメント上の機器からは、プロキシサーバを経由したインターネット上のWebサイトへのアクセスが許可されており、アップデート用サーバとPCにはプロキシサーバを経由するような設定がなされている。一方、社内サーバセグメントと各PCセグメント上の機器からのプロキシサーバを経由しないインターネットへのアクセスは、FWによって禁止されている。アップデート用サーバからのアクセス先は、特定のベンダのサイトに限定されている。\n\n### 〔脆弱性対策の立案〕\n最近、国内外でソフトウェアの重大な脆弱性が数多く報告されており、それらの悪用によって、製造業の複数の企業でも被害が起きている。そのため、センタ部では、A社の情報システムについて、脆弱性対策を強化する必要があると考え、脆弱性対策方針案を作成し、取締役会に提案した。脆弱性対策方針案を図3に示す。\n\n### 図3 脆弱性対策方針案\n- **脆弱性対策を行うチーム**（以下、Vチームという）を組織する。Vチームは、脆弱性対策に関する次の業務を担当する。\n  1. **機器の特定及び重要度レベルの決定**: 脆弱性対策の対象となる機器を特定し、その重要度レベルを決定する。\n  2. **脆弱性に関する情報の収集と選別**: 脆弱性情報を収集し、その中からA社の機器に影響する情報を選別する。\n  3. **脆弱性対策適用の判断**: A社の機器に影響する脆弱性情報について、機器の重要度レベルと脆弱性の影響度（以下、脆弱性レベルという）を勘案し、脆弱性対策適用の緊急度を判断する。\n  4. **脆弱性対策の実施**: 脆弱性情報を各情報システム担当者に通知し、脆弱性対策適用を指示する。\n  5. **適用状況の確認**: 脆弱性対策を各情報システム担当者が適切に適用できたかどうかを確認する。\n\n取締役会は、この脆弱性対策方針案を了承し、センタ部が中心となってVチームを製品本部横断的に組織することを決定した。Vチームの責任者には、センタ部のP部長が任命された。P部長は、部下のQ主任をチームリーダに任命した。他にセンタ部の3名と各製品本部の情報システム担当チームから2名ずつの計9名（以下、Vチーム員という）から成るVチームを発足させた。Q主任の役割は、情報システムの脆弱性対策の立案、Vチーム員への指示、及び脆弱性対策の実施状況のP部長への報告である。\nQ主任は、任命を受けてVチーム員を招集し、図3の業務を具体化するための協議をした。その中で、脆弱性対策適用の緊急度を機器ごとに判断するための基準（以下、脆弱性対策基準という）を作成した。脆弱性レベルの判断基準には、脆弱性情報に記載された共通脆弱性評価システム (CVSS) の基本値を利用することにした。Vチームが作成した脆弱性対策基準を図4に示す。\n\n### 図4 脆弱性対策基準\n1. **機器の重要度レベルの定義**: 機器ごとの重要度レベルを、次表によって高・低の2段階に分ける。\n   | | 重要情報を扱っている | 重要情報を扱っていない |\n   | :--- | :--- | :--- |\n   | 社外からアクセスできる | 重要度レベル高 | 重要度レベル低 |\n   | 社外からアクセスできない | 重要度レベル低 | 重要度レベル低 |\n2. **脆弱性レベルの定義**: 脆弱性情報ごとに脆弱性レベルを、高・低の2段階に分ける。\n   - CVSS基本値が7.0以上の脆弱性を脆弱性レベル高とする。\n   - それ以外は、脆弱性レベル低とする。\n3. **リスクレベルの定義**: 機器と脆弱性情報の組合せごとのリスクレベルを、次表によってリスクが低い順に1・2・3の3段階に分ける。\n   | | 重要度レベル高 | 重要度レベル低 |\n   | :--- | :--- | :--- |\n   | 脆弱性レベル高 | リスクレベル3 | リスクレベル2 |\n   | 脆弱性レベル低 | リスクレベル2 | リスクレベル1 |\n4. **脆弱性対策適用の緊急度判断基準**: リスクレベルに基づき、脆弱性対策適用の緊急度を判断する。\n   - リスクレベル3の場合は、直ちに脆弱性対策を実施する。\n   - リスクレベル2の場合は、次回のシステム保守時に脆弱性対策を実施する。\n   - リスクレベル1の場合は、今後の追加情報に注意して経過を見守る。\n   脆弱性対策については、脆弱性情報にパッチや回避策の記載がある場合には、その適用方法を検討する。脆弱性情報に脆弱性対策の記載がない場合には、何らかの対策を検討する。\n\n### 〔脆弱性の公表と対応〕\n脆弱性対策基準の運用を開始して間もなく、あるWebアプリケーションのソフトウェアパッケージ（以下、ソフトウェアMという）のバージョンZにSQLインジェクションの脆弱性（以下、脆弱性Xという）があり、パッチが提供されているという情報が公表された。CVSS基本値は6.5であった。Q主任は、A社の機器にソフトウェアMが導入されているかどうかが分からなかった。そこで、Vチーム員に次の対応を指示した。\n- 固定資産管理台帳に記載がある機器について、ソフトウェアMを導入しているかどうかを調査すること\n- 導入している機器について、X脆弱性に対する脆弱性対策適用の緊急度を判断すること\n\nVチーム員は、ソフトウェアMを導入しているかどうかの確認に手間取り、1週間後にQ主任に調査結果を報告した。ソフトウェアMを導入した機器はないとの調査結果だったので、Q主任は、脆弱性Xへの対応を終了し、P部長に報告した。ところがその2週間後、α製品本部のVチーム員から、①社外の取引先と重要情報を共有するための公開WebサーバにソフトウェアMのバージョンZが導入されていることが分かり、対応したとの報告が入った。\n当初の調査に見落としがあったことを問題視し、Q主任は、α製品本本のVチーム員に見落としの原因を調べさせた。原因は、当該機器が先月導入されたばかりで、固定資産管理台帳に記載がなかったことにあった。Q主任は、Vチーム員に対して、固定資産の棚卸以降に導入された機器がないかの確認を指示した。他に見落とした機器はなかったことが分かり、Q主任はP部長に報告した。\n報告を受けたP部長は、当初の調査のような見落としの再発防止策を検討するようQ主任に指示した。Q主任は、まず、固定資産管理台帳を基に、機器の新たな管理台帳（以下、新台帳という）をVチームで作成することにした。②新台帳にはバージョンを含むソフトウェアの情報も記載することにした。また、機器の新規導入や構成変更の際には、新台帳を速やかに修正する手順にした。Q主任は、これらの改善策についてP部長に報告し、承認を得て実施した。\n\n### 〔新たな脆弱性の公表と対応〕\n改善策を実施して1か月後、UNIX/Linuxで利用されるshellの一つであるbashに重大な脆弱性（以下、脆弱性Yという）が存在するという脆弱性情報が公表された。CVSS基本値は10.0であった。脆弱性Yが存在するbashでは、環境変数の値が \"() {\" という文字列で始まる場合、関数として解釈され、実行することができる。例えば、図5のように、exportコマンドを使って環境変数としてTEST1を設定し、bashで呼び出すと \"echo test\" が実行される。\n\n### 図5 bashにおける環境変数の設定とその利用例\n```bash\nexport TEST1='() { echo test; }'\nbash -c TEST1\n```\n\n脆弱性Yは、例えば、図6のように環境変数としてTEST2を設定すると、bashを起動しただけで、TEST2を呼び出さなくても、bashが起動されて環境変数を引き継ぐ際、区切り文字 \";\" の後に書かれたコマンドを実行してしまうというものである。図6の例では、catコマンドが実行されてしまい、ファイル /etc/passwd が表示される。\n\n### 図6 脆弱性Yの確認例\n```bash\nexport TEST2='() { echo test; }; /usr/bin/cat /etc/passwd'\nbash\n```\n\nWebサーバにおいても、③ある条件を満たす場合には、この脆弱性Yを悪用される。図7は、CGIを利用した、あるWebアプリケーションプログラム（以下、WebアプリBという）が呼び出される際のフローである。\n\n### 図7 WebアプリBに対するアクセスのフロー\n```mermaid\nsequenceDiagram\n    participant Client as Webブラウザ\n    participant Server as Webサーバ (httpd)\n    participant App as WebアプリB\n    Client->>Server: (1) HTTPリクエスト\n    Note over Server: (2) WebアプリBが起動され、<br/>bashが呼び出される。\n    App-->>Client: (3) HTTPレスポンス\n```\n\n典型的なWebサーバでは、Webサーバ (httpd) が [ a ] ヘッダの④フィールド値を環境変数として設定してからWebアプリBを起動するので、攻撃者は、脆弱性Yを悪用してWebサーバで任意のコードを実行できる。例えば、図6の例と同様の場合であれば、catコマンドが実行され、このとき、catコマンドの実行時の権限によっては、攻撃者にどのようなファイルでも参照されてしまう。\nQ主任は、直ちに脆弱性Yへの対応を開始した。新台帳を基に、脆弱性Yが影響する機器があるかをVチーム員が確認したところ、公開Webサーバのうち、重要度レベル高のサーバ8台と重要度レベル低のサーバ5台が該当していることが分かった。\n\n脆弱性Yが悪用されると公開Webサーバが改ざんされるおそれもあり、事態を重く受け止めたQ主任は、重要度レベル高のサーバだけでなく、該当する重要度レベル低のサーバ5台に対しても直ちに脆弱性対策を適用するようVチーム員に指示した。\n\n### 〔WAFによる脆弱性対策〕\n脆弱性Yへの対応指示に対して、β製品本部のVチーム員からは、β製品本部機器は、パッチの適用作業に1か月が必要なので、代替策を検討する必要があるとの報告を受けた。Vチームでは、シグネチャによる [ b ] という手法で攻撃を検知できるWebアプリケーションファイアウォール (WAF) が代替策になるかどうか、セキュリティベンダのG氏に相談することにした。\nG氏によれば、WAFによる対応は、サーバへのパッチ適用に比べて、⑤対策を実施するまでの期間が短いといわれており、脆弱性Yへの対応も既に可能になっているとのことであった。そこで、Q主任は、WAFの導入について、導入形態が異なる表1のような2案を作成した。\n\n### 表1 WAFの導入案\n| 案 | 導入形態 | 概要 |\n| :--- | :--- | :--- |\n| 案1 | オンプレミス型 | - WAFは、センタ部機器として購入し、A社内に設置する。<br>- 設定とログ解析は、セキュリティ専門業者に委託する。<br>- 通信量の上限は、導入機器の性能によって制限される。 |\n| 案2 | クラウド型 | - WAFは、サービス事業者に設置されたものを利用する。<br>- 設定とログ解析は、サービス事業者が実施する。<br>- 図2の中の機器のうち、 [ c ] サーバにおいて、サービス事業者の指示どおりに次のように設定する。<br> [ d ] レコードにおいて、公開Webサーバの別名としてサービス事業者に指定されたFQDNを記述する。<br>- （省略）<br>- 通信量の上限は、サービス利用契約を随時変更し、切り替えることができる。 |\n\nβ製品本部の脆弱性Yがある公開Webサーバには、新製品の発表時などに、購入希望者からのアクセスが通常時の100倍程度まで一時的に増大するものがあり、かつ、次の新製品発表が3週間後に予定されている。このため、Q主任は、案2を選び、⑥クラウド型のWAFを1週間後に導入し、β製品本部での脆弱性Yに対する代替策とする案をP部長に提案した。P部長は、この提案を承認し、センタ部に作業を指示した。\n\n### 〔脆弱性への追加対応〕\nWAF導入後、β製品本部でのサーバへのパッチ適用前の月る日、脆弱性Yについて、社外から直接はアクセスできない機器も社外から攻撃を受ける可能性があるという追加情報（以下、追加情報Yという）が公表された。A社の情報システムの構成では、FWによって社外から社内Webサーバへのアクセスを防いでいる。しかし、追加情報Yによれば、図8に示すような、社外から社内Webサーバに対する脆弱性Yを悪用した攻撃が考えられるという。\n\n### 図8 社内Webサーバに対する脆弱性Yを悪用した攻撃\n```mermaid\nsequenceDiagram\n    participant Attacker as 攻撃者のサイト\n    participant Browser as Webブラウザ (A社内)\n    participant FW as FW\n    participant InternalWeb as 社内Webサーバ\n    Note over Browser, Attacker: (1) HTTPリクエスト\n    Attacker-->>Browser: (2) HTTPレスポンス ([ e ] を使った攻撃コード)\n    Browser->>InternalWeb: (3) HTTPリクエスト ([ e ] によるクロスオリジンリクエスト)\n    InternalWeb-->>Browser: (4) HTTPレスポンス (情報の送信)\n    Browser->>Attacker: (5) HTTPリクエスト (情報の送信)\n```\n\n次の条件1〜3が全て成立すると、この攻撃は、成功する可能性がある。\n- **条件1**: 攻撃者が [ f ] を知ることができ、その情報を図8の(2)の攻撃コードに組み込むことができること\n- **条件2**: 社内Webサーバにおいて、CGIを利用したWebアプリケーションプログラムが、bashを呼び出すこと\n- **条件3**: 図8の(4)のHTTPレスポンスにヘッダとして [ g ] が付加されていること\n\nA社内のWebブラウザが攻撃者のサイトにアクセスしてしまうと、 [ e ] を使った攻撃コードがダウンロードされ、実行される。攻撃コードが実行されたとしても、条件3が成立していない場合、現在A社で利用を許可しているWebブラウザでは、 [ h ] ポリシーによって、社内WebサーバからのHTTPレスポンスを読み取ることはできない。しかし、条件3が成立している場合、攻撃コードが社内WebサーバからのHTTPレスポンスを読み取ることができ、その内容を攻撃者のサイトへ送信することで、社内Webサーバに対する攻撃が成功する。\nA社では、社内Webサーバは、クロスオリジンリクエストに対する図8中の(4)のHTTPレスポンスに、ヘッダとして [ g ] を付加していないことが調査の結果分かった。このため、Q主任は、社内Webサーバ上のデータが操作される可能性はあるものの、Webブラウザ経由で情報が攻撃者のサイトに送信される可能性は低いと判断した。\nQ主任は、追加情報Yによる対策の変更は必要ないことをP部長に報告した。P部長は、念のため社外のセキュリティ専門業者のF氏にレビューを依頼するようQ主任に指示した。\nQ主任から説明を受け、F氏は、攻撃者がA社のプロキシサーバを利用するために必要な情報を知ることができた場合には、図8中の(4), (5)とは別の手法を用いることで、社内Webサーバの情報が攻撃者のサイトに送信されるおそれがあると指摘した。そして、F氏は、⑦どのような機能をもつOSコマンドが社内Webサーバで利用できる場合に、それが可能かを説明した。Q主任は、直ちに対策する必要があるとP部長に報告した。P部長は、対策を追加するとともに、脆弱性Yへの対応を振り返ると、脆弱性レベル高の脆弱性については、重要度レベル低の機器であっても、直ちに脆弱性対策を実施すべき場合があるとして、Q主任に脆弱性対策基準の見直しを指示した。\n\n### 〔脆弱性対策基準の見直し〕\nQ主任は、重要情報を扱ってはいないが社外からアクセスできる機器、及び社外からアクセスできないが重要情報を扱っている機器も、場合によっては直ちに脆弱性に対応する必要があると考えた。ただし、情報システム担当者の作業負荷の観点から、図4において対策が不要となる機器については、引き続き、対策を行わずに済むようにしたい。そこで、脆弱性対策基準の中の“4. 脆弱性対策適用の緊急度判断基準”の修正案（図9）を作成した。\n\n### 図9 脆弱性対策基準の修正案\n- リスクレベルに基づき、脆弱性対策適用の緊急度を判断する。\n- リスクレベル3の場合は、直ちに脆弱性対策を実施する。\n- リスクレベル2の場合は、次回のシステム保守時に脆弱性対策を実施する。ただし、Vチームが機器ごとに緊急度を評価し、その結果、緊急度が高いと判断された場合には、リスクレベル3と同じく、直ちに脆弱性対策を実施する。\n- リスクレベル1の場合は、今後の追加情報に注意して経過を見守る。\n\nこの修正案について、F氏は、⑧Vチームによる評価が必要な場合の数を減らすことができると指摘した。Q主任による修正案（図9）の代わりとして、F氏は、次の2点を提案した。\n- 重要度レベルの定義を修正する。\n- リスクレベルの定義を修正する。\n\nQ主任は、この提案を基に、脆弱性対策基準の別の修正案を作成した。修正箇所を図10に示す。\n\n### 図10 脆弱性対策基準の修正箇所\n1. **機器の重要度レベルの定義**\n   機器ごとの重要度レベルを、次表によって高・中・低の3段階に分ける。\n   | | 重要情報を扱っている | 重要情報を扱っていない |\n   | :--- | :--- | :--- |\n   | 社外からアクセスできる | 重要度レベル高 | [ i ] |\n   | 社外からアクセスできない | 重要度レベル中 | 重要度レベル低 |\n3. **リスクレベルの定義**\n   機器と脆弱性情報の組合せごとのリスクレベルを、次表によってリスクが低い順に1・2・3の3段階に分ける。\n   | | 重要度レベル高 | 重要度レベル中 | 重要度レベル低 |\n   | :--- | :--- | :--- |\n   | 脆弱性レベル高 | リスクレベル3 | リスクレベル2又は3<sup>1)</sup> | リスクレベル2 |\n   | 脆弱性レベル低 | リスクレベル2 | リスクレベル1 | リスクレベル1 |\n   注1) Vチームが機器ごとにリスクを評価し、その結果、 [ j ] というリスク又は [ k ] というリスクが高いと判断された場合は、リスクレベル3とする。\n\nQ主任は、脆弱性対策基準の修正箇所をP部長に説明し、承認を得た。承認された脆弱性対策基準は、即時、Vチーム内に周知された。その後、WAFの導入を含む対応作業も完了し、脆弱性Y対応が終結した。",
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔脆弱性の公表と対応〕について、(1)、(2)に答えよ。",
          "explanation": "### 脆弱性レベルの判断\nSQLインジェクション脆弱性X（CVSS 6.5）について、重要度レベル高の公開Webサーバでのリスクレベルを判定します。\n- 図4より、CVSS 6.5は「脆弱性レベル低」に分類されます。\n- 公開Webサーバは「重要度レベル高」です。\n- 重要度レベル高 × 脆弱性レベル低 ＝ 「リスクレベル2」となります。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線①について、公開Webサーバに対する脆弱性Xの適切なリスクレベルを、図4の脆弱性対策基準に基づき判断し、解答群の中から選び、記号で答えよ。",
              "text_ans": "ウ（リスクレベル2）"
            },
            {
              "label": "(2)",
              "text": "本文中の下線②について、記載する目的は何か。45文字以内で述べよ。",
              "text_ans": "脆弱性情報が公表された際、自社の機器に影響があるかを即座に判断できるようにするため。"
            }
          ]
        },
        {
          "subQNo": "設問2",
          "text": "〔新たな脆弱性の公表と対応〕について、(1)〜(4)に答えよ。",
          "explanation": "### Shellshock脆弱性 (Y)\nbashの脆弱性Yは、環境変数に関数を定義する記述があると、bash起動時に意図しないコマンドが実行されるものです。CGI（Webサーバが外部プログラムを呼び出す仕組み）では、HTTPリクエストヘッダの内容が環境変数にセットされるため、攻撃者がリクエストヘッダを細工することでWebサーバ上で任意のOSコマンドを実行できてしまいます。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線③について、必要な条件を解答群の中から選び、記号で答えよ。",
              "text_ans": "ウ（Webサーバに脆弱性Yがあるbashが導入されていること）"
            },
            {
              "label": "(2)",
              "text": "図7について、Webサーバ(httpd)に対して脆弱性Yを悪用され、図6の例と同様にcatコマンドが実行されたとき、どのような権限で、catコマンドが実行されるか。解答群の中から選び、記号で答えよ。",
              "text_ans": "ウ（WebアプリBの実行時の権限）"
            },
            {
              "label": "(3)",
              "text": "本文中の [ a ] に入れる適切な字句を、10文字以内で答えよ。",
              "text_ans": "HTTPリクエスト"
            },
            {
              "label": "(4)",
              "text": "本文中の下線④について、図7中のWebサーバ(httpd)に対して脆弱性Yを悪用された場合、ファイル /etc/passwd を不正に参照されるときにフィールド値として指定される文字列を答えよ。ここで、catコマンドはディレクトリ /usr/bin 下にあるものとする。",
              "text_ans": "() { :; }; /usr/bin/cat /etc/passwd"
            }
          ]
        },
        {
          "subQNo": "設問3",
          "text": "〔WAFによる脆弱性対策〕について、(1)〜(4)に答えよ。",
          "explanation": "### クラウド型WAFの仕組みと利点\nクラウド型WAF（案2）は、DNSの設定（CNAMEレコード）を変更することで、Webサイトへのトラフィックを一度WAFサービスへ誘導し、検査後に正常な通信のみを実サーバへ転送する仕組みです。機器購入や設置の手間がなく、急なアクセス増大にも契約変更で柔軟に対応できるため、納期が短くスケーラビリティに優れています。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ b ] に入れるWAFの攻撃検知手法を、15文字以内で答えよ。",
              "text_ans": "ブラックリスト方式（またはシグネチャマッチング）"
            },
            {
              "label": "(2)",
              "text": "本文中の下線⑤について、期間が短い理由を検証作業の観点から40文字以内で述べよ。",
              "text_ans": "パッチ適用に比べて、OSやアプリケーションの動作に与える影響の検証範囲が狭いから。"
            },
            {
              "label": "(3)",
              "text": "表1中の [ c ], [ d ] に入れる適切な字句を解答群の中から選び、記号で答えよ。",
              "subQuestions": [
                {
                  "label": "c",
                  "text": "ウ (DNS)"
                },
                {
                  "label": "d",
                  "text": "イ (CNAME)"
                }
              ]
            },
            {
              "label": "(4)",
              "text": "本文中の下線⑥について、Q主任がオンプレミス型ではなくクラウド型を選ぶ根拠となったクラウド型の利点を、50文字以内で述べよ。",
              "text_ans": "トラフィックの急増に柔軟に対応でき、機器の購入や設置が不要なため導入までの期間が短い点。"
            }
          ]
        },
        {
          "subQNo": "設問4",
          "text": "〔脆弱性への追加対応〕について、(1)〜(3)に答えよ。",
          "explanation": "### CSRFとSame Origin Policy\n図8の攻撃は、攻撃者のサイトが「踏み台」となり、閲覧者のブラウザから社内サーバへリクエストを送らせるものです。通常は「同一起源ポリシー(Same Origin Policy)」により、別ドメイン（社内サーバ）からのレスポンスは読み取れませんが、CORSヘッダ（Access-Control-Allow-Origin）が設定されていると読み取りが可能になります。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ f ] に入れる適切な字句を、20文字以内で答えよ。",
              "text_ans": "社内WebサーバのIPアドレス（またはホスト名）"
            },
            {
              "label": "(2)",
              "text": "図8中及び本文中の [ e ], [ g ] 及び [ h ] に入れる適切な字句を解答群の中から選び、記号で答えよ。",
              "subQuestions": [
                {
                  "label": "e",
                  "text": "オ (XMLHttpRequest (XHR))"
                },
                {
                  "label": "g",
                  "text": "ア (Access-Control-Allow-Origin)"
                },
                {
                  "label": "h",
                  "text": "キ (同一生起元)"
                }
              ]
            },
            {
              "label": "(3)",
              "text": "本文中の下線⑦について、どのような機能がこれに該当するか。30文字以内で具体的に述べよ。",
              "text_ans": "外部のサーバとの間で任意の通信を行う機能"
            }
          ]
        },
        {
          "subQNo": "設問5",
          "text": "〔脆弱性対策基準の見直し〕について、(1)〜(3)に答えよ。",
          "explanation": "### 基準の最適化\n「社外からアクセスできるが重要情報を扱っていない」機器は、侵入の足掛かり（踏み台）にされるリスクがあります。これを「重要度レベル中」に格上げし、脆弱性レベル高のときのリスクをVチームで個別に評価（改ざんや踏み台のリスク）することで、一律の即時対応は避けつつ、必要な対策を漏れなく実施できるようにしています。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図10中の [ i ] に入れる適切な句を答えよ。",
              "text_ans": "重要度レベル中"
            },
            {
              "label": "(2)",
              "text": "本文中の下線⑧について、図9の案ではリスクレベルの判定を行わなければならないが、図10では行わなくて済むのはどのような場合か。解答群から全て選び、記号で答えよ。",
              "text_ans": "ア、イ、オ、カ"
            },
            {
              "label": "(3)",
              "text": "図10中の [ j ], [ k ] に入れる適切な字句をそれぞれ15文字以内で答えよ。",
              "text_ans": "j: 情報を改ざんされる / k: 他の機器への攻撃の踏み台にされる"
            }
          ]
        }
      ],
      "point": 50
    }
  ]
}