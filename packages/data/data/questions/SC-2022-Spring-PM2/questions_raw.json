{
  "qNo": 1,
  "theme": "Webサイトのセキュリティ管理と脆弱性診断（XSS, CSRF, クリックジャッキング, SSRF）及び開発プロセスの見直し",
  "description": "A社は、従業員 1,500名の中堅システム開発会社であり、セキュリティ品質の高い Web サイトを開発するために、表1に示す Web セキュリティ管理基準を定めて運用している。\n\n## 表1 Webセキュリティ管理基準(抜粋)\n| 項番 | 管理策 | 概要 |\n| :--- | :--- | :--- |\n| 1 | セキュリティ要件レビュー | ・概要設計,基本設計,詳細設計それぞれの設計レビューにおいて、Webサイトに関するセキュリティ要件をレビューする。 |\n| 2 | ツールによるソースコードレビュー | ・Webサイトのリリースまでに実施する。・期間は、3日間くらいが目安である。・開発環境の特性などが原因で実施できない場合、項番3を行う。・ツールが検出した指摘事項について、開発担当者は,脆弱性かどうか、対策が必要かどうかを判断する。・セッション管理の脆弱性は、一部だけが対象である。・認可・アクセス制御の脆弱性は、対象外である。 |\n| 3 | プロジェクトメンバによるソースコードレビュー | ・項番2が実施できない場合, Webサイトのリリースまでに実施する。・期間は、10日間くらいが目安である。・A社の指定した既知の脆弱なコードパターンを見つける。・レビューでの指摘事項について、開発担当者は、脆弱性かどうか、対策が必要かどうかを判断する。・セッション管理の脆弱性は、一部だけが対象である。・認可・アクセス制御の脆弱性は、対象外である。 |\n| 4 | ツールによる脆弱性診断 | ・Webサイトのリリースまでに実施する。・期間は、3日間くらいが目安である。・Webサイトをテスト環境で稼働させ、ツールでWebサイトに様々な HTTP リクエストを送り、その応答を評価する。・ツールが検出した指摘事項について、開発担当者は、脆弱性かどうか、対策が必要かどうかを判断する。・セッション管理の脆弱性は、一部だけが対象である。・認可・アクセス制御の脆弱性は、対象外である。 |\n| 5 | 専門技術者による脆弱性診断 | ・Webサイトのリリースまでに実施する。・期間は、10日間くらいが目安である。・専門会社注1)に委託する。・Webサイトをテスト環境で稼働させ, Webサイトに様々な HTTPリクエストを送り、その応答を評価する。・診断による指摘事項について、専門技術者と開発担当者は、対策が必要かどうかを協議して判断する。・セッション管理の脆弱性は、対象である。・認可・アクセス制御の脆弱性は、対象である。 |\n| 注 | 脆弱性診断サービスを提供しているD社に委託している。 | |\n\n## [A社によるB社の子会社化]\nB社は、従業員200名の新興の IT サービス会社であり,各種 SaaS を提供している。アジャイル開発の能力が高く、機能の追加や性能の改善を頻繁に行っている。B社と A 社とは協業関係にあったが、両社の経営陣は、双方の強みを生かせると判断し、A社によるB社の子会社化について合意した。\nB社のクラウド環境には、コーポレートサイト(以下,サイトBという)、及びB社が提供中の三つの SaaS それぞれの Web サイト(以下、サイトX, サイトY, サイトZという)がある。それらの概要を表2に示す。\n\n## 表2 B社の Web サイトの概要\n| サイト名及び URL | 概要 | システム構成 |\n| :--- | :--- | :--- |\n| サイト B https://www.b-sha.co.jp/ | ・B社に関する情報を発信している。・コンテンツマネジメントシステム (CMS)を導入し、運用している。 | IaaS 上の Web サーバで構成されている。 |\n| サイト X https://x.b-sha.co.jp/ | ・会社又は組織向けのコミュニケーションサービスであり、利用する会社間又は組織間で、情報共有やチャットが行える。・利用する会社又は組織は、B社の提携企業の新商品のモニターになると、“キャンペーン応募”をサイトXで行える。 | IaaS 上の Web サーバ及びデータベースサーバ 注1) (以下, DBサーバという) で構成されている。 |\n| サイト Y https://y.b-sha.co.jp/ | ・個人向けのブログサイトであり、利用者が情報を発信できる。・“A社のニューストピック”を表示できる。 | IaaS 上の Web サーバ及びデータベースサーバ 注1) (以下, DBサーバという) で構成されている。 |\n| サイト Z https://z.b-sha.co.jp/ | ・ソフトウェア開発企業向けの Web サービスである。利用者はグループを作ることができ、そのグループ内で、スケジュール、タスク、ソースコードなどのプロジェクト情報を共有できる。・外部のWebサイトと連携して、経費精算、出張申請などの業務手続を行う機能を提供予定である。 | IaaS 上の Web サーバ及びデータベースサーバ 注1) (以下, DBサーバという) で構成されている。 |\n| 注1) | DB サーバには、B社のシステム担当者と、それぞれのサイトの Web サーバとがアクセスできる。各DBサーバには、レコードの更新や削除が簡単にできるメンテナンス用の Web インタフェースがある。そのURLを次に示す。・サイトXのDB サーバ: https://db-x.b-sha.co.jp/・サイトYのDB サーバ: https://db-y.b-sha.co.jp/・サイトZのDB サーバ: https://db-z.b-sha.co.jp/ | |\n\n子会社化に当たって、B社の Web サイトのセキュリティ水準を確認することになり、A社の品質管理部でセキュリティ技術を担当しているRさんが対応することになった。\n\n## [B社のWebサイトのセキュリティ水準の確認]\nRさんは、サイトB, サイトX, サイトY及びサイトZに対する脆弱性診断をD社に依頼した。診断の結果、検出された脆弱性を表3に示す。\n\n## 表3 検出された脆弱性(抜粋)\n| サイト名 | 脆弱性名 |\n| :--- | :--- |\n| サイト B | ・クロスサイトスクリプティング(以下,XSSという) 脆弱性 |\n| サイト X | ・XSS 脆弱性・クロスサイトリクエストフォージェリ(以下,CSRF という)脆弱性・クリックジャッキング脆弱性 |\n| サイト Y | ・XSS 脆弱性・サーバサイドリクエストフォージェリ (以下,SSRF という)脆弱性 |\n| サイト Z | ・XSS 脆弱性・SSRF 脆弱性 |\n\n### [サイトBのXSS 脆弱性]\nD社は、サイトBに①診断用リクエストを送ることで、XSS 脆弱性があることを確認した。このリクエストは、ライブラリ Mを使ってプログラムCが処理する。ライブラリ Mのコードを図1に示す。\n\n**図1 ライブラリ Mのコード**\n```\n(省略)\n1: out.println(\"<meta property=\\\"og:url\\\" content=\\\"https://\"+serverName+\"/\"\n+scriptName+\"?\"+queryString+\"\\\"> \");\n(省略)\n```\n注記 serverName には、リクエストのURLのホスト名が格納されている。scriptName には、URLのパス名が格納されている。queryStringには、URLのクエリ文字列以降の値が URL デコードされて格納されている。\n\nライブラリMは、SEOのためのライブラリである。\nB社では、開発部のメンバそれぞれが、開発時に利用可能なライブラリを収集している。使用するライブラリは、マルウェアが含まれていない、既知の脆弱性が修正された、安全性が確認できているライブラリを公開している Web サイトから、ファイルサーバにダウンロードし、利用している。ファイルサーバは、開発部のメンバであればアクセス可能である。\n\n今回使われていたライブラリ Mは、既知のXSS 脆弱性の対策をしていないバージョンであった。その結果、ライブラリ Mを使っているサイトB, サイトX, サイトY及びサイトZにおいて、同じ XSS 脆弱性が検出された。これを受けて、B社における②再発防止策について検討した。\n\n### [サイトXのCSRF 脆弱性]\nサイトXは、セッションIDをJSESSIONID という cookie に格納している。D社は、サイトXのキャンペーン応募ページで CSRF 脆弱性を検出した。\nCSRF 脆弱性を確認した手順は、次のとおりであった。\n(1) 診断用利用者(以下,利用者Aという)の利用者ID でサイトXにログインし、キャンペーン応募ページで送信されるリクエストの内容をツールを使って確認した。リクエストの内容を図2に示す。\n\n**図2 リクエストの内容**\n```\nPOST /campaign HTTP/1.1\nHost: x.b-sha.co.jp\nCookie: JSESSIONID=KCRQ88ERH2G8MGT319E5OSMOAJFDIVEM\n\ncsrftoken=3f4aee446f680df6e0842d7179fcefd00fe5b232\n\n注記1 リクエストヘッダ部分は、設問に必要なものだけを記載している。\n注記2 JSESSIONID について、SameSite 属性は指定されていない。\n注記3 csrftoken の値は、サーバが発行する推測困難な値であり、ほかの利用者の利用時には別の値が発行される。\n注記4 リクエストを送るとトークンが破棄される可能性があるので、リクエストの内容は、ツールで確認しただけであり、実際にはサイトXに届いていない。\n```\nリクエストの内容を確認後, csrftoken を CSRF 対策用のパラメタと考え、リクエスト中の csrftoken の値を削除して送信した場合と1文字変更して送信した場合を試したところ、どちらもエラーになった。\n(2) 利用者Aとは別の診断用利用者(以下,利用者Bという)の利用者ID でサイトX にログインし、キャンペーン応募ページで送信されるリクエスト中の csrftoken の値に、図2のcsrftoken の値を設定して送信したところ、利用者Bとして処理された。\n\nこの結果から, csrftoken と [ a ] 又は [ b ] とをひも付けるという対策ができていないことが分かった。\n\n### [サイトXのクリックジャッキング脆弱性]\nサイトXでは、クリックジャッキングによって、利用者が気付かずに利用者情報の公開範囲を変更させられてしまう脆弱性が検出された。攻撃者が図3の画面を用いてクリックジャッキングを行う場合を仮定してみる。このとき、クリックイベントは、利用者から見て手前にある画面上で発生するものとする。\n\n**図3 攻撃者が用いる画面**\n```mermaid\ngraph TD\n    subgraph 画面α\n        direction LR\n        A[利用者情報の公開範囲設定]\n        B(制限なし)\n        C(同一組織内)\n        D[更新]\n    end\n    subgraph 画面β\n        E[ここをクリックして]\n        F[次にここをクリック]\n    end\n```\n攻撃者は, 画面 [ c ] を利用者から見て [ d ] に [ e ] 状態で罠サイトに公開し、サイト X の画面 [ f ] を利用者から見て [ g ] に [ h ] 状態で重ねて表示する。この状態のサイトにアクセスした利用者は、意図せず利用者情報の公開範囲を変更させられてしまう可能性がある。\nクリックジャッキング脆弱性の対策には、レスポンスヘッダに [ i ] を含める方法と [ j ] を含める方法がある。後者は標準化されている。\n\n### [サイトYのSSRF 脆弱性]\nサイトYでは、例えば、図4のリクエストを受け取ると、A社のニューストピックを取得し、表示するようになっている。\n\n**図4 A社のニューストピックを取得するリクエスト**\n```\nGET /news?topic=https://www.a-sha.co.jp/news/20220417.html HTTP/1.1\n(省略)\n注記 topic パラメタにA社のニューストピックのURLを指定している。\n```\nこの処理に SSRF 脆弱性があった。D社は、③図4のリクエスト中の値を変更してサイトYに送り、サイトYのDBサーバのメンテナンス用 Web インタフェースにアクセスできることを確認した。\n\n### [サイトZのSSRF 脆弱性]\nサイトZでは、最近、新機能が開発された。新機能の一つである、旅行会社P社の宿泊サイト(以下,P社宿泊サイトという)との連携機能でSSRF 脆弱性が検出された。その機能は、駅名を入力すると、その駅近辺のホテルの割引クーポンなどの“お得情報”を表示できるというものである。利用者が、P社宿泊サイトに登録されている駅名の一つ、“東京”を入力したときの流れを図5に、登録されていない架空の駅名である“abc” を入力したときの流れを図6に、D社の専門技術者V氏がSSRF 脆弱性を検出した手順を表4に示す。\n\n**図5 登録されている駅名である“東京”を入力したときの流れ**\n```mermaid\nsequenceDiagram\n    participant U as 利用者\n    participant Z as サイトZ\n    participant P as P社宿泊サイト\n\n    U->>Z: (1) \"東京\"駅近辺の\"お得情報\"を取得するリクエスト\n    Z->>P: (2) \"東京\"駅近辺の\"お得情報\"を取得するリクエスト\n    P->>Z: (3) \"東京\"駅近辺の\"お得情報\"\n    Z->>U: (4) \"東京\"駅近辺の\"お得情報\"を含むページ\n\n    note over U,Z: (1) GET/station/%E6%9D%B1%E4%BA%AC HTTP/1.1 Host: z.b-sha.co.jp\n    note over Z,P: (2) GET/station/%E6%9D%B1%E4%BA%AC?returnURL=https://z.b-sha.co.jp/error HTTP/1.1 Authorization: Basic\n    note over P,Z: (3) \"東京\"駅近辺の\"お得情報\"\n    note over Z,U: (4) \"東京\"駅近辺の\"お得情報\"を含むページ\n```\n\n**図6 登録されていない駅名である“abc”を入力したときの流れ**\n```mermaid\nsequenceDiagram\n    participant U as 利用者\n    participant Z as サイトZ\n    participant P as P社宿泊サイト\n\n    U->>Z: (1) \"abc\" 駅近辺の\"お得情報\"を取得するリクエスト\n    Z->>P: (2) \"abc\" 駅近辺の\"お得情報\"を取得するリクエスト\n    P->>Z: (3) \"abc\"駅が登録されていなかったことを知らせるレスポンス\n    Z->>Z: (4) サーバ上にあるエラーページのテンプレート情報 (GET/error HTTP/1.1)\n    Z->>U: (5) 登録されていない駅名が入力されたことを示すエラーページ\n\n    note over U,Z: (1) GET/station/abc HTTP/1.1 Host: z.b-sha.co.jp\n    note over Z,P: (2) GET/station/abc?returnURL=https://z.b-sha.co.jp/error HTTP/1.1 Authorization: Basic\n    note over P,Z: (3) HTTP/1.1 301 MOVED PERMANENTLY\n    note over Z: (4) GET/error HTTP/1.1\n    note over Z,U: (5) エラーページ\n```\n\n**表4 SSRF 脆弱性を検出した手順**\n| 順序 | 手順 |\n| :--- | :--- |\n| 1 | P社宿泊サイトに登録されていない駅名,例えば,“abc”を入力し、Host ヘッダの値を、V氏が用意したサイトの FQDN に変更して、サイトZにリクエストを送る。 |\n| 2 | サイトZは、P社宿泊サイトに, “/station/abc”をリクエスト URI に指定したリクエストを送る。 |\n| 3 | P社宿泊サイトは, Location ヘッダに [ k ] のURLを含めたレスポンスをサイトZに返す。 |\n| 4 | サイトZは、受け取ったレスポンスを基に、 [ k ] にリクエストを送る。 |\n\n表4の手順によって、V氏は, Authorization ヘッダの値を受け取ることができた。P社の協力の下、この値を用いることで、本来許可なしではアクセスできないP社宿泊サイトや同じ Authorization ヘッダの値を利用する P社保有のサーバへのアクセスが可能になることを確認した。\nD社からは、P社宿泊サイトからのレスポンスに含まれる URL が想定されたものかを調べて想定外の値の場合はその URL にはアクセスしないようにするという, SSRF 脆弱性への対策が提案された。加えて、④別の対策も実施することが望ましいとのことであった。\n\nRさんは、D社の脆弱性診断で検出された脆弱性について、B社の開発部のE課長に報告した。その後、B社の開発部によって対策が実施され、D社による再度の脆弱性診断で問題が修正されたことが確認された。\n\n## [開発プロセスの見直し]\nB社のWebサイトのセキュリティ水準について、Rさんは、開発プロセスの観点からも調査を進めた。\nB社では、顧客に機能の追加要望や性能の改善要望をヒアリングしながら、開発部内で目標を設定し,アジャイル開発を行っている。また、社外の研修などでセキュアプログラミングの知識を習得し、その知識を生かして Web サイトを開発している。\nB社の開発プロセスの概要を図7に示す。\n\n**図7 B社の開発プロセスの概要**\n```mermaid\ngraph LR\n    subgraph 開発フェーズ\n        D1[設計] --> I1[実装] --> T1[テスト] -- 試作版1 --> CF\n        D2[設計] --> I2[実装] --> T2[テスト] -- 試作版N --> NR(新規リリース)\n        T1 --> D2\n        T2 --> CF\n        D1 & I1 & T1 & D2 & I2 & T2: 開発フェーズ\n    end\n    subgraph 改良フェーズ\n        direction LR\n        D3[設計] --> I3[実装] --> T3[テスト] --> CR1(改良リリース)\n        CR1 --> V1(改良版1)\n        CR1 --> D4\n        D4[設計] --> I4[実装] --> T4[テスト] --> CR2(改良リリース)\n        CR2 --> V2(改良版2)\n        CR2 --> MP(1か月の休止期間) --> D3\n        MP --> MP\n        CR1 --> D3\n        T4 --> CR2\n\n    end\n    NR --> CF(改良フェーズ)\n\n    style NR fill:#ccffcc\n    style CR1 fill:#ffff99\n    style CR2 fill:#ffff99\n    style MP fill:#ffcc99\n```\n注記1 ライブラリの活用などで2週間周期での改良リリースを実現しているが、およそ20回に1回は大規模な改修があり、改良リリース間隔を1か月とすることがある。\n注記2 改良フェーズにおいて、半年に1回、1か月の休止期間を設けている。その間、開発部のメンバは、長期休暇の取得、長期研修の受講, Web サイトの点検などを実施している。\n\nRさんとE課長（開発部）の会話。\nE課長: 改良リリースの周期は2週間。専門技術者による脆弱性診断には、その周期の大半を費やしてしまうので、省略⑤できないでしょうか。\nRさん: ⑤ソースコードレビューやツールによる脆弱性診断では発見できないが、専門技術者による脆弱性診断では発見できる脆弱性が多くあります。専門技術者による脆弱性診断を改良リリースにおいて毎回実施できない場合でも、当該診断が長期間行われないことを避けるために、⑥時期を決めて実施することや、⑦開発プロセスを見直すことを検討してみてください。\nE課長: 分かりました。そのほかに、アジャイル開発に合った脆弱性対策はないでしょうか。\nRさん: Webサイトの実装に必要となる一般的な機能や定型コードを、ライブラリとしてあらかじめ用意したフレームワークには、⑧脆弱性対策が組み込まれていて、それがデフォルトで有効になっているものもあるので、利用を検討してみてください。\n",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "〔サイトBのXSS 脆弱性〕について、(1), (2)に答えよ。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の下線①における診断用リクエストの構成要素を、解答群の中から選び、記号で答えよ。\n解答群\nア リクエストライン:GET/confirm?\"\\u003e\\u003cimg src=1 onerror=alert(1)\\u003e\\u003c\"\nイ リクエストライン: GET/confirm?> <img src=1 onerror=alert(1)>\"\\u003c\"\nウ リクエストライン: POST/confirm\nリクエストボディ: \"\\u003e\\u003cimg src=1 onerror=alert(1)\\u003e\\u003c\"\nエ リクエストライン: POST/confirm\nリクエストボディ: >\\u003cimg src=1 onerror=alert(1)\\u003e\\u003c\""
        },
        {
          "label": "(2)",
          "text": "本文中の下線②について、考えられる再発防止策を,35字以内で述べよ。"
        }
      ],
      "explanation": "### 設問1 (1) 解説\n**解答: ア**\n\nサイトBのXSS脆弱性は、図1のコードにおいて、クエリ文字列(`queryString`)がHTMLタグの属性値内にエスケープされずに直接出力されていることに起因します。\n\n```html\n<meta property=\"og:url\" content=\"https://...?[queryStringの値]\">\n```\n\n攻撃を成功させるには、まず `content` 属性を閉じ、次に `meta` タグ自体を閉じる必要があります。一般的なXSSペイロードである `\"><img src=1 onerror=alert(1)><` を `queryString` として注入します。\n\n1.  **\"** (ダブルクォート): `content` 属性を閉じる。\n2.  **>** (不等号): `meta` タグを閉じる。\n3.  **<img src=1 onerror=alert(1)>**: 任意のHTML要素（ここではXSSペイロード）を挿入。\n4.  **<**: ペイロード終了。\n\n解答群アの `GET/confirm?\"\\u003e\\u003cimg src=1 onerror=alert(1)\\u003e\\u003c\"` は、クエリ文字列として `\"\\u003e\\u003cimg src=1 onerror=alert(1)\\u003e\\u003c\"` が送信されることを想定しています。これは、URLデコード後に `"><img src=1 onerror=alert(1)><"` となり、XSSを成立させるための典型的なペイロードです。（末尾の`"`は元のコードの`">`と結合して`"">`になるが、XSSは既に成功している）。\n\n### 設問1 (2) 解説\n**解答例: 安全性が確認されたライブラリをリスト化し、それ以外は使用しないよう制限する。** (34字)\n\nXSS脆弱性の原因として、既知の脆弱性対策をしていないライブラリMを利用していたことが指摘されています。開発者が個別にライブラリを収集・利用できる環境にあるため、安全なライブラリのみを使用する仕組みが必要です。\n\nまた、根本的な対策としては「ユーザーからの入力をHTMLに出力する際、適切なエスケープ処理を実施する」も考えられますが、文脈（ライブラリ管理の不備）を考慮すると、ライブラリの使用に関するプロセス改善がより適切な再発防止策となります。"
    },
    {
      "subQNo": "設問2",
      "text": "本文中の [ a ], [ b ] に入れる適切な字句を答えよ。",
      "explanation": "### 設問2 解説\n\nサイトXのCSRF脆弱性の確認手順(2)では、利用者Bがログインしたセッションで、利用者AのCSRFトークンを使用してリクエストを送信したところ、処理が成功しました。これは、サーバがそのトークンが現在のセッションや、そのセッションを保持する利用者に紐づいているかを検証していないことを意味します。\n\nCSRFトークンは、そのトークンを発行した**セッションID**や、そのセッションに対応する**利用者ID**（または**利用者の識別情報**）と紐づけて検証する必要があります。\n\n*   [ a ]: **セッションID**\n*   [ b ]: **利用者ID**"
    },
    {
      "subQNo": "設問3",
      "text": "〔サイトXのクリックジャッキング脆弱性〕について、(1), (2)に答えよ。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の [ c ] 〜 [ h ] に入れる適切な字句を、それぞれの解答群の中から選び、記号で答えよ。\nc, fに関する解答群: ア α, イ β\nd, gに関する解答群: ア 奥, イ 手前\ne, hに関する解答群: ア 可視の, イ 透明な"
        },
        {
          "label": "(2)",
          "text": "本文中の [ i ], [ j ] に入れる適切な字句を、解答群の中から選び、記号で答えよ。\n解答群\nア Content-Disposition\nイ Content-Security-Policy\nウ X-Content-Type-Options\nエ X-Frame-Options"
        }
      ],
      "explanation": "### 設問3 (1) 解説\nクリックジャッキング攻撃では、ユーザーを騙すための罠サイト（画面β）を一番手前（可視）に配置し、クリックさせたいターゲットサイト（画面α）を奥に配置したIFrame内に埋め込み、そのIFrameを透明に設定します。\n\n*   [ c ]: 攻撃者が用意した罠画面は**画面β**です。(イ)\n*   [ d ]: 罠サイト(β)は、利用者から見て一番**手前**に表示されます。(イ)\n*   [ e ]: 罠サイト(β)の見た目（クリックを誘うボタンなど）は通常**可視の**状態です。(ア)\n*   [ f ]: ターゲットとなるサイトXの画面は**画面α**です。(ア)\n*   [ g ]: ターゲット画面(α)は、罠画面(β)よりも**奥**に配置されます。(ア)\n*   [ h ]: ユーザーのクリックイベントを透過させるため、奥にある画面αを埋め込んだIFrame/要素は**透明な**状態で重ねられます。(イ)\n\n### 設問3 (2) 解説\n**解答: i: イ, j: エ**\n\nクリックジャッキング対策として、ブラウザがIFrame内でのコンテンツ表示を制御するために利用されるレスポンスヘッダが問われています。\n\n[ j ] は「後者は標準化されている」とあるため、長らくデファクトスタンダードとして使用されてきた **X-Frame-Options** (エ) が適切です。\n\n[ i ] には、より柔軟な制御が可能で、現在推奨されている **Content-Security-Policy** (イ) の `frame-ancestors` ディレクティブを利用する方法が入ります。\n"
    },
    {
      "subQNo": "設問4",
      "text": "本文中の下線③について、図4のリクエスト中のどの値をどのような値に変更したか。45字以内で具体的に述べよ。",
      "explanation": "### 設問4 解説\n\n下線③は、サイトYのSSRF脆弱性を利用して、サイトYのDBサーバのメンテナンス用Webインタフェースにアクセスした状況を指します。\n\nサイトYは、図4のリクエストの `topic` パラメタに指定されたURLから情報を取得します。これがSSRFの発生源です。\n\nサイトYのDBサーバのメンテナンス用WebインタフェースのURLは、表2の注記1より `https://db-y.b-sha.co.jp/` です。\n\n**解答例: topicパラメタの値を、A社のURLからサイトYのDBサーバのメンテナンス用WebインタフェースのURL(https://db-y.b-sha.co.jp/)に変更した。** (44字)"
    },
    {
      "subQNo": "設問5",
      "text": "〔サイトZのSSRF 脆弱性〕について、(1), (2)に答えよ。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "表4中の [ k ] に入れる適切な字句を,15字以内で答えよ。"
        },
        {
          "label": "(2)",
          "text": "本文中の下線④について、別の対策とは何か。B社で実施することが望ましい対策を,25字以内で述べよ。"
        }
      ],
      "explanation": "### 設問5 (1) 解説\n**解答例: Locationヘッダの値** (10字)\n\n表4の手順3において、P社宿泊サイトはサイトZからのリクエストに対する301レスポンスの一部として、Locationヘッダに [ k ] を含めたURLを返します。手順4で、サイトZは「受け取ったレスポンスを基に、 [ k ] にリクエストを送る」とあるため、[ k ] はP社が返した**Locationヘッダの値**、つまりリダイレクト先URLそのものを指します。\n\nV氏が手順1でHostヘッダを自身のFQDNに変更したため、サイトZはP社からのリダイレクトとして、V氏のサイトのURLを受け取り、そのURL（k）にアクセスすることで、P社向けに利用されるはずだったAuthorizationヘッダの値を受け取ることができたと考えられます。\n\n### 設問5 (2) 解説\n**解答例: Webサーバから内部ネットワークへの通信を遮断する。** (19字)\n\n既に提案された対策（URLのアクセス先チェック）に加え、別の対策として望ましいのは、SSRF攻撃が成功しても内部リソースに被害が及ばないように、ネットワークレベルで防御を講じることです。\n\nサイトYおよびZのWebサーバは、SSRF実行によってDBサーバのメンテナンスインタフェース（内部リソース）にアクセスできてしまいました。Webサーバが、本来アクセスが不要な内部ネットワークセグメント（DBサーバ）に対して通信できないよう、ファイアウォールなどでアウトバウンド通信を制限（最小権限の原則）することが最も効果的です。"
    },
    {
      "subQNo": "設問6",
      "text": "[開発プロセスの見直し〕について、(1)~(4)に答えよ。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の下線⑤について、該当する脆弱性を二つ挙げ、それぞれ15字以内で答えよ。"
        },
        {
          "label": "(2)",
          "text": "本文中の下線⑥について、専門技術者による脆弱性診断が長期間行われないことを避けるためには、どのような時期に実施すればよいか。改良リリースの実施に影響を与えないことを前提に、20字以内で答えよ。"
        },
        {
          "label": "(3)",
          "text": "本文中の下線⑦について、専門技術者による脆弱性診断が長期間行われないことを避けるためには、開発プロセスをどのように見直せばよいか。アジャイル開発の継続を前提に、40字以内で述べよ。"
        },
        {
          "label": "(4)",
          "text": "本文中の下線⑧について,CSRF 脆弱性の場合では,どのような処理を行う機能が考えられるか。その処理を,55字以内で具体的に述べよ。"
        }
      ],
      "explanation": "### 設問6 (1) 解説\n**解答例1: CSRF脆弱性 (15字)**\n**解答例2: SSRF脆弱性 (15字)**\n\n下線⑤は、静的解析や簡易なツール診断では検出が難しく、専門家による動的な診断やロジック分析が必要な脆弱性を指します。\n\n表1において、項番5（専門技術者による診断）はセッション管理と認可・アクセス制御を対象としていますが、項番2, 3, 4はそれらが対象外または一部のみです。CSRFやSSRFは、動的なリクエスト操作や外部連携機能の検証が必要であり、専門家による診断で効果的に検出されます。（表3でも、XSSは他の手段でも検出された可能性があるが、CSRF, クリックジャッキング, SSRFは専門診断の結果として挙げられている）\n\n### 設問6 (2) 解説\n**解答例: 改良フェーズで半年に一度設ける1か月の休止期間。** (20字)\n\n専門技術者による脆弱性診断は期間を要します（10日間）。アジャイル開発の2週間リリースサイクル中に組み込むのは困難であり、リリースの実施に影響を与えてしまいます。\n図7の注記2にある通り、改良フェーズでは半年に一度、1か月の休止期間が設けられています。この期間は、長期休暇や研修、Webサイトの点検などに使われており、脆弱性診断を実施するのに最適です。\n\n### 設問6 (3) 解説\n**解答例: 改良リリースの休止期間とは別に、専門技術者による脆弱性診断を定期的に計画し、実施するプロセスを導入する。** (40字)\n\nアジャイル開発を継続しつつ、長期間診断を避けるためには、開発サイクル（設計、実装、テスト）とは独立した計画が必要です。診断を休止期間に依存させるだけでなく、例えば年次計画などに組み込み、定期的に実施する管理プロセスを明確に導入することが、開発プロセスにおける見直しとなります。\n\n### 設問6 (4) 解説\n**解答例: リクエストごとにセッションに紐づいた推測困難なCSRFトークンを自動で生成し、POSTリクエスト時にそのトークンが一致するか検証する処理。** (55字)\n\nCSRF対策としてフレームワークが提供する機能は、セッションと結びついたトークン（ワンタイムトークン）の自動生成と検証です。これにより、外部からの不正なリクエストを排除できます。設問2で指摘された「セッションIDとトークンをひも付ける」処理を自動で行う機能が該当します。"
    }
  ]
}
```