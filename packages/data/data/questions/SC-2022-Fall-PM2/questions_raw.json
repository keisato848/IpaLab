{
  "qNo": 1,
  "theme": "情報処理安全確保支援士試験 午後 II 問題 (令和4年度秋期)",
  "description": "L社は、従業員200名のセキュリティ関連会社である。L社の脅威情報調査部(以下,Q部という)は、国内で流行しているマルウェアを解析したり、攻撃者グループの攻撃手法を調査したりして、顧客にレポートを提供する事業を行っているほか、四半期レポートを作成して公開している。Q部が管理するネットワークの概要を図1に、システムの概要を表1に示す。\n\n```mermaid\ngraph LR\n    subgraph L社 Q部ネットワーク\n        DPC(D-PC)\n        L2SW(L2SW)\n        VPN_G(VPN-G)\n        subgraph 解析環境\n            WirelessRouter(無線LANルータ)\n        end\n        \n        DPC -- 接続 --> L2SW\n        L2SW --> VPN_G\n        L2SW --- WirelessRouter\n    end\n    \n    Internet(インターネット)\n    Firewall(ファイアウォール)\n    DC(データセンタ)\n    DSystem(Dシステム)\n    \n    VPN_G --> Firewall\n    Firewall -- 接続 --> Internet\n    Firewall --> DC\n    DC --> DSystem\n    \n    VPN_G -. IPsec-VPN .-> DSystem\n    \n    WirelessRouter -.-> Internet\n    \n    %% D-PC: 管理用PC, L2SW: レイヤー2スイッチ, VPN-G: VPNゲートウェイ装置\n```\n**図1 ネットワークの概要**\n\n**表1 システムの概要**\n| 項番 | 名称 | 概要 |\n| :--- | :--- | :--- |\n| 1 | 解析環境 | マルウェアを実行して挙動を確認したり、マルウェアを簡易的に解析して機能を確認したりする環境である。サンドボックス用の複数の仮想マシンで構成されている。各仮想マシンは、動的解析中だけ無線 LAN ルータを経由して、インターネットにアクセスできる状態にする。 |\n| 2 | Dシステム | 自社開発したハニーポット用のシステムであり、Q部の事業に活用している。小規模オフィスから大規模オフィスまでの、疑似オフィス環境 (以下, OF 環境という) 10組などで構成されている。各 OF 環境は、PC のほか, DHCP サーバ、メールサーバ, DNS サーバ、業務用各種サーバといった仮想マシン(以下, OF 機器という)、及びルータで構成されている。必要に応じて、L2SW を含むこともある。各 OF 環境間の通信は全て禁止されている。 |\n| 3 | D-PC | 解析環境及び Dシステムを操作する。Webブラウザを起動しDシステムにアクセスする。 |\n| 4 | VPN-G | Q部ネットワークとDシステムの間を IPsec-VPNで接続する。 |\n\nDシステムの概要を図2に、Dシステムの構成要素の説明を表2に示す。\n\n```mermaid\ngraph TD\n    Internet -- > Firewall(ファイアウォール)\n    Firewall -- > VPN_G(VPN-G)\n    \n    subgraph Q部ネットワーク\n        VPN_G\n    end\n    \n    subgraph Dシステム\n        VPN_G -- > L3SW(L3SW)\n        L3SW -- > L2SW(L2SW)\n        \n        subgraph Other Servers\n            L3SW --> LogServer(監査ログ保存サーバ)\n            L3SW --> WebServer(管理Webサーバ)\n            L3SW --> FileShareServer(ファイルシェアサーバ)\n        end\n        \n        subgraph OF環境\n            Router(ルータ)\n            L2SW -- > Router\n            Router --> OF(OF機器)\n        end\n        L3SW[L3SW: レイヤー3スイッチ]\n    end\n```\n**図2 Dシステムの概要**\n\n**表2 Dシステムの構成要素の説明**\n| 項番 | 構成要素 | 説明 |\n| :--- | :--- | :--- |\n| 1 | OF 機器 | OF 機器での始業時のログインや終業時のログアウトといった利用者の日常的な業務を模した操作は、各 OF 機器上の専用プログラムによって自動的に行われる。各 OF 機器ではログも取得され, ARP テーブルの状態, CPU 使用率といったシステム情報も定期的に記録される。スナップショット機能によって OF 機器は定期的にディスクイメージが保存されており、 OF 機器を任意の保存時点の状態に戻すことができる。 |\n| 2 | ファイルシェアサーバ | D-PC と各 OF 機器との間で転送するファイルを一時的に保存するための仮想マシンである。 |\n| 3 | 監査ログ保存サーバ | OF 環境内の、各 OF 機器で記録された情報、並びにルータ及び L2SW でキャプチャしたパケットを集約して保存する。保存した情報を監査ログと呼び、解析業務などで利用する。 |\n| 4 | 管理 Web サーバ | D-PC から Dシステムを操作するための Web インタフェースを提供する。Dシステムの各構成要素に対して行える操作は次のとおりである。<br>OF 機器: OF 環境内の全部又は個別の OF 機器に対する起動又はシャットダウン、各 OF 機器へのログイン<br>OF 環境内のルータ: OF 環境ごとのインターネット及びファイルシェアサーバとの通信制御の切替え<br>ファイルシェアサーバ: D-PC との間でのファイル転送<br>監査ログ保存サーバ: 監査ログの閲覧 |\n\n各 OF 環境内のルータには、“内部モード”と“公開モード”の二つのモードがあり、各モードでは、表3に示す通信制御のルールに従って各 OF 機器とそれ以外との間での通信制御が行われる。初期設定は内部モードである。\n\n**表3 OF 機器に対するモードごとの通信制御のルール**\n| 項番 | 送信元 | 宛先 | 内部モード | 公開モード |\n| :--- | :--- | :--- | :--- | :--- |\n| 1 | OF 機器 | インターネット | 禁止 | 許可 |\n| 2 | OF 機器 | 監査ログ保存サーバ | 禁止 | 禁止 |\n| 3 | OF 機器 | 管理 Web サーバ | 禁止 | 禁止 |\n| 4 | OF 機器 | ファイルシェアサーバ | 許可 | 禁止 |\n| 5 | OF 機器 | Q部ネットワーク | 禁止 | 禁止 |\n| 6 | インターネット | OF 機器 | 禁止 | 許可 |\n| 7 | 監査ログ保存サーバ | OF 機器 | 許可 | 許可 |\n| 8 | 管理 Web サーバ | OF 機器 | 許可 | 許可 |\n| 9 | ファイルシェアサーバ | OF 機器 | 許可 | 禁止 |\n| 10 | Q部ネットワーク | OF 機器 | 禁止 | 禁止 |\n注記: 通信制御はステートフルパケットインスペクションで行われる。\n\n### [検体の解析作業]\n\n**表4 Tさんが確認した挙動と簡易的な解析の結果**\n| 検体名 | 確認した挙動 | 簡易的な解析の結果 |\n| :--- | :--- | :--- |\n| 検体α | C&C サーバに接続し、プログラムコードをダウンロードした。 | ダウンロードしたプログラムコードは、**①ディスクには展開されずメモリ内だけに展開される**。このプログラムコードは、キーボード入力を記録し、定期的に C&C サーバに送信するキーロガー機能をもつ。 |\n| 検体β | PC 上の特定の拡張子をもつファイルを次々に暗号化した。暗号化完了後にデスクトップの背景を変更して終了した。 | OSの言語設定を参照する。(省略) |\n| 検体γ | 自身のデータの一部を削除して、すぐに終了した。 | 自身が仮想マシン上で動作していることを検知すると、システムコールを使用して自身のプログラムコード中の攻撃コードを削除した後、終了する。この機能は解析を回避するためのものであると考えられる。 |\n\nTさんは、これらの検体の挙動と解析の結果を報告書にまとめ、Y主任に報告した。次は、報告後のTさんとY主任の会話である。\n\nTさん: 今日は金曜日なので、解析環境の仮想マシンは帰宅前に全てシャットダウンして、週明けに改めて解析環境を使い、追加の調査をしようと思います。\nY主任: 近年の攻撃の傾向を考えると、**②今日確認した検体αの挙動**が、検体αを週明けに再実行した時には、攻撃者による変更によって再現できなくなる可能性がある。念のため、今の仮想マシンの状態を保存しておいてほしい。その上で、週明けに改めて解析環境で検体αを実行してみよう。\n\nTさんは、指示に従って保存作業を実施した。週明け、Tさんが改めて検体αを実行したところ、表4の挙動が再現できることを確認した。Tさんは、追加の調査を実施し、Y主任に最終報告をした。その後のQ部内の会議で、検体αはDシステムを用いて詳細に解析すること、検体βは詳細な解析を見送ること、検体γは現在の解析環境ではこれ以上解析できないので、**③別の環境を構築して解析する**ことが決定した。Tさんが、検体αをDシステム上で実行し、インターネットとの通信を解析することになった。\n\n### [ファイル転送手順の改善]\n\n**図3 検体を持ち込んで実行する手順**\n1. D-PCでWebブラウザを起動し、管理 Web サーバにアクセスする。\n2. 解析に使用する OF 環境内のルータが内部モードであることを確認する。\n3. 圧縮した検体をD-PCからファイルシェアサーバに転送する。\n4. OF 環境内の解析に使用する OF 機器にログインし、圧縮した検体をファイルシェアサーバから OF 機器に転送する。\n5. 使用する OF 環境内のルータを公開モードに切り替える。\n6. OF 機器上で、検体を取り出し、実行する。\n\n検体の実行によって生成される OF 機器上のログやファイルなどは、監査ログ保存サーバでは収集されない。そこで、検体の実行後、図4に示すファイル転送手順によってD-PC に転送する。\n\n**図4 ファイル転送手順**\n1. D-PCでWebブラウザを起動し、管理 Webサーバにアクセスする。\n2. 使用した OF 環境内のルータを内部モードに切り替える。\n3. 使用した OF 機器にログインし、ログ自動収集ツールが出力したファイル及び解析に必要な任意のファイル(以下,2種類のファイルをあわせて解析ファイルという)を収集する。\n4. 解析ファイルをファイルシェアサーバに転送する。\n5. 使用した OF 環境内の全部のOF 機器をシャットダウンする。\n6. ファイルシェアサーバ上でマルウェアスキャンを実行し、ファイルシェアサーバがマルウェアに感染していないことを確認した上で、解析ファイルをD-PC に転送する。\n\nTさんは、図4の手順では、OF 環境で実行するマルウェアが,自律的に感染を広げる機能をもっている場合、ファイルシェアサーバに感染が及ぶ可能性があると考えた。そこで、検疫 PC を用いた新しいファイル転送手順案を図5に示す。\n\n**図5 新しいファイル転送手順**\n1. D-PCでWebブラウザを起動し、管理 Web サーバにアクセスする。\n2. 使用した OF 環境内の OF 機器にログインし、解析ファイルを収集する。\n3. [ a ]\n4. [ b ]\n5. 検疫 PC にログインし、マルウェアスキャンを実行して検疫 PC がマルウェアに感染していないことを確認した上で、以降の手順に進む。\n6. [ c ]\n7. [ d ]\n8. ファイルシェアサーバからD-PCに解析ファイルを転送する。(省略)\n\n### [模擬攻撃試験の受験]\n\nTさんは、最初の flag の入手過程で ARP スプーフィングを使用したことから説明を始めることにした。\n\n**表5 Aツールの機能**\n| 項番 | 機能名称 | 機能詳細 |\n| :--- | :--- | :--- |\n| 1 | プローブ機能 | OS 標準の機能を用いて同一セグメント内に ARP 要求を出し、応答を記録する。 |\n| 2 | ARP スプーフィング機能 | 標的の機器の IP アドレスを指定して実行すると、標的の機器が ARP 要求を出した際に、正規の ARP 応答が戻ってくる前に、自身の MAC アドレスを含んだ不正な ARP 応答を送る。 |\n| 3 | 中継機能 | ARP スプーフィング機能が成功した後、自身に送られてきたパケットを加工し、パケットの本来の宛先に転送する。 |\n\n(3) ネットワーク内の機器の情報を得たいと考え、表5中の項番 [ e ] の機能を実行した。実行後のX-PCのARP テーブルは表6であった。\n\n**表6 X-PCのARP テーブル(抜粋)**\n| IP アドレス | MAC アドレス |\n| :--- | :--- |\n| 192.168.15.51 | XX-XX-XX-23-46-4a |\n| 192.168.15.98 | XX-XX-XX-f9-48-1b |\n注記 XX-XX-XX は同一のベンダ IDである。\n\n(4) X-PC の ARP テーブル, X-PC 内のメール情報などを基にして、図6に示すネットワーク図を作成した。\n\n```mermaid\ngraph TD\n    Internet -- > Firewall(ファイアウォール)\n    Firewall -- > Router(ルータ)\n    \n    subgraph 試験用OF環境\n        Router -- L2SW-1 --> XPC(X-PC, IP: 192.168.15.50, MAC: XX-XX-XX-fb-44-25)\n        Router -- L2SW-1 --> DNS(DNSサーバ, IP: 192.168.15.98, MAC: XX-XX-XX-f9-48-1b)\n        Router -- L2SW-1 --> TargetPC(標的PC, IP: 192.168.15.51, MAC: XX-XX-XX-23-46-4a)\n        \n        Router -- L2SW-2 --> HR(人事サーバ, IP: 192.168.16.22)\n        Router -- L2SW-2 --> FileServer(ファイルサーバ, IP: 192.168.16.23)\n        \n        L2SW1[L2SW-1]\n        L2SW2[L2SW-2]\n    end\n```\n**図6 作成したネットワーク図**\n\n(5) ARP スプーフィング機能について、標的PCのIPアドレスを指定して実行した後, DNS サーバの IP アドレスを指定して実行し、標的PCから DNS サーバへの通信を盗み見する準備を整えた。この時のX-PC のARP テーブルは表7,標的PCのARP テーブルは表8のとおりであった。\n\n**表7 ARP スプーフィング機能実行後のX-PCのARP テーブル (抜粋)**\n| IP アドレス | MAC アドレス |\n| :--- | :--- |\n| 192.168.15.51 | [ f ] |\n| 192.168.15.98 | [ g ] |\n\n**表8 ARP スプーフィング機能実行後の標的PCのARP テーブル(抜粋)**\n| IP アドレス | MAC アドレス |\n| :--- | :--- |\n| 192.168.15.50 | [ h ] |\n| 192.168.15.98 | [ i ] |\n\n(6) ARP スプーフィングが成功している証拠を評価者に説明するために、監査ログ保存サーバに記録されていた、L2SW-1 を通過したパケットの記録を確認したところ、表9に示すとおりであった。\n\n**表9 パケットの記録(抜粋)**\n| 送信元 IPアドレス | 宛先 IPアドレス | サービス | 送信元 MACアドレス | 宛先 MACアドレス |\n| :--- | :--- | :--- | :--- | :--- |\n| 192.168.15.51 | 192.168.15.98 | DNS | [ j ] | [ k ] |\n| 192.168.15.51 | 192.168.15.98 | DNS | [ l ] | [ m ] |\n| 192.168.15.98 | 192.168.15.51 | DNS | XX-XX-XX-f9-48-1b | XX-XX-XX-fb-44-25 |\n| 192.168.15.98 | 192.168.15.51 | DNS | [ n ] | [ o ] |\n注記1 ARP スプーフィングに関係するパケットだけを抜粋している。\n注記2 パケットは表中の上から順に送信された。\n\n### [パスワードの解読に関する説明]\n\n**図7 整理した情報**\n1. ファイルサーバに保存されていた人事サーバの設計資料の情報\n・利用者 ID に対してログイン失敗が5回連続した場合は、当該利用者 ID によるログインを10分間ロックする。\n・利用者が設定したパスワードは、Blowfish 暗号を用いた、ソルトあり、**④ストレッチングあり**のハッシュ関数を用いて出力した文字列(以下,H文字列という)の形式で保存される。\n2. 人事サーバに用いられている OSS の既知の脆弱性を悪用して閲覧できたデバッグログの情報\n・システム管理者が直近のログインに成功した時に入力したパスワードに対して出力された H 文字列(以下、文字列Zという)は次のとおりであった。\n`$2b$05$U/fzKvG0d//4E68fqvHJf0trLcfj8LL5i70ziYaG8J5IS.vDpLJFy`\n3. パスワードについての推測\n・システム管理者のパスワードは、いずれも “Admin [数字5桁]”であり、人事サーバにおいても同じ形式のパスワードが用いられていると推測できる。\n\n**表10 攻撃手法と判断理由**\n| 項番 | 攻撃手法 | 困難であると判断した理由 |\n| :--- | :--- | :--- |\n| 1 | 人事サーバに対して、ツールを用いて、ブルートフォース攻撃によるログイン試行をする。 | **⑤ブルートフォース攻撃に対抗する機能があるから** |\n| 2 | 文字列 Zに含まれるハッシュ値から平文を得るために、 [ p ] 攻撃を行う。 | 文字列 Z の生成にはソルトが用いられているから |\n\n(4) 三つ目の攻撃手法として、図8に示すオフライン攻撃の流れをプログラムとして実装し、実行することによってシステム管理者のパスワードを解読した。\n\n```mermaid\ngraph TD\n    A[STEP1: 整数型の変数nに0を代入する];\n    B[STEP2: ⑥n番目の候補となる文字列を生成し、ハッシュ関数を実行。H文字列を出力];\n    C{STEP3: H文字列と文字列Zを比較し、一致するか?};\n    D[STEP4: 変数nに1を加え、STEP2に戻る];\n    E{STEP4: 変数nが最大値か?};\n    F[オフライン攻撃を終了する];\n    G[n番目の候補文字列を出力してオフライン攻撃を終了する];\n    \n    A --> B;\n    B --> C;\n    C -- No --> E;\n    C -- Yes --> G;\n    E -- No --> D;\n    E -- Yes --> F;\n    D --> B;\n```\n**図8 オフライン攻撃の流れ**\n\n### [運用に関する改善提案]\n\nARP スプーフィングの有力な対策方法は二つある。例えば、各PC及びサーバの ARP テーブルを常時監視して、**⑦ ARP テーブルの不審な状態**を確認した場合には、システム管理者が当該 PC 又はサーバ、及びネットワークを調査し、ARP スプーフィングが行われていないかどうかを確認する運用が考えられる。\n\n人事サーバについて、次の点の改善が望ましい。\n(3) ログの観点: [ q ] 。具体的には(省略)\n\n**図9 運用に関する改善提案の報告書(抜粋)**\n\n### 問2. インシデントレスポンスチーム\n\nK社は、従業員500名の輸入卸売業者である。K社のネットワーク構成を図1に、各サーバで取得しているログの内容を表1に示す。\n\n```mermaid\ngraph LR\n    Internet(インターネット) --> FW1(FW)\n    \n    subgraph 本社\n        FW1 -- 接続 --> L3SW1(L3SW)\n        \n        subgraph DMZ\n            FW1 -- 接続 --> MailServer(メールサーバ)\n        end\n        \n        L3SW1 --> L2SW_PC(L2SW)\n        L3SW1 --> FileServer(ファイルサーバ)\n        L3SW1 --> ProxyServer(プロキシサーバ)\n        L2SW_PC --> PC_H(PC)\n    end\n    \n    subgraph 倉庫\n        L3SW1 -- 接続 --> L2SW_W(L2SW)\n        L2SW_W --> PC_W(PC)\n    end\n    \n    subgraph 営業所2\n        L3SW1 -- 接続 --> L2SW_E2(L2SW)\n        L2SW_E2 --> PC_E2(PC)\n    end\n    \n    subgraph 営業所1\n        L3SW1 -- 接続 --> L2SW_E1(L2SW)\n        L2SW_E1 --> PC_E1(PC)\n    end\n    \n    %% FW: ファイアウォール, L3SW: レイヤー3スイッチ, L2SW: レイヤー2スイッチ\n```\n**図1 K社のネットワーク構成 (抜粋)**\n\n**表1 ログの内容(抜粋)**\n| サーバ名 | ログに記録される項目 |\n| :--- | :--- |\n| メールサーバ | イベントの発生日時, 送受信メールの送信元メールアドレス、送受信メールの宛先メールアドレス、メール全体のサイズ、添付ファイルの名称、添付ファイルのサイズ |\n| ファイルサーバ | イベントの発生日時, アクセスされたファイルのパス名, アクセス元の IP アドレス、読み込み書込みの種別 |\n| プロキシサーバ | イベントの発生日時、アクセス元のIPアドレス、アクセス先のURL, 転送したデータのサイズ、アップロードされたファイルのサイズ |\n\n(中略 - 製品C、検知ルール、マルウェアα/βの特性説明)\n\n### [マルウェアβの検知]\n\n**図4 製品Cが記録したPC1~3のイベント (抜粋)**\n(表は省略)\n\nP社は、推測した状況を表5のとおり報告した。\n\n**表5 P社による推測**\n| 発生順序 | 日時 | 事象 |\n| :--- | :--- | :--- |\n| 1 | 5月19日(木) | USB メモリが、 [ a ] に装着された。そのUSBメモリには、 [ b ] というファイルが存在していたが、そのファイルにはマルウェアβという新種のマルウェアが潜んでいた。 |\n| 2 | (省略) | [ c ] が [ b ] のCドライブにコピーされた。 |\n| 3 | (省略) | C ドライブ上の [ c ] を開いて、マクロを実行したところ、マルウェア β が起動した。その直後に、ファイル利用履歴の中から選ばれたと思われる [ d ] というファイルが開かれ、マルウェア β がマクロとして埋め込まれた後、直ちに上書き保存された。 |\n| 4 | (省略) | [ e ] 上で、利用者が [ d ] を開いて、マクロを実行したので、 [ e ] にも感染が広がった。 |\n| 5 | (省略) | さらに、3台目のPCにも感染が広がった。 |\n| 6 | 5月23日(月) 10:00 | 5月22日に更新されたマルウェア定義ファイルにマルウェア β が登録されたので、スケジュールスキャンによってPC1~3のCドライブでマルウェア β が検知された。(駆除失敗の理由については省略) |\n\nP社は、**③マルウェア β が埋め込まれたファイルの削除**など必要な対応を完了した。P社がマルウェアβの検体を静的解析したところ、マルウェアβは、追加のマルウェアをダウンロードする機能をもっていたが、ダウンロードに失敗していたことも分かった。その後、U氏は、P社の運用サービスでは、このような場合は、すぐに検知ルールを作成し、登録しますとW主任に提案した。\n\n### [運用サービスの利用]\n\nP社は、まず、**④マルウェア β と同じ手段による感染の拡大を検知するための検知ルール**を作成して製品Cに登録した。\n\n### [運用体制の組替え]\n\n**図5 レベル判定基準(案)** (省略)\n\n```mermaid\ngraph TD\n    subgraph 従業員\n        A[PCの異常な動作を発見したときは、通報する]\n        B{問合せに応じる}\n        F[対応策を実施する]\n        A --> C\n        B --> J\n        F --> L\n    end\n\n    subgraph IRT\n        C[通報窓口の要員が通報を受け付ける]\n        D[通報窓口の要員が通報内容を確認する]\n        E{インシデント対応の要否を判定する}\n        G[終了]\n        H[被害状況からレベルを判定する]\n        I[レベルに応じた体制をとる]\n        J{問合せを取り次ぐ}\n        K[対応策を決定し、実施する]\n        \n        C --> D\n        D --> E\n        E -- 対応不要 --> G\n        E -- 対応要 --> H\n        H --> I\n        I --> J\n        I --> K\n        K --> F\n    end\n    \n    subgraph P社\n        M[製品Cが警告メールを送信...]\n        N[被害状況を把握する]\n        O[感染,侵入,情報漏えいなどの経路、経緯の特定を行う]\n        \n        M --> E\n        E -- 対応要 --> N\n        N --> O\n        O --> K\n    end\n    \n    L[終了]\n```\n**図6 インシデント対応の流れ (案)**\n\n### [秘密ファイルの流出]\nIRTは、ファイルの公開停止を依頼し、P社に解析サービスを発注した。その後、ファイルNが公開された経緯として可能性の高いものを四つ、表6に示すとおりに想定して順に調査した。\n\n**表6 ファイルNが公開された経緯の想定**\n| 項番 | 公開された経緯 | 調査方法 |\n| :--- | :--- | :--- |\n| 想定1 | 従業員が、攻撃者にだまされた結果、又は意図的に、ファイル Nを攻撃者のメールアドレスに送信し、攻撃者がSサービスにアップロードした。 | メールサーバのログについて、 [ f ] 又は [ g ] が、ファイル Nと一致するものを洗い出す。 |\n| 想定2 | 従業員が、攻撃者にだまされた結果、又は意図的に, HTTP で攻撃者のサーバにファイルNをアップロードし、攻撃者がSサービスにアップロードした。 | プロキシサーバのログについて、ファイル N の [ h ] と、 [ i ] が一致するものを洗い出し、その [ j ] が信頼できるサイトのものかどうか確認する。 |\n| 想定3 | ファイルサーバが不正アクセスを受けて、何らかの方法で攻撃者のサーバにファイルNが送信され、攻撃者がSサービスにアップロードした。 | ファイルサーバのログについて、製品Cの記録と突き合わせて一致しないものを洗い出す。 |\n| 想定4 | 従業員が、USBメモリにファイルを書き込み、社外に持ち出してからSサービスにアップロードした。 | 図7に示す調査計画に従って各PCを調査する。 |\n\n```mermaid\ngraph TD\n    A[USBメモリへの、ファイル名又はファイルサイズがファイルNと一致するファイルの書込み記録を洗い出す。]\n    B{記録あり?}\n    C[詳細調査Aに進む]\n    \n    A --> B\n    B -- Yes --> C\n    B -- No --> D[ファイル名又はファイルサイズがファイルNと一致するファイルの読出し記録を洗い出す。]\n    \n    D --> F{記録あり?}\n    D -- 記録なし --> G[可能性は低い]\n    \n    F -- Yes --> H[ファイルを開いてから1時間以内の、USBメモリへのファイルの書込み記録を洗い出す。]\n    F -- No --> G\n    \n    H --> J{記録あり?}\n    H -- 記録なし --> K[記録なし]\n    \n    J -- Yes --> L[詳細調査Bに進む]\n    J -- No --> K\n```\n**図7 想定4の調査計画**\n\nP社が調査を進めた結果、想定1~3の可能性は低いことが分かったので、想定4について調査を進めた。\nU氏は、従業員がファイルを書き込む際に、 [ k ] という操作をして、ファイル Nと同じ内容が含まれるものの、 [ l ] 及び [ m ] が異なるファイルへと変換した場合が考えられると答えた。\n\n### [再発防止]\n\nP社は、違反する持出し操作のうち製品Cで検知可能な操作について**⑤新たな検知ルール**を作成して、製品Cに登録した。\n\n### [事後評価]\n\n**表7 インシデント対応についての修正案(抜粋)**\n| 項番 | 方針 | 具体的内容 |\n| :--- | :--- | :--- |\n| 1 | IRT での通報受付を早めるために、通報窓口を見直す。 | [ n ] |\n| 2 | 図5中の“影響の広がり”の判定基準を見直す。 | (省略) |\n| 3 | インシデント対応の開始を早めるために、図6を見直す。 | 通報の受付時には、IRT メンバー全員の集合を待たず、最低限のメンバーが集合した時点で対応を開始するかどうかを決定する。 |\n| 4 | 体制のとり方を見直すために、レベルの判定のタイミングを見直す。 | [ o ] |\n",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "[検体の解析作業]について答えよ。\n(1) 表4中の下線①の挙動を特徴とするマルウェアの種類を、解答群の中から選び、記号で答えよ。\n解答群: ア アドウェア, ウ トロイの木馬, オ ランサムウェア, イ 暗号資産採掘マルウェア, エ ファイルレスマルウェア\n(2) 本文中の下線②について、再現ができなくなるのは、攻撃者によって何が変更される場合か。攻撃者によって変更されるものを15字以内で答えよ。\n(3) 本文中の下線③について、現在の解析環境との違いを20字以内で答えよ。",
      "explanation": "### 設問1(1) 解説\n下線①の挙動は「ディスクには展開されずメモリ内だけに展開される」というもので、これはディスク上に痕跡を残さないマルウェア、すなわちファイルレスマルウェアの特徴です。\n\n**正解**: エ\n\n### 設問1(2) 解説\n検体αはC&Cサーバに接続してプログラムコードをダウンロードしています。再現性が失われる可能性があるのは、攻撃者側がC&Cサーバの構成や、ダウンロードされるプログラムコードの内容を変更するためです。再現性の核となるのは、C&Cサーバから送られる具体的な指示やプログラム内容です。\n\n**正解**: C&Cサーバからの応答内容\n\n### 設問1(3) 解説\n現在の解析環境（表1 項番1）は動的解析中のみインターネットにアクセスできますが、検体αはC&C通信を伴うため、Tさんは「検体αをDシステム上で実行し、インターネットとの通信を解析する」ことになりました。Dシステムではルータを公開モードに切り替えることで（図3 ステップ5）、通信を自由に許可し、監査ログ保存サーバ（表2 項番3）でパケットを記録できます。\n\n**正解**: インターネットとの通信を解析できる環境",
      "point": 10,
      "subCategory": "その他"
    },
    {
      "subQNo": "設問2",
      "text": "図5 中の [ a ]、[ d ] に入れる適切な手順を、解答群の中から選び、記号で答えよ。\n解答群:\nア 検疫PCにログインし、検疫PCのPFWの設定を変更して検疫PCと OF 機器との間の通信を許可する。解析ファイルを OF 機器から検疫PCに転送する。\nイ 検疫PCにログインし、検疫PCのPFWの設定を変更して検疫PCとファイルシェアサーバとの間の通信を許可する。解析ファイルを検疫 PC からファイルシェアサーバに転送する。\nウ 検疫PCを除く OF 機器をシャットダウンする。\nエ 使用した OF 環境内のルータを内部モードに切り替える。",
      "explanation": "### 設問2 解説\n図5は、検体実行後（ルータが公開モードになっている可能性が高い）に、OF機器から収集した解析ファイルを、検疫PCを経由させてD-PCへ転送する手順です。ファイルシェアサーバへの感染を防ぐため、検疫PCでのスキャンが必須です。\n\n**全体フロー:**\n1.  ルータを内部モードに戻す (ファイルシェアサーバとの通信ルール適用のため)。\n2.  OF機器 → 検疫PCへファイルを転送する (PFW設定変更が必要)。\n3.  検疫PCでスキャン。\n4.  検疫PC → ファイルシェアサーバへファイルを転送する (PFW設定変更が必要)。\n5.  感染源となったOF機器をシャットダウンする (拡散防止のため)。\n6.  ファイルシェアサーバ → D-PCへ転送。\n\n図5の手順と解答群を比較します。\n\n*   **ステップ3 [ a ]**: 最初にルータモードを内部に戻す必要があります。検体の実行（図3 Step 5）で公開モードになっていた場合、図4 Step 2と同様に、ファイル転送（表3 ルール4, 9）のために**内部モード**に戻さなければなりません。よって [ a ] = エ。\n*   **ステップ4 [ b ]**: OF機器から検疫PCへの転送（ア）が必要です。\n*   **ステップ6 [ c ]**: スキャン後、検疫PCからファイルシェアサーバへの転送（イ）が必要です。\n*   **ステップ7 [ d ]**: 転送元となったOF機器は感染源の可能性があるため、シャットダウンします（図4 Step 5と同様）。よって [ d ] = ウ。\n\n```mermaid\nsequenceDiagram\n    participant DPC\n    participant MW(管理Webサーバ)\n    participant Router\n    participant OF(OF機器)\n    participant QPC(検疫PC)\n    participant FSS(ファイルシェアサーバ)\n    \n    Note over OF, DPC: 1, 2. 解析ファイルをOF機器で収集済\n    DPC->>MW: Webアクセス\n    DPC->>Router: 3. ルータを内部モードに切替え (a: エ)\n    OF->>QPC: 4. 解析ファイルを転送 (b: ア: PFW設定と転送)\n    Note over QPC: 5. マルウェアスキャン実施\n    QPC->>FSS: 6. 解析ファイルを転送 (c: イ: PFW設定と転送)\n    DPC->>OF: 7. OF機器をシャットダウン (d: ウ)\n    FSS->>DPC: 8. 解析ファイルをD-PCへ転送\n```\n\n**正解**: a: エ, d: ウ",
      "point": 9,
      "subCategory": "その他"
    },
    {
      "subQNo": "設問3",
      "text": "[ARP スプーフィングの使用に関する説明]について答えよ。\n(1) 本文中の [ e ] に入れる適切な機能を、表5の中から選び、項番で答えよ。\n(2) 表7中及び表8中の [ f ] ～ [ i ] に入れる適切な MAC アドレスを、解答群の中から選び、記号で答えよ。なお、同一のMACアドレスが入る場合もある。\n解答群: ア XX-XX-XX-23-46-4a, イ XX-XX-XX-f9-48-1b, ウ XX-XX-XX-fb-44-25, エ XX-XX-XX-ff-ff-ff\n(3) 表9中の [ j ] ～ [ o ] に入れる適切な MAC アドレスを、解答群の中から選び、記号で答えよ。なお、同一のMACアドレスが入る場合もある。\n解答群: ア XX-XX-XX-23-46-4a, イ XX-XX-XX-f9-48-1b, ウ XX-XX-XX-fb-44-25, エ XX-XX-XX-ff-ff-ff",
      "explanation": "### 設問3(1) 解説\nTさんは、ARPスプーフィングを行う前に、ネットワーク内の機器情報を取得したいと考えています。これは、IPアドレスとMACアドレスの対応情報を得る「プローブ」の機能（表5 項番1）に該当します。\n\n**正解**: 1\n\n### 設問3(2) 解説\nARPスプーフィング（中間者攻撃, MITM）をX-PC(192.168.15.50, MAC: ウ)で行い、標的PC(192.168.15.51, MAC: ア)とDNSサーバ(192.168.15.98, MAC: イ)間の通信を盗み見ます。\n\n**X-PCのARPテーブル（表7）**\nX-PCは中継機能（項番3）のために、ターゲットの真のMACアドレスを知っている必要があります。\n*   f (192.168.15.51, 標的PCのMAC) = ア\n*   g (192.168.15.98, DNSサーバのMAC) = イ\n\n**標的PCのARPテーブル（表8）**\n標的PCには、X-PCがARP応答を偽装して送ります。\n*   h (192.168.15.50, X-PCのMAC): 攻撃対象ではないため、通常のX-PC MACが記録されます。= ウ\n*   i (192.168.15.98, DNSサーバのMAC): X-PCがDNSサーバを騙るので、X-PC MACが記録されます。= ウ\n\n**正解**: f: ア, g: イ, h: ウ, i: ウ\n\n### 設問3(3) 解説\nパケットはL2SW-1を通過しています。ARPスプーフィングが成功しているため、パケットの宛先MACアドレスは途中でX-PCのMACアドレスに書き換えられます。\n\n*   **Packet 1 (TargetPC → DNS)**: TargetPC (IP: 15.51, MAC: ア) はDNS (15.98)へ送りますが、ARPテーブルにはDNS MACとしてX-PC MAC (ウ)が登録されているため、Destination MACはX-PC MACになります。\n    *   j (送信元 MAC) = ア (15.51のMAC)\n    *   k (宛先 MAC) = ウ (X-PCのMAC)\n*   **Packet 2 (X-PCがDNSへ転送)**: X-PCはパケットを受け取り（k=ウ）、本来の宛先であるDNSへ転送します。Source MACはX-PC MAC (ウ)、Destination MACはDNS MAC (イ)です。\n    *   l (送信元 MAC) = ウ (X-PCのMAC)\n    *   m (宛先 MAC) = イ (15.98のMAC)\n*   **Packet 3 (DNS → TargetPC)**: 監査ログ記載済み。DNS (MAC: イ)はTargetPC (15.51)へ送りますが、ARPテーブルにはTargetPC MACとしてX-PC MAC (ウ)が登録されているため、Destination MACはX-PC MAC (ウ)です。\n*   **Packet 4 (X-PCがTargetPCへ転送)**: X-PCはパケットを受け取り、本来の宛先であるTargetPCへ転送します。Source MACはX-PC MAC (ウ)、Destination MACはTargetPC MAC (ア)です。\n    *   n (送信元 MAC) = ウ (X-PCのMAC)\n    *   o (宛先 MAC) = ア (15.51のMAC)\n\n**正解**: j: ア, k: ウ, l: ウ, m: イ, n: ウ, o: ア",
      "point": 9,
      "subCategory": "その他"
    },
    {
      "subQNo": "設問4",
      "text": "[パスワードの解読に関する説明]について答えよ。\n(1) 図7中の下線④について、どのような処理か。20字以内で具体的に答えよ。\n(2) 表10中の下線⑤について、どのような機能か。40字以内で具体的に答えよ。\n(3) 表10中の [ p ] に入れる適切な攻撃を、解答群の中から選び、記号で答えよ。\n解答群: ア Pass the Hash, ウ 既知平文, イ SHA-1 衝突, エ レインボーテーブル\n(4) 図8中の下線⑥はどのような文字列か。システム管理者のパスワードの特徴を踏まえ,40字以内で具体的に答えよ。",
      "explanation": "### 設問4(1) 解説\nストレッチング（鍵拡張）は、ハッシュ関数の計算を意図的に遅延させるために、ハッシュ処理を繰り返し行うことです。\n\n**正解**: ハッシュ関数を繰り返し実行すること\n\n### 設問4(2) 解説\nブルートフォース攻撃に対抗する機能は、図7の設計資料に記載されている「利用者 ID に対してログイン失敗が5回連続した場合は、当該利用者 ID によるログインを10分間ロックする」機能です。\n\n**正解**: ログイン失敗が5回連続した場合に10分間ロックする機能\n\n### 設問4(3) 解説\n攻撃手法 p は、ハッシュ値Zから平文を得る試みで、ソルトが用いられているために困難と判断されています。ソルトは、レインボーテーブル攻撃（事前に計算されたテーブルを用いた攻撃）を無効化するために使用されます。\n\n**正解**: エ\n\n### 設問4(4) 解説\nシステム管理者のパスワードは「Admin[数字5桁]」と推測されています。図8のSTEP1でn=0から始まり、nが最大値(99999)になるまで候補文字列を生成します。\n\n**正解**: \"Admin\"に00000から99999までの連番を付加した文字列",
      "point": 9,
      "subCategory": "その他"
    },
    {
      "subQNo": "設問5",
      "text": "[運用に関する改善提案]について答えよ。\n(1) 図9中の下線⑦について、どのような状態か。30字以内で具体的に答えよ。\n(2) 図9中の [ q ] に入れる適切な改善提案を,25字以内で答えよ。",
      "explanation": "### 設問5(1) 解説\nARPテーブルの不審な状態とは、ARPスプーフィング攻撃が成功している状態、すなわち特定のIPアドレスに対して、本来の機器のMACアドレスではなく、攻撃者（X-PC）のMACアドレスが対応付けられている状態を指します。\n\n**正解**: 標的の IP アドレスが攻撃者の MAC アドレスに対応している状態\n\n### 設問5(2) 解説\n人事サーバのセキュリティ上の弱点は、デバッグログにハッシュ文字列Z（ソルトとハッシュ値を含む機密情報）が出力されていたことです。これを防ぐためのログの観点からの改善提案は、機密情報が含まれたログの出力を停止することです。\n\n**正解**: 機密情報が含まれたログの出力を停止する",
      "point": 9,
      "subCategory": "その他"
    },
    {
      "subQNo": "設問6_Q2",
      "text": "問2 [インシデントレスポンスチーム] について答えよ。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の下線①, ②について、検知するための単純ルールを、それぞれ30字以内で具体的に答えよ。",
          "point": 9
        },
        {
          "label": "(2)",
          "text": "[マルウェアβの検知] について答えよ。\n表5中の [ a ] ～ [ e ] に入れる適切な時刻,ファイル名又はPC名を答えよ。",
          "subQuestions": [
            {
              "label": "(i)",
              "text": "a, b, c, d, e"
            },
            {
              "label": "(ii)",
              "text": "本文中の下線③について、PC1~3の内蔵SSD 及びファイルサーバから削除すべきファイルは何か。解答群から全て選び、記号で答えよ。\n解答群: ア PC1のC:\\file1.v, イ PC2のC:\\file3.v, ウ PC2のC:\\file6.v, エ PC2のC:\\file8.v, オ PC3のC:\\file4.v, カ PC3のC:\\file7.v, キ 共有フォルダ内のfile2. v"
            }
          ],
          "point": 9
        },
        {
          "label": "(3)",
          "text": "本文中の下線④について、作成した検知ルールを60字以内で答えよ。",
          "point": 9
        },
        {
          "label": "(4)",
          "text": "[秘密ファイルの流出] について答えよ。",
          "subQuestions": [
            {
              "label": "(i)",
              "text": "表6中の [ f ], [ g ] に入れる適切なログの項目名を、表1から選び答えよ。"
            },
            {
              "label": "(ii)",
              "text": "表6中の [ h ] に入れる適切な字句を答えよ。"
            },
            {
              "label": "(iii)",
              "text": "表6中の [ i ], [ j ] に入れる適切なログの項目名を、表1から選び答えよ。"
            },
            {
              "label": "(iv)",
              "text": "本文中の [ k ] ～ [ m ] に入れる適切な字句を、それぞれ 10字以内で答えよ。"
            }
          ],
          "point": 9
        },
        {
          "label": "(5)",
          "text": "本文中の下線⑤について、新たに作成した検知ルールを60字以内で答えよ。",
          "point": 9
        },
        {
          "label": "(6)",
          "text": "表7中の [ n ], [ o ] に入れる適切な字句を、 [ n ] は 30字以内で, [ o ] は50字以内でそれぞれ答えよ。",
          "point": 9
        }
      ],
      "subCategory": "その他"
    }
  ],
  "explanation": {
    "設問6_Q2": {
      "(1)": {
        "text": "マルウェアαの挙動は、「電子メールファイルの読込み」,「同サイズのファイルアップロード」,「OS設定変更」です。これらを単純ルールとして記述します。",
        "subQuestions": [
          {
            "label": "①",
            "answer": "電子メールフォルダ内のファイルを読み込む操作",
            "reason": "マルウェアαはPC上のメールフォルダにある電子メール（ファイル）を読み出します。"
          },
          {
            "label": "②",
            "answer": "読み込んだファイルと同じサイズのファイルをHTTPでアップロードする操作",
            "reason": "マルウェアαは読み出した電子メールファイルを攻撃者サーバにアップロードします。ルール5の複合ルールの条件に「同一のサイズのファイルがHTTPでアップロードされた」とあるため、これを参考にします。"
          }
        ]
      },
      "(2)": {
        "text": "表5のP社による推測は、PC1を感染源とし、共有ファイルN:\\file2.vを介してPC2に感染が拡大したというシナリオに基づいています。時系列はPC1のログを中心に推測します。",
        "subQuestions": [
          {
            "label": "(i)",
            "answer": "a: PC1, b: file1.v, c: C:\\file1.v, d: N:\\file2.v, e: PC2",
            "reason": "aはUSBが装着されたPC名（PC1）。bはUSB上にあった感染ファイル名（file1.v）。cはCドライブにコピーされたパス（C:\\file1.v）。dはマクロ実行後に感染を広げた共有ファイル（N:\\file2.v）。eは共有ファイルを開いて二次感染したPC（PC2）。"
          },
          {
            "label": "(ii)",
            "answer": "ア, イ, ウ, エ, オ, カ, キ",
            "reason": "下線③はマルウェアβが埋め込まれたファイルの削除です。削除すべきは、USBからコピーされた感染源ファイル（ア、イ、オ）、ランサムウェアによって暗号化された可能性のあるファイル（ウ、エ、カ）、および共有フォルダで感染源となったファイル（キ）の全てです。"
          }
        ]
      },
      "(3)": {
        "text": "マルウェアβは、Vソフトデータファイルを介して感染が拡大します。感染経路は「USBからVファイルコピー」→「Vファイル実行」→「共有フォルダのVファイルを上書き」です。このシーケンスを検知ルールとして作成します。",
        "answer": "VソフトがUSBメモリからコピーされたファイルを読み込み、ファイルサーバ上のファイルを上書きする操作が短時間で発生する"
      },
      "(4)": {
        "text": "秘密ファイルの流出経緯の調査におけるログ項目と字句の確認です。",
        "subQuestions": [
          {
            "label": "(i)",
            "answer": "f: 添付ファイルの名称, g: 宛先メールアドレス",
            "reason": "想定1ではファイルNを添付してメール送信しています。メールサーバのログ（表1）で、添付ファイル名がNと一致し、宛先が攻撃者のアドレスであるかを確認します。"
          },
          {
            "label": "(ii)",
            "answer": "サイズ",
            "reason": "想定2はHTTPアップロードです。プロキシサーバログ（表1）の項目とファイルNの特性を比較します。hはファイルNの特性であり、「サイズ」が適切です。"
          },
          {
            "label": "(iii)",
            "answer": "i: アップロードされたファイルのサイズ, j: アクセス先のURL",
            "reason": "iはh（サイズ）に対応するプロキシログの項目です。jはアップロード先のURLであり、信頼できるサイトかどうか確認するために利用されます。"
          },
          {
            "label": "(iv)",
            "answer": "k: 暗号化, l: ファイル名, m: ファイルサイズ",
            "reason": "従業員はファイルを暗号化（k）しようとした際、ファイルNと同じ内容を保ちつつ、暗号化処理によりファイル名（l）やファイルサイズ（m）が異なるファイルに変換されたと考えられます。"
          }
        ]
      },
      "(5)": {
        "text": "下線⑤は、秘密ファイルが管理外のUSBメモリに持ち出されることを検知するルールです。規程（図8）では、秘密ファイルは特定の文字列（【秘密】など）で始まり、使用するUSBはUSB-IDが管理されているものに限定されています。この規程違反を検知します。",
        "answer": "ファイル名が秘密情報を示す文字列で始まるファイルを管理外USBメモリに書き込む操作"
      },
      "(6)": {
        "text": "表7はインシデント対応の修正案です。",
        "subQuestions": [
          {
            "label": "n",
            "answer": "通報窓口の要員が常時通報専用メールアドレスを確認する",
            "reason": "通報受付を早めるには、常時監視が必要です。"
          },
          {
            "label": "o",
            "answer": "最低限のメンバーが招集された時点で被害状況を把握しレベルを判定する",
            "reason": "体制のとり方（IRTメンバー数）はレベル判定によって決まります。迅速に対応するために、レベル判定を早期に行うことが必要です。"
          }
        ]
      }
    }
  }
}