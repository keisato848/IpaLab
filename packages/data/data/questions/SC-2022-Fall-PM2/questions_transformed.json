{
  "questions": [
    {
      "qNo": 1,
      "theme": "マルウェア検体解析とインシデントレスポンス",
      "context": {
        "title": "マルウェア検体解析環境の設定と評価",
        "background": "【注意】この入力データには、大問の背景となる本文（description）が含まれていません。設問文と解説から、マルウェア（検体α）の動的解析と解析環境設定（表1、図3、表2など）に関する問題であると推測されます。\n\nこの問題は、L社におけるシステム認証情報の管理、ハッシュ化の手法、およびそれに対する攻撃手法に関する考察である。設問4では、特にパスワードの解読および認証機能のセキュリティ対策について問われている。\n\n本文が提供されていません。設問5は図9を参照しています。",
        "diagrams": [
          {
            "id": "fig5",
            "label": "解析ファイル転送手順（検体実行後）",
            "type": "mermaid",
            "content": "sequenceDiagram\n    participant DPC\n    participant MW(管理Webサーバ)\n    participant Router\n    participant OF(OF機器)\n    participant QPC(検疫PC)\n    participant FSS(ファイルシェアサーバ)\n    \n    Note over OF, DPC: 1, 2. 解析ファイルをOF機器で収集済\n    DPC->>MW: Webアクセス\n    DPC->>Router: 3. ルータを内部モードに切替え (a: エ)\n    OF->>QPC: 4. 解析ファイルを転送 (b: ア: PFW設定と転送)\n    Note over QPC: 5. マルウェアスキャン実施\n    QPC->>FSS: 6. 解析ファイルを転送 (c: イ: PFW設定と転送)\n    DPC->>OF: 7. OF機器をシャットダウン (d: ウ)\n    FSS->>DPC: 8. 解析ファイルをD-PCへ転送"
          },
          {
            "id": "table5",
            "label": "表5 Tさんが作成したツールの機能",
            "type": "markdown",
            "content": "| 項番 | 機能 | 説明 |\n| :--- | :--- | :--- |\n| 1 | プローブ | IPアドレスとMACアドレスの対応情報を得る |\n| 2 | 偽装応答 | ARP応答を偽装して送信する |\n| 3 | 中継 | 受信したパケットを正規の宛先に転送する |"
          },
          {
            "id": "table7",
            "label": "表7 攻撃成功後のX-PCのARPテーブル",
            "type": "markdown",
            "content": "| 接続先 IPアドレス | MAC アドレス |\n| :--- | :--- |\n| 192.168.15.51 (標的PC) | [ f ] |\n| 192.168.15.98 (DNSサーバ) | [ g ] |"
          },
          {
            "id": "table8",
            "label": "表8 攻撃成功後の標的PCのARPテーブル",
            "type": "markdown",
            "content": "| 接続先 IPアドレス | MAC アドレス |\n| :--- | :--- |\n| 192.168.15.50 (X-PC) | [ h ] |\n| 192.168.15.98 (DNSサーバ) | [ i ] |"
          },
          {
            "id": "table9",
            "label": "表9 L2SW-1を通過するパケット（一部）",
            "type": "markdown",
            "content": "| No. | 送信元 IPアドレス | 宛先 IPアドレス | 送信元 MACアドレス | 宛先 MACアドレス |\n| :--- | :--- | :--- | :--- | :--- |\n| 1 | 192.168.15.51 | 192.168.15.98 | [ j ] | [ k ] |\n| 2 | 192.168.15.50 | 192.168.15.98 | [ l ] | [ m ] |\n| 3 | 192.168.15.98 | 192.168.15.51 | XX-XX-XX-f9-48-1b | XX-XX-XX-fb-44-25 |\n| 4 | 192.168.15.50 | 192.168.15.51 | [ n ] | [ o ] |"
          },
          {
            "id": "fig7",
            "label": "図7 パスワード管理システムに関する設計資料 (抜粋)",
            "type": "image",
            "content": "パスワードのハッシュ化プロセス（ソルトとストレッチング、下線④）や、ログイン失敗回数に基づくアカウントロック機能（下線⑤の根拠）に関する記述を含むと推測される。"
          },
          {
            "id": "table10",
            "label": "表10 ハッシュ値解読の検討",
            "type": "markdown",
            "content": "ハッシュ値Zの解読難易度や、攻撃P（p）、およびこれに対抗するための認証機能（下線⑤）に関する情報をまとめていると推測される。"
          },
          {
            "id": "fig8",
            "label": "図8 パスワード推測ツールの処理フロー",
            "type": "image",
            "content": "システム管理者のパスワードパターン（Admin[数字5桁]）に特化して、候補文字列（下線⑥）を生成し、ハッシュ値と比較するツールの手順を示していると推測される。"
          },
          {
            "id": "fig9",
            "label": "図9 運用改善に関する考察",
            "type": "image",
            "content": "図9の内容は提供されていませんが、ARPテーブルの状態（下線⑦）と、改善提案[q]の箇所が含まれていると推測されます。"
          }
        ]
      },
      "questions": [
        {
          "subQNo": "設問1",
          "text": "[検体の解析作業]について答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "表4中の下線①の挙動を特徴とするマルウェアの種類を、解答群の中から選び、記号で答えよ。\n解答群: ア アドウェア, ウ トロイの木馬, オ ランサムウェア, イ 暗号資産採掘マルウェア, エ ファイルレスマルウェア",
              "answer": "エ",
              "explanation": "下線①の挙動は「ディスクには展開されずメモリ内だけに展開される」というもので、これはディスク上に痕跡を残さないマルウェア、すなわちファイルレスマルウェアの特徴です。",
              "references": [
                "table4"
              ]
            },
            {
              "label": "(2)",
              "text": "本文中の下線②について、再現ができなくなるのは、攻撃者によって何が変更される場合か。攻撃者によって変更されるものを15字以内で答えよ。",
              "answer": "C&Cサーバからの応答内容",
              "explanation": "検体αはC&Cサーバに接続してプログラムコードをダウンロードしています。再現性が失われる可能性があるのは、攻撃者側がC&Cサーバの構成や、ダウンロードされるプログラムコードの内容を変更するためです。再現性の核となるのは、C&Cサーバから送られる具体的な指示やプログラム内容です。"
            },
            {
              "label": "(3)",
              "text": "本文中の下線③について、現在の解析環境との違いを20字以内で答えよ。",
              "answer": "インターネットとの通信を解析できる環境",
              "explanation": "現在の解析環境（表1 項番1）は動的解析中のみインターネットにアクセスできますが、検体αはC&C通信を伴うため、Tさんは「検体αをDシステム上で実行し、インターネットとの通信を解析する」ことになりました。Dシステムではルータを公開モードに切り替えることで（図3 ステップ5）、通信を自由に許可し、監査ログ保存サーバ（表2 項番3）でパケットを記録できます。"
            }
          ],
          "point": 9
        },
        {
          "subQNo": "設問2",
          "text": "図5 中の [ a ]、[ d ] に入れる適切な手順を、解答群の中から選び、記号で答えよ。\n解答群:\nア 検疫PCにログインし、検疫PCのPFWの設定を変更して検疫PCと OF 機器との間の通信を許可する。解析ファイルを OF 機器から検疫PCに転送する。\nイ 検疫PCにログインし、検疫PCのPFWの設定を変更して検疫PCとファイルシェアサーバとの間の通信を許可する。解析ファイルを検疫 PC からファイルシェアサーバに転送する。\nウ 検疫PCを除く OF 機器をシャットダウンする。\nエ 使用した OF 環境内のルータを内部モードに切り替える。",
          "references": [
            "fig5"
          ],
          "answer": "a: エ, d: ウ",
          "explanation": "### 設問2 解説\n図5は、検体実行後（ルータが公開モードになっている可能性が高い）に、OF機器から収集した解析ファイルを、検疫PCを経由させてD-PCへ転送する手順です。ファイルシェアサーバへの感染を防ぐため、検疫PCでのスキャンが必須です。\n\n**全体フロー:**\n1.  ルータを内部モードに戻す (ファイルシェアサーバとの通信ルール適用のため)。\n2.  OF機器 → 検疫PCへファイルを転送する (PFW設定変更が必要)。\n3.  検疫PCでスキャン。\n4.  検疫PC → ファイルシェアサーバへファイルを転送する (PFW設定変更が必要)。\n5.  感染源となったOF機器をシャットダウンする (拡散防止のため)。\n6.  ファイルシェアサーバ → D-PCへ転送。\n\n図5の手順と解答群を比較します。\n\n*   **ステップ3 [ a ]**: 最初にルータモードを内部に戻す必要があります。検体の実行（図3 Step 5）で公開モードになっていた場合、図4 Step 2と同様に、ファイル転送（表3 ルール4, 9）のために**内部モード**に戻さなければなりません。よって [ a ] = エ。\n*   **ステップ4 [ b ]**: OF機器から検疫PCへの転送（ア）が必要です。\n*   **ステップ6 [ c ]**: スキャン後、検疫PCからファイルシェアサーバへの転送（イ）が必要です。\n*   **ステップ7 [ d ]**: 転送元となったOF機器は感染源の可能性があるため、シャットダウンします（図4 Step 5と同様）。よって [ d ] = ウ。\n",
          "point": 9
        },
        {
          "subQNo": "設問3",
          "text": "[ARP スプーフィングの使用に関する説明]について答えよ。\n(1) 本文中の [ e ] に入れる適切な機能を、表5の中から選び、項番で答えよ。\n(2) 表7中及び表8中の [ f ] ～ [ i ] に入れる適切な MAC アドレスを、解答群の中から選び、記号で答えよ。なお、同一のMACアドレスが入る場合もある。\n解答群: ア XX-XX-XX-23-46-4a, イ XX-XX-XX-f9-48-1b, ウ XX-XX-XX-fb-44-25, エ XX-XX-XX-ff-ff-ff\n(3) 表9中の [ j ] ～ [ o ] に入れる適切な MAC アドレスを、解答群の中から選び、記号で答えよ。なお、同一のMACアドレスが入る場合もある。\n解答群: ア XX-XX-XX-23-46-4a, イ XX-XX-XX-f9-48-1b, ウ XX-XX-XX-fb-44-25, エ XX-XX-XX-ff-ff-ff",
          "references": [
            "table5",
            "table7",
            "table8",
            "table9"
          ],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の [ e ] に入れる適切な機能を、表5の中から選び、項番で答えよ。",
              "answer": "1",
              "explanation": "Tさんは、ARPスプーフィングを行う前に、ネットワーク内の機器情報を取得したいと考えています。これは、IPアドレスとMACアドレスの対応情報を得る「プローブ」の機能（表5 項番1）に該当します。\n\n**正解**: 1"
            },
            {
              "label": "(2)",
              "text": "表7中及び表8中の [ f ] ～ [ i ] に入れる適切な MAC アドレスを、解答群の中から選び、記号で答えよ。なお、同一のMACアドレスが入る場合もある。\n解答群: ア XX-XX-XX-23-46-4a, イ XX-XX-XX-f9-48-1b, ウ XX-XX-XX-fb-44-25, エ XX-XX-XX-ff-ff-ff",
              "answer": "f: ア, g: イ, h: ウ, i: ウ",
              "explanation": "ARPスプーフィング（中間者攻撃, MITM）をX-PC(192.168.15.50, MAC: ウ)で行い、標的PC(192.168.15.51, MAC: ア)とDNSサーバ(192.168.15.98, MAC: イ)間の通信を盗み見ます。\n\n**X-PCのARPテーブル（表7）**\nX-PCは中継機能（項番3）のために、ターゲットの真のMACアドレスを知っている必要があります。\n*   f (192.168.15.51, 標的PCのMAC) = ア\n*   g (192.168.15.98, DNSサーバのMAC) = イ\n\n**標的PCのARPテーブル（表8）**\n標的PCには、X-PCがARP応答を偽装して送ります。\n*   h (192.168.15.50, X-PCのMAC): 攻撃対象ではないため、通常のX-PC MACが記録されます。= ウ\n*   i (192.168.15.98, DNSサーバのMAC): X-PCがDNSサーバを騙るので、X-PC MACが記録されます。= ウ\n\n**正解**: f: ア, g: イ, h: ウ, i: ウ"
            },
            {
              "label": "(3)",
              "text": "表9中の [ j ] ～ [ o ] に入れる適切な MAC アドレスを、解答群の中から選び、記号で答えよ。なお、同一のMACアドレスが入る場合もある。\n解答群: ア XX-XX-XX-23-46-4a, イ XX-XX-XX-f9-48-1b, ウ XX-XX-XX-fb-44-25, エ XX-XX-XX-ff-ff-ff",
              "answer": "j: ア, k: ウ, l: ウ, m: イ, n: ウ, o: ア",
              "explanation": "パケットはL2SW-1を通過しています。ARPスプーフィングが成功しているため、パケットの宛先MACアドレスは途中でX-PCのMACアドレスに書き換えられます。\n\n*   **Packet 1 (TargetPC → DNS)**: TargetPC (IP: 15.51, MAC: ア) はDNS (15.98)へ送りますが、ARPテーブルにはDNS MACとしてX-PC MAC (ウ)が登録されているため、Destination MACはX-PC MACになります。\n    *   j (送信元 MAC) = ア (15.51のMAC)\n    *   k (宛先 MAC) = ウ (X-PCのMAC)\n*   **Packet 2 (X-PCがDNSへ転送)**: X-PCはパケットを受け取り（k=ウ）、本来の宛先であるDNSへ転送します。Source MACはX-PC MAC (ウ)、Destination MACはDNS MAC (イ)です。\n    *   l (送信元 MAC) = ウ (X-PCのMAC)\n    *   m (宛先 MAC) = イ (15.98のMAC)\n*   **Packet 3 (DNS → TargetPC)**: 監査ログ記載済み。DNS (MAC: イ)はTargetPC (15.51)へ送りますが、ARPテーブルにはTargetPC MACとしてX-PC MAC (ウ)が登録されているため、Destination MACはX-PC MAC (ウ)です。\n*   **Packet 4 (X-PCがTargetPCへ転送)**: X-PCはパケットを受け取り、本来の宛先であるTargetPCへ転送します。Source MACはX-PC MAC (ウ)、Destination MACはTargetPC MAC (ア)です。\n    *   n (送信元 MAC) = ウ (X-PCのMAC)\n    *   o (宛先 MAC) = ア (15.51のMAC)\n\n**正解**: j: ア, k: ウ, l: ウ, m: イ, n: ウ, o: ア"
            }
          ],
          "point": 9
        },
        {
          "subQNo": "設問4",
          "text": "[パスワードの解読に関する説明]について答えよ。",
          "references": [
            "fig7",
            "fig8",
            "table10"
          ],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図7中の下線④について、どのような処理か。20字以内で具体的に答えよ。",
              "answer": "ハッシュ関数を繰り返し実行すること",
              "explanation": "ストレッチング（鍵拡張）は、ハッシュ関数の計算を意図的に遅延させるために、ハッシュ処理を繰り返し行うことです。"
            },
            {
              "label": "(2)",
              "text": "表10中の下線⑤について、どのような機能か。40字以内で具体的に答えよ。",
              "answer": "ログイン失敗が5回連続した場合に10分間ロックする機能",
              "explanation": "ブルートフォース攻撃に対抗する機能は、図7の設計資料に記載されている「利用者 ID に対してログイン失敗が5回連続した場合は、当該利用者 ID によるログインを10分間ロックする」機能です。"
            },
            {
              "label": "(3)",
              "text": "表10中の [ p ] に入れる適切な攻撃を、解答群の中から選び、記号で答えよ。\n解答群: ア Pass the Hash, ウ 既知平文, イ SHA-1 衝突, エ レインボーテーブル",
              "answer": "エ",
              "explanation": "攻撃手法 p は、ハッシュ値Zから平文を得る試みで、ソルトが用いられているために困難と判断されています。ソルトは、レインボーテーブル攻撃（事前に計算されたテーブルを用いた攻撃）を無効化するために使用されます。"
            },
            {
              "label": "(4)",
              "text": "図8中の下線⑥はどのような文字列か。システム管理者のパスワードの特徴を踏まえ,40字以内で具体的に答えよ。",
              "answer": "\"Admin\"に00000から99999までの連番を付加した文字列",
              "explanation": "システム管理者のパスワードは「Admin[数字5桁]」と推測されています。図8のSTEP1でn=0から始まり、nが最大値(99999)になるまで候補文字列を生成します。"
            }
          ],
          "point": 9
        },
        {
          "subQNo": "設問5",
          "text": "[運用に関する改善提案]について答えよ。",
          "references": [
            "fig9"
          ],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図9中の下線⑦について、どのような状態か。30字以内で具体的に答えよ。",
              "answer": "標的の IP アドレスが攻撃者の MAC アドレスに対応している状態",
              "explanation": "ARPテーブルの不審な状態とは、ARPスプーフィング攻撃が成功している状態、すなわち特定のIPアドレスに対して、本来の機器のMACアドレスではなく、攻撃者（X-PC）のMACアドレスが対応付けられている状態を指します。"
            },
            {
              "label": "(2)",
              "text": "図9中の [ q ] に入れる適切な改善提案を,25字以内で答えよ。",
              "answer": "機密情報が含まれたログの出力を停止する",
              "explanation": "人事サーバのセキュリティ上の弱点は、デバッグログにハッシュ文字列Z（ソルトとハッシュ値を含む機密情報）が出力されていたことです。これを防ぐためのログの観点からの改善提案は、機密情報が含まれたログの出力を停止することです。"
            }
          ],
          "point": 9
        }
      ],
      "description": "提供された入力データには、大問の導入や背景情報が含まれていません。設問3のみに基づき構造化しています。"
    },
    {
      "qNo": 2,
      "theme": "インシデントレスポンスチーム",
      "description": "問2 [インシデントレスポンスチーム] について答えよ。",
      "context": {
        "title": "インシデントレスポンスチームに関するインシデント対応",
        "background": "この設問を解くために必要な背景情報（本文中の下線①～⑤を含む詳細な記述、および表1, 表5, 表6, 表7の内容）は、提供されたJSON入力データには含まれていません。そのため、図表の抽出や本文の参照は行えません。",
        "diagrams": []
      },
      "questions": [
        {
          "subQNo": "設問1",
          "text": "本文中の下線①, ②について、検知するための単純ルールを、それぞれ30字以内で具体的に答えよ。",
          "references": [],
          "point": 9
        },
        {
          "subQNo": "設問2",
          "text": "[マルウェアβの検知] について答えよ。",
          "references": [
            "table5"
          ],
          "subQuestions": [
            {
              "label": "(i)",
              "text": "表5中の [ a ] ～ [ e ] に入れる適切な時刻,ファイル名又はPC名を答えよ。"
            },
            {
              "label": "(ii)",
              "text": "本文中の下線③について、PC1~3の内蔵SSD 及びファイルサーバから削除すべきファイルは何か。解答群から全て選び、記号で答えよ。\n解答群: ア PC1のC:\\file1.v, イ PC2のC:\\file3.v, ウ PC2のC:\\file6.v, エ PC2のC:\\file8.v, オ PC3のC:\\file4.v, カ PC3のC:\\file7.v, キ 共有フォルダ内のfile2. v"
            }
          ],
          "point": 9
        },
        {
          "subQNo": "設問3",
          "text": "本文中の下線④について、作成した検知ルールを60字以内で答えよ。",
          "references": [],
          "point": 9
        },
        {
          "subQNo": "設問4",
          "text": "[秘密ファイルの流出] について答えよ。",
          "references": [
            "table6",
            "table1"
          ],
          "subQuestions": [
            {
              "label": "(i)",
              "text": "表6中の [ f ], [ g ] に入れる適切なログの項目名を、表1から選び答えよ。"
            },
            {
              "label": "(ii)",
              "text": "表6中の [ h ] に入れる適切な字句を答えよ。"
            },
            {
              "label": "(iii)",
              "text": "表6中の [ i ], [ j ] に入れる適切なログの項目名を、表1から選び答えよ。"
            },
            {
              "label": "(iv)",
              "text": "本文中の [ k ] ～ [ m ] に入れる適切な字句を、それぞれ 10字以内で答えよ。"
            }
          ],
          "point": 9
        },
        {
          "subQNo": "設問5",
          "text": "本文中の下線⑤について、新たに作成した検知ルールを60字以内で答えよ。",
          "references": [],
          "point": 9
        },
        {
          "subQNo": "設問6",
          "text": "表7中の [ n ], [ o ] に入れる適切な字句を、 [ n ] は 30字以内で, [ o ] は50字以内でそれぞれ答えよ。",
          "references": [
            "table7"
          ],
          "point": 9
        }
      ]
    }
  ]
}