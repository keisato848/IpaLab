{
  "qNo": 1,
  "theme": "DNSのセキュリティ対策",
  "description": "R社は、Webサイト向けソフトウェアの開発を主業務とする, 従業員約50名の企業である。R社の会社概要や事業内容などをR社のWebサイト(以下, R社サイトという)に掲示している。\n\nR社内からインターネットへのアクセスは、R社が使用するデータセンタを経由して行われている。データセンタのDMZには、R社の Web サーバ、権威 DNS サーバ、キャッシュ DNS サーバなどが設置されている。DMZは、ファイアウォール(以下, FW という)を介して、インターネットとR社社内LANの両方に接続している。データセンタ内のR社のネットワーク構成の一部を図1に示す。\n\n**図1 データセンタ内のR社のネットワーク構成(一部)**\n```mermaid\ngraph LR\n    A[インターネット] -- FW/DNS/HTTP --> F[FW]\n    F -- 接続 --> RLAN[R社社内LAN]\n    F -- 接続 --> R[ルータ]\n    R -- 接続 --> RLAN\n    F -- 接続 --> C[DMZ]\n    \n    subgraph C\n        WS[Webサーバ]\n        ADNS[権威DNSサーバ]\n        CDNS[キャッシュDNSサーバ]\n    end\n    \n    C --> WS\n    C --> ADNS\n    C --> CDNS\n    \n    style C fill:#f9f,stroke:#333,stroke-width:2px\n```\n\nR社サイトは、データセンタ内の Web サーバで運用され,インターネットから R社サイトへは、HTTP Over TLS(以下,HTTPS という)によるアクセスだけが許されている。\n\n### [インシデントの発生]\nR社の顧客である Y社の担当者から、“社員のPCが、R社サイトに埋め込まれていたリンクからマルウェアに感染したと思われる”との連絡を受けた。Y社は、Y社が契約している ISPである Z社の DNS サーバを利用していた。\n\nR社情報システム部のS部長は、部員のTさんに、R社のネットワークのインターネット接続を一時的に切断し、マルウェア感染の状況について調査するように指示した。Tさんが調査した結果,R社の権威 DNS サーバ上の, R社の Web サーバの A レコードが別のサイトの IP アドレスに改ざんされていることが分かった。R社のキャッシュ DNS サーバと Web サーバには、侵入や改ざんされた形跡はなかった。\n\nTさんから報告を受けたS部長は,①Y社のPCがR社の偽サイトに誘導され、マルウェアに感染した可能性が高いと判断した。\n\n### [当該インシデントの原因調査]\nS部長は,当該インシデントの原因調査のために、R社の権威 DNS サーバ、キャッシュ DNS サーバ及び Web サーバの脆弱性診断及びログ解析を実施するよう、Tさんに指示した。Tさんは外部のセキュリティ会社の協力を受けて、脆弱性診断とログ解析を実施した。診断結果の一部を表1に示す。\n\n**表1 R社サーバの脆弱性診断及びログ解析の結果(一部)**\n| 診断対象 | 脆弱性診断結果 | ログ解析結果 |\n|:---|:---|:---|\n| 権威 DNS サーバ | ・OS は最新であったが、DNS ソフトウェアのバージョンが古く、[ a ] を奪取されるおそれがあった。 ・インターネットから権威 DNS サーバへのアクセスは DNS プロトコルだけに制限されていた。 | 業務時間外にログインされた形跡が残っていた。 |\n| キャッシュ DNS サーバ | ・OS及びDNS ソフトウェアは最新であった。 ・インターネットからキャッシュ DNS サーバへのアクセスはDNS プロトコルだけに制限されていた。 | 不審なアクセスの形跡は確認されなかった。 |\n| Web サーバ | ・OS 及び Web サーバのソフトウェアは最新であった。 ・インターネットから Web サーバへのアクセスは HTTPS だけに制限されていた。 | Y社のPCがマルウェア感染した時期に②R社サイトへのアクセスがほとんどなかった。 |\n\n診断結果を確認したS部長は、R社の権威 DNS サーバのDNS ソフトウェアの脆弱性を悪用した攻撃によって [ a ] が奪取された可能性が高いと考え、早急にその脆弱性への対応を行うようにTさんに指示した。\n\nTさんは、R社の権威 DNS サーバの DNS ソフトウェアの脆弱性は、ソフトウェアベンダが提供する最新版のソフトウェアで対応可能であることを確認し、当該ソフトウェアをアップデートしたことをS部長に報告した。S部長はTさんに、R社の権威 DNS サーバ上のR社の Web サーバのAレコードを正しい IPアドレスに戻し、R社のネットワークのインターネット接続を再開させたが、Y社のPCからR社サイトに正しくアクセスできるようになるまで、③しばらく時間が掛かった。R社は、Y社に謝罪するとともに、当該インシデントについて経緯などをとりまとめて、R社サイトなどを通じて、顧客を含む関係者に周知した。\n\n### [セキュリティ対策の検討]\nS部長は、R社の権威 DNS サーバに対する④同様なインシデントの再発防止に有効な対策と、R社のキャッシュ DNS サーバ及びWeb サーバに対するセキュリティ対策の強化を検討するように、Tさんに指示した。\n\nTさんは、R社の Web サーバが使用しているディジタル証明書が、ドメイン名の所有者であることが確認できる DV (Domain Validation) 証明書であることが問題と考えた。そこでTさんは、EV (Extended Validation)証明書を導入することを提案した。R社の Web サーバに EV 証明書を導入し, Web ブラウザでR社サイトにHTTPSでアクセスすると、R社の [ b ] を確認できる。\n\nまたTさんは、⑤R社のキャッシュ DNS サーバがインターネットから問合せ可能であることも問題だと考えた。その対策として、FWの設定を修正して R 社社内LAN からだけ問合せ可能とすることを提案した。また、R社のキャッシュ DNS サーバに、偽の DNS 応答がキャッシュされ、R社の社内LAN上のPCがインターネット上の偽サイトに誘導されてしまう, [ c ] の脅威があると考えた。DNS ソフトウェアの最新版を確認したところ、ソースポートのランダム化などに対応していることから、この脅威については対応済みとして報告した。",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "本文中の下線①で、Y社のPCがR社の偽サイトに誘導された際に、Y社のPCに偽のIPアドレスを返した可能性のある DNS サーバを、解答群の中から全て選び、記号で答えよ。\n\n解答群\nア DNS ルートサーバ\nイ R社のキャッシュ DNSサーバ\nウ R社の権威 DNS サーバ\nエ Z社のDNS サーバ",
      "explanation": "### 解説: 偽のIPアドレスを返したDNSサーバ\n下線①は、Y社のPCがR社の偽サイトに誘導された状況を指しています。\n\nY社PCがR社サイトにアクセスする際のDNS解決の経路は以下の通りです。\n1. Y社PCは、利用しているZ社のDNSサーバ（再帰リゾルバ）にR社サイトのIPアドレスを問い合わせます。\n2. Z社のDNSサーバは、R社の権威DNSサーバに問い合わせます。\n3. R社の権威DNSサーバは、改ざんされた（偽サイトの）IPアドレスをZ社のDNSサーバに返します。（**ウ**）\n4. Z社のDNSサーバは、その偽IPアドレスをキャッシュし、Y社PCに返します。（**エ**）\n\nしたがって、偽のIPアドレスを生成した原因である**ウ R社の権威 DNS サーバ**と、それをY社のPCに回答として返した**エ Z社のDNS サーバ**の両方が、偽のIPアドレスを返した可能性があります。\n\n```mermaid\nsequenceDiagram\n    participant YPC as Y社PC\n    participant ZDNS as Z社のDNSサーバ\n    participant R_ADNS as R社の権威DNSサーバ(改ざん済)\n    \n    YPC->>ZDNS: R社サイトのIPアドレス照会\n    ZDNS->>R_ADNS: R社サイトのIPアドレス照会\n    R_ADNS-->>ZDNS: 偽IPアドレス(改ざんデータ)\n    ZDNS-->>YPC: 偽IPアドレス(キャッシュ/応答)\n    YPC->>Note: 偽サイトに誘導される\n```\n\n**解答**: ウ, エ",
      "point": 13
    },
    {
      "subQNo": "設問2",
      "text": "〔当該インシデントの原因調査〕について、(1)~(3)に答えよ。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "表1及び本文中の [ a ] に入れる適切な字句を、解答群の中から選び、記号で答えよ。\n\n解答群\nア 管理者権限\nイ シリアル番号\nウ ディジタル証明書\nエ 利用者パスワード",
          "point": 13
        },
        {
          "label": "(2)",
          "text": "表1中の下線②で、R社サイトへのアクセスがほとんどなかった理由を 20字以内で述べよ。",
          "point": 13
        },
        {
          "label": "(3)",
          "text": "本文中の下線③で,Y社のPCが正しいR社サイトにアクセスできるようになるまで、しばらく時間が掛かった理由は、どの DNS サーバにキャッシュが残っていたからか、解答群の中から選び、記号で答えよ。\n\n解答群\nア DNS ルートサーバ\nイ R社のキャッシュ DNS サーバ\nウ R社の権威 DNS サーバ\nエ Z社のDNS サーバ",
          "point": 13
        }
      ],
      "explanation": "### 解説: 当該インシデントの原因調査\n\n#### (1) [ a ] に入れる語句\n権威 DNS サーバのDNSソフトウェアのバージョンが古く、脆弱性が存在していました。攻撃者がこの脆弱性を悪用し、業務時間外にログインした形跡があることから、システム設定（Aレコード）を変更するために必要な、そのサーバ上での最高権限を奪取したと考えられます。\n\n**解答**: ア 管理者権限\n\n#### (2) 下線②の理由\n下線②は「Y社のPCがマルウェア感染した時期にR社サイトへのアクセスがほとんどなかった」ことを指しています。原因は、R社の権威DNSサーバのAレコードが改ざんされ、偽サイトのIPアドレスを指すようになっていたためです。Y社PCは偽IPアドレスを受け取り、本来のR社Webサーバではなく、偽サイトに接続しようとしたからです。\n\n**解答**: Aレコードが改ざんされ、偽サイトのIPアドレスを指していたため。\n\n#### (3) 下線③の理由\nR社の権威DNSサーバのAレコードは修正されましたが、Y社PCが利用している**Z社のDNSサーバ**（再帰リゾルバ）には、改ざんされた偽のIPアドレスがキャッシュとして残っていました。このキャッシュの有効期限（TTL）が切れるまでは、Z社DNSサーバは誤った情報をY社PCに返し続けます。R社キャッシュDNSサーバはY社は利用していません。\n\n**解答**: エ Z社のDNS サーバ"
    },
    {
      "subQNo": "設問3",
      "text": "〔セキュリティ対策の検討〕について、(1)~(4)に答えよ。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の下線④で、同様なインシデントの再発防止に有効な対策として、R社の権威 DNS サーバに実施すべきものを、解答群の中から選び、記号で答えよ。\n\n解答群\nア 逆引き DNSレコードを設定する。\nイ シリアル番号の桁数を増やす。\nウ ゾーン転送を禁止する。\nエ 定期的に脆弱性検査と対策を実施する。",
          "point": 12
        },
        {
          "label": "(2)",
          "text": "本文中の [ b ] に入れる適切な字句を、解答群の中から選び、記号で答えよ。\n\n解答群\nア 会社名\nイ 担当者の電子メールアドレス\nウ 担当者の電話番号\nエ ディジタル証明書の所有者",
          "point": 12
        },
        {
          "label": "(3)",
          "text": "本文中の下線⑤で、R社のキャッシュ DNS サーバがインターネットから問合せ可能な状態であることによって発生する可能性のあるサイバー攻撃を、解答群の中から選び、記号で答えよ。\n\n解答群\nア DDoS 攻撃\nイ SQLインジェクション攻撃\nウ パスワードリスト攻撃\nエ 水飲み場攻撃",
          "point": 12
        },
        {
          "label": "(4)",
          "text": "本文中の [ c ] に入れるサイバー攻撃手法の名称を,15字以内で答えよ。",
          "point": 12
        }
      ],
      "explanation": "### 解説: セキュリティ対策の検討\n\n#### (1) 下線④の対策\n今回のインシデントは、古いDNSソフトウェアの脆弱性を突かれ、管理者権限が奪取されてAレコードが改ざんされたことが原因でした。脆弱性への対応（ソフトウェアアップデート）は既に実施されていますが、再発防止のためには、継続的な脆弱性管理が必須です。\n\n**解答**: エ 定期的に脆弱性検査と対策を実施する。\n\n#### (2) [ b ] に入れる語句\nEV (Extended Validation) 証明書は、従来のDV証明書（ドメイン所有者検証のみ）に比べ、組織の実在性を厳格に検証します。Webブラウザによっては、アドレスバーなどに組織名（会社名）を表示することで、利用者に高い信頼性を提供します。\n\n**解答**: ア 会社名\n\n#### (3) 下線⑤のサイバー攻撃\nキャッシュDNSサーバがインターネットに対して再帰的な問い合わせを受け付けている状態（オープンリゾルバ状態）だと、攻撃者に悪用され、大量の問い合わせを特定のターゲットに送りつける「DNS増幅攻撃（DNS amplification attack）」の踏み台として利用される可能性があります。これは**DDoS攻撃**の一種です。\n\n**解答**: ア DDoS 攻撃\n\n#### (4) [ c ] に入れる語句\n「偽の DNS 応答がキャッシュされ、R社の社内LAN上のPCがインターネット上の偽サイトに誘導されてしまう」脅威は、DNSサーバのキャッシュに偽の情報を意図的に登録させる攻撃です。この手法は**DNSキャッシュポイズニング**と呼ばれます。\n\n**解答**: DNSキャッシュポイズニング"
    }
  ]
}