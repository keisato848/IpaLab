{
  "questions": [
    {
      "qNo": 1,
      "theme": "インシデントレスポンスとログ分析",
      "description": "提供された問題文の断片（設問3とその解説）に基づく構造化。",
      "context": {
        "title": "不正ログインインシデント対応に関するケーススタディ",
        "background": "【データソース不足のため、大問の本文（ケーススタディ）は提供されていません。設問内容から、L社における不正アクセスインシデント対応に関する記述が含まれていたと推測されます。】\n\n## 図5 インシデントPの発生と対応\n\n{{diagram:fig5}}\n\n提供された入力データは、元のIPA情報処理安全確保支援士試験の午後問題の一部（設問2）のみであり、全体の問題文や参照される図表（表1、図2）の情報が欠落しています。設問の解析は、設問文と解説文に含まれる情報に限定されます。\n\n本問題は、L社が管理するR1サーバへの不正アクセス事案に関する調査と対応について述べている。\n\nR1サーバは認証認可システムAC-Xを利用している。{{diagram:fig3}}に示すように、SSH接続は/etc/hosts.allowファイルでN社とV社からの接続に限定されており、認証情報は/etc/shadowに格納され管理者権限でのみ参照可能である。また、R1サーバへのHTTP接続はFW2で接続元制限がないが、開発支援ツールJに脆弱性M、R1サーバに脆弱性Lが存在する可能性がある。\n\nインシデント調査の結果、{{diagram:fig8}}の通り、N社及びV社からの通信は正規のものであったことが確認された。\n\n新たなインシデントとして、N社及びV社からの通信ではない複数のIPアドレスからのSSH接続が確認され、そのログの抜粋が{{diagram:fig9}}に示されている。\n\n本問題で参照するN社及びV社のIPアドレス範囲は{{diagram:note4}}の通りである。\n\nこの不正アクセスにより、攻撃者は管理者権限を取得し、{{diagram:fig10}}に示すような行動（脆弱性の悪用、設定変更⑦、スキャン結果ファイルF1/F2のアップロードなど）を行ったと推測されている。\n\n〔新たなインシデントの発生と対応〕\n\nこの設問は、L社におけるインシデント（インシデントQ）対応に関連する脆弱性評価の判断（下線⑩）に関するものです。背景として、R1サーバに機密情報がないことから脆弱性対応が見送られたが、その後のインシデントで当該サーバが踏み台として利用されたという事例が存在します。本文の具体的な記述（図表等を含む）は提供されていません。",
        "diagrams": [
          {
            "id": "fig5",
            "label": "インシデントPの発生と対応",
            "type": "markdown",
            "content": "（図5の内容は、設問(1)〜(5)で言及されているとおり、パスワードリスト攻撃の経緯、対応策、およびログ分析における時刻情報（JST, UTC）の特定に関わる情報を含んでいたと推測されます。）"
          },
          {
            "id": "fig_nist_lifecycle",
            "label": "NIST SP 800-61 Rev. 2 ライフサイクル",
            "type": "mermaid",
            "content": "graph LR\n    A[準備] --> D[検知];\n    D --> E[分析];\n    E --> C[封じ込め];\n    C --> F[根絶];\n    F --> R[復旧];\n    R --> P[事後活動];\n    P --> A;"
          },
          {
            "id": "fig3",
            "label": "R1サーバの認証/接続制限設定概要",
            "type": "image",
            "content": "R1サーバの設定:(1)認証情報は/etc/shadow (管理者権限必須)。(2) SSH接続は/etc/hosts.allowでN社/V社に限定。 (3) R1サーバへのHTTP接続はFW2で接続元制限なし。開発支援ツールJに脆弱性M、R1サーバに脆弱性L。"
          },
          {
            "id": "fig8",
            "label": "インシデント調査結果の一部",
            "type": "markdown",
            "content": "N社及びV社からの通信は正規のものであった。"
          },
          {
            "id": "fig9",
            "label": "SSH接続ログ（抜粋）",
            "type": "markdown",
            "content": "SSH接続元IPアドレスリスト:\n- x2.y2.z2.130 (V社)\n- x2.y2.z2.129 (V社)\n- x1.y1.z1.100\n- x1.y1.z1.240\n- x2.y2.z2.60\n- x2.y2.z2.58\n- a2.b2.c2.d2\n（その他、F1ファイルアップロード時の通信量320kバイト、F2ファイルアップロード時の通信量960kバイトの情報が含まれる。）"
          },
          {
            "id": "fig10",
            "label": "攻撃者の行動フローと痕跡",
            "type": "image",
            "content": "攻撃手順の概要: 脆弱性L/Mの悪用、設定変更⑦（下線）、フォレンジックで発見されたファイルF1/F2（通信量320kB/960kB）。"
          },
          {
            "id": "note4",
            "label": "N社及びV社のIPアドレス範囲",
            "type": "markdown",
            "content": "N社: x1.y1.z1.0/28 (x1.y1.z1.1〜x1.y1.z1.14)\nV社: x2.y2.z2.128/30 (x2.y2.z2.129〜x2.y2.z2.130)"
          }
        ]
      },
      "questions": [
        {
          "subQNo": "設問1",
          "text": "〔インシデントの発生と対応〕について、(1)~(5)に答えよ。",
          "references": [
            "fig5"
          ],
          "explanation": "インシデントPに関する被害状況と対応、およびその際に顕在化した課題について問われています。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "図5中の下線①で示したパスワードリスト攻撃とは、一般にどのような攻撃か。45字以内で具体的に述べよ。",
              "answer": "他のサービスから流出したIDとパスワードの組のリストを用いて、不正ログインを試行する攻撃。",
              "explanation": "パスワードリスト攻撃は、利用者IDとパスワードのセットを大量に用意し、それを複数のサービスで試行する攻撃です。これは多くの利用者がIDやパスワードを使い回す傾向を悪用しています。"
            },
            {
              "label": "(2)",
              "text": "図5中の下線②について、パスワードの安全な設定方法とは何か。35字以内で具体的に述べよ。",
              "answer": "他のサービスと異なるパスワードを設定することや、十分な長さと複雑性をもたせること。",
              "explanation": "パスワードリスト攻撃対策の基本は、パスワードの使い回しを防ぐことです。また、パスワードの長さと複雑性を確保することで、辞書攻撃や総当たり攻撃に対する耐性を向上させます。"
            },
            {
              "label": "(3)",
              "text": "図5中の下線③について、ログインが普段と異なる環境から行われたことを判定する技術的手法を、45字以内で具体的に述べよ。",
              "answer": "ログイン元のIPアドレスやジオロケーションなどの情報を平時と比較し、異常を検知する。",
              "explanation": "普段と異なる環境とは、地理的な位置情報（ジオロケーション）や、過去の利用履歴にないIPアドレス、または使用しているデバイス情報などが該当します。これらの情報を用いて、通常の利用パターンとの乖離を判定します。"
            },
            {
              "label": "(4)",
              "text": "図5中の [ a ] に入れる適切な字句を8字以内で答えよ。",
              "answer": "JST",
              "explanation": "ログに記録されていた時刻情報 [ a ] は日本標準時(JST)であり、協定世界時(UTC)に対して時刻情報 [ b ] 時間進んでいたとあります。JSTは日本標準時 (Japan Standard Time) を指します。"
            },
            {
              "label": "(5)",
              "text": "図5中の [ b ] に入れる適切な数値を答えよ。",
              "answer": "9",
              "explanation": "日本標準時(JST)は協定世界時(UTC)より9時間進んでいます (UTC+9)。"
            }
          ],
          "point": 20
        },
        {
          "subQNo": "設問2",
          "text": "表1中の下線④について、社内LAN から店舗 PC を経由せずにどのようにマルウェアが侵入すると想定されるか。侵入方法を50字以内で具体的に述べよ。",
          "references": [
            "table1",
            "fig2"
          ],
          "answer": "社内LANの機器に感染したマルウェアが、管理用PCと店舗管理サーバ間のデータ受け渡しに使うUSBメモリを介して管理用PCに侵入する。",
          "explanation": "表1の指摘事項2は、ネットワーク分離にもかかわらずリスクが存在することを示しています。図2の注記2によると、店舗管理システムと社内LANの間でデータの受け渡しが必要な場合、管理用PC（社内LAN接続）と店舗管理サーバの間で**USBメモリ**を使用するとあります。このUSBメモリを介したマルウェア感染経路が想定されます。",
          "point": 20
        },
        {
          "subQNo": "設問3",
          "text": "〔条件2と条件3への対応〕について、(1), (2)に答えよ。",
          "subQuestions": [
            {
              "label": "(1)",
              "text": "表2中の [ c ] に入れる適切な字句を、解答群の中から選び、記号で答えよ。",
              "answer": "オ",
              "explanation": "表2の役割は「基本方針の策定やN社インシデント対応ポリシの承認を担当する」とあります。図6(3)および(5)から、権限行使や情報開示の際には「情報セキュリティ委員会」の承認が必要とされており、この委員会が経営陣で構成されていることから、基本方針やポリシの承認を行う役割を担っているのはオの情報セキュリティ委員会です。",
              "references": [
                "table2",
                "fig6"
              ]
            },
            {
              "label": "(2)",
              "text": "図7中の [ d ] ~ [ f ] に入れる適切な字句を,解答群の中から選び、記号で答えよ。",
              "answer": "イ, カ, ウ",
              "explanation": "図7はNIST SP 800-61 Rev. 2に基づくインシデント対応ライフサイクルを示しています。\n\n### NIST SP 800-61 Rev. 2 ライフサイクル\n\n{{diagram:fig_nist_lifecycle}}\n\nしたがって、dは**検知 (イ)**、eは**分析 (カ)**、fは**根絶 (ウ)** が適切です。",
              "references": [
                "fig7"
              ]
            }
          ],
          "point": 20
        },
        {
          "subQNo": "設問4",
          "text": "〔新たなインシデントの発生と対応〕について、(1)~(5)に答えよ。",
          "references": [],
          "subQuestions": [
            {
              "label": "(1)",
              "text": "本文中の下線⑤について、図9中の接続元 IP アドレスのうち、不正ログインを行ったと推測される接続元IPアドレスは幾つか。個数を答えよ。",
              "answer": "5",
              "explanation": "不正ログインはAC-Xを利用したSSH接続で行われました。図8より「N社及びV社からの通信は正規のものだけであった」ため、N社およびV社のIPアドレス範囲外からのSSH接続が不正アクセスと推測されます。\n\n注記4のIPアドレス範囲を確認します。\nN社 (x1.y1.z1.0/28): x1.y1.z1.1〜x1.y1.z1.14\nV社 (x2.y2.z2.128/30): x2.y2.z2.129〜x2.y2.z2.130\n\n図9のSSH接続元IPアドレス:\n1. x2.y2.z2.130 (V社): 正規\n2. x2.y2.z2.129 (V社): 正規\n3. x1.y1.z1.100: N社/V社範囲外 → 不正\n4. x1.y1.z1.240: N社/V社範囲外 → 不正\n5. x2.y2.z2.60: N社/V社範囲外 → 不正\n6. x2.y2.z2.58: N社/V社範囲外 → 不正\n7. a2.b2.c2.d2: N社/V社範囲外 → 不正\n\n不正アクセスを行ったと推測されるIPアドレスは、3, 4, 5, 6, 7 の5個です。",
              "references": [
                "fig9",
                "note4",
                "fig8"
              ]
            },
            {
              "label": "(2)",
              "text": "図10中の下線⑥について、脆弱性 Mだけを悪用しても“/etc/shadow\" ファイルを参照できない理由を, \"/etc/shadow” ファイルの性質を含めて,70字以内で述べよ。",
              "answer": "/etc/shadowファイルは管理者権限でしか参照できないが、脆弱性Mを悪用したコマンド実行は開発支援ツールJが持つ一般利用者権限で動作するため。",
              "explanation": "図3(3)より、認証情報は/etc/shadowファイルに格納されており、これは管理者権限が必要です。一方、表3より、脆弱性M（開発支援ツールJの脆弱性）を悪用しても、実行されるコマンドは開発支援ツールJが持つOSの一般利用者権限で動作するため、管理者権限が必要な/etc/shadowファイルを参照することはできません。",
              "references": [
                "fig10",
                "fig3"
              ]
            },
            {
              "label": "(3)",
              "text": "図10中の下線⑦について、攻撃者が行った設定変更の内容を、45字以内で具体的に述べよ。",
              "answer": "R1サーバの/etc/hosts.allowファイルの設定を変更し、インターネット経由のSSH接続元制限を解除した。",
              "explanation": "R1サーバへのSSH接続は、図3(3)に基づき、/etc/hosts.allowファイルでN社とV社に限定されていました。図8ではN社でもV社でもない複数のIPアドレスからSSH接続が行われているため、攻撃者は管理者権限でAC-Xを作成した後、このファイルの設定を変更し、外部からのSSH接続を許可したと考えられます。",
              "references": [
                "fig10",
                "fig3",
                "fig8"
              ]
            },
            {
              "label": "(4)",
              "text": "図10中の下線⑧について、F2 ファイルには、幾つの IP アドレスをスキャンした結果が格納されていると考えられるか。図9中の値及び図 10中の値を用いて求めよ。",
              "answer": "24",
              "explanation": "F1ファイルのサイズ (320kバイト) は、8個のIPアドレスのスキャン結果に相当します。IPアドレスごとの出力結果は固定長です。\n\nF1ファイルをアップロードした通信は通信量320kバイト。\nF2ファイルをアップロードしたと推測される通信は、通信量960kバイト。\n\n格納されているIPアドレスの数は、通信量に比例します。\n(F2のIPアドレス数) / (F1のIPアドレス数) = (F2の通信量) / (F1の通信量)\nX / 8 = 960 / 320\nX = 8 * 3 = 24\n\nしたがって、F2ファイルには24個のIPアドレスのスキャン結果が格納されていたと考えられます。",
              "references": [
                "fig10",
                "fig9"
              ]
            },
            {
              "label": "(5)",
              "text": "本文中の下線⑨について、措置を75字以内で具体的に述べよ。",
              "answer": "R1サーバの脆弱性L及びMを解消するための修正プログラムを適用する。また、FW2においてR1サーバへのHTTP接続についても接続元IPアドレスをN社とV社に限定する。",
              "explanation": "攻撃は脆弱性L, Mが悪用され（(2)参照）、特に脆弱性MはHTTP接続経由で実行可能であり、R1サーバのHTTP接続には接続制限がないため(図3(3))、この経路が利用された可能性が高いです。したがって、脆弱性解消に加え、FW2でHTTP接続の接続元をN社とV社に限定し、不正な外部からのアクセスを防ぐ必要があります。",
              "references": [
                "fig3"
              ]
            }
          ],
          "point": 20
        },
        {
          "subQNo": "設問5",
          "text": "本文中の下線⑩について、悪用される可能性を評価する際に加えるべき観点,又は影響を評価する際に加えるべき観点を、今回の事例を踏まえて 30 字以内で述べよ。",
          "references": [],
          "answer": "脆弱なサーバが踏み台にされ、外部攻撃や他のシステムへの侵入に利用される影響。",
          "explanation": "インシデントQでは、R1サーバに機密情報がないことから脆弱性対応が見送られましたが、結果として不正アクセスを許し、外部スキャンや情報収集の踏み台として利用されました。したがって、脆弱性評価において、当該システムが情報資産を持たない場合でも、他のシステムや外部への攻撃の基点（踏み台）となる影響を考慮すべきでした。",
          "point": 20
        }
      ]
    }
  ]
}