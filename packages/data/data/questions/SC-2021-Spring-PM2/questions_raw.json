{
  "qNo": 1,
  "theme": "インシデント対応体制の整備",
  "description": "N社は,従業員800名のドラッグストアチェーンである。グローバルに事業を展開する海外の企業B社のブランドライセンスを取得し、同ブランドの下,国内80店舗の展開,及び N社 Web サイト(以下,通販サイトという)での通信販売を行っている。N社は、消費者向けの会員制度を設けており、会員は商品購入時に特典を受けられる。N社の組織図を図1に示す。\n\n### 図1 N社の組織図\n```mermaid\ngraph TD\n    A[社長]\n    A --> B(内部監査室)\n    \n    subgraph Level 2\n        direction LR\n        C1(お客様相談室) & C2(営業統括部) & C3(マーケティング部) & C4(商品開発部) & C5(店舗開発部)\n    end\n    \n    subgraph Level 3\n        direction LR\n        D1(システム部) & D2(総務部) & D3(人事部) & D4(法務部) & D5(財務経理部)\n    end\n    \n    A --> C1\n    A --> C5\n    \n    C1 --> D1\n    C5 --> D5\n    \n    %% The actual diagram connects C1-C5 and D1-D5 horizontally, implying parallelism, and shows a general reporting line from C group to D group.\n\n    A --> C1\n    A --> C2\n    A --> C3\n    A --> C4\n    A --> C5\n    \n    C1 & C2 & C3 & C4 & C5 --> D1\n    C1 & C2 & C3 & C4 & C5 --> D5\n```\n\nN社は、情報セキュリティ委員会を設置している。同委員会は、経営陣が委員となり、情報セキュリティについての基本方針(以下,基本方針という)及び重要な課題を取り扱う。セキュリティ対策は主にシステム部が担っており、セキュリティインシデント(以下、インシデントという)が発生した場合は,対応チームを立ち上げて対応する。基本方針では、消費者に影響を与えるインシデントの場合、社外に向けて速やかに情報開示することを挙げている。\n\nB社は、同社がブランドライセンスを提供する店舗運営会社を対象にしたインシデント対応ポリシ(以下, B社インシデント対応ポリシという)を定めている。B社インシデント対応ポリシは、インシデントによるB社ブランドの毀損を最小限にすることを目的として策定された。\n\nN社は、B社インシデント対応ポリシを順守する契約をB社と締結しており、N社でインシデントが発生した場合は、B社のセキュリティ担当部署(以下,B社セキュリティ部という)に報告し、指示に基づき対応する。分析対象となるログは、N社のシステム部が取得し、インシデント発生時にはB社セキュリティ部に送信する。\n\n通販サイトは、Z社が提供するクラウドサービス(以下,Z サービスという)上に構築し、設計、開発及び運用をV社に委託している。Zサービス上には開発用システムも構築している。また、各店舗の情報を一元管理し、運営を支援するためのシステム(以下,店舗管理システムという)をN社に設置しており、設計、開発及び運用の一部を外部に委託している。N社が利用するシステム及びネットワークの概要を図2に、開発用システムの概要を図3に、N社の脆弱性管理プロセスを図4に示す。\n\n### 図2 N社が利用するシステム及びネットワークの概要\n```mermaid\ngraph TD\n    subgraph Zサービス\n        subgraph 通販サイト\n            D_V(データベース) & A_V(アプリサーバ) & W_V(Webサーバ)\n            W_V -- L2SW --> L2_V[L2SW]\n            L2_V --> FW1[FW1]\n        end\n        \n        subgraph 開発用システム\n            D_D(データベース) & A_D(アプリサーバ) & W_D(Webサーバ)\n            W_D -- L2SW --> L2_D[L2SW]\n            L2_D --> FW2[FW2]\n            R1[R1 サーバ] --> FW2\n        end\n        \n        V[V社] --> FW4[FW4]\n    end\n    \n    FW1 & FW2 & FW4 --> INT[インターネット]\n    \n    INT --> FW3[FW3]\n    INT --> IPVPN[IP-VPN]\n    \n    subgraph N社\n        subgraph 社内LAN\n            FW3 --> N_LAN[社内LAN]\n            N_LAN --> L2SW_N[L2SW]\n            L2SW_N --> GP_PC[管理用PC]\n        end\n        \n        subgraph 店舗管理システムLAN\n            GS[店舗管理サーバ]\n            GS --> L2SW_GS[L2SW]\n            L2SW_GS --> L3SW_GS[L3SW]\n            \n            GP_PC -- 利用(注2) --> GS\n            N_LAN -- 分離(注2) -- 店舗管理システムLAN\n        end\n        \n        IPVPN --> L3SW_GS\n        IPVPN --> L3SW_T[L3SW]\n        \n        subgraph 店舗LAN\n            L3SW_T --> L2SW_T[L2SW]\n            L2SW_T --> T_PC[店舗PC]\n            L2SW_T --> PR[プリンタ]\n            \n            T_PC -- IP-VPN経由 --> GS\n            T_PC -- Wi-Fiルータ(注3) --> INT\n        end\n    end\n\n    style R1 fill:#fcc\n    style GP_PC fill:#ccf\n    style T_PC fill:#ccf\n```\n\n注記1 Zサービス上の機器及びネットワークは、仮想化技術で実現されるものを含む。\n注記2 店舗管理システムと店舗との間は、IP-VPNで接続されている。一方,店舗管理システムと社内LANとは、ネットワークが分離されている。N社の関係部門は、管理用 PCを操作して店舗管理サーバを利用する。また、店舗管理システムと社内LANとの間でデータの受渡しが必要な場合は、USBメモリを用いる。\n注記3 店舗では、店舗PCから IP-VPN 経由で店舗管理サーバを利用する。また、販売促進施策の検討などのため、店舗PCは、Wi-Fi ルータなどでインターネットに接続する。\n注記4 割り当てられたグローバルIPアドレスの範囲は、次のとおりである。\n・N社 : x1.y1.z1.0/28\n・V社 : x2.y2.z2.128/30\n・通販サイト : x3.y3.z3.0/28\n・開発用システム: x4.y4.z4.0/28\n\n### 図3 開発用システムの概要(抜粋)\n\n(1) 開発用システムの接続制御\n・N社及びV社はインターネットを介して、HTTP及びHTTPSを用いた接続(以下,HTTP接続という)を行い、システムのテストを行う。\n・N社及びV社はインターネットを介して, R1 サーバにSSH接続を行い、開発業務を行う。R1 サーバ以外の開発用システム内にあるサーバ(以下,他サーバ群という)を操作する場合は、R1 サーバから SSH接続を行う。\n・インターネットからのインバウンド通信は、FW2 において、各サーバへの SSH接続及びHTTP接続を許可し、その他の通信を遮断している。また、インターネットへのアウトバウンド通信は、R1 サーバからの通信だけを許可し、その他の通信を遮断している。\n・開発用システムと通販サイトの間には、通信経路は存在しない。通販サイトにプログラムを配備する際は、開発用システムから該当するプログラムを取得し、V社環境から配備を行う。\n\n(2) R1 サーバの構成\n・R1 サーバに導入されているソフトウェアは、OS, SSHサーバプログラム、及びWebインタフェースをもつ開発支援ツールJである。\n・開発支援ツールJは、OSの一般利用者権限を割り当てた利用者アカウントで動作する。OSの一般利用者権限には、開発支援ツールJが動作するための、必要最小限の権限だけが与えられている。\n・R1 サーバには、ソースコード, バイナリコード、テスト用データなどを保存しているが、会員情報,取引情報などの秘密情報は保持していない。\n\n(3) R1 サーバへの接続制御\n・R1 サーバの\"/etc/hosts.allow”ファイルの設定において、SSH接続の接続元をN社とV社に限定している。このファイルの変更には、管理者権限が必要である。\n・SSH接続でR1 サーバにログインするための認証情報は、“/etc/shadow\"ファイルに格納されている。具体的には、利用者アカウント、利用者アカウントごとに異なるソルト値, ソルト値と平文パスワードから計算したハッシュ値が含まれている。\n・HTTP 接続で開発支援ツールJを操作できる。接続制限は行っていない。\n\n(4) 他サーバ群の概要\n・他サーバ群では、それぞれの目的に必要なソフトウェアに加え, SSHサーバプログラムが動作している。他サーバ群それぞれの \"/etc/hosts.allow\" ファイルでは、SSH接続の接続元を R1 サーバに限定している。また、他サーバ群それぞれには、複数の利用者アカウントが登録されている。\n\n(5) 開発用システムにおけるセキュリティ対策\n・WAF や改ざん検知の仕組みは、各種テストに支障を来す可能性があり、導入していない。\n・開発用システムで作成されたソフトウェアは通販サイトに配備する前に脆弱性診断を行う。\n\n### 図4 N社の脆弱性管理プロセス\n```mermaid\ngraph TD\n    A[(ア) 脆弱性情報を収集] --> B[(イ) 悪用可能性を評価]\n    B --> C[(ウ) 影響を評価]\n    C --> D[(エ) 対応決定]\n    \n    A[4日に1回以上の頻度で脆弱性情報を収集する]\n    B[収集した脆弱性情報を基に、脆弱性が悪用される可能性を評価する]\n    C[悪用される可能性が高いと判断した場合、悪用されたときのN社のシステムへの影響を評価する]\n    D[評価の結果、対応が必要と判断した場合、対応方法、対応の優先度, 対応期限を決定する]\n```\n\n**[インシデントの発生と対応]**\n\nある日、複数の会員から N社のお客様相談室に、身に覚えのない商品購入を知らせる電子メールが届いたという連絡があった。N社は、対応チームを立ち上げて調査した結果、通販サイトが不正アクセスを受けたと判断した。N社は、直ちにこのインシデント(以下,インシデントPという)をB社セキュリティ部に報告した。N社とB社セキュリティ部が協力して対応したが、問題が幾つか発生し、対応を終えるまでに1か月掛かった。\n\nインシデントPについて、判明した被害状況及び対応の概要を図5に示す。\n\n### 図5 判明した被害状況及び対応の概要\n\n(1) 被害状況\n・16名の利用者ID が不正ログインされ、総額130万円の商品が不正に購入されたことが判明した。\n・ログの調査から、**下線①**パスワードリスト攻撃と推定された。\n・攻撃の接続元IPアドレスは五つであった。\n\n(2) 対応\n・不正に購入された商品の半数は、注文及び発送を取り消した。\n・不正ログインされた16名の利用者IDについて、パスワードを強制的にリセットした。\n・**下線②**パスワードリスト攻撃の被害を防ぐ上で必要な、パスワードの安全な設定方法を全会員に案内した。\n・通販サイトに不正アクセスがあったことを情報開示した。\n・認証に対する攻撃を検知するため、次の二つの仕組みを通販サイトに導入した。\n - 同じIPアドレスから行われる多数のログイン試行を攻撃と判断する。\n - 一定時間ごとの認証失敗数を記録し、特定のしきい値を超えた場合は、攻撃と判断する。\n・**下線③**ログインが普段と異なる環境から行われた場合、会員が事前に登録した電子メールアドレスにその旨を通知する仕組みを通販サイトに導入した。\n\n(3) 対応を通じて顕在化した課題\n・B社セキュリティ部がログを分析した際に誤解が生じた。N社が提供したログの大半は、記録されていた時刻情報が [ a ] が日本標準時であり、協定世界時に対し時刻情報が [ b ] 時間進んだ値で記録されていた。しかし、協定世界時で記録されていたログや、 [ a ] を示す情報が記録されていなかったログも存在した。\n・B社インシデント対応ポリシでは、インシデントに関わる情報を不特定多数に情報開示するのは法令に規定されているなどの幾つかの場合だけであった。そのため、N社は速やかな情報開示を要望したものの、当初、B社から認められなかった。N社社長からB社の経営陣に特別な要請を行うことによって、ようやく情報開示が認められた。しかし、情報開示のタイミングが遅くなり、N社の基本方針にはそぐわなかった。\n\n**[インシデント対応方法の変更]**\n\nインシデントPの対応が一段落した後、N社の経営陣は、N社で今後インシデントが起きた場合には、N社の基本方針に従って対応する契約に変更したいとB社に申し入れた。B社は、この申入れに対し、次の条件を満たすことを前提として了承した。\n\n条件1: N社は, ISO/IEC 27001 を利用して、自社の情報セキュリティ対策を評価し、その結果と対策案についてB社の了承を得る。\n条件2: N社は、B社の支援なしにインシデント対応を行う体制を整備し、その体制についてB社の了承を得る。\n条件3: N社は、インシデント対応後、B社に事後報告を行う。ただし、両社で別途定める基準によって、B社ブランドを著しく毀損するインシデントと判断された場合は、直ちにB社に報告し、対応を協議する。\n\nN社は、条件1~3を含め、包括的なインシデント対応体制を実現するプロジェクトを発足させた。システム部のG部長を責任者に、システム部のHさんを担当者にそれぞれ任命するとともに、情報セキュリティ分野でコンサルティングサービスを展開するE社に支援を依頼した。E社のコンサルタントである情報処理安全確保支援士(登録セキスペ)のT氏がN社を支援することになった。\n\n**[条件1への対応]**\n\n条件1に対応すべく、Hさんは、情報セキュリティ対策の評価をT氏に依頼した。T氏は、ISO/IEC 27001 附属書Aを基に評価し、指摘事項と対策案を表1のとおりに整理した。\n\n### 表1 T氏の指摘事項と対策案(抜粋)\n| 番号 | 指摘事項 | 対策案 |\n| :---: | :--- | :--- |\n| 1 | 店舗 PC がインターネット経由で侵入され、店舗管理サーバがマルウェアに感染するリスクがある。 | (省略) |\n| 2 | **下線④**店舗管理システムは社内 LAN と分離されているが、社内LANにマルウェアが侵入した場合、店舗管理サーバにもマルウェアが侵入するリスクがある。 | (省略) |\n\nN社は、T氏の対策案を参考に、N社としての対策をまとめ、B社の了承を得た。\n\n**[条件2と条件3への対応]**\n\n条件2と条件3に対応すべく、Hさんは、図6に示すN社インシデント対応ポリシ案を作成し、T氏のレビューを受けた。\n\n### 図6 N社インシデント対応ポリシ案(抜粋)\n\n(1) 取り扱うインシデントの範囲\nサイバー攻撃、不正行為、及びその他の情報セキュリティに関する事件事故を対象とする。\n(2) インシデント対応のための組織\nインシデント対応を行うためにCSIRTを設置する(以下、N社に設置するCSIRTをN-CSIRTという)。システム部長をN-CSIRT の責任者(以下,N-CSIRT 長という)とし、表2に示す部門で構成する。インシデントを発見した時点で初期調査を行い、重大なインシデントの可能性があると N-CSIRT 長が判断した時点で、その重大なインシデントに対応するチーム(以下,PTという)を発足させる。\n(3) N-CSIRTの権限\nN社の全てのシステムについて、停止又は変更を指示できる。その他の権限が必要な場合、N-CSIRT 長は、情報セキュリティ委員会の承認を得る。\n(4) インシデントの深刻度と対応方針の基準 (省略)\n(5) 情報開示方針\nN-CSIRT 長は、別途定める基準に従い、対象となるインシデントについて、情報開示の内容を決定する。不特定多数への情報開示は、事前に情報セキュリティ委員会の承認を得る。\n\n### 表2 N-CSIRTの構成部門\n| 部門 | 役割 |\n| :---: | :--- |\n| システム部 | インシデント対応における技術面を担当する。 |\n| 人事部 | 従業員による不正が発覚した場合、その対応を担当する。 |\n| **[ c ]** | 基本方針の策定やN社インシデント対応ポリシの承認を担当する。 |\n| 運用委託先 | 各委託先が担当するシステムについて、N-CSIRT と協力し、インシデントの調査,証跡の取得、システムの停止、復旧などを行う。 |\n\n次は、レビューの際のT氏とHさんの会話である。\n\nT氏: インシデント対応プロセスも整理すべきです。NISTの文書 SP 800-61 Rev. 2 に記載されているインシデント対応のライフサイクルを図7に示します。\n\n### 図7 インシデント対応のライフサイクル\n```mermaid\ngraph LR\n    A[準備] --> D1\n    \n    subgraph 検知・分析\n        D1[d]\n        E1[e]\n    end\n    \n    D1 --> E1\n    E1 --> C1\n    \n    subgraph 封じ込め, 根絶, 復旧\n        C1[封じ込め]\n        F1[f]\n        R1[復旧]\n    end\n    \n    C1 --> F1\n    F1 --> R1\n    \n    R1 --> P[事後活動]\n    P --> A\n```\n\nHさん: 分かりました。図6の一部として整理します。ところで、今後のインシデント対応における技術面について不安があります。\nT氏: インシデント対応サービスを提供し、登録セキスペが多数在籍する専門事業者が幾つかあります。そのような事業者に支援を依頼するとよいと思います。\nHさん: 分かりました。表2に専門事業者とその役割を追加します。\n\nN社は、検討結果を取りまとめ、B社の了承を得た。\n\n**[新たなインシデントの発生と対応]**\n\nN社インシデント対応ポリシの運用を開始してから約1か月後の11月22日,V社は、不審な利用者アカウント(以下、AC-X という)が R1 サーバに作成されていることを見付け、N-CSIRTに報告した。G部長は、インシデントであると判断し、初期調査をHさんに指示した(以下、このインシデントをインシデントQという)。Hさんは、V社と協力してインシデントQについて調査した。その結果を図8に示す。\n\n### 図8 インシデントQの調査結果(抜粋)\n\n・利用者アカウントの作成には管理者権限が必要である。AC-Xは11月19日の深夜1時に作成された。V社ではその時間帯に誰も作業していなかったことから、不正アクセスの可能性が高い。\n・R1 サーバに一部残っていたアクセスログと FW2のログから、AC-X が作成されてから発見されるまでの4日間、N社でもV社でもない複数のIPアドレスからSSH接続があり、合計10回以上AC-Xを利用して不正ログインが行われていたことが判明した。\n・N社及びV社からの通信は正規のものだけであった。\n\n図9は、FW2において、AC-Xが作成されてから発見されるまでの4日間、通信に成功した全てのパケットを対象とし、通信方向,接続元及び宛先の IP アドレス、サービスの組合せで通信量を集計し、降順に並べたものである。Hさんは、**下線⑤**図9を基に、不正ログインを行ったと推測される接続元 IPアドレスを割り出した。\n\n### 図9 FW2での通信量の集計\n| 接続元 IPアドレス | 宛先 IPアドレス | サービス | 通信量(kバイト) |\n| :---: | :---: | :---: | :---: |\n| x2.y2.z2.130 | R1 サーバ | HTTPS | 492 |\n| x2.y2.z2.129 | R1 サーバ | HTTP | 382 |\n| x2.y2.z2.129 | R1 サーバ | HTTPS | 379 |\n| x2.y2.z2.130 | R1 サーバ | SSH | 320 |\n| x2.y2.z2.129 | R1 サーバ | SSH | 232 |\n| x1.y1.z1.10 | R1 サーバ | HTTP | 228 |\n| x1.y1.z1.200 | R1 サーバ | HTTPS | 123 |\n| x1.y1.z1.100 | R1 サーバ | SSH | 112 |\n| x1.y1.z1.240 | R1 サーバ | HTTPS | 69 |\n| x2.y2.z2.60 | R1 サーバ | SSH | 48 |\n| x1.y1.z1.240 | R1 サーバ | SSH | 37 |\n| x1.y1.z1.10 | R1 サーバ | HTTPS | 14 |\n| x2.y2.z2.58 | R1 サーバ | SSH | 12 |\n| a2.b2.c2.d2 | R1 サーバ | SSH | 6 |\n| **アウトバウンド通信注1)** | | | |\n| 接続元 IPアドレス | 宛先 IPアドレス | サービス | 通信量(kバイト) |\n| R1 サーバ | a2.b2.c2.d2 | HTTP | 960 |\n| R1 サーバ | a1.b1.c1.d1 | HTTP | 320 |\n\n注1) アウトバウンド通信には、R1 サーバ上のファイルの持出しに使われたと推測され,かつ,通信量が大きいものだけを示す。\n\nHさんから調査結果について報告を受けたG部長は、R1 サーバの隔離を指示した上で、インシデントQは重大なインシデントの可能性があると判断し、PTを発足させた。PTは専門事業者の支援を受けて調査を行い、R1 サーバには、脆弱性L及び脆弱性 Mが残っていることが判明した。脆弱性Lと脆弱性Mの概要、及びそれぞれの対応を見送った経緯とその理由を表3に、PTによる調査結果を図10に示す。\n\n### 表3 脆弱性Lと脆弱性Mの概要、及びそれぞれの対応を見送った経緯とその理由\n| 脆弱性名称 | 脆弱性の概要 | 対応を見送った経緯とその理由 |\n| :---: | :--- | :--- |\n| 脆弱性L | OSコマンドAの脆弱性である。OSコマンド Aは、指定したプログラムを起動する。脆弱性 Lを悪用すると,一般利用者権限でOSコマンドAを実行した場合でも、指定したプログラムを管理者権限で起動できる。 | 脆弱性修正プログラムが9月末に公開されたが、R1 サーバでは適用が見送られた。理由: 脆弱性Lの悪用には、OSコマンドAを実行する必要がある。OSコマンド Aを実行するには、R1 サーバに SSH 接続してログインする必要があり、脆弱性Lが悪用される可能性は低い。さらに、R1 サーバは会員情報及び秘密情報を保持しないので、影響は小さい。|\n| 脆弱性 M | 開発支援ツールJの脆弱性である。細工された HTTP リクエストを送信することによって、開発支援ツールJを実行している利用者アカウントの権限で任意のコマンドを実行できる。 | 脆弱性修正プログラムが11月10日に公開されたが、R1 サーバでは11月末に予定されている月例メンテナンスで適用することにした。理由: 開発支援ツールJは、OSの一般利用者権限で動作しており、変更可能なファイル及びディレクトリが限定されている。さらに、R1 サーバは会員情報及び秘密情報を保持しないので、影響は小さい。|\n\n次の(1)~(3)に示す順でR1 サーバに攻撃されたことを確認した。\n\n### 図10 PTによる調査結果\n\n(1) \"/etc/shadow” ファイルの参照\n・**下線⑥**脆弱性Lと脆弱性Mを悪用して、“/etc/shadow” ファイルを参照した。\n\n(2) 利用者アカウントの作成とSSH接続\n・管理者権限でAC-Xを作成した。\n・**下線⑦** R1 サーバをインターネット経由で操作するために設定を変更した。\n・AC-Xを利用してSSH接続でR1 サーバにログインした。\n\n(3) 外部へのスキャン\n・SSH接続でR1 サーバにログインした後、脆弱性スキャンを行うツールXを使って多数のIPアドレスをスキャンし、スキャン結果を二つのファイル(以下、F1ファイルとF2 ファイルという)に格納して、攻撃者のサーバにアップロードした。\n・コマンド履歴とフォレンジック調査結果から次に示す内容が判明した。\n - ツールXはR1 サーバにダウンロードされていた。\n - F1 ファイルは、AC-Xのホームディレクトリに配置された後、IPアドレス a1.b1.c1.d1のサーバにアップロードされ、その後ホームディレクトリから削除されていた。F1ファイルはフォレンジック調査によって復元でき、サイズは320kバイトであった。F1ファイルには、ツールXが8個のIPアドレスをスキャンした結果が格納されており、IPアドレスごとの出力結果は固定長であった。\n - **下線⑧** F2 ファイルは一部しか復元できなかったが、F1ファイルと同様の形式で、ツールXによるスキャン結果が格納されていると考えられた。\n\n引き続いて、R1 サーバ以外への侵入拡大の有無を確認した。\n\n(4) 他サーバ群への侵入拡大の有無\n・他サーバ群には、開発支援ツールJがインストールされていない。したがって、脆弱性Mが悪用されることはなく、上記(1)~(3)の攻撃は発生しない。\n・他サーバ群に登録されている利用者アカウントには、十分な複雑性をもち、異なるパスワードが設定されていた。また、SSH接続による不審なログイン試行が行われていないことをログから確認した。\n\n(5) 通販サイトへの侵入拡大の有無\n・通販サイトには、脆弱性Lが残っているサーバも、開発支援ツールJがインストールされているサーバも存在しない。また、開発用システムの接続制御から、R1 サーバから通販サイトへの侵入拡大も困難である。したがって、通販サイト内への侵入はないと判断した。\n\nこの報告を受けたG部長は、幸いにも被害が限定的であり、顧客への影響が全くないことから、インシデント Q について情報開示する必要はないと判断し、情報セキュリティ委員会に報告し承認を得た。\n\nその後、G部長は、利用者アカウントのパスワード変更, R1 サーバの復旧,脆弱性L及び脆弱性 M を解消する脆弱性修正プログラムの適用, **下線⑨** SSH接続及び HTTP接続を使った攻撃から開発用システムを保護するための措置などを指示した。\n\n**[脆弱性管理プロセスの改善]**\n\nインシデントPと比較してインシデントQの対応は迅速に行われ、N-CSIRTのインシデント対応は有効であると、N社の経営陣からもB社からも一定の評価を得た。一方、インシデントQでR1 サーバが不正にログインされたことを考えると、**下線⑩** 図4(イ)及び(ウ)において、悪用される可能性の評価についての観点の不足,又は影響の評価についての観点の不足があり、悪用される可能性又は影響を過小評価したのではないかという指摘があった。そのため,脆弱性管理プロセスを見直すことにした。\n\nインシデントPの終息から1年後,表1の指摘事項及びインシデントQで明らかになった課題は全て解決できた。N-CSIRT は、関係者の訓練を進め、更に迅速かつ効果的なインシデント対応が可能になった。",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "〔インシデントの発生と対応〕について、(1)~(5)に答えよ。",
      "explanation": "インシデントPに関する被害状況と対応、およびその際に顕在化した課題について問われています。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "図5中の下線①で示したパスワードリスト攻撃とは、一般にどのような攻撃か。45字以内で具体的に述べよ。",
          "answer": "他のサービスから流出したIDとパスワードの組のリストを用いて、不正ログインを試行する攻撃。",
          "explanation": "パスワードリスト攻撃は、利用者IDとパスワードのセットを大量に用意し、それを複数のサービスで試行する攻撃です。これは多くの利用者がIDやパスワードを使い回す傾向を悪用しています。",
          "point": 8
        },
        {
          "label": "(2)",
          "text": "図5中の下線②について、パスワードの安全な設定方法とは何か。35字以内で具体的に述べよ。",
          "answer": "他のサービスと異なるパスワードを設定することや、十分な長さと複雑性をもたせること。",
          "explanation": "パスワードリスト攻撃対策の基本は、パスワードの使い回しを防ぐことです。また、パスワードの長さと複雑性を確保することで、辞書攻撃や総当たり攻撃に対する耐性を向上させます。",
          "point": 8
        },
        {
          "label": "(3)",
          "text": "図5中の下線③について、ログインが普段と異なる環境から行われたことを判定する技術的手法を、45字以内で具体的に述べよ。",
          "answer": "ログイン元のIPアドレスやジオロケーションなどの情報を平時と比較し、異常を検知する。",
          "explanation": "普段と異なる環境とは、地理的な位置情報（ジオロケーション）や、過去の利用履歴にないIPアドレス、または使用しているデバイス情報などが該当します。これらの情報を用いて、通常の利用パターンとの乖離を判定します。",
          "point": 7
        },
        {
          "label": "(4)",
          "text": "図5中の [ a ] に入れる適切な字句を8字以内で答えよ。",
          "answer": "JST",
          "explanation": "ログに記録されていた時刻情報 [ a ] は日本標準時(JST)であり、協定世界時(UTC)に対して時刻情報 [ b ] 時間進んでいたとあります。JSTは日本標準時 (Japan Standard Time) を指します。",
          "point": 7
        },
        {
          "label": "(5)",
          "text": "図5中の [ b ] に入れる適切な数値を答えよ。",
          "answer": "9",
          "explanation": "日本標準時(JST)は協定世界時(UTC)より9時間進んでいます (UTC+9)。",
          "point": 7
        }
      ]
    },
    {
      "subQNo": "設問2",
      "text": "表1中の下線④について、社内LAN から店舗 PC を経由せずにどのようにマルウェアが侵入すると想定されるか。侵入方法を50字以内で具体的に述べよ。",
      "answer": "社内LANの機器に感染したマルウェアが、管理用PCと店舗管理サーバ間のデータ受け渡しに使うUSBメモリを介して管理用PCに侵入する。",
      "explanation": "表1の指摘事項2は、ネットワーク分離にもかかわらずリスクが存在することを示しています。図2の注記2によると、店舗管理システムと社内LANの間でデータの受け渡しが必要な場合、管理用PC（社内LAN接続）と店舗管理サーバの間で**USBメモリ**を使用するとあります。このUSBメモリを介したマルウェア感染経路が想定されます。",
      "point": 7
    },
    {
      "subQNo": "設問3",
      "text": "〔条件2と条件3への対応〕について、(1), (2)に答えよ。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "表2中の [ c ] に入れる適切な字句を、解答群の中から選び、記号で答えよ。",
          "answer": "オ",
          "explanation": "表2の役割は「基本方針の策定やN社インシデント対応ポリシの承認を担当する」とあります。図6(3)および(5)から、権限行使や情報開示の際には「情報セキュリティ委員会」の承認が必要とされており、この委員会が経営陣で構成されていることから、基本方針やポリシの承認を行う役割を担っているのはオの情報セキュリティ委員会です。",
          "point": 7
        },
        {
          "label": "(2)",
          "text": "図7中の [ d ] ~ [ f ] に入れる適切な字句を,解答群の中から選び、記号で答えよ。",
          "answer": "イ, カ, ウ",
          "explanation": "図7はNIST SP 800-61 Rev. 2に基づくインシデント対応ライフサイクルを示しています。\n\n### NIST SP 800-61 Rev. 2 ライフサイクル\n```mermaid\ngraph LR\n    A[準備] --> D[検知];\n    D --> E[分析];\n    E --> C[封じ込め];\n    C --> F[根絶];\n    F --> R[復旧];\n    R --> P[事後活動];\n    P --> A;\n```\n\nしたがって、dは**検知 (イ)**、eは**分析 (カ)**、fは**根絶 (ウ)** が適切です。",
          "multiAnswer": true,
          "d": "イ",
          "e": "カ",
          "f": "ウ",
          "point": 7
        }
      ]
    },
    {
      "subQNo": "設問4",
      "text": "〔新たなインシデントの発生と対応〕について、(1)~(5)に答えよ。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "本文中の下線⑤について、図9中の接続元 IP アドレスのうち、不正ログインを行ったと推測される接続元IPアドレスは幾つか。個数を答えよ。",
          "answer": "5",
          "explanation": "不正ログインはAC-Xを利用したSSH接続で行われました。図8より「N社及びV社からの通信は正規のものだけであった」ため、N社およびV社のIPアドレス範囲外からのSSH接続が不正アクセスと推測されます。\n\n注記4のIPアドレス範囲を確認します。\nN社 (x1.y1.z1.0/28): x1.y1.z1.1〜x1.y1.z1.14\nV社 (x2.y2.z2.128/30): x2.y2.z2.129〜x2.y2.z2.130\n\n図9のSSH接続元IPアドレス:\n1. x2.y2.z2.130 (V社): 正規\n2. x2.y2.z2.129 (V社): 正規\n3. x1.y1.z1.100: N社/V社範囲外 → 不正\n4. x1.y1.z1.240: N社/V社範囲外 → 不正\n5. x2.y2.z2.60: N社/V社範囲外 → 不正\n6. x2.y2.z2.58: N社/V社範囲外 → 不正\n7. a2.b2.c2.d2: N社/V社範囲外 → 不正\n\n不正アクセスを行ったと推測されるIPアドレスは、3, 4, 5, 6, 7 の5個です。",
          "point": 7
        },
        {
          "label": "(2)",
          "text": "図10中の下線⑥について、脆弱性 Mだけを悪用しても“/etc/shadow\" ファイルを参照できない理由を, \"/etc/shadow” ファイルの性質を含めて,70字以内で述べよ。",
          "answer": "/etc/shadowファイルは管理者権限でしか参照できないが、脆弱性Mを悪用したコマンド実行は開発支援ツールJが持つ一般利用者権限で動作するため。",
          "explanation": "図3(3)より、認証情報は/etc/shadowファイルに格納されており、これは管理者権限が必要です。一方、表3より、脆弱性M（開発支援ツールJの脆弱性）を悪用しても、実行されるコマンドは開発支援ツールJが持つOSの一般利用者権限で動作するため、管理者権限が必要な/etc/shadowファイルを参照することはできません。",
          "point": 7
        },
        {
          "label": "(3)",
          "text": "図10中の下線⑦について、攻撃者が行った設定変更の内容を、45字以内で具体的に述べよ。",
          "answer": "R1サーバの/etc/hosts.allowファイルの設定を変更し、インターネット経由のSSH接続元制限を解除した。",
          "explanation": "R1サーバへのSSH接続は、図3(3)に基づき、/etc/hosts.allowファイルでN社とV社に限定されていました。図8ではN社でもV社でもない複数のIPアドレスからSSH接続が行われているため、攻撃者は管理者権限でAC-Xを作成した後、このファイルの設定を変更し、外部からのSSH接続を許可したと考えられます。",
          "point": 7
        },
        {
          "label": "(4)",
          "text": "図10中の下線⑧について、F2 ファイルには、幾つの IP アドレスをスキャンした結果が格納されていると考えられるか。図9中の値及び図 10中の値を用いて求めよ。",
          "answer": "24",
          "explanation": "F1ファイルのサイズ (320kバイト) は、8個のIPアドレスのスキャン結果に相当します。IPアドレスごとの出力結果は固定長です。\n\nF1ファイルをアップロードした通信は通信量320kバイト。\nF2ファイルをアップロードしたと推測される通信は、通信量960kバイト。\n\n格納されているIPアドレスの数は、通信量に比例します。\n(F2のIPアドレス数) / (F1のIPアドレス数) = (F2の通信量) / (F1の通信量)\nX / 8 = 960 / 320\nX = 8 * 3 = 24\n\nしたがって、F2ファイルには24個のIPアドレスのスキャン結果が格納されていたと考えられます。",
          "point": 7
        },
        {
          "label": "(5)",
          "text": "本文中の下線⑨について、措置を75字以内で具体的に述べよ。",
          "answer": "R1サーバの脆弱性L及びMを解消するための修正プログラムを適用する。また、FW2においてR1サーバへのHTTP接続についても接続元IPアドレスをN社とV社に限定する。",
          "explanation": "攻撃は脆弱性L, Mが悪用され（(2)参照）、特に脆弱性MはHTTP接続経由で実行可能であり、R1サーバのHTTP接続には接続制限がないため(図3(3))、この経路が利用された可能性が高いです。したがって、脆弱性解消に加え、FW2でHTTP接続の接続元をN社とV社に限定し、不正な外部からのアクセスを防ぐ必要があります。",
          "point": 7
        }
      ]
    },
    {
      "subQNo": "設問5",
      "text": "本文中の下線⑩について、悪用される可能性を評価する際に加えるべき観点,又は影響を評価する際に加えるべき観点を、今回の事例を踏まえて 30 字以内で述べよ。",
      "answer": "脆弱なサーバが踏み台にされ、外部攻撃や他のシステムへの侵入に利用される影響。",
      "explanation": "インシデントQでは、R1サーバに機密情報がないことから脆弱性対応が見送られましたが、結果として不正アクセスを許し、外部スキャンや情報収集の踏み台として利用されました。したがって、脆弱性評価において、当該システムが情報資産を持たない場合でも、**他のシステムや外部への攻撃の基点（踏み台）となる影響**を考慮すべきでした。",
      "point": 7
    }
  ]
}