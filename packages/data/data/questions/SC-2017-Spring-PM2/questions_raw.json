[
  {
    "qNo": 1,
    "theme": "マルウェアの解析とインシデント対応",
    "description": "マルウェアの解析に関する次の記述を読んで，設問1～6に答えよ。\n\n R社は，インターネット上でショッピングモール（以下，ECサイトという）を運営する，従業員数 3,000名の企業である。ECサイトの総店舗数は 5,000店，会員数は 300,000名である。\n\n### [R社のネットワーク構成と組織]\n 図1は，R社のネットワーク構成である。\n\n```mermaid\ngraph TD\n  Internet((インターネット)) --- FW1\n  FW1 --- DMZ\n  FW1 --- Seg_Internal[内部メール・Webサーバセグメント]\n  FW1 --- FW2\n  FW1 --- Seg_Manage[運用管理セグメント]\n  FW1 --- Seg_Office[事務PCセグメント]\n  \n  FW2 --- DC[データセンタ ECサイトセグメント]\n  FW2 --- Seg_EC[EC管理セグメント]\n  FW2 --- Seg_AuthProxy[認証・プロキシセグメント]\n\n  subgraph DMZ\n    ExtMail[外部メールサーバ]\n    ExtDNS[外部DNSサーバ]\n    L2SW1[L2SW]\n  end\n  ExtMail --- L2SW1\n  ExtDNS --- L2SW1\n  L2SW1 --- FW1\n\n  subgraph Seg_Internal\n    IntMail[内部メールサーバ]\n    IntWeb[内部Webサーバ]\n    L2SW2[L2SW]\n  end\n  IntMail --- L2SW2\n  IntWeb --- L2SW2\n  L2SW2 --- FW1\n\n  subgraph Seg_Manage\n    Patch[パッチ配信サーバ]\n    Mon[運用監視サーバ]\n    Virus[ウイルス対策管理サーバ]\n    L2SW3[L2SW]\n  end\n  Patch --- L2SW3\n  Mon --- L2SW3\n  Virus --- L2SW3\n  L2SW3 --- FW1\n\n  subgraph Seg_Office\n    DHCP[DHCPサーバ]\n    OfficePC[事務用PC]\n    L2SW4[L2SW]\n  end\n  DHCP --- L2SW4\n  OfficePC --- L2SW4\n  L2SW4 --- FW1\n\n  subgraph Seg_EC\n    ECPC[EC管理PC]\n    L2SW5[L2SW]\n  end\n  ECPC --- L2SW5\n  L2SW5 --- FW2\n\n  subgraph Seg_AuthProxy\n    Auth[認証サーバ]\n    Proxy[プロキシサーバ]\n    L2SW6[L2SW]\n  end\n  Auth --- L2SW6\n  Proxy --- L2SW6\n  L2SW6 --- FW2\n\n  DC --- FW2\n\n  classDef fw fill:#f96,stroke:#333,stroke-width:2px;\n  class FW1,FW2 fw;\n```\n\n R社内では無線LANを使用していない。また，事務用PCとEC管理PCを併せて社内PCと呼んでいる。\n R社では，内部Webサーバに対してサーバ証明書を発行するためにプライベートCAを有しており，そのルート証明書を社内PCにインストールしている。プライベートCAは，必要に応じてサーバ証明書を発行することができる。プライベートCAはネットワークに接続されていない。\n 表1は，R社のネットワーク機器と役割である。\n\n#### 表1 R社のネットワーク機器と役割（抜粋）\n| 機器 | 役割・仕様 | 取得しているログ | \n| :--- | :--- | :--- | \n| FW1, 2 | 各ゾーンの境界を構成して，ゾーン間を接続し，通過するパケットを検査し，許可/遮断を判定する。 | ・許可ログ<br>・遮断ログ | \n| 外部DNSサーバ | ・社外からのR社のドメインに対するDNS問合せに応答する。<br>・認証サーバ及びDMZ内のサーバからの，社外のドメインに対するDNS問合せを処理する。 | なし | \n| 外部メールサーバ | ・社外からのR社宛ての電子メールを受信し，内部メールサーバに転送する。<br>・内部メールサーバからの社外宛てのメールを受信し，社外のメールサーバに転送する。<br>・メール転送時にウイルススキャンを行い，検知した場合は転送しない。 | ・受信したメールの情報<br>・転送したメールの情報<br>・ウイルススキャンの結果と対処情報 | \n| 内部Webサーバ | ・従業員に対して，情報提供，勤怠管理などの各種サービスを提供する。 | ・アクセスログ | \n| 認証サーバ | ・社内の利用者の認証を処理する。<br>・DMZを除く社内からのDNS問合せを処理する。R社のドメインについては自ら応答し，社外のドメインについては，外部DNSサーバに転送する。 | ・利用者認証の結果 | \n| 内部メールサーバ | ・社内の利用者のメールボックスを管理するとともに，社内の利用者からのメールの送受信要求を処理する。 | ・送受信したメールの情報<br>・利用者からの送受信要求ログ | \n| プロキシサーバ | ・社内PCから社外のWebサーバへのアクセスを中継する。本サーバ以外から社外のWebサーバへの直接アクセスは，FW1で遮断される。<br>・アクセス先URLに基づき，アクセス制御を行う。ホワイトリスト/ブラックリストの登録ができる。<br>・通信の中継時にウイルススキャンを行い，検知した場合はダウンロードしない。<br>・HTTP over TLS（以下，HTTPSという）復号機能はない。 | ・アクセスログ<br>・URLフィルタリング結果<br>・ウイルススキャンの結果と対処情報 | \n| パッチ配信サーバ | ・OSとPDF閲覧ソフトの脆弱性修正プログラムを社内PCに配信し，適用結果を収集する。 | ・配信した脆弱性修正プログラムの情報<br>・各PCの脆弱性修正プログラム適用結果 | \n| DHCPサーバ | ・事務用PCに対して，DHCPサービスを提供する。<br>・IPアドレスのリース期間は，20時間である。 | ・DHCPによる割当て結果 | \n| 事務用PC | ・一般事務のために利用される。 | なし | \n| EC管理PC | ・ECサイトを管理するために利用される。 | なし | \n\n### [不審な通信の発見]\n IS部では，セキュリティ監視業務の一環として8時間ごとにプロキシサーバのアクセスログを確認している。ある日の正午過ぎ，その日の午前4時から正午までのプロキシサーバのアクセスログの集計情報を確認していたIS部のU君は，特定の社内PCから特定のサーバに多数のHTTPS通信が行われていることを発見した。U君は不審に思い，アクセスログを急いで調査した結果，次のことが判明したので，それを午後0時30分にIS部のT部長に報告した。\n ・1台の事務用PCから，社外の同一サーバ（以下，被疑サーバという）に対して多数のHTTPS通信が，およそ30分おきに行われている。\n ・HTTPS通信が行われるごとに，数100kバイトのデータを送信している。\n\n### [インシデントへの初動対応]\n 報告を受けたT部長は，インシデントが発生したと判断して，IS部内に設置されているCSIRTの責任者であるV課長に対してインシデント対応を開始するよう指示した。V課長は，CSIRTメンバのM君を呼び，対応を開始するよう指示した。M君は，図2に示すインシデント対応規程に従って，表3の順序で初動対応を行った。\n\n#### 図2 インシデント対応規程（抜粋）\n ・PCからの不審な通信を発見した場合\n (1) 各種のログを調査して，不審な通信の送信元を特定する（以下，特定した送信元を不審PCという）。\n (2) 不審PCをLANから切り離す。電源オンの状態のまま移動できる場合は，直ちに解析室へ移動する。電源オンの状態のまま移動できない場合は，①電源をオフにすると消去されてしまう情報について，必要な調査を電源オンの状態で行い，調査終了後，電源をオフにして直ちに解析室へ不審PCを移動する。\n (3) 不審な通信を行っているPCが他にないか確認する。同様の通信を行っているPCを発見した場合は，不審PCと同じ対処をする。\n (4) 解析室内でマルウェア感染の可能性について初期判定を行う。\n (5) 不審PCを利用していた部署に初期判定結果を報告する。\n (6) 初期判定でマルウェアの可能性ありと判定したら，マルウェアの動作を特定するために詳細解析を開始する。\n (7) 特定されたマルウェアの動作から，被害の有無及び影響範囲を確認するとともに，被害拡大を防ぐために必要な措置を決定し，実施する。\n\n#### 表3 M君の初動対応\n| 順序 | 概要 | 詳細 | \n| :--- | :--- | :--- | \n| 1 | 送信元特定のためのログ調査 | ・[ a ] のログから，被疑サーバを宛先としたエントリを抽出し，送信元IPアドレスとアクセス時刻を洗い出した。<br>・送信元IPアドレスとアクセス時刻を基に，[ b ] のログを検索し，アクセス時刻に送信元IPアドレスを使用していた不審PCのMACアドレスを特定した。<br>・特定したMACアドレスをPC管理台帳中で検索して，不審PCの利用者，利用部署，設置場所及び不審PCの管理番号を特定した。不審PCの利用者は，サポート部のSさんであった。 | \n| 2 | 不審PCの確保 | ・不審PCの設置場所に行き，不審PCに接続されているLANケーブルを抜いた。<br>・不審PCはノートPCであったので，電源オンの状態のまま解析室に移動することにした。 | \n| 3 | 他のPCからの不審な通信の有無の調査 | ・移動中，IS部のU君に対して，正午以降に不審な通信がないか確認するよう依頼した。U君の調査の結果，正午から午後1時までの不審な通信は，SさんのPCからのものだけであった。 | \n\n### [マルウェアの初期判定]\n 午後1時，不審PCを回収して解析室に設置した後，M君は初期判定を開始した。初期判定は図3に示すIS部のマルウェア初期判定ガイドラインに従って実施した。\n\n#### 図3 マルウェア初期判定ガイドライン（抜粋）\n 1. ゴール：不審PCについて，マルウェアに感染している，感染している疑いがある，感染している疑いが薄いのいずれかに当たるかを迅速に判定することである。\n 2. 方針：不審PCと比較対照用PCを比較して，その差異に基づいて判定する。比較対照用PCとは，OS及びアプリケーションソフトウェアをインストールした後に，最新の脆弱性修正プログラムの適用やウイルス定義ファイルの更新を行った社内PCであり，インシデント対応開始時に作成する。\n 3. 遵守事項：\n  (a) 不審PCは，解析専用LANだけに接続し，他のLANに接続してはならない。\n  (b) 比較対照用PCは，比較対照用LAN以外に接続してはならない。また，比較対照用LANには他のPCを接続してはならない。\n  (c) 不審PCから外部媒体にデータを書き出す場合，又は外部媒体から不審PCにデータを書き込む場合は，所定の手続を経なければならない。\n 4. 解析チェックリスト：次のチェックリストのうち，不審PCにおいて1件でも該当すれば，マルウェアに感染している疑いがあると判定する。\n  (1) 動作中のプロセスの一覧を比較対照用PCと突き合わせると，比較対照用PCには存在しないプロセスが存在する。\n  (2) OSの起動後，操作をしない状態で，比較対照用PCでは発現しない通信が発現する。\n  (3) OSの起動後，Webブラウザの起動，メールソフトの起動などの操作をした際に，当該操作と関係のない通信が発現する。\n  (4) OSのシステムファイルの名称，タイムスタンプ及びサイズを比較対照用PCと突き合わせると，差異が存在する。\n\n M君が図3中の解析チェックリストの (2) について通信の有無を解析したところ，該当する通信を発見した。その通信は，被疑サーバを宛先とした通信であった。M君は，不審PCがマルウェアに感染している疑いがあると判定し，即座にV課長に報告した。不審PCは，マルウェア感染の疑いが濃くなってきたので，CSIRTでは被疑PCという名称で呼ぶことにした。\n\n### [インシデントへの二次対応]\n V課長は，次の指示を出した。\n ・M君に対して，図3中の解析チェックリストの (3), (4) について解析した後，詳細解析を開始すること\n ・CSIRTメンバのG君に対して，被疑PCの利用者及び所属部署に連絡し，聞き取り調査をすること\n ・CSIRTメンバのZ君に対して，ECサイトへの影響の有無を調査すること\n\n G君が，被疑PCの利用者であるSさんから聞き取り調査をした結果は次のとおりであった。\n ・昨日まで出張が続いていたので，被疑PCの電源を入れるのは3か月ぶりであった。\n ・朝，被疑PCの電源を入れ，午前9時30分までの間，Webブラウザを開いて幾つか社外のWebページを閲覧した。その後，今まで会議に出席していたので，それ以外は被疑PCを操作していなかった。その間，被疑PCにはログオンしたままであった。被疑PCは，無操作状態でもスリープ状態にならない設定であった。\n ・会社から貸与されている出張用スマートフォンでメールを読んでおり，今日は被疑PCのメールソフトを起動していない。\n\n G君は，念のため各種ログを調査したが，聞き取り調査の結果との矛盾はなかった。Z君が実施した調査では，ECサイトへの影響は一切発見できなかった。\n\n### [マルウェアの詳細解析]\n M君が解析室に戻り，図3中の解析チェックリストの (4) についてファイルの差異を解析したところ，不審なファイルを発見した。その後，被疑PCを図4の詳細解析環境に接続し，通信の観測を続けた。表4は，詳細解析環境内の各サーバの役割である。\n\n#### 図4 詳細解析環境\n```mermaid\ngraph LR\n  SuspectPC[被疑PC] --- L2SW\n  L2SW --- Pcap[パケットキャプチャ装置]\n  L2SW --- Proxy[解析用プロキシサーバ]\n  L2SW --- Auth[解析用認証サーバ]\n  L2SW --- DNS[解析用DNSサーバ]\n  L2SW --- DHCP[解析用DHCPサーバ]\n  L2SW --- Router[ルータ]\n  Router --- Web[解析用Webサーバ]\n```\n\n#### 表4 詳細解析環境内のサーバの役割\n| サーバ名 | 役割 | \n| :--- | :--- | \n| 解析用プロキシサーバ | 社内のプロキシサーバを模する。被疑PCからのHTTP/HTTPS通信を中継する。 | \n| 解析用認証サーバ | 社内の認証サーバを模する。被疑PCの利用者の認証を処理する。また，被疑PCからのDNS問合せを処理する。 | \n| 解析用DNSサーバ | 社内の外部DNSサーバを模する。解析用プロキシサーバからのDNS問合せを処理する。任意のDNS問合せに対して，解析用Webサーバのアドレスを返す。 | \n| 解析用DHCPサーバ | 社内のDHCPサーバを模する。被疑PCに対して，DHCPサービスを提供する。 | \n| 解析用Webサーバ | 社外のWebサーバを模する。任意のURLに対するHTTPリクエストに対して，同一のHTTPレスポンスを返す。HTTPSにも応答する。 | \n\n 被疑PCの通信について，観測の結果は次のとおりであった。\n (i) 解析用認証サーバに，認証を要求する。\n (ii) 解析用プロキシサーバを経由して被疑サーバにHTTPS通信を行おうとする。\n (iii) 被疑サーバ以外を宛先としたHTTP/HTTPS通信は行わない。\n (iv) 被疑PCと同一サブネット上のIPアドレスに対して，何らかのアクセスをする。\n\n このうち，アクセスの内容が不明であった (iv) を詳細に解析した結果，社内PCのOSで以前発見された脆弱性（以下，脆弱性Kという）を突いて攻撃を仕掛けていることが判明した。脆弱性Kは，2か月ほど前に脆弱性修正プログラムと併せて公開されており，R社でも社内PCに脆弱性修正プログラムを配信していた。\n 被疑PCが (ii) と (iv) の通信を行っている最中に，動いているプロセスをM君が調査したところ，マルウェアと思われるプロセスを発見した。発見したプロセスは，一通りの処理を終えると自身のファイルの隠蔽処理を行うとともに，自身を所定の時間経過後に起動するための設定をOSに対して組み込み，終了することが判明した。\n\n### [マルウェアのHTTPS通信の解析]\n マルウェアのおよその動きが判明したので，被害の有無を確認するために，被疑サーバにアクセスしている内容を確認すべく，M君は詳細解析環境を図5のように変更した。また，次の三つを行った。\n ・解析作業による被疑PCの状態変化を考慮し，被疑PCの状態を保存するために，被疑PCのHDDの複製を作成した。\n ・解析作業による情報漏えいを防ぐために，被疑PC内のファイルのうち，機密情報が含まれているファイルの内容をランダムデータに置き換えた。\n ・マルウェアがHTTPS通信を行う際，サーバ証明書の検証を行っている可能性を考慮し，検証が成功するよう，②サーバ証明書を発行し，図5の環境に，サーバ証明書と，それに対応する秘密鍵を組み込んだ。\n\n#### 図5 変更後の詳細解析環境\n```mermaid\ngraph TD\n  SuspectPC[被疑PC] --- L2SW\n  L2SW --- Proxy[解析用プロキシサーバ]\n  L2SW --- Auth[解析用認証サーバ]\n  L2SW --- DHCP[解析用DHCPサーバ]\n  L2SW --- Pcap[パケットキャプチャ装置]\n  Pcap --- Relay1[中継サーバ1]\n  Relay1 --- Relay2[中継サーバ2]\n  Relay2 --- Router[ルータ]\n  Router --- Internet((インターネット))\n  Relay2 --- SuspiciousServer[被疑サーバ]\n```\n※注記 中継サーバ2は，R社が契約しているISPで用意しているDNSサーバにDNS問合せを送る。\n\n 図5の環境で被疑PCがHTTPS通信を開始した場合の動作は，図6のとおりである。\n\n#### 図6 変更後の詳細解析環境における通信の概要\n (1) 被疑サーバを宛先としたHTTPS通信を開始するために，被疑PCから解析用プロキシサーバにセッション開始要求を送信する。\n (2) 解析用プロキシサーバが，HTTPS通信を中継することによって，被疑PCと中継サーバ1間の通信路が確立する。\n (3) 被疑PCは，確立した通信路を使用して，被疑サーバ宛てのHTTPS通信でのデータ送受信を開始する。\n (4) 中継サーバ1は，HTTPS通信を復号してHTTP通信に変換した上で，中継サーバ2に転送する。応答は，HTTP通信からHTTPS通信に変換して解析用プロキシサーバに返す。\n (5) 中継サーバ2は，HTTP通信を暗号化してHTTPS通信に変換した上で，インターネット上の被疑サーバと通信を確立する。応答は，HTTPS通信からHTTP通信に変換して中継サーバ1に返す。\n\n M君は，図5の環境で1～2時間ほど被疑PCを稼働させることにした。パケットデータの収集を待つ間，デバッガを用いた解析を行うことにした。\n\n### [デバッガによる解析]\n M君は，被疑PC内の不審なファイルのうち，マルウェアと思われる実行ファイルを所定の手続に従って取り出し，これを検体$\\alpha$と呼ぶことにした。続いて，CSIRTで用意している，デバッガを含むコード解析環境に検体$\\alpha$を投入した。\n まず，検体$\\alpha$から読解可能な文字列を探したが，ほとんど存在しなかった。続いて，デバッガによる逆アセンブルを試行した。その結果，得られたアセンブリコードには，通常であれば多数存在するはずのシステムコールの呼出しが少数しかなかった。M君はブレークポイントを指定して検体$\\alpha$を実行してみたが，コードの冒頭部分が実行されただけで，何ら不正な動作をすることなく終了してしまった。\n 解析に行き詰まったM君がV課長に相談したところ，検体$\\alpha$にはデバッガ環境下で実行していることを検知して実行を停止する機能が組み込まれているのであろうという説明を受けた。マルウェアがデバッガ環境下であることを検知する方法としては，デバッガ環境下であるかどうかを調べるシステムコールを実行する方法があるが，③その他にも幾つかの方法が知られている。\n M君は，検体$\\alpha$のアセンブリコードを読んで，デバッガ検知機能を発見し，これを無効化することに成功した。無効化後の検体を検体$\\alpha2$と呼ぶことにし，M君は，検体$\\alpha2$の解析を次の手法で進めた。\n ・検体$\\alpha2$をデバッガにロードした時点で，逆アセンブルを行い，システムコールの呼出し全てにブレークポイントを設定する。\n ・ブレークするごとにシステムコールの内容を記録し，検体$\\alpha$の動作を推測する。\n\n この結果判明したシステムコールの呼出し回数はごく僅かで，動作の推測には至らなかった。ごく僅かの回数ブレークした後は，ブレークすることなく検体$\\alpha2$の実行が続き，他のPCを感染させるための通信を試みた上で終了した。この通信を行うには，システムコールの呼出しが必要なはずであるが，ブレークすることはなかった。\n またもや解析に行き詰まったM君がV課長に相談したところ，パッカーが使われている可能性が高いとの説明を受けた。V課長は，パッカーの一般的な仕組みについて図7と図8を使って説明した。\n\n#### 図7 パッカーに関する説明\n (1) 図8の三つの図は，いずれもメモリ上のメモリブロックを表しており，プログラムカウンタ（以下，カウンタという）は上から下へと移動していく。\n (2) マルウェアがメモリにロードされた時点では，図8のマルウェアのロード時の状態になる。デバッガにロードされたときも同じ状態である。\n (3) マルウェアが動作を始めると，図8のアンパック処理時の状態になる。この時点で，暗号化済みコード部のデータは実行プログラム部によって復号されて，見せかけのデータ部に書き込まれる。\n (4) 見せかけのデータ部への書込みが完了すると，図8の本体の実行開始時の状態になる。この時点で，見せかけのデータ部が，マルウェア本体に変わり，攻撃者の意図した動作を開始する。\n (5) このようなマルウェアは，ウイルス定義ファイルに基づくウイルススキャンでの検知が著しく難しい。\n\n#### 図8 パッカーの説明図\n```mermaid\ngraph LR\n  subgraph Loading [マルウェアのロード時]\n    H1[プログラムヘッダ部]\n    E1[実行プログラム部 復号処理部]\n    C1[暗号化済みコード部]\n    D1[見せかけのデータ部]\n  end\n  \n  subgraph Unpacking [アンパック処理時]\n    H2[プログラムヘッダ部]\n    E2[実行プログラム部 復号処理部]\n    C2[暗号化済みコード部]\n    D2[見せかけのデータ部]\n  end\n  \n  subgraph Running [本体の実行開始時]\n    H3[プログラムヘッダ部]\n    E3[実行プログラム部 復号処理部]\n    C3[暗号化済みコード部]\n    D3[マルウェア本体]\n  end\n\n  E2 -- 復号・書込み --> D2\n  Loading -.-> Unpacking -.-> Running\n```\n\n M君は，パッカーによる動作を解析して，検体$\\alpha2$のマルウェア本体のコードを手に入れることができた。\n\n### [応急措置の決定と実施]\n M君がデバッガを使って検体$\\alpha2$を解析している間に，図5の環境において十分なパケットデータが取得できた。このパケットデータから，被疑サーバに送信していた情報が判明した。情報は暗号化されていたが，検体$\\alpha2$のマルウェア本体から取り出した鍵を使って復号したところ，平文を得ることができた。\n その結果，次の三つが被疑サーバに送信されていることが確認できた。\n ・被疑PC内に一時的に保存された認証情報（利用者IDと，パスワードのハッシュ値を含む）\n ・解析用認証サーバから取得した認証情報（利用者IDだけを含み，パスワードのハッシュ値を含まない）\n ・OSの設定情報及びシステムファイルのファイル名の一覧\n\n M君の報告を受けたV課長は，マルウェアの動作の特定並びに被害の有無及び影響範囲の確認ができたと考え，これ以上の被害拡大を防ぐために，表5の応急措置を即時実施することをT部長に進言した。\n\n#### 表5 インシデントに対する応急措置\n| 措置の目的 | マルウェアの動作に対応した応急措置 | \n| :--- | :--- | \n| 被疑サーバへのHTTPSアクセスの禁止 | ・[ c ] に被疑サーバを登録するとともに，念のためFW1のルールを変更する。 | \n| マルウェアの感染の防止 | ・全ての社内PCについて，[ d ] 。 | \n| マルウェアによる不正なプロセスの実行の禁止 | ・解析の結果，判明したマルウェアのプログラム名を，社内PCのOSに，実行禁止プログラムとして登録する。 | \n| 窃取されたアカウント情報の悪用の防止 | ・被疑PC内にキャッシュされていた認証情報に含まれる利用者のアカウントについて，[ e ] を行う。 | \n\n### [感染経路の特定と対処]\n V課長は，再感染を防止するために，M君に感染経路を特定するよう指示した。M君は，Sさんからの聞き取り調査の内容から，被疑PCが社外のWebページを閲覧した際にマルウェアに感染した可能性が高いと考え，表6の手順で感染経路の特定を目指した。\n\n#### 表6 感染経路の特定手順\n| 順序 | 概要 | 詳細 | \n| :--- | :--- | :--- | \n| 1 | 被疑PCのIPアドレスの特定 | ・初動対応において特定済みである。 | \n| 2 | アクセス先URLの一覧取得 | ・[ a ] のログを参照し，今日被疑PCがアクセスした社外のURLの一覧を作成する。 | \n| 3 | URLの内容確認 | ・URLの一覧の中の各URLについて，URLの安全性を評価するWebサイトで評価結果を確認する。<br>・URLの一覧の中の各URLにアクセスし，不審な内容が存在しないか確認する。 | \n\n 確認したところ，URLの一覧に記載されたWebサイトの中で，インターネット上のECサービスに関するニュースを提供しているQ社のWebサイト内の1ページ（以下，Nページという）に，不自然な形でスクリプトが埋め込まれていることが発見された。このスクリプトは複雑であり，M君が読んでも動作を把握することができなかった。そこでV課長がNページを分析してみたところ，次のことが分かった。\n ・NページをWebブラウザで開くと，Q社のドメイン外のサイトからPDFファイルをダウンロードして，PDF閲覧ソフトで開く。\n ・Nページから不自然なスクリプトを削除したページをWebブラウザで開くと，Nページと表示に違いはないが，PDFファイルはダウンロードされない。\n\n V課長とM君は，Nページが改ざんされ，マルウェアを配布していると推測した。しかし，比較対照用PCをインターネットにアクセスできる環境とした上でNページを開いても，PDFの内容が表示されるだけで，不審なファイルや不審なプロセスが生成されることはなく，マルウェアに感染しなかった。\n 困ったM君がV課長に相談したところ，④比較対照用PCの状態と，今日の勤務開始時刻時点の被疑PCの状態では，重要な点が異なっている可能性が高いので，[ f ] のログを確認してみるようアドバイスを受けた。[ f ] のログを確認したM君は，比較対照用PCの状態を，今日の勤務開始時刻時点の被疑PCと同一の状態にした上で，もう一度Nページにアクセスした。その結果，不審なプロセスや検体$\\alpha$などの不審なファイルが生成されていた。このことによって，マルウェア（以下，マルウェアLという）に感染したことが分かった。\n この時点で，マルウェアLの感染経路はNページを閲覧したことによるものと判断することができた。この報告を受けたV課長は，次の対応策の実施をT部長に進言した。\n ・当面の間，社内PCからQ社のWebサイトへのアクセスを遮断する。\n ・過去1週間の [ a ] のログを調査し，Q社のWebサイトを閲覧した社内PCを洗い出し，それらのPCについて，[ a ] のログと [ f ] のログを突き合わせ，⑤マルウェアLに感染する可能性があったかどうか判断する。\n ・Q社に対して適切な方法で，Webサイトが改ざんされている旨を伝える。\n\n 調査の結果，SさんのPC以外に感染した社内PCは存在しないことが確認できた。最後に，検体及び複製HDDを消去し，インシデント対応を無事終了した。\n\n### [インシデント対応の事後評価]\n V課長は，今回のインシデント対応を振り返り，1日以内に全ての対応を完了したこと，マルウェアLに感染したPCも1台だけであり，拡大を防げたことから，対応は成功したと考えた。\n 後日，V課長は，今回のインシデント対応に当たったメンバを招集し，事後評価を実施した。その結果，⑥デジタルフォレンジックスという観点から，実施するタイミングを見直す必要がある作業があること，⑦被疑PCの利用者の業務継続を考慮して対応する必要があることが課題として挙げられた。さらに，今回のマルウェアLの場合，図3中の解析チェックリストではマルウェア感染を発見できない場合があるので，解析チェックリストの項目に，“[ g ] を比較対照用PCと突き合わせると，差異が存在する”という項目を追加する必要があるとの結論に至った。\n その後，Q社からWebサイトの改ざんの原因の判明と復旧の連絡が届いたので，内容を確認後，Q社Webサイトへのアクセス遮断を解除した。",
    "questions": [
      {
        "subQNo": "設問1",
        "text": "〔インシデントへの初動対応〕について，(1), (2)に答えよ。",
        "explanation": "初動対応におけるログ調査とPC確保に関する問題です。\n\n### (1) 電源オンで消去される情報の例\n図2の下線①「電源をオフにすると消去されてしまう情報」には、メモリ上にのみ存在する揮発性情報が含まれます。\n- ア: HDDのパーティションテーブル（不揮発）\n- イ: OSのバージョン（不揮発）\n- ウ: 画面に表示されているウィンドウの名称（揮発性。表示されているだけでプロセスと結びついている）\n- エ: 起動しているプロセスの一覧（揮発性。メモリ上の情報）\n- オ: 脆弱性修正プログラムの適用状況（レジストリやファイル等に記録。不揮発）\n\n### (2) 空欄 a, b に入れる適切な字句\n- **空欄 [ a ]**: 不審な通信（被疑サーバ宛て）の送信元IPと時刻を特定するために使用するログ。図1より、社内PCから外部へのアクセスはプロキシサーバを経由するため、プロキシサーバのアクセスログを参照します。\n- **空欄 [ b ]**: IPアドレスからMACアドレスを特定するためのログ。DHCPサーバはIPの割り当て時にMACアドレスとIPの対応を記録するため、DHCPサーバのログが適切です。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "図2中の下線①について，該当する情報を，解答群の中から全て選び，記号で答えよ。",
            "subQuestions": [
              {
                "label": "解答群",
                "text": "ア HDDのパーティションテーブルの情報\nイ OSのバージョンの情報\nウ 画面に表示されているウィンドウの名称一覧\nエ 起動しているプロセスの一覧\nオ 脆弱性修正プログラムの適用状況"
              }
            ]
          },
          {
            "label": "(2)",
            "text": "表3，表6及び本文中の [ a ] ，表3中の [ b ] に入れる適切な字句を，図1中の構成要素から選び，答えよ。"
          }
        ]
      },
      {
        "subQNo": "設問2",
        "text": "〔マルウェアのHTTPS通信の解析〕について，(1)～(3)に答えよ。",
        "explanation": "HTTPS通信の復号解析（SSL可視化）に関する技術的な設問です。\n\n### (1) 証明書のサブジェクト名\nマルウェア（被疑PC）が証明書の検証に成功するためには、アクセス先である「被疑サーバ」のFQDN（またはホスト名）が証明書の「サブジェクトのコモンネーム（CN）」に設定されている必要があります。\n\n### (2) 秘密鍵の組み込み先\n図5及び図6の構成では、「中継サーバ1」がHTTPSを復号してHTTPに変換しています。したがって、復号に必要な秘密鍵は中継サーバ1に組み込む必要があります。\n\n### (3) プロキシサーバの設定\n通常、HTTPS通信はプロキシを単に「トンネル（CONNECTメソッド）」として通過しますが、中継サーバで復号するためには、解析用プロキシサーバが中継サーバ1に対して通信を転送するように設定するか、あるいは証明書の検証を回避させるような特別なルーティング（または透過プロキシ設定）が必要です。最も直接的なのは、被疑サーバ宛のHTTPS通信を解析用プロキシサーバが中継サーバ1へ転送するように設定することです。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線②について，発行する証明書において，サブジェクトのコモンネームは，どのサーバの何を組み込むべきか。15字以内で答えよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の下線②について，発行した証明書と対応する秘密鍵を組み込むべきサーバの名称を，図5中の機器から選び，答えよ。"
          },
          {
            "label": "(3)",
            "text": "図5の解析環境を正常に動作させるためには，図5中の解析用プロキシサーバ上で特別な設定を行う必要がある。その設定内容を，45字以内で述べよ。"
          }
        ]
      },
      {
        "subQNo": "設問3",
        "text": "〔デバッガによる解析〕について，(1), (2)に答えよ。",
        "explanation": "アンチデバッグとパッカー（実行時解凍）に関する問題です。\n\n### (1) デバッガ検知の方法\nシステムコール以外の方法としては、「デバッグ中を示すフラグ（PEBのBeingDebuggedフラグなど）をチェックする」や「特定の命令を実行した際の例外処理の挙動を確認する」、「コードの実行時間を計測して遅延を検知する」などが挙げられます。\n\n### (2) パッカーによる検知の難しさ\nパッカーで保護されたマルウェアは、ファイルとして保存されている状態（静的な状態）では「本体のコード」が暗号化・圧縮されており、ウイルス定義ファイル（シグネチャ）とのマッチングができないためです。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線③について，どのような方法があるか。40字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "図7の(5)について，検知が著しく難しい理由を，60字以内で述べよ。"
          }
        ]
      },
      {
        "subQNo": "設問4",
        "text": "〔応急措置の決定と実施〕について，(1)～(3)に答えよ。",
        "explanation": "インシデント発生後の暫定的な封じ込め策に関する問題です。\n\n- [ c ]: プロキシサーバのブラックリスト（またはURLフィルタリングリスト）。被疑サーバへのアクセスを拒絶するため。\n- [ d ]: 全ての社内PCにおいて、マルウェアが利用していた脆弱性Kの修正プログラムが適用されているか確認し、未適用なら適用する。\n- [ e ]: パスワードの変更。認証情報が窃取されたため、不正ログインを防ぐ必要があります。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "表5中の [ c ] に入れる適切な字句を，20字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "表5中の [ d ] に入れる適切な措置を，新規にソフトウェアや機器を調達しない前提で，30字以内で述べよ。"
          },
          {
            "label": "(3)",
            "text": "表5中の [ e ] に入れる適切な字句を，10字以内で答えよ。"
          }
        ]
      },
      {
        "subQNo": "設問5",
        "text": "〔感染経路の特定と対処〕について，(1)～(3)に答えよ。",
        "explanation": "特定のPCだけが感染した理由（脆弱性の有無）を特定するプロセスです。\n\n### (1) 状態の差異\n比較対照用PCは「最新の修正プログラムを適用済み」の状態ですが、Sさんの被疑PCは「3か月間電源がオフ」であり、2か月前に公開された「脆弱性Kの修正プログラムが未適用」の状態でした。\n\n### (2) 空欄 f に入れる機器名\n脆弱性の適用状況を確認するログです。表1の「パッチ配信サーバ」のログには、各PCの脆弱性修正プログラム適用結果が記録されています。\n\n### (3) 感染の可能性の判断基準\n「Q社のWebサイトにアクセスした時刻」に、当該PCが「脆弱性Kの修正プログラムを未適用」であった場合に、感染の可能性があると判断します。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線④について，どのような点が異なっていたか。30字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の [ f ] に入れる適切な機器名称を，表1中の機器から選び，答えよ。"
          },
          {
            "label": "(3)",
            "text": "本文中の下線⑤について，どのような場合に感染の可能性があったと判断するか。55字以内で述べよ。"
          }
        ]
      },
      {
        "subQNo": "設問6",
        "text": "〔インシデント対応の事後評価〕について，(1)～(3)に答えよ。",
        "explanation": "フォレンジックの原則と、パッカー等への対策改善です。\n\n### (1) タイミングの見直し\nデジタルフォレンジックスでは、揮発性情報（メモリ内容等）の消失を防ぐため、PCをシャットダウンする前やネットワークから切り離す直前にメモリダンプを取得するなどの「揮発性データの収集」作業のタイミングが重要です。\n\n### (2) 業務継続への対応\nPCを即座に没収すると業務が止まるため、「代替PCを即座に提供する」または「HDDの複製（イメージ）を迅速に取得してPC自体は返却する」などの配慮が必要です。\n\n### (3) チェックリストの追加項目 [ g ]\nパッカーを使ったマルウェアなどは、OSの起動設定や自動実行設定を書き換えます。本文中に「自身を所定の時間経過後に起動するための設定をOSに対して組み込み」とあるため、「OSの自動起動設定（レジストリ等）」が適切です。",
        "subQuestions": [
          {
            "label": "(1)",
            "text": "本文中の下線⑥について，実施するタイミングを見直す必要がある作業とは何か。20字以内で述べよ。"
          },
          {
            "label": "(2)",
            "text": "本文中の下線⑦について，どのような対応をすべきか。25字以内で具体的に述べよ。"
          },
          {
            "label": "(3)",
            "text": "本文中の [ g ] に入れる適切な内容を 40 字以内で述べよ。"
          }
        ]
      }
    ]
  }
]