{
  "qNo": 1,
  "theme": "情報セキュリティ / インターネットサービス向けサーバのセキュリティ対策",
  "description": "食品販売業を営むL社では、社内外の電子メール(以下,メールという)を扱うメールサーバ、商品を紹介するWebサーバ及び自社ドメイン名を管理するDNSサーバを運用している。L社情報システム部のM部長は、インターネット経由の外部からのサイバー攻撃への対策が重要だと考え、当該サイバー攻撃にさらされるおそれのあるサーバの脆弱性診断を行うように、情報システム部のNさんに指示した。L社のサーバなどを配置したDMZを含むネットワーク構成を図1に、各サーバで使用している主なソフトウェアを表1に示す。\n\nなお、L社のセキュリティポリシでは、各サーバで稼働するサービスへのアクセス制限は、ファイアウォール(以下,FWという)及び各サーバのOSがもつFW機能の両方で実施することになっている。\n\n### 図1 L社のサーバなどを配置したDMZを含むネットワーク構成\n```mermaid\ngraph TD\n    Internet[インターネット] --> Router[ルータ]\n    Router --> WebServer[Web サーバ]\n    Router --> DNSServer[DNSサーバ]\n    LAN[社内LAN] --> FW[FW]\n    FW --> L2SW[レイヤ2スイッチ]\n    L2SW --> MailServer[メールサーバ]\n    subgraph DMZ\n        WebServer\n        DNSServer\n        MailServer\n        L2SW\n    end\n```\n\n### 表1 各サーバで使用している主なソフトウェア\n| サーバ名     | ソフトウェア                                                                         |\n|--------------|--------------------------------------------------------------------------------------|\n| メールサーバ | OS-A, メールサーバソフトウェア                                                       |\n| Web サーバ   | OS-B, Web サーバソフトウェア, DBMS, 商品検索ソフトウェア (社外に委託して開発した自社ソフトウェア) |\n| DNS サーバ   | OS-A, DNS サーバソフトウェア                                                         |\n\n### 脆弱性診断の実施\nNさんは、社外のセキュリティベンダであるQ社に、メールサーバ, Webサーバ及びDNSサーバの脆弱性診断を実施してもらい、脆弱性診断の内容とその結果を受け取った。Q社が実施した脆弱性診断の内容の抜粋を表2に、Q社から受け取った脆弱性診断結果の抜粋を表3に示す。\n\n### 表2 Q社が実施した脆弱性診断の内容(抜粋)\n| 項番 | 項目                       | 実施内容                                                                                                                                                                             |\n|------|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| 診1  | ポートスキャン             | インターネット側から対象サーバにTCPスキャン及び [ a ] スキャンを実施し、稼働しているサービスに関する情報を収集する。                                                                          |\n| 診2  | 既知の脆弱性に対する診断 | 使用しているソフトウェアのバージョンなどから既知の脆弱性がないことを確認する。                                                                                                       |\n| 診3  | ソフトウェア設定診断     | OS, ミドルウェア, アプリケーションの設定の不備などがないことを確認する。                                                                                                           |\n| 診4  | Webアプリケーション診断  | Webアプリケーションについて、 [ b ] の不備、Webページの出力処理の不備などがないことを確認する。                                                                                         |\n\n### 表3 Q社から受け取った脆弱性診断結果(抜粋)\n| 項番 | 対象サーバ   | 脆弱性診断の項番 | 対象ソフトウェア         | 脆弱性の内容                                                                                                                                     |\n|------|--------------|------------------|--------------------------|------------------------------------------------------------------------------------------------------------------------------------------|\n| 脆1  | メールサーバ | [ c ]           | メールサーバソフトウェア | 送信ドメイン認証機能が未設定なので、インターネットから届く送信元メールアドレスを偽装したスパムメールを受信してしまう状態であった。     |\n| 脆2  | Webサーバ    | 診1              | OS-B                     | DBMSに接続するためのTCPポートにインターネットからアクセス可能であった。                                                                  |\n| 脆3  | Webサーバ    | 診3              | Webサーバソフトウェア    | 脆弱な暗号化通信方式が使用できてしまう設定であり、情報漏えいのおそれがあった。                                                           |\n| 脆4  | Webサーバ    | 診4              | 商品検索ソフトウェア     | 入力値チェックの不備によって、データベースに蓄積された非公開情報が閲覧されるおそれがあった。                                           |\n| 脆5  | DNSサーバ    | 診2              | DNSサーバソフトウェア    | DNSサーバソフトウェアの脆弱性によって、ゾーン情報がリモートから操作可能であった。                                                    |\n\n### 発見された脆弱性への対策の検討\nNさんは、表3の脆弱性診断結果の内容を確認し、発見された脆弱性に対して実施すべき対策の案を検討した。検討結果を表4に示す。\n\n### 表4 発見された脆弱性に対して実施すべき対策(案)\n| 脆弱性診断結果の項番 | 実施すべき対策                                                                                                                                                                                                                                                                                                                                                                                                                                     |\n|----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| 脆1                  | メールサーバソフトウェアに送信ドメイン認証機能として [ d ] 認証の設定を行う。送信元メールアドレスのドメイン名からDNSに問合せを行い、 [ e ] レコードから正規のIPアドレスを調べる。受信したメールのIPアドレスと照合して、なりすましの受信メールをフィルタリングする。                                                                                                                                                     |\n| 脆2                  | [ f ] と、 [ g ] のOSがもつFW機能で、DBMSに接続するためのTCPポートを閉塞して、インターネットからDBMSにアクセスできないようにする。                                                                                                                                                                                                                                                                                                                       |\n| 脆3                  | Webサーバソフトウェアの設定を変更して、脆弱な暗号化通信方式を使用禁止にする。                                                                                                                                                                                                                                                                                                                                                                      |\n| 脆4                  | SQL文を組み立てる際に害のあるコードが入力値に含まれていないか十分にチェックして [ h ] を防止する。                                                                                                                                                                                                                                                                                                                                              |\n| 脆5                  | DNSサーバソフトウェアの脆弱性に対応する修正ソフトウェアがリリースされているので、これを適用する。                                                                                                                                                                                                                                                                                                                                                  |\n\nNさんは、脆弱性診断結果(表3)と、実施すべき対策の案(表4)をM部長に報告した。報告を受けたM部長は、Nさんが検討した表4の脆弱性対策を速やかに実施することと、中長期的な脆弱性対策を検討することを指示した。\n\n### 中長期的な脆弱性対策\nNさんは、OSやミドルウェアなどの市販ソフトウェアと社外に委託して開発する自社ソフトウェアについて、L社が中長期的に取り組むべき脆弱性対策の案を検討した。検討結果を表5に示す。\n\n### 表5 L社が中長期的に取り組むべき脆弱性対策(案)\n| 市販ソフトウェア                                                                                                                                 | 社外に委託して開発する自社ソフトウェア                                                                                                                                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| ・サーバで使用しているソフトウェアの製造元・提供元から更新情報を入手する。                                                             | ・ソフトウェア開発の委託先企業との契約に、セキュアコーディングの実施を盛り込む。                                                                                                       |\n| ・①社外の関連する組織から脆弱性情報を入手して活用する。                                                                                   | ・②ソフトウェア開発の委託先企業のセキュリティ対策の実施状況を確認する。                                                                                                               |\n| ・運用・保守要員に対するセキュリティ教育を実施し、脆弱性対策への意識を高める。                                                         | ・③ソフトウェアの企画・設計段階からセキュリティ機能を組み込むようにセキュリティの専門家を参加させる。                                                                               |\n\nNさんは、表5の脆弱性対策の案を盛り込んだ改善計画を策定し、その結果をM部長に報告した。改善計画を確認したM部長は、この改善計画を基に具体的な取り組みを検討するようにNさんに指示した。\n",
  "questions": [
    {
      "subQNo": "設問1",
      "text": "[脆弱性診断の実施]について、(1), (2)に答えよ。",
      "explanation": "本設問では、脆弱性診断の内容と結果に関する空欄を埋める問題です。表2は診断内容、表3は診断結果を表しています。各診断がどのような目的で行われるかを理解することが重要です。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "表2中の [ a ], [ b ] に入れる適切な字句を解答群の中から選び、記号で答えよ。\n解答群\nア ARP\nウ UDP\nオ インシデント管理\nキ セッション管理\nイ IT資産管理\nエ XML\nカ ウイルス\nクログ管理",
          "explanation": "### (1) [ a ] について\n「診1 ポートスキャン」は、「インターネット側から対象サーバにTCPスキャン及び [ a ] スキャンを実施し、稼働しているサービスに関する情報を収集する」とあります。ポートスキャンは、ターゲットの開いているポートを特定するために行われるもので、主にTCPとUDPのポートが対象となります。したがって、[ a ] には「ウ UDP」が入ります。\n\n### (1) [ b ] について\n「診4 Webアプリケーション診断」は、「Webアプリケーションについて、 [ b ] の不備、Webページの出力処理の不備などがないことを確認する」とあります。Webアプリケーションの脆弱性診断では、セッション管理の不備（セッションハイジャック、セッション固定化など）は主要な診断項目の一つです。他の選択肢はWebアプリケーションの直接的な不備としては不適切です。\n\n```mermaid\ngraph TD\n    A[ポートスキャン] --> B{TCPスキャン};;\n    A --> C{[ a ] スキャン};;\n    C --> D[稼働サービス情報収集];;\n\n    E[Webアプリケーション診断] --> F{[ b ] の不備確認};;\n    E --> G[Webページ出力処理の不備確認];;\n    F --> H[セキュリティ脆弱性特定];;\n    G --> H;\n```\n**解答:**\n*   [ a ] : ウ\n*   [ b ] : キ",
          "point": 15
        },
        {
          "label": "(2)",
          "text": "表3中の [ c ] に入れる適切な字句を答えよ。",
          "explanation": "「脆1 メールサーバ」の脆弱性の内容は、「送信ドメイン認証機能が未設定なので、インターネットから届く送信元メールアドレスを偽装したスパムメールを受信してしまう状態であった」とあります。これは、メールサーバの**設定の不備**に起因する脆弱性です。\n\n表2の脆弱性診断の内容を見ると、「診3 ソフトウェア設定診断」が「OS, ミドルウェア, アプリケーションの設定の不備などがないことを確認する」とあります。この内容が「脆1」の脆弱性に合致するため、[ c ] には「診3」が入ります。\n\n```mermaid\ngraph TD\n    A[脆1: メールサーバの脆弱性] --> B[送信ドメイン認証機能が未設定];\n    B --> C[スパムメール受信リスク];\n    C -- 対策の確認 --> D{表2の診断項目と照合};;\n    D -- 設定の不備に該当 --> E[診3: ソフトウェア設定診断];\n```\n**解答:** 診3",
          "point": 15
        }
      ]
    },
    {
      "subQNo": "設問2",
      "text": "[発見された脆弱性への対策の検討]について、(1)~(3)に答えよ。",
      "explanation": "本設問では、発見された脆弱性に対してどのような対策を講じるか、具体的な内容について問われています。メール認証の仕組み、ネットワークのアクセス制御、Webアプリケーションの脆弱性対策といった幅広い知識が求められます。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "表4中の [ d ], [ e ] に入れる適切な字句を解答群の中から選び、記号で答えよ。\n解答群\nア MX\nイ PTR\nウ SMTP\nエ SPF\nオ 送信先\nカ 送信元\nキ 中継先\nク 中継元",
          "explanation": "### (1) [ d ] について\n「脆1」の対策は、「メールサーバソフトウェアに送信ドメイン認証機能として [ d ] 認証の設定を行う」とあります。送信ドメイン認証機能として広く使われているのは、Sender Policy Framework（SPF）、DomainKeys Identified Mail（DKIM）、DMARCなどです。解答群の中では「エ SPF」が適切です。\n\n### (1) [ e ] について\n「送信元メールアドレスのドメイン名からDNSに問合せを行い、 [ e ] レコードから正規のIPアドレスを調べる」とあります。SPF認証では、送信元のIPアドレスが、送信元ドメインのDNSレコード（通常はTXTレコードとして登録されるSPFレコード）に記載された許可されたIPアドレスリストに含まれているかを確認します。また、`ptr`メカニズムを用いる場合、送信元IPアドレスの逆引き（IPアドレスからドメイン名を検索）を行い、そのドメイン名が送信元メールアドレスのドメイン名と一致するかを確認することがあります。この逆引きに使用されるのが「イ PTR」レコードです。\n\n```mermaid\nsequenceDiagram\n    participant S as 送信元メールサーバ\n    participant R as 受信側メールサーバ\n    participant D as DNSサーバ\n\n    S->>R: メール送信 (From: example.com, 送信元IP: 192.0.2.1)\n    R->>D: example.com の [ d ] レコードを問い合わせ\n    D-->>R: SPFレコード (TXT) を応答\n    R->>D: 192.0.2.1 の [ e ] レコード (PTR) を問い合わせ\n    D-->>R: PTRレコード (例: mail.example.com) を応答\n    R->>R: 応答に基づきIPアドレスを照合、なりすましをフィルタリング\n```\n**解答:**\n*   [ d ] : エ\n*   [ e ] : イ",
          "point": 14
        },
        {
          "label": "(2)",
          "text": "表4中の [ f ], [ g ] に入れる適切な字句を、図1中の構成機器の名称で答えよ。",
          "explanation": "「脆2」の脆弱性は、「DBMSに接続するためのTCPポートにインターネットからアクセス可能であった」というものです。この対策として、「[ f ] と、 [ g ] のOSがもつFW機能で、DBMSに接続するためのTCPポートを閉塞して、インターネットからDBMSにアクセスできないようにする」とあります。\n\n図1のネットワーク構成を見ると、インターネットからのアクセスを最初に受けるネットワーク機器は「ルータ」であり、DMZに入る手前には「FW（ファイアウォール）」があります。また、DBMSは「Webサーバ」上で稼働しているため、Webサーバ自身のOSが持つファイアウォール機能も利用できます。\n\nしたがって、インターネットからDBMSへのアクセスを遮断するためには、ネットワーク上のファイアウォールである「FW」と、DBMSが稼働している「Web サーバ」のOSが持つファイアウォール機能の両方でポートを閉塞するのが適切です。\n\n```mermaid\ngraph TD\n    Internet[インターネット] --> Router[ルータ];\n    Router --> FW[FW];\n    FW --> WebServer[Web サーバ (DBMS)];\n    WebServer -- OSのFW機能 --> DBMS[DBMSのポート];\n    FW -- ネットワークFW機能 --> WebServer;\n    Internet -.-> DBMS;\n    style Internet fill:#f9f,stroke:#333,stroke-width:2px\n    style DBMS fill:#f9f,stroke:#333,stroke-width:2px\n    linkStyle 4 stroke:#f00,stroke-width:2px,fill:none,stroke-dasharray: 5 5;\n    linkStyle 0 stroke:#333,stroke-width:2px\n    linkStyle 1 stroke:#333,stroke-width:2px\n    linkStyle 2 stroke:#333,stroke-width:2px\n    linkStyle 3 stroke:#333,stroke-width:2px\n\n    subgraph 対策\n        F[ [ f ] FW ];\n        G[ [ g ] Web サーバ ];\n    end\n    F & G --> Block[DBMSポート閉塞];\n```\n**解答:**\n*   [ f ] : FW\n*   [ g ] : Web サーバ (順序は問いませんが、ネットワーク層からホスト層の順で記載)",
          "point": 14
        },
        {
          "label": "(3)",
          "text": "表4中の [ h ] に入れる適切なサイバー攻撃手法の名称を15字以内で答えよ。",
          "explanation": "「脆4」の対策は、「SQL文を組み立てる際に害のあるコードが入力値に含まれていないか十分にチェックして [ h ] を防止する」とあります。また、脆弱性の内容が「入力値チェックの不備によって、データベースに蓄積された非公開情報が閲覧されるおそれがあった」とあります。\n\nこれらの記述は、入力されたデータにSQLの命令文を不正に挿入し、データベースを不正に操作する「SQLインジェクション」というサイバー攻撃の手法に合致します。\n\n```mermaid\ngraph TD\n    A[利用者入力] --> B{入力値チェック};;\n    B -- 不備がある --> C[害のあるコード混入];\n    C --> D[不正なSQL文生成];\n    D --> E[データベース不正操作];\n    E --> F[非公開情報閲覧リスク];\n    B -- 対策 --> H[ [ h ] 防止];\n    style F fill:#f9f,stroke:#333,stroke-width:2px\n    style H fill:#f9f,stroke:#333,stroke-width:2px\n    linkStyle 2 stroke:#f00,stroke-width:2px,fill:none,stroke-dasharray: 5 5;\n```\n**解答:** SQLインジェクション",
          "point": 14
        }
      ]
    },
    {
      "subQNo": "設問3",
      "text": "[中長期的な脆弱性対策]について、(1), (2)に答えよ。",
      "explanation": "この設問では、中長期的な脆弱性対策として提示された項目について、具体的な内容との関連付けや、その狙いについて問われています。セキュリティ対策は短期的な修正だけでなく、継続的な取り組みが重要です。",
      "subQuestions": [
        {
          "label": "(1)",
          "text": "表5中の下線①,②の各対策に該当する項目として適切なものを解答群の中からそれぞれ選び、記号で答えよ。\n解答群\nア インシデント発生時の緊急対応体制を整備する。\nイ 公開されている脆弱性情報データベースを確認する。\nウ 実施すべきセキュリティ対策を定めて定期的に監査する。\nエ セキュリティ対策に関する予算を増額する。\nオ リスク分析を定期的に実施して対応計画を立案する。",
          "explanation": "### (1) 下線①について\n「①社外の関連する組織から脆弱性情報を入手して活用する」という対策は、外部で公開されている脆弱性情報源から情報を収集することを指します。これは「イ 公開されている脆弱性情報データベースを確認する」に該当します。\n\n### (1) 下線②について\n「②ソフトウェア開発の委託先企業のセキュリティ対策の実施状況を確認する」という対策は、委託先のセキュリティ対策が適切に実施されているかを検証する活動です。これは「ウ 実施すべきセキュリティ対策を定めて定期的に監査する」に該当します。監査は、現状の確認と評価を通じて改善を促す活動です。\n\n```mermaid\ngraph TD\n    SubGraph1[市販ソフトウェア] --> A1[更新情報入手];\n    SubGraph1 --> A2[ [ ① ] 社外の組織から脆弱性情報を入手];\n    A2 -- 該当する --> B1[イ: 公開脆弱性DB確認];\n    SubGraph1 --> A3[要員教育];\n\n    SubGraph2[自社ソフトウェア (委託開発)] --> C1[セキュアコーディング実施];\n    SubGraph2 --> C2[ [ ② ] 委託先のセキュリティ対策状況を確認];\n    C2 -- 該当する --> B2[ウ: 定期的な監査実施];\n    SubGraph2 --> C3[[ ③ ] 企画・設計段階から専門家参加];\n```\n**解答:**\n*   ① : イ\n*   ② : ウ",
          "point": 14
        },
        {
          "label": "(2)",
          "text": "表5中の下線③について、表3の項番“脆3”で発見された脆弱性への対策として、ソフトウェアの企画・設計段階からセキュリティの専門家を参加させる狙いを30字以内で述べよ。",
          "explanation": "表3の「脆3」は、「脆弱な暗号化通信方式が使用できてしまう設定であり、情報漏えいのおそれがあった」という内容です。これは、Webサーバソフトウェアの**設定**が不適切であることに起因します。\n\nソフトウェアの企画・設計段階からセキュリティの専門家を参加させる狙いは、このような脆弱性を作りこんでしまうことを未然に防ぐ「シフトレフト」の考え方に基づいています。開発の後工程で脆弱性を発見して修正するよりも、初期段階でセキュリティを考慮することで、手戻りや修正コストを大幅に削減できます。\n\n```mermaid\ngraph TD\n    A[企画段階] --> B[設計段階];\n    B --> C[開発段階];\n    C --> D[テスト段階];\n    D --> E[運用段階];\n\n    F[専門家参加] --> A;\n    F --> B;\n    F -- 狙い --> G{脆弱性を作りこまない};;\n    G -- 結果 --> H[手戻り/コスト削減];\n\n    Note right of F: 下線③の対策\n    Note right of D: 脆3のような設定不備の発見\n```\n**解答:** 設計段階で脆弱な設定や機能を作りこまないため",
          "point": 14
        }
      ]
    }
  ]
}