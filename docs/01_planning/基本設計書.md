# PM Exam DX 基本設計書・開発計画書

## 1. 開発計画 (Development Plan)

要件定義書の「段階的リリース」の方針に基づき、機能実装をフェーズ分けし、各マイルストーンを設定します。

### Grade 1: MVP（最小機能製品） - 午前I・II対策 & 進捗可視化
**目標:** 早期に学習サイクル（出題→回答→復習）を回せる状態にし、データ蓄積を開始する。

- **Milestone 1.1: 基盤構築 &認証 (Weeks 1-2)**
  - Azure環境構築 (Static Web Apps, Functions, Cosmos DB, Entra ID B2C)
  - リポジトリ構成 (Monorepo) の確立
  - ユーザー認証・登録フローの実装

- **Milestone 1.2: ドメインロジック & データ (Weeks 3-4)**
  - 過去問データのDBスキーマ設計とインポート
  - Spaced Repetition (忘却曲線) アルゴリズムの実装 (Shared Lib)
  - 午前I/II 解答判定ロジック

- **Milestone 1.3: Webフロントエンド (Weeks 5-7)**
  - ダッシュボード (バーンダウンチャート、今日のタスク) 実装
  - 試験演習UI (回答、解説表示) 実装
  - レスポンシブ対応

- **Milestone 1.4: MVPリリース (Week 8)**
  - 結合テスト、セキュリティチェック
  - 本番デプロイ

### Grade 2: 午後対策 & モバイルアプリ (Expansion)
**目標:** 記述式・論文式の学習サポートと、スマホアプリによる隙間時間活用。

- **Milestone 2.1: 午後I・II対策機能 (Weeks 9-11)**
  - 午後I: 根拠ハイライト機能
  - 午後II: モジュール式エディタ、オートセーブ機能
  - 合格者プロット共有機能

- **Milestone 2.2: モバイルアプリ開発 (Weeks 12-14)**
  - React Native (Expo) プロジェクト構築
  - Sharedロジックの組み込み
  - オフライン対応、暗記カード機能

### Grade 3: AI & パーソナライズ (Future)
- AI採点、弱点分析等の高度機能実装 (要件定義書 3.3参照)

---

## 2. フォルダ構成計画 (Directory Structure)

フロントエンド(Web/Mobile)とバックエンド(API)、共通ロジックを効率的に管理するため、Monorepo構成を採用します。

```text
IpaLab/
├── apps/                   # アプリケーション層
│   ├── web/                # Next.js (App Router) - フロントエンド
│   ├── mobile/             # React Native (Expo) - モバイルアプリ
│   └── api/                # Azure Functions (Node.js) - バックエンドAPI
├── packages/               # 共通ライブラリ層
│   ├── shared/             # 共通ロジック (Spaced Repetition, Types, Validation)
│   ├── ui/                 # 共通UIコンポーネント (将来的な共通化用)
│   └── config/             # ESLint, TSConfig 等の共通設定
├── infra/                  # インフラ構成コード (Bicep/Terraform)
│   └── azure/              # Azureリソース定義
├── docs/                   # プロジェクトドキュメント
│   ├── 01_planning/        # 要件定義、設計書、コスト試算
│   └── agent_logs/         # AIエージェント対話ログ
└── package.json            # Monorepo管理 (Workspaces / Turbo)
```

---

## 3. 開発規約 (Development Conventions)

プロジェクトの一貫性と品質を保つためのルールを定義します。

### 3.1 コーディングスタイル (Coding Style)
**言語:** TypeScript (Strict Mode) を全領域で採用。

| 対象                   | ツール・基準              | 詳細                                                                                             |
| :--------------------- | :------------------------ | :----------------------------------------------------------------------------------------------- |
| **Linter / Formatter** | **ESLint + Prettier**     | インデント2スペース、セミコロン必須、シングルクォート推奨。                                      |
| **Naming Convention**  | **CamelCase**             | 変数・関数名。クラス・コンポーネント名は **PascalCase**。定数は **UPPER_SNAKE_CASE**。           |
| **Component Design**   | **Functional Components** | React Hooksを使用。Class Componentsは原則禁止。                                                  |
| **CSS Styling**        | **CSS Modules / Vanilla** | フレームワーク依存を避けるため標準CSSまたはModulesを使用 (`.module.css`)。Tailwindは使用しない。 |
| **Comments**           | **JSDoc**                 | 公開関数や複雑なロジックにはJSDoc形式でコメントを付与。                                          |

### 3.2 ブランチ運用ルール (Branching Model)
開発スピードとCI/CDとの親和性を重視し、**GitHub Flow** をベースとした運用を行います。

- **主要ブランチ:**
  - `main`: 常にデプロイ可能なプロダクションコード。保護設定を行う。

- **作業ブランチ命名規則:**
  - 機能追加: `feature/機能名` (例: `feature/auth-login`)
  - バグ修正: `fix/バグ内容` (例: `fix/sr-algorithm-bug`)
  - リファクタリング: `refactor/対象` (例: `refactor/db-schema`)
  - ドキュメント: `docs/内容` (例: `docs/update-readme`)

- **Workflow:**
  1. `main` からブランチを作成。
  2. ローカルで開発・コミット。コミットメッセージは「feat: xxx」「fix: xxx」の形式 (Conventional Commits) を推奨。
  3. Pull Request (PR) を作成。自動テスト (CI) を通過させる。
  4. レビュー承認後、`main` にマージ (Squash Merge 推奨)。
  5. `main` へのマージをトリガーにステージング/本番環境へ自動デプロイ。

---
